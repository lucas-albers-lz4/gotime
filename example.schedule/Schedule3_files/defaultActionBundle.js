/**
 * IBM Confidential OCO Source Materials IBM Business Platform: CA Share
 * (C) Copyright IBM Corp. 2017, 2018
 *
 * The source code for this program is not published or otherwise divested of
 * its trade secrets, irrespective of what has been deposited with the U.S.
 * Copyright Office
 */

define("bi/defaultaction/views/DefaultActionView",["bi/glass/app/ContentView","jquery","bi/sharecommon/utils/translator"],function(t,e,n){var i=t.extend({init:function(t){i.inherited("init",this,arguments),e.extend(this,t)},render:function(){return this.id?new Promise(function(t,e){this._getObjectProperties(this.id).then(function(e){this._openObject(e).then(function(){this.glassContext.appController.closeAppView("defaultaction",this.id)}.bind(this)),t(this)}.bind(this)).fail(function(){this.glassContext.appController.closeAppView("defaultaction",this.id),t(this)}.bind(this))}.bind(this)):Promise.reject()},getContent:function(){return{id:this.id}},getTitle:function(){return""},_openObject:function(t){return new Promise(function(e,n){var i="com.ibm.bi.contentApps.defaultAction."+t.type;this.glassContext.appController.performAction(i,{glassContext:this.glassContext,target:{itemId:i,activeObject:{aSelectedContext:[t]}}}).then(function(){e()}).fail(function(){n()})}.bind(this))},_getObjectProperties:function(t){return this.glassContext.getSvc(".Content").then(function(e){return new Promise(function(i,o){var s={},r=e.getBaseObjectsURL()+"/"+t+"?fields=id,defaultName,owner.defaultName,type,runAsOwner,runWithOwnerCapabilities,options,executionPrompt,parameters,disabled,hidden,modificationTime,runInAdvancedViewer,permissions";e.get(r,{}).then(function(t,e,r){t.data[0]?(s=t.data[0],i(s)):(this.glassContext.appController.showToast(n.translate("error_get_object_properties"),{type:"error",newestOnTop:!0,preventDuplicates:!1,timeOut:6e3,extendedTimeOut:1e3}),o())}.bind(this)).fail(function(t){this.glassContext.appController.showToast(n.translate("error_get_object_properties"),{type:"error",newestOnTop:!0,preventDuplicates:!1,timeOut:6e3,extendedTimeOut:1e3}),o()}.bind(this))}.bind(this))}.bind(this))}});return i}),define("js/defaultaction/defaultActionBundle",function(){});