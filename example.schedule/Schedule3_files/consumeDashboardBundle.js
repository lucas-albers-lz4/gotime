/**
 * IBM Confidential OCO Source Materials IBM Business Platform: Dashboard
 * (C) Copyright IBM Corp. 2016, 2021
 *
 * The source code for this program is not published or otherwise divested of
 * its trade secrets, irrespective of what has been deposited with the U.S.
 * Copyright Office
 */

function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("dashboard-core/js/dashboard/glass/controllers/OpenActionHandler",["../../../lib/@waca/core-client/js/core-client/ui/core/Class","../../../app/util/ErrorUtils","underscore","../util/InstrumentationUtil"],(function(e,t,n,i){return e.extend({isItemVisible:function(e){return this.canExecute(e)},canExecute:function(e){var n=!1;return 1===(e.target&&e.target.activeObject&&e.target.activeObject.aSelectedContext).length&&(n=this._isSelectionValid(e,!0)),n&&t.hasCapability(e.glassContext)},doAction:function(e){return this._openDashboardView(e)},onSelectItem:function(e){return this._openDashboardView(e)},_openDashboardView:function(e){var t=e.target.activeObject.aSelectedContext[0].id;return this._getTargetPerspective(t,e).then((function(n){return i.track(e.glassContext,"viewed",{objectType:n,object:t,type:"Read Object"}),e.glassContext.appController.openAppView(n,{id:t,content:{boardId:t,isAuthoringMode:!1,objRef:t}})}))},_getTargetPerspective:function(){return Promise.resolve("dashboard")},_hasValidTags:function(e){return-1!==(e.tags||[]).indexOf("dashboard")},_isSelectionValid:function(e,t){var i=e.target&&e.target.activeObject&&e.target.activeObject.aSelectedContext;if(i){var o=i,r=Array.isArray(o),a=0;for(o=r?o:o[Symbol.iterator]();;){var A;if(r){if(a>=o.length)break;A=o[a++]}else{if((a=o.next()).done)break;A=a.value}var s=A;if(!this._hasValidTags(s))return!1;if(n.intersection([s.type],["exploration","page_asset"]).length<1)return!1;var l=["read","execute"];if(n.intersection(s.permissions,l).length<l.length)return!1;if(s.disabled&&"true"===s.disabled.toString().toLowerCase())return!1}return!0}return t||!1}})})),define("dashboard-core/js/dashboard/glass/controllers/LegacyOpenActionHandler",["./OpenActionHandler","../../../app/util/ErrorUtils"],(function(e,t){return e.extend({_getTargetPerspective:function(e,t){return this._getSpec(e,t).then((function(e){return e.timeline?"story":"dashboard"}))},_hasValidTags:function(e){return!e.tags||!e.tags.length},_getSpec:function(e,n){return n.glassContext.getSvc(".Content").then((function(i){return new Promise((function(o,r){var a=i.getBaseObjectsURL()+"/"+e;i.get(a,{dataType:"json",data:{fields:"specification"},MRUInfo:{}}).then((function(e){var t=e.data&&e.data.length&&e.data[0].specification;if(t)try{o(JSON.parse(t))}catch(e){r(e)}else o(i.get(a+"/content"))})).fail((function(i,r){t.showError(n.glassContext,r,e),o({})}))}))}))}})})),define("dashboard-core/js/dashboard/glass/controllers/CustomWidgetActionHandler",["../../../lib/@waca/dashboard-common/dist/glass/controllers/WidgetBaseActionHandler","../../../app/nls/StringResources","../../../lib/@waca/core-client/js/core-client/utils/ClassFactory","underscore"],(function(e,t,n,i){return e.extend({getDashboardView:function(e){return e.glassContext.appController.getCurrentContentView()},getUiHelperClass:function(){return n.loadModule("dashboard-core/js/lib/@waca/dashboard-common/dist/ui/WidgetAddUIHelper")},getOptions:function(e){var n=this,i=this.getDashboardView(e),o=i.getDashboardApi(),r={module:"dashboard-core/js/dashboard/views/CustomWidgetListView",label:t.get("customWidgetsTitle"),getEntries:this.getEntries.bind(this),className:"customWidgetSlideout",services:i.services,dashboardApi:o};return this._createWidgetAddUIHelper(e,o).then((function(e){return r.onItemClick=function(t,i){return n._onItemClickHandler(t,i,e,o)},r.onItemStartDrag=e.addWidgetByDrag.bind(e),r}))},_onItemClickHandler:function(e,t,n,i){var o=i.getFeature("Logger"),r=i.getFeature("Canvas");return i.getFeature("ContentTypeRegistry").isTypeRegistered(e.type)?r.addContent(e.defaultSpec).catch((function(e){o.log(e)})):n.addWidgetBySelection(e,t)},getEntries:function(e){var t=this.getDashboardView(e).getDashboardApi(),n=t.getFeature("ContentTypeRegistry");return this._createWidgetAddUIHelper(e,t).then((function(e){return e.fetchWidgetListFromPerspective("com.ibm.bi.dashboard.widgets")})).then((function(e){return e.list=i.filter(e.list,(function(e){return!e.builtin})),e.list=e.list.concat(n.getExposedContents()),e}))},_createWidgetAddUIHelper:function(e,t){var n={services:this.getDashboardView(e).services,dashboardApi:t};return this.getUiHelperClass().then((function(i){var o=new i(n);return o.panelAttributes={cdnUrl:t.getCDNUrl(),glassContext:e.glassContext},o}))}})})),define("dashboard-core/js/dashboard/glass/ModeButton",["../../lib/@waca/baglass/js/baglass/app/plugins/Button","../../app/nls/StringResources"],(function(e,t){var n=e.extend({init:function(){n.inherited("init",this,arguments),this.pressedTitle=t.get("togglePreviewModeLabel"),this.unpressedTitle=t.get("toggleEditModeLabel")},setPressed:function(){n.inherited("setPressed",this,arguments),this.$el.attr("title",this.pressedTitle),this.getIcon().attr("aria-label",this.pressedTitle)},setUnpressed:function(){n.inherited("setUnpressed",this,arguments),this.$el.attr("title",this.unpressedTitle),this.getIcon().attr("aria-label",this.unpressedTitle)},getIcon:function(){return this.$icon||(this.$icon=this.$el.find("*[role=img],img")),this.$icon}});return n})),define("dashboard-core/js/dashboard/glass/controllers/ModeActionHandler",["../ModeButton","../../../api/DashboardAPI","../../../app/nls/StringResources"],(function(e,t,n){return function(e){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(i,e),i.prototype.onPress=function(e){var i=this,o=e.glassContext.appController.getCurrentContentView().getDashboardApi();if(o.getMode()===t.MODES.VIEW)return this._checkCapabilitiesOfSources(o).then((function(t){t?o.getFeature("DashboardState").setAuthoring(!0):(i._unpressEditButton(e.glassContext.appController),o.showToast(n.get("noCapabilityForEdit"),{type:"error",preventDuplicates:!0}))})).catch((function(t){i._unpressEditButton(e.glassContext.appController),o.getFeature("Logger").error("Fail to check capabilities in Edit mode",t)}));o.getFeature("DashboardState").setAuthoring(!1)},i.prototype._unpressEditButton=function(e){e.findPlugin("com.ibm.bi.dashboard.editToggleButton").setUnpressed()},i.prototype._checkCapabilitiesOfSources=function(e){var t=e.getFeature("Capabilities");if(!t)return Promise.resolve(!0);for(var n=e.getFeature("DataSources").getDataSourceList(),i=[],o=0;o<n.length;o++)i.push({assetId:n[o].getAssetId(),type:n[o].getType()});return t.hasCapability(i)},i}(e)})),define("dashboard-core/js/dashboard/glass/controllers/OpenTemplateActionHandler",["./OpenActionHandler"],(function(e){return function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t.prototype.canExecute=function(t){return!t.glassContext.getCoreSvc(".FeatureChecker").checkValue("dashboard","dashboardTemplates","disabled")&&e.prototype.canExecute.call(this,t)},t.prototype._getTargetPerspective=function(){return Promise.resolve("dashboardTemplate")},t.prototype._hasValidTags=function(e){return-1!==(e.tags||[]).indexOf("dashboard_template")},t}(e)})),define("dashboard-core/js/dashboard/glass/controllers/PinningActionHandler",["../../../lib/@waca/dashboard-common/dist/glass/controllers/BaseSlideoutActionHandler","../../../app/nls/StringResources"],(function(e,t){return e.extend({getExtraCustomSpec:function(e){var n=e.glassContext,i=e.target,o=i&&i.plugin&&i.plugin.itemSpec,r=o&&o.content&&o.content.module||"dashboard-core/js/pinning/PinView",a=n.appController.getCurrentContentView();return{id:"dashboardPanel",reuseSlideout:!0,width:this.commonOptions.defaultWidth,position:"left",resizable:{min:300},pinning:{isPinned:!0,float:!1,display:!1},label:t.get("pinsOld"),content:{module:r,glassContext:n,services:a.services,canvasController:a.boardLoader.canvasController}}}})})),define("dashboard-core/js/dashboard/glass/UndoRedoButton",["../../lib/@waca/baglass/js/baglass/app/plugins/Button","../../lib/@waca/dashboard-common/dist/ui/react_toolbar/components/Button","react"],(function(e,t,n){return function(e){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(i,e),i.prototype.init=function(e){Object.assign(this,e),this.itemSpec.action=this.onPress.bind(this),this.itemSpec.callbacks={registerCallback:this.onRender.bind(this),unregisterCallback:function(){}},this.myRef=n.createRef()},i.prototype.canEnable=function(){return!0},i.prototype.onPress=function(){},i.prototype.onRender=function(){this._toggleState(this)},i.prototype.onStateChange=function(e){this._toggleState(this,e)},i.prototype.render=function(){return n.createElement(t,{itemSpec:this.itemSpec,setSelectedSubMenu:function(){}})},i.prototype._toggleState=function(e,t){e&&(t&&this.canEnable(t)?e.enable():e.disable())},i}(e)})),define("dashboard-core/js/dashboard/glass/controllers/RedoActionHandler",["../UndoRedoButton"],(function(e){return e.extend({onPress:function(){var e=this.glassContext.appController.getCurrentContentView().getDashboardApi();e&&e.redo()},canEnable:function(e){return e.canRedo()}})})),define("dashboard-core/js/dashboard/glass/controllers/SaveActionHandler",["underscore","../../../lib/@waca/core-client/js/core-client/ui/core/Class","../../../app/util/ErrorUtils","../../../app/util/CapabilityUtils"],(function(e,t,n,i){var o=["status","name","saveRequest","assetId","url","savedSpec","cmSpec"];return t.extend({getContentView:function(e){return e.glassContext.appController.currentAppView.currentContentView},getDashboardView:function(e){return this.getContentView(e)},getStringResourcesService:function(e){return this.getContentView(e).services.getSvcSync(".StringResources")},_getDashboardApi:function(e){return this.getContentView(e).getDashboardApi()},_getContextContent:function(e){return this.getContentView(e).getContent()},onSelectItem:function(e){var t=this;return i.hasCapabilityToSaveDashboard(e,!0).then((function(n){if(n){var i=t.getDashboardView(e),o=i.getBoardId(),r="com.ibm.bi.dashboard.save"===e.target.itemId;o&&r&&i.canAuthor()?t.save(e,!0,!0):t.saveAs(e,o)}}))},isItemVisible:function(e){var t=this.getDashboardView(e),i=t.getDashboardApi().getType().toUpperCase(),o="com.ibm.bi.dashboard.save"===e.target.itemId;return"EXPLORE"===i?!o||t.canAuthor():o?t.canAuthor()&&n.hasCapability(e.glassContext,"canAuthorDashboard"):n.hasCapability(e.glassContext,"canAuthorDashboard")},_require:function(e,t){return require(e,t)},saveAs:function(e,t){var n=this,i=this.getDashboardView(e).boardModel.name;return this._getAncestors(e,t).then((function(t){return e.glassContext.getSvc(".ContentDialogFactory").then((function(o){n._saveAsDialog=o.createSaveAsDialog({glassContext:e.glassContext,defaultFileName:i,service:{context:e,save:n.onSaveAs.bind(n)},ancestors:t}),n._saveAsDialog.open()}))}))},_getAncestors:function(e,t){return this._getContentService(e).then((function(e){return e.getAncestors({id:t})}))},onSaveAs:function(e,t,n,i){var r=e.context;return this._getSaveFeature(r).saveAs(n,t.url,i,o).then(this._onSaveAsSuccess.bind(this,r),this._onSaveAsError.bind(this,r)).then(this._invokeLifeCycleHandlers.bind(this,"saveas.after",r)).finally(this._saveAsDialog.hide.bind(this._saveAsDialog))},_onSaveAsError:function(e,t){var i=n.getErrorCode(t.saveRequest);if("cmDuplicateName"===i){var o={isDuplicate:!0};return Promise.reject(o)}return 0===i.lastIndexOf("cmAddWithReplaceFailed",0)||0===i.lastIndexOf("cmInvalidReference",0)?(o={isReplaceFailed:!0},Promise.reject(o)):(n.showError(e.glassContext,t.saveRequest,t.cmSpec),Promise.resolve())},_onSaveAsSuccess:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getContentView(e);return n.setSavedInstance(t.savedSpec),this._getContentService(e).then((function(e){return e.onSaveAsSuccess({url:t.url})})).done(function(i){var o=this._getDashboardApi(e);i&&(i.id&&n.boardModel.set({id:i.id},{silent:!0}),i.permissions&&n.setPermissions(i.permissions)),n.boardModel.set({name:t.name},{silent:!0});var r=o.getFeature("segment"),a={type:"Updated Object"};r.track("savedAs",(function(){return a})),o.getFeature("DashboardState").setDirty(!1),n.boardController.undoRedoController.registerSaveAction(),e.glassContext.appController.updateCurrentCachedAppView();var A=this._getAppConfig(e);A&&A.saveThumbnail&&this._saveThumbnail(e,i&&i.id);var s=this.getStringResourcesService(e);return e.glassContext.appController.showToast(s.get("dashboard_save_success")),this._invokeSaveServiceHandlers(e,{saveAs:!0,stringResources:s,context:e,spec:o.getFeature("Serializer").toJSON()})}.bind(this))},_getContentService:function(e){return e.glassContext.getSvc(".DashboardContent")},save:function(e,t,i){var r=this,a=this.getDashboardView(e),A=a.getDashboardApi(),s=a.getBoardId(),l=A.getFeature("Serializer").toJSON(),c=null;return this._getSaveFeature(e).save(o).then((function(t){var n=t.savedSpec;return n&&(c=n),r._invokeLifeCycleHandlers("save.after",e)})).then((function(){var n=r.getStringResourcesService(e),o=A.getFeature("segment"),d={type:"Updated Object"};o.track("saved",(function(){return d})),A.getFeature("DashboardState").setDirty(!1),a.boardController.undoRedoController.registerSaveAction(),a.setSavedInstance(c);var u=r._getAppConfig(e);u&&u.saveThumbnail&&r._saveThumbnail(e,s),i&&e.glassContext.appController.showToast(n.get("dashboard_save_success")),t&&r._invokeSaveServiceHandlers(e,{saveAs:!1,stringResources:n,context:e,spec:l})})).catch((function(t){"cmEmptySelection"===n.showError(e.glassContext,t)&&r.saveAs(e)}))},_invokeLifeCycleHandlers:function(e,t){var n=this.getDashboardView(t).getDashboardApi();return n.getFeature("LifeCycle").invokeHandlers(e).catch((function(e){n.getGlassCoreSvc(".Logger").error("[SaveActionHandler] Life cycle handlers error",e)}))},_invokeSaveServiceHandlers:function(e,t){var n=this._getDashboardApi(e);return this._getSaveServiceExtensionCollection(e.glassContext,n).then(function(i){var o=[];return i&&(t.resaveDashboardSpecCallback=this.save.bind(this,e,!1,!1),i.forEach((function(e){var i=n.getFeature(e.name);i&&i.onDashboardSave&&o.push(i.onDashboardSave(t))}))),Promise.all(o)}.bind(this))},_getSaveServiceExtensionCollection:function(e,t){var n=t.getCollectionConfig("saveServices");return n?Promise.all([e.appController.findCollection(n.id)]).then((function(e){return e[0]})):Promise.resolve()},_getAppConfig:function(e){var t=this._getContextContent(e);return t&&t.options&&t.options.config},_saveThumbnail:function(e,t){var n=this;return this._createThumbnail(e).then((function(i){return n._getContentService(e).then((function(e){return e.saveThumbnail({thumbnailDataUri:i,id:t})}))}))},_createThumbnail:function(e){var t=this.getDashboardView(e),n=t.getDashboardApi().getFeature(".Thumbnail");return n&&n.generateImage(t.el)},_getSaveFeature:function(e){return this._getDashboardApi(e).getFeature("Save")}})})),define("dashboard-core/js/lib/@waca/dashboard-common/dist/utils/URLUtil",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.getBoardIdFromUrl=function(e){var t=e&&e.slice(e.lastIndexOf("/")+1);if(t)return t},e}()})),define("dashboard-core/js/dashboard/glass/controllers/SaveAsTemplateActionHandler",["./SaveActionHandler","../../../dashboard/glass/util/SaveActionUtil","../../../app/util/ErrorUtils","../../../app/util/GlassUtil","../../../lib/@waca/dashboard-common/dist/utils/URLUtil"],(function(e,t,n,i,o){return e.extend({onSelectItem:function(e){var t=this.getContentView(e).getBoardId();this.saveAsTemplate(e,t)},isItemVisible:function(e){return!e.glassContext.getCoreSvc(".FeatureChecker").checkValue("dashboard","dashboardTemplates","disabled")&&this._isBoardTypeSupported(e)&&n.hasCapability(e.glassContext,"canAuthorDashboard")},_isBoardTypeSupported:function(e){return"dashboard"===this.getContentView(e).getDashboardApi().getType()},saveAsTemplate:function(e,t){var n=this,i=this.getDashboardView(e);return this._getAncestors(e,t).then((function(t){return e.glassContext.getSvc(".ContentDialogFactory").then((function(o){var r=n.getStringResourcesService(e);n._saveAsTemplateDialog=o.createSaveAsDialog({glassContext:e.glassContext,defaultFileName:r.get("dashboard_template_prefix",{name:i.boardModel.name}),service:{context:e,save:n.onSaveAsTemplate.bind(n)},ancestors:t}),n._saveAsTemplateDialog.open()}))}))},onSaveAsTemplate:function(e,t,n,i){return this._executeSaveAsTemplateRequest(e.context,t.url,n,i).then(this._onSaveAsTemplateSuccess.bind(this),this._onSaveAsError.bind(this,e.context)).finally(this._saveAsTemplateDialog.hide.bind(this._saveAsTemplateDialog))},_onSaveAsTemplateSuccess:function(e){var t=this,n=e.context,i=n.glassContext;return i.appController.openAppView("dashboardTemplate",{perspective:"dashboardTemplate",content:{perspective:"dashboardTemplate",boardId:o.getBoardIdFromUrl(e.saveRequest.getResponseHeader("location")),isAuthoringMode:i.appController.getCurrentContentView().isAuthoringMode}}).then((function(){var e=t.getStringResourcesService(n),o=t.getContentView(n),r=o.getBoardId(),a=o.getDashboardApi().getCanvas(),A=a.findContent({type:"widget"}).filter((function(e){return"widget.filter"===e.getType()}));A.length&&(A.forEach((function(e){a.removeContent(e.getId())})),i.appController.showToast(e.get("dashboard_template_filters_removed"),{type:"warning"}),t.save(n,!0,!1));var s=a.getContent(o.boardModel.getSelectedLayout()).findContent({type:"widget"}).map((function(e){var t=e.getFeature("state");return t.whenStatusChanges(t.STATUS.RENDERED)}));return Promise.all(s).then((function(){return t._saveThumbnail(n,r).catch((function(e){i.getCoreSvc(".Logger").error(e)}))})).then((function(){i.appController.showToast(e.get("dashboard_template_save_success"))}))}))},_executeSaveAsTemplateRequest:function(e,n,o,r){var a=this,A=e.glassContext,s=i.getAjaxService(A),l=this.getDashboardView(e),c=l.getDashboardApi(),d=c.getFeature("ConvertToTemplate"),u=c.getFeature("Serializer").toJSON();return t.cleanUnusedCustomColors(c,u,l.boardModel),o&&(u.name=o),new Promise((function(t,i){d.convertToTemplate(u).then((function(o){var l=a._getCMSpec(o,e);n+=r?"?updateAction=replace&ignoreInvalidObjectReference=true":"?ignoreInvalidObjectReference=true",s.post(n,{contentType:"application/json",processData:!1,dataType:"text",data:JSON.stringify(l)}).done((function(n,i,o){t({saveRequest:o,context:e})})).fail((function(e,t){i({saveRequest:t,cmSpec:u,glassContext:A})}))}))}))},_getCMSpec:function(e,n){var i=Object.assign(e,{dataSources:{}}),o=this.getContentView(n).getDashboardApi();return{defaultName:i.name,type:t.getAssetType(o),specification:JSON.stringify(i),tags:["dashboard_template"]}}})})),define("dashboard-core/js/dashboard/glass/controllers/ShareActionHandler",["../../../lib/@waca/core-client/js/core-client/ui/core/Class","../../../app/nls/StringResources"],(function(e,t){return e.extend({init:function(e){this.vidaMapAnimTimeout=e&&e.vidaMapAnimTimeout||1e4},execute:function(e){if(e.urlMap.objRef){var t={perspective:e&&e.target&&e.target.activeObject&&e.target.activeObject.aSelectedContext&&e.target.activeObject.aSelectedContext[0].tags&&-1!==e.target.activeObject.aSelectedContext[0].tags.indexOf("story")?"story":"dashboard",objRef:e.urlMap.objRef,action:"view",mode:e.urlMap.mode?e.urlMap.mode:"dashboard"},n=e.glassContext.appController.getCurrentContentView();return"dashboard"===n.perspective&&"function"==typeof n.boardController.layoutController.getCurrentSubViewId&&(t.subView=n.boardController.layoutController.getCurrentSubViewId()),t}throw new Error("Unable to resolve share context. Missing objRef.")},getShareableItems:function(e){var n=[],i=e.glassContext.appController.getCurrentContentView();if("dashboard"===i.perspective){var o={};o.el=i.el,"function"==typeof i.boardController.layoutController.getCurrentSubViewTitle?o.label=t.get("screenshot_label_tab",{title:i.getTitle(),tabName:i.boardController.layoutController.getCurrentSubViewTitle()}):o.label=t.get("screenshot_label",{title:i.getTitle()}),n.push(o)}return this.reRenderMaps(i).then((function(){return n}))},isEnabled:function(e){var t=e.context;if(t){var n=1===t.length&&t[0]&&t[0].tags;return n&&(-1!==n.indexOf("dashboard")||-1!==n.indexOf("story"))}return!0},_triggerDataPlayerEvent:function(e,t){var n=t.dashboardApi;n&&n.triggerDashboardEvent(e)},enterShareState:function(e){var t=this;return Promise.resolve().then((function(){var n=e.glassContext.appController.getCurrentContentView();t._triggerDataPlayerEvent("open:sharePanel",n)}))},leaveShareState:function(e){var t=this;return Promise.resolve().then((function(){var n=e.glassContext.appController.getCurrentContentView();t._triggerDataPlayerEvent("close:sharePanel",n)}))},reRenderMaps:function(e){var t=e.boardController.layoutController,n=e.boardModel.getSelectedLayout(),i=e.dashboardApi.getCanvas().getContent(n).findContent({type:"widget"}).filter((function(e){var t=e.getFeature("Visualization");return!(!t||"Tiledmap"!==t.getType())})).map((function(e){return e.getId()}));return i.length>0?Promise.map(i,(function(e){return t.widgetLoader.getWidget(e).mapVizRenderForPrint()})).delay(this.vidaMapAnimTimeout):Promise.resolve()},canExportToPDF:function(){return!0},getInstrumentation:function(e){return e.glassContext.appController.getCurrentContentView().getDashboardApi().getFeature("segment").getInfo({type:"Shared Object"})},exportToPDF:function(e,t,n){var i=e.glassContext.appController.getCurrentContentView().getDashboardApi(),o=i.getFeature("Canvas").getContent().getId(),r={pageSize:t,printFilters:n};if(!i.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard","pdf2.0","enabled"))return i.getFeature("Print").print(o,e.glassContext.appController,r);i.getFeature("PrintClient").print(r)}})})),define("dashboard-core/js/dashboard/glass/controllers/UndoActionHandler",["../UndoRedoButton"],(function(e){return e.extend({onPress:function(){var e=this.glassContext.appController.getCurrentContentView().getDashboardApi();e&&e.undo()},canEnable:function(e){return e.canUndo()}})})),define("dashboard-core/js/dashboard/glass/controllers/WidgetsPanelHandler",["underscore","../../../lib/@waca/dashboard-common/dist/glass/controllers/WidgetBaseActionHandler","../../../app/nls/StringResources","../../../lib/@waca/core-client/js/core-client/utils/ClassFactory","../../widgets/staticwidget/ShapeWidget"],(function(e,t,n,i,o){return t.extend({getDashboardView:function(e){return e.glassContext.appController.getCurrentContentView()},getUiHelperClass:function(){return i.loadModule("dashboard-core/js/lib/@waca/dashboard-common/dist/ui/WidgetAddUIHelper")},createWidgetAddUIHelper:function(e){var t=this.getDashboardView(e);return this.uiHelperClassOptions={dashboardApi:t.getDashboardApi(),services:t.services},this.getUiHelperClass().then(function(n){var i=new n(this.uiHelperClassOptions);return i.panelAttributes={canvasController:t.boardLoader.canvasController,cdnUrl:t.getCDNUrl(),ajaxSvc:t.ajaxSvc,glassContext:e.glassContext},i}.bind(this))},getOptions:function(e){var t=this.getDashboardView(e),i={className:"widgetsPanelSlideout",title:n.get("widgetsPanelTitle"),module:"dashboard-core/js/dashboard/views/WidgetsPanelView",getEntries:this.getEntries.bind(this,e),services:t.services,dashboardApi:t.getDashboardApi()};return Promise.resolve(i)},getEntries:function(e){var t=e.glassContext;return Promise.all([this._getShapeWidgets(t),this._getImageLibrary(t),this._getWidgets(t)]).then((function(e){var t=e[0],n=e[1],i={widgets:e[2],images:{},shapeWidgets:t};return n&&n.list&&n.list.length>0&&(i.images=n),i})).then(this.getSpecs.bind(this,e))},getSpecs:function(e,t){var i=this._getWidgetColorsHelper(t.widgets),o=e.glassContext.getCoreSvc(".Config").getConfigValue("BIProxy.jupyter",!1),r=e.glassContext.getCoreSvc(".Config").getConfigValue("WatsonStudio.wsUrl",!1);return Promise.all([this.createWidgetAddUIHelper(e),this._getShapeSpecHelper(t.shapeWidgets,i),this._getImageLibrarySpecHelper(t.images),o,r]).then(function(i){var o=i[0],r=i[1],a=i[2],A=i[3],s=i[4],l=this.getDashboardView(e).getDashboardApi().getFeature("Icons"),c={},d={onItemClick:o.addWidgetBySelection.bind(o),onItemStartDrag:o.addWidgetByDrag.bind(o)};c.options=d,c.items={};var u="dashboard-core/js/dashboard/widgets/staticwidget/";return c.items.widgets=[this._formulateWidgetSpec(n.get("textWidgetLabel"),l.getIcon("text-creation").id,u,"TextWidget"),this._formulateWidgetSpec(n.get("imageWidgetLabel"),l.getIcon("image").id,u,"ImageWidget"),this._formulateWidgetSpec(n.get("mediaWidgetLabel"),l.getIcon("video-file").id,u,"MediaWidget"),this._formulateWidgetSpec(n.get("webpageWidgetLabel"),l.getIcon("webpage").id,u,"WebpageWidget")],this._addWidgets(t.widgets.list,"basicWidgets",c.items.widgets,l),c.allItems=[].concat(c.items.widgets),c.items.advancedWidgets=[],(A||s)&&c.items.advancedWidgets.push(this._formulateWidgetSpec(n.get("notebookWidgetLabel"),l.getIcon("notebook").id,"","notebook/DashboardWidget")),this._addWidgets(t.widgets.list,"advancedWidgets",c.items.advancedWidgets,l),c.allItems=c.allItems.concat(c.items.advancedWidgets),c.items.shapes=r,c.allItems=c.allItems.concat(r),a&&a.length>0&&(c.items.images=a,c.allItems=c.allItems.concat(a)),c}.bind(this))},_formulateWidgetSpec:function(e,t,n,i,o){return{label:e,name:e,icon:t,content:{widget:n+i,name:e,title:e,fragment:o}}},_addWidgets:function(e,t,n,i){var o=this;(e||[]).filter((function(e){return e.sections&&-1!==e.sections.indexOf(t)})).forEach((function(e){var t=i&&i.getIcon(e.icon),r=t?t.id:e.icon;n.push(o._formulateWidgetSpec(e.label,r,"",e.widget,e.fragment))}))},_getShapeSpecHelper:function(t,i){var r=[],a=i&&i["com.ibm.bi.dashboard.widgets.shape"];return e.each(t.list,(function(e){e.options.fillColor=a.fillColor,e.options.borderColor=a.borderColor,e.options.fillColorIndex=a.fillColorIndex,e.options.borderColorIndex=a.borderColorInder;var t=o.getDefaultSpec(e.name,e.options).then((function(t){return{label:n.get(e.name),name:n.get(e.name),svg:t.model.content,content:e}}));r.push(t)})),Promise.all(r)},_getImageLibrarySpecHelper:function(t){var n=[];return t.list&&e.each(t.list,(function(e){n.push({label:e.name,name:e.name,image:e.options,content:e})})),Promise.resolve(n)},_getWidgetColorsHelper:function(t){var n={};if(t.list){var i=function(t,n){return e.find(t,(function(e){return e.id===n}))};e.each(t.list,(function(e){if(n[e.id]={},e.propertyList){var t=i(e.propertyList,"fillColor"),o=i(e.propertyList,"borderColor");n[e.id].fillColor=t&&t.defaultValue,n[e.id].borderColor=o&&o.defaultValue}}))}return n},_getShapeWidgets:function(e){return this._getEntries(e,"com.ibm.bi.dashboard.shapes","dashboard-core/js/dashboard/widgets/staticwidget/ShapeWidget")},_getImageLibrary:function(e){return this._getEntries(e,"com.ibm.bi.common.media","dashboard-core/js/dashboard/widgets/staticwidget/ImageWidget")},_getWidgets:function(e){return this._getEntries(e,"com.ibm.bi.dashboard.widgets","dashboard-core/js/dashboard/widgets/staticwidget/StaticWidget")},_getEntries:function(t,n,i){return this.createWidgetAddUIHelper({glassContext:t}).then((function(e){return e.fetchWidgetListFromPerspective(n)})).then((function(t){return t&&e.each(t.list,(function(e){e.widget||(e.widget=i)})),t}))}})})),define("text!dashboard-core/js/dashboard/views/templates/LoadingIndicator.html",[],(function(){return'/**\n * Licensed Materials - Property of IBM\n * IBM Cognos Products: BI Cloud\n * (C) Copyright IBM Corp. 2020\n * US Government Users Restricted Rights - Use, duplication or disclosure restricted by GSA ADP Schedule Contract with IBM Corp.\n */\n<div class="loadingIndicatorContainer">\n    <div class="loading_indicator"></div>\n</div>'})),define("dashboard-core/js/dashboard/views/WidgetsContentContainer",["react","prop-types","@ba/ba-ui-carbon-toolkit","../../lib/@waca/dashboard-common/dist/utils/HtmlXSSUtils"],(function(e,t,n,i){var o=e.Component,r=n.Container,a=n.FlexLayout,A=n.FlexItem,s=n.VSpacer,l=n.SVGIcon,c=function(t){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(n,t),n.prototype.componentDidMount=function(){this.props.handlers.componentDidMountCallback(this.props.containerClass,this.props.itemClass)},n.prototype.componentWillUnmount=function(){this.props.handlers.componentWillUnmountCallback(this.props.containerClass,this.props.itemClass)},n.prototype.render=function(){var t=this,n=this.props,i=n.containerClass,o=n.items,l=[];return o.forEach((function(e){var n=t.renderWidgetItem(e);n&&l.push(n)})),l.length?e.createElement(r,{className:i},e.createElement(a,{fullHeight:!0,direction:"column",justifyContent:"flex-start"},e.createElement(A,null,e.createElement(s,{size:2})),e.createElement(A,null,e.createElement(a,{fullHeight:!0,direction:"row",wrap:"wrap"},l)))):null},n.prototype.renderWidgetItem=function(t){var n=this._getIconMarkup(t);return n?e.createElement(A,{role:"group",className:"prop-item","data-name":t.name},e.createElement(a,{fullHeight:!0,direction:"column",alignItems:"center",tabIndex:0,className:"prop-icon",role:"button",title:t.label,"aria-label":t.label},n)):null},n.prototype._getIconMarkup=function(e){return e.icon?this._renderIcon(e.icon):e.svg?this._renderSvg(e.svg):e.image?this._renderImage(e.image):null},n.prototype._renderIcon=function(t){return e.createElement(A,null,e.createElement(l,{iconId:t,className:"svgIcon"}))},n.prototype._renderSvg=function(t){return e.createElement(A,null,e.createElement("div",{dangerouslySetInnerHTML:{__html:i.sanitizeHtml(t)}}))},n.prototype._renderImage=function(t){var n=t.imageLink,i=t.altText;return e.createElement(A,null,e.createElement("img",{src:n,alt:i}))},n}(o);return c.propTypes={items:t.array.isRequired,containerClass:t.string.isRequired,itemClass:t.string.isRequired,handlers:t.shape({componentDidMountCallback:t.func.isRequired,componentWillUnmountCallback:t.func.isRequired}).isRequired},c})),define("dashboard-core/js/dashboard/views/WidgetsPanelView",["../../lib/@waca/core-client/js/core-client/ui/core/View","../../lib/@waca/core-client/js/core-client/ui/KeyCodes","underscore","jquery","doT","text!./templates/LoadingIndicator.html","react","react-dom","prop-types","@ba/ba-ui-carbon-toolkit","../../app/nls/StringResources","./WidgetsContentContainer"],(function(e,t,n,i,o,r,a,A,s,l,c,d){var u=a.Component,h=l.Container,g=l.ProgressIndicator,f=l.Tabs,p=l.TabPanel,m=l.VSpacer,C=l.Label,B=l.FlexLayout,v=l.FlexItem,w=function(e){function t(){_classCallCheck(this,t);for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];var r=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(i)));return r.state={selectedTab:r.props.selectedTab,deleteable:!1,editable:!1,addable:!1,align:"left",tabs:r.props.tabs},r}return _inherits(t,e),t.prototype.render=function(){var e=this._renderTabPanels(),t=1===e.length?"widgets-panel-tabs hide-tabs":"widgets-panel-tabs";return a.createElement(h,{className:"widgets-panel-container"},a.createElement(m,{size:2}),a.createElement(C,{className:"widgets-panel-banner",label:c.get("widgets")}),a.createElement(m,{size:2}),a.createElement(f,{className:t,selected:this.state.selectedTab,onChange:this.onChange.bind(this)},e))},t.prototype._renderTabPanels=function(){var e=[];e.push(a.createElement(p,{id:"Basics",label:c.get("widgetsPanelBasicsTab")},this._renderBasicsPanel()));var t=this.props.tabs.items.images;return t&&t.length&&e.push(a.createElement(p,{id:"ImagesTab",label:c.get("widgetsPanelImageLibraryTab")},this._renderImageWidgets(t))),e},t.prototype._renderBasicsPanel=function(){if("Basics"===this.state.selectedTab){var e=this.props.tabs.items,t=e.widgets,n=e.advancedWidgets,i=e.shapes,o=this._renderSection("standard",c.get("widgetsPanelSectionStandard"),t),r=this._renderSection("advanced",c.get("widgetsPanelSectionAdvanced"),n),A=this._renderSection("shapes",c.get("widgetsPanelSectionShapes"),i);return a.createElement("div",null,o,r,A)}return null},t.prototype._renderSection=function(e,t,n){if(n&&n.length){var i="widgets-"+e+"-container",o="widgets-"+e+"-banner",r="widgets-"+e+"-icons-container";return a.createElement(h,{className:i},a.createElement(m,{size:3}),a.createElement(C,{className:o,label:t}),this._renderWidgets(r,n))}return null},t.prototype._renderImageWidgets=function(){if("ImagesTab"===this.state.selectedTab){var e=this._renderWidgets("widgets-images-icons-container",this.props.tabs.items.images);return a.createElement(h,{className:"widgets-images-container"},e)}return null},t.prototype._renderWidgets=function(e,t){return a.createElement(d,{containerClass:e,itemClass:"prop-item",items:t,handlers:this.props.tabs.handlers})},t.prototype.onChange=function(e){this.setState({selectedTab:e})},t.prototype._renderProgressIndicator=function(){return a.createElement(B,{fullHeight:!0,direction:"column",justifyContent:"center",width:"100%",height:"100%"},a.createElement(v,{alignSelf:"center"},a.createElement(g,null)))},t}(u);w.propTypes={tabs:s.object.isRequired,dashboardApi:s.object.isRequired,selectedTab:s.string.isRequired},w.defaultProps={selectedTab:"Basics"};var b=function(e){return n.chain(e).map((function(e){return"."+e})).value().join(" ")};return function(e){function n(){_classCallCheck(this,n);for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];var A=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(i))),s=i[0];return A.getEntries=s.getEntries,A.selectedTab=s.selectedTab||"Basics",A.dashboardApi=s.dashboardApi,A.glassContext=s.glassContext,A.dndManager=A.dashboardApi.getFeature("DashboardDnd.internal"),A.loadingIndicatorTemplate=o.template(r||""),A.viewState={},A}return _inherits(n,e),n.prototype.init=function(){var t;this.events={"clicktap .widgets-panel-container .prop-item":"_onItemClick","mousedown .widgets-panel-container .prop-item":"_onItemMouseDownStartDrag","keydown .widgets-panel-container .prop-item":"_onItemKeyDown"};for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];(t=e.prototype.init).call.apply(t,[this].concat(i))},n.prototype.remove=function(){var t;this._dropZone&&(this._dropZone.remove(),this._dropZone=null),this.dndManager=null,A.unmountComponentAtNode(this.$el[0]);for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];(t=e.prototype.remove).call.apply(t,[this].concat(i))},n.prototype.render=function(){var e=this;return this._showLoadingIndicator(),this.getEntries().then((function(t){return e.items=t.allItems,e.options=t.options,t.items})).then((function(t){e.viewState.handlers={componentDidMountCallback:e._componentDidMountCallback.bind(e),componentWillUnmountCallback:e._componentWillUnmountCallback.bind(e)},e.viewState.items=t,A.render(a.createElement(w,{tabs:e.viewState,dashboardApi:e.dashboardApi,selectedTab:e.selectedTab}),e.$el[0])})).finally((function(){e._hideLoadingIndicator(),e._dropZone=e.dndManager.addDropTarget(e.$el[0],{accepts:e._accepts.bind(e)})}))},n.prototype._showLoadingIndicator=function(){this.$el.append(this.loadingIndicatorTemplate({})),this.loadingIndicatorContainer=this.$el.find(".loadingIndicatorContainer"),this.loadingIndicator=this.loadingIndicatorContainer.find(".loading_indicator"),A.render(a.createElement(g,null),this.loadingIndicator.get(0))},n.prototype._hideLoadingIndicator=function(){this.loadingIndicatorContainer&&(this.loadingIndicatorContainer.remove(),this.loadingIndicatorContainer=null,A.unmountComponentAtNode(this.loadingIndicator.get(0)))},n.prototype._accepts=function(){return!0},n.prototype._componentDidMountCallback=function(e,t){for(var n=this._onItemHoldAndStartDrag.bind(this),o=b([e,t]),r=this.$el.find(o),a=0;a<r.length;++a){var A=i(r[a]);A.hammer(),A.on("hold",n)}},n.prototype._componentWillUnmountCallback=function(e,t){for(var n=this._onItemHoldAndStartDrag.bind(this),o=b([e,t]),r=this.$el.find(o),a=0;a<r.length;++a){i(r[a]).off("hold",n)}},n.prototype._getEntry=function(e){var t=i(e.target).closest(".prop-item").data("name");return this.items.find((function(e){return e.name===t})).content},n.prototype._onItemKeyDown=function(e){e.keyCode!==t.ENTER&&e.keyCode!==t.SPACE||this._onItemClick(e)},n.prototype._onItemClick=function(e){var t=e.currentTarget;if(!0!==i.data(t,"_clickEventReceived")&&(i.data(t,"_clickEventReceived",!0),setTimeout((function(){i.data(t,"_clickEventReceived",!1)}),500),this.options.onItemClick)){var n=this._getEntry(e);this._setDashboardApi(n),this.options.onItemClick(n,e),e&&e.gesture&&e.gesture.preventDefault()}},n.prototype._onStartDrag=function(e){if(this.options.onItemStartDrag){e.preventDefault&&e.preventDefault();var t=this._getEntry(e);this._setDashboardApi(t),this.options.onItemStartDrag(t,e)}},n.prototype._setDashboardApi=function(e){e.options||(e.options={}),e.options.dashboardApi=this.glassContext.appController.getCurrentContentView().getDashboardApi()},n.prototype._onItemHoldAndStartDrag=function(e){e.showAvatarImmediately=!0,this._onStartDrag(e)},n.prototype._onItemMouseDownStartDrag=function(e){this._onStartDrag(e)},n}(e)})),define("dashboard-core/js/dashboard/views/react_custom_widget/CustomWidgetGridView",["react","prop-types","@ba/ba-ui-carbon-toolkit","@ba/ba-ui-carbon","../../../app/nls/StringResources"],(function(e,t,n,i,o){var r=n.SVGIcon,a=n.SearchInput,A=n.Container,s=n.FlexLayout,l=n.FlexItem,c=n.Label,d=n.Multilinetruncatedtext,u=i.ClickableTile,h=function(t){function n(e){_classCallCheck(this,n);var i=_possibleConstructorReturn(this,t.call(this,e));return i.state={filteredWidgets:i.props.customWidgets},i}return _inherits(n,t),n.prototype._onSearchInputChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.props.customWidgets;if(e){var n=function(t){return-1!==t.title.toLowerCase().indexOf(e.toLowerCase())};t=this.props.customWidgets.filter(n)}this.setState({filteredWidgets:t})},n.prototype._renderCustomWidgetTitle=function(t){return e.createElement(l,null,e.createElement(A,{className:"customWidgetTitleContainer",width:74,height:32},e.createElement(d,{className:"customWidgetTitle",numLines:2,key:t,value:t,title:t,disableTooltip:!1})))},n.prototype._renderCustomWidgetIcon=function(t){return t.svgIcon?e.createElement(l,null,e.createElement(r,{iconId:t.svgIcon,height:22,width:22,className:"svgIcon"})):t.iconUrl?e.createElement(l,null,e.createElement("img",{className:"listitem-icon listitem-icon-detail",src:t.iconUrl,width:22,height:22})):void 0},n.prototype._renderClickableTile=function(t){return e.createElement(u,{className:"customWidgetTile",width:90,height:92,handleKeyDown:this.props.onKeyDown,handleClick:this.props.handleClick,"data-id":t.id},e.createElement(s,{fullHeight:!0,direction:"column",alignItems:"center",justifyContent:"center",tabIndex:0,className:"customWidgetLayout",role:"button","aria-label":t.label,width:90,height:92},this._renderCustomWidgetIcon(t),this._renderCustomWidgetTitle(t.title)))},n.prototype._renderCustomWidgetItem=function(t){return e.createElement(l,{role:"group",className:"prop-item","data-name":t.name,width:90,height:92,style:{margin:"4px"}},this._renderClickableTile(t))},n.prototype._renderCustomWidgets=function(){var t=this;return e.createElement(s,{fullHeight:!0,className:"customWidgetsContainerLayout",direction:"column",justifyContent:"flex-start"},e.createElement(l,null,e.createElement(s,{fullHeight:!0,direction:"row",wrap:"wrap"},this.state.filteredWidgets.map((function(e){return t._renderCustomWidgetItem(e)})))))},n.prototype._renderSearchView=function(){var t=this;return e.createElement(a,{className:"customWidgetSearch",value:"",hideLeftIcon:!1,placeholder:o.get("searchPanel"),onChange:function(e){return t._onSearchInputChange(e)},size:"sm"})},n.prototype.render=function(){return e.createElement(A,{className:"customWidgetViewContainer"},e.createElement(c,{className:"customWidgetPanelHeader",label:o.get("customWidgetsTitle")}),e.createElement(A,{className:"customWidgetView"},this._renderSearchView(),this._renderCustomWidgets()))},n}(e.Component);return h.propTypes={customWidgets:t.array,onKeyDown:t.func,handleClick:t.func},h})),define("dashboard-core/js/dashboard/views/CustomWidgetListView",["../../lib/@waca/core-client/js/core-client/ui/core/View","../../lib/@waca/dashboard-common/dist/ui/CenterLoadingSpinner","./react_custom_widget/CustomWidgetGridView","@ba/ba-ui-carbon-toolkit","react","react-dom","underscore"],(function(e,t,n,i,o,r,a){var A=i.keyboardUtils.keyNames,s=e.extend({events:{"mousedown .customWidgetTile":"onItemStartDrag","drag .customWidgetTile":"onItemStartDrag"},init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.inherited("init",this,arguments),this.options=e},_getEntry:function(e){var t=this.getTarget(e.target,"customWidgetTile").getAttribute("data-id");return this.widgetMap[t]},onItemClick:function(e){if(this.options.onItemClick){var t=this._getEntry(e);this.options.onItemClick(t,e),this._setDashboardApi(t),e&&e.gesture&&e.gesture.preventDefault()}},onItemStartDrag:function(e){if(this.options.onItemStartDrag){var t=this._getEntry(e);this._setDashboardApi(t),this.options.onItemStartDrag(t,e)}},onKeyDown:function(e){e.key.toUpperCase()===A.ENTER&&this.onItemClick(e)},_setDashboardApi:function(e){e.options||(e.options={}),e.options.dashboardApi=this.options.glassContext.appController.getCurrentContentView().getDashboardApi()},getListItems:function(){var e=this;return this.options.getEntries({glassContext:this.options.glassContext}).then((function(t){return Array.isArray(t.list)?(t.list=t.list.filter((function(e){return!!e&&e.id})),e.list=t.list):e.list=[],e.widgetMap=a.object(a.map(t.list,(function(e){return[e.id,e]}))),e.list}))},_renderSpinner:function(){var e=document.createElement("div");this.$el.append(e);return r.render(t({variant:"circle",size:"normal"}),e),this.getListItems().then((function(){return r.unmountComponentAtNode(e)}))},render:function(){return this._renderSpinner().then(function(){var e=this;return new Promise((function(t){r.render(o.createElement(n,{customWidgets:e.list,onKeyDown:e.onKeyDown.bind(e),handleClick:function(t){return e.onItemClick(t)}}),e.$el[0],t)}))}.bind(this))}});return s})),define("dashboard-core/js/dashboard/glass/controllers/CustomWidgetButton",["../../../lib/@waca/baglass/js/baglass/app/plugins/Button"],(function(e){var t=e.extend({init:function(e){t.inherited("init",this,arguments);var n=e.glassContext.appController;this._determineVisibility(n)},_determineVisibility:function(e){var t=this;e.findCollection("com.ibm.bi.dashboard.widgets").then((function(t){return t.filter((function(e){return!e.builtin})).length>0||e.findCollection("com.ibm.bi.dashboard.contentTypes").then((function(e){return(e||[]).some((function(e){return e.expose}))}))})).then((function(e){e?t.show():(t.hideForever=!0,t.hide())}))}});return t})),define("dashboard-core/js/dashboard/UndoRedoController",["underscore","chronology","./util/EventConstants","../lib/@waca/dashboard-common/dist/core/APIContext"],(function(e,t,n,i){return function(){function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,o),this.undoRedoExclusionList={"change:name":1,"change:id":1,"change:_meta":1},this.canvasModel=e,this.transactionApi=t.transaction,this.listeners={},this._removeApiEvents=[],this.canvasModel.on("all",this.addToUndoRedoStack.bind(this),this.canvasModel),this.logger=t.logger,this.currentMode=t.mode||"canvasMode",this.isStateDirty=t.isStateDirty||!1,this.undoRedoStacks={},this.changeModeName=n.changeModeAction,this._getUndoRedoStack(),this.getPublicProperties()}return o.prototype.destroy=function(){this._removeApiEvents.forEach((function(e){return e&&"function"==typeof e&&e()}))},o.prototype.registerAPIEvents=function(e){var t=this;if(e&&e.on){var n=e.on("all",(function(n){n.info&&n.info.supportsUndoRedo&&t._addAPIEventToUndoRedo(e,n)}));this._removeApiEvents.push(n)}},o.prototype._addAPIEventToUndoRedo=function(e,t){t.tracking&&t.tracking.undoActions&&this.addToUndoRedoStack(this._convertAPIEventToUndoAction(e,t))},o.prototype._convertAPIEventToUndoAction=function(e,t){return{value:"redo",prevValue:"undo",data:{undoRedoTransactionId:t&&t.transactionToken&&t.transactionToken.transactionId,transactionToken:t.transactionToken,transactionParamIndex:t.info.transactionParamIndex},sender:t.context&&t.context.undoRedo?"UndoRedoController":"api",senderContext:{applyFn:this._apiEventApplyFn.bind(this,e,t)}}},o.prototype._apiEventApplyFn=function(e,t,n,o,r,a){var A=this,s=void 0,l=a&&a.transactionToken,c=new i({undoRedo:!0,transactionToken:l}),d=this._executeTrace(t.tracking.callStack,[e]);if("undo"===n){var u=t.tracking.undoActions,h=[];u.forEach((function(e){h.push({fn:A._executeAction.bind(A),args:[e,d,c]})})),s=this._executeActions(h)}else{var g=t.tracking.action;s=this._executeAction(g,d,c)}return s instanceof Promise&&(s=s.catch((function(e){throw A.logger.error("An error occured while executing an API undo trace",e),e}))),s},o.prototype._executeTrace=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[].concat(t);return e&&e.forEach((function(e){var t=n[n.length-1];e&&".."===e.name?n.pop():e&&t&&"function"==typeof t[e.name]&&n.push(t[e.name].apply(t,e.params))})),n},o.prototype._executeAction=function(e,t,n){var i=this,o=void 0,r=this._executeTrace(e.callStack,t),a=r[r.length-1];if(e&&a&&"function"==typeof a[e.name]){var A=JSON.parse(JSON.stringify(e.params||[]));if(A.unshift(n),o=a[e.name].apply(a,A),e.resultActions)(Array.isArray(o)?o:[o]).forEach((function(t,o){var r=e.resultActions[o];r&&r.forEach((function(e){i._executeAction(e,t,n)}))}))}else this.logger.warn("undo/redo: missing action in event or action does not exist in API ",e,a);return o},o.prototype.getPublicProperties=function(){return{addToUndoRedoStack:this.addToUndoRedoStack.bind(this),clearStack:this.clearStack.bind(this),addListener:this.addListener.bind(this),removeListener:this.removeListener.bind(this),canUndo:this.canUndo.bind(this),canRedo:this.canRedo.bind(this),undo:this.undo.bind(this),redo:this.redo.bind(this),setMode:this.setMode.bind(this),setDirty:this.setDirty.bind(this),registerSaveAction:this.registerSaveAction.bind(this),registerAPIEvents:this.registerAPIEvents.bind(this),isDirty:this.isDirty.bind(this),destroy:this.destroy.bind(this)}},o.prototype._validateUndoRedoAction=function(e){return!!(e&&e.senderContext&&e.senderContext.applyFn)&&("UndoRedoController"!==e.sender&&(!e.data||!e.data.transactionToken||!(e.data.transactionToken||{}).eventGenerated))},o.prototype.addToUndoRedoStack=function(e){if(this._validateUndoRedoAction(e)){var t=this._checkTransaction(e);if(t){var n={up:function(){this.call||t.up(e.upValue?e.upValue:e.value,"UndoRedoController",e.name)},down:function(){t.down(e.prevValue,"UndoRedoController",e.name)},call:!1,name:e.name,prevDirtyState:this.isStateDirty};this.logger.debug("UndoRedoController:addToUndoRedoStack",e.data?e.data.undoRedoTransactionId:e.data,e.name,e.value,e.prevValue),this._getUndoRedoStack().add(n)}}},o.prototype.setDirty=function(e){this.isStateDirty=e},o.prototype.clearStack=function(){var t=this,n=this._getUndoRedoStack();n&&n.clear(),e.each(this.listeners,(function(e){e.onStateChange(t)}))},o.prototype._checkTransaction=function(e){if(e.data&&(e.data.saveOnly||e.data.skipUndoRedo||e.data.runtimeOnly))return null;var t={up:e.senderContext.applyFn,down:e.senderContext.applyFn},n=e.data?e.data.undoRedoTransactionId:null;if(n){var i=this._getTransactionsMap(),o=i[n];if(o)return o.push(e),null;o=[e],i[n]=o,t.up=function(){this._redoTransaction(o)}.bind(this),t.down=function(){delete i[n],this._undoTransaction(o)}.bind(this)}return t},o.prototype._redoTransaction=function(e){for(var t=this,n=this.transactionApi.startTransaction(),i=void 0,o=void 0,r=[],a=0;a<e.length;a++)(o=(i=e[a]).senderContext.applyFn)&&(i.data.transactionToken=n,i.data.undoRedoTransactionId=n.transactionId,i.data.undoRedoTransactionType="redo",r.push({fn:o,args:[i.upValue?i.upValue:i.value,"UndoRedoController",i.name,i.data]}));var A=this._executeActions(r);A instanceof Promise?this.lastUndoRedoOpPromise=A.catch((function(e){throw t.logger.error("An error occured while executing the redo stack",e),e})).finally((function(){t.transactionApi.endTransaction(n)})):this.transactionApi.endTransaction(n)},o.prototype._undoTransaction=function(e){for(var t=this,n=this.transactionApi.startTransaction(),i=void 0,o=void 0,r=[],a=e.length-1;a>=0;a--)(o=(i=e[a]).senderContext.applyFn)&&(i.data.transactionToken=n,i.data.undoRedoTransactionId=n.transactionId,i.data.undoRedoTransactionType="undo",r.push({fn:o,args:[i.prevValue,"UndoRedoController",i.name,i.data]}));var A=this._executeActions(r);A instanceof Promise?this.lastUndoRedoOpPromise=A.catch((function(e){throw t.logger.error("An error occured while executing the undo stack",e),e})).finally((function(){t.transactionApi.endTransaction(n)})):this.transactionApi.endTransaction(n)},o.prototype._executeActions=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=void 0;n<e.length;){var o;if(i=(o=e[n]).fn.apply(o,e[n].args),n++,i instanceof Promise){i=i.then((function(){return t._executeActions(e,n)}));break}}return i},o.prototype.addListener=function(e,t){"function"==typeof t.onStateChange&&(this.listeners[e]=t)},o.prototype.removeListener=function(e){delete this.listeners[e]},o.prototype.canUndo=function(){return this._getUndoRedoStack().undos.length>0},o.prototype.canRedo=function(){return this._getUndoRedoStack().redos.length>0},o.prototype._trackDirtyState=function(e){if(e&&e[0]){var t=e[0].prevDirtyState;e[0].prevDirtyState=this.isStateDirty,e[0].name!==this.changeModeName&&this.setDirty(t)}},o.prototype.undo=function(){var e=this._getUndoRedoStack();this._trackDirtyState(e.undos),e.undo();var t=this.lastUndoRedoOpPromise||Promise.resolve();return this.lastUndoRedoOpPromise&&(this.lastUndoRedoOpPromise=null),t},o.prototype.redo=function(){var e=this._getUndoRedoStack();this._trackDirtyState(e.redos),e.redo();var t=this.lastUndoRedoOpPromise||Promise.resolve();return this.lastUndoRedoOpPromise&&(this.lastUndoRedoOpPromise=null),t},o.prototype.onAdd=function(){this.enableState("undo",!0),this.enableState("redo",!1)},o.prototype.enableState=function(t,n){this.canvasModel.trigger("undo:state",{senderContext:this,stack:t,enabled:n}),e.each(this.listeners,function(e){e.onStateChange(this)}.bind(this))},o.prototype.setMode=function(e){var t=void 0;"canvasMode"!==this.currentMode&&(t=this.undoRedoStacks[this.currentMode].transactions,delete this.undoRedoStacks[this.currentMode]),this.currentMode=e||"canvasMode",this._mergeUndoStacks(t);var n=this._getUndoRedoStack();this.enableState("undo",n.undos.length>0),this.enableState("redo",n.redos.length>0)},o.prototype.registerSaveAction=function(){var t=this._getUndoRedoStack();e.forEach(t.undos,(function(e){e.prevDirtyState=!0}))},o.prototype.isDirty=function(){return this.isStateDirty},o.prototype._getUndoRedoStack=function(){return this.undoRedoStacks[this.currentMode]||(this.undoRedoStacks[this.currentMode]=new t({limit:150,onAdd:this.onAdd.bind(this),onRedo:this.enableState.bind(this,"undo",!0),onUndo:this.enableState.bind(this,"redo",!0),onBegin:this.enableState.bind(this,"undo",!1),onEnd:this.enableState.bind(this,"redo",!1)}),this.undoRedoStacks[this.currentMode].transactions={}),this.undoRedoStacks[this.currentMode]},o.prototype._getTransactionsMap=function(){return this.undoRedoStacks[this.currentMode].transactions},o.prototype._mergeUndoStacks=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.each(n,(function(e){e.forEach((function(e){t.addToUndoRedoStack(e)}))}))},o}()})),define("dashboard-core/js/dashboard/CopyPasteController",["underscore","./util/DashboardSpecHelper","../app/nls/StringResources","../app/util/CapabilityUtils"],(function(e,t,n,i){return function(){function o(e){_classCallCheck(this,o),this.layoutController=e.layoutController,this.dashboardApi=e.dashboardApi,this.logger=e.logger,this.model=e.model,this.api=e.api,this.specType=e.type||"DASHBOARD",this.clipboard=this.dashboardApi.getGlassCoreSvc(".Clipboard")}return o.prototype.destroy=function(){this.layoutController=null,this.dashboardApi=null,this.logger=null,this.model=null,this.api=null,this.clipboard=null},o.prototype.getSpecHelper=function(){var e=this;return this.specHelper?Promise.resolve(this.specHelper):this.layoutController.getInteractionController().then((function(n){return e.specHelper=new t(n),e.specHelper}))},o.prototype.doCopy=function(e){var t=this;return this.getSpecHelper().then((function(n){var i,o=(new Date).getTime(),r=void 0;return(i=e)&&"DASHBOARD"!==i.type&&i.count?r=e:(r=t.selectFromSpecForCopyPaste(n)).type=t.specType,r.timestamp=o,t.clipboard.set(r).then((function(){return r.errMsg&&t._showToast(r.errMsg),r.count>0?t._showToast("copy",{count:r.count}):null}))})).catch((function(e){return t._showError("specCopyErr",e)}))},o.prototype.doPaste=function(e){var t=this,o=null,r=this.dashboardApi.getFeature("Canvas").getSelectedContentList({type:"tab"});return r.length&&(o=r[0].getId()),e?this.getConvertedSpec(e).then((function(e){var o=e?JSON.parse(e):void 0;return o?i.checkAuthoringCapability(t.dashboardApi,o,n.get("noCapabilityForPaste")).then((function(e){return e?o:void 0})):o})).catch((function(e){return t._showError("specConvertErr",e)})):this.getConvertedSpec(this.specType).then((function(e){if(e)return t.getSpecHelper().then((function(t){return t.validateDashboardSpec(e)}))})).then((function(e){return i.checkAuthoringCapability(t.dashboardApi,e,n.get("noCapabilityForPaste")).then((function(t){return t?e:null}))})).then((function(e){if(e)return t.layoutController.interactionController.selectionHandler.deselectAll(),t._performPaste(e,o)})).catch((function(e){return t._showError("specConvertErr",e)}))},o.prototype.getConvertedSpec=function(e){var t=this;return this.clipboard.get().then((function(n){return t._doConvert(n,e)}))},o.prototype._doConvert=function(e,t){var i=e.type,o=e.spec;return"REPORT"==i?(this._showError("pasteNotSupportedErr",{name:n.get("reportParam")}),null):i!==t&&o?this.dashboardApi.getGlassSvc(".ConversionService").then((function(e){return e.convert(i,t,o)})):Promise.resolve(o)},o.prototype.selectFromSpecForCopyPaste=function(e){var t={spec:null,count:0};return this.dashboardApi.getCanvas().getSelectedContentList().length&&(t=e.getContentsToJSONSpec()),t},o.prototype._performPaste=function(t,n){var i=this;t.nonMergedWidgets&&(t.widgets=t.nonMergedWidgets,delete t.nonMergedWidgets);function o(n,i,o){var r=function(t,n){return e.find(t,(function(e){return n===e.id}))}(t.widgets,n);r&&(!function(n,i){n.data&&n.data.dataViews&&e.each(n.data.dataViews,(function(n){var o=e.find(t.dataSources.sources,(function(e){return e.id===n.modelRef}));i[n.modelRef]=o}))}(r,o),i.push(r))}var r=function(n){var r={},a=null;if(i._isTypeRegistered(n.type))a=n;else{if(r.layout=n,t.widgets&&t.widgets.length){var A=[],s={};if(n.items&&function e(t,n,i){t.forEach((function(t){o(t.id,n,i),t.items&&e(t.items,n,i)}))}(n.items,A,s),o(n.id,A,s),A.length)if(r.widgets=A,r.dataSources={version:t.dataSources.version,sources:e.values(s)},n.content&&n.content.properties)-1!==Object.keys(n.content.properties).indexOf("explicitScale")&&delete n.content.properties.explicitScale}t.drillThrough&&t.drillThrough.length&&(r.drillThrough=t.drillThrough),t.properties&&(r.properties=t.properties),t.fredIsRed&&(r.fredIsRed=t.fredIsRed),t.episodes&&(r.episodes=t.episodes)}return{content:a,model:r}},a=function(e,o){var a=function(e){return e<t.layout.length?t.layout[e]:void 0}(e);if(a){var A=r(a);return A.copyPaste=!0,A&&(A.content||A.model&&A.model.layout)?i.dashboardApi.getFeature("Canvas").addContent({containerId:n,spec:A.content||A.model,copyPaste:!0},o).then((function(e){var t=e.getId();return i.layoutController.whenWidgetRenderComplete(t).then((function(e){i.layoutController.interactionController.selectionHandler.selectNode(e.domNode,{isTouch:!1})}))})):Promise.reject(new Error("Unable to complete pasting of widget(s). Can not determine the layout fragment"))}return Promise.reject(new Error("Unable to complete pasting of widget(s). Checking for a layout that is not there"))};if(t){if(t.layout){for(var A=[],s=this.dashboardApi.getFeature("Transaction"),l=s.startTransaction(),c=0;c<t.layout.length;c++)A.push(a(c,l));return s.endTransaction(l),Promise.all(A)}return Promise.resolve()}return Promise.resolve()},o.prototype._isTypeRegistered=function(e){return this.dashboardApi.getFeature("ContentTypeRegistry").isTypeRegistered(e)},o.prototype._showError=function(e,t){return this.logger.error(n.get(e),t),t instanceof Error&&(t=null),this._showToast(e,t,{type:"error",preventDuplicates:!0})},o.prototype._showToast=function(e,t,i){var o=t?n.get(e,t):n.get(e);return this.dashboardApi.showToast(o,i)},o}()})),define("dashboard-core/js/dashboard/contentpane/SlideoutHelper",["jquery","../../lib/@waca/core-client/js/core-client/ui/core/Class"],(function(e,t){return t.extend({createAndShowSlideout:function(t,n){var i=this;this._slideout=this.glassContext.appController.showSlideOut(t),this._slideout.$el.addClass("dashboardPane");var o=function(){try{e(window).resize()}catch(e){console.error(e)}};this._slideout.on("done:show",o),this._slideout.on("hide",(function(){i._closeSlideout(),n&&n.target&&n.target.plugin&&n.target.plugin.setUnpressed&&n.target.plugin.setUnpressed(),o()}))},isSlideoutOpen:function(){return this._slideout&&this._slideout.isOpen()},_closeSlideout:function(){this._slideout&&(this._slideout.hide({force:!0}),delete this._slideout)},onHide:function(){this.isSlideoutOpen()&&this._closeSlideout()}})})),define("dashboard-core/js/dashboard/widgets/PropertyListUtil",["jquery","underscore","../../lib/@waca/core-client/js/core-client/utils/UniqueId","../../app/nls/StringResources"],(function(e,t,n,i){return new(function(){function t(){_classCallCheck(this,t)}return t.prototype.processProperties=function(t,n,i){var o=this;if(!t)return!1;var r=i.getDashboardCoreSvc("TranslationService"),a=function(e){r&&e.translationIconNode&&(r.removeTranslationIcon(e.translationIconNode),e.translationIconNode=null)},A=function(e,t,i,o){e.displayMultiplier&&(i=Math.round(i/e.displayMultiplier)),this._callPropertyOnChangeCallback(e,t,i),n.setPropertyValue(t,i,o),a(e)},s=[],l=0;return t.slice().forEach((function(r,c){var d="function"==typeof r.onChange?r.onChange.bind(r):null;if(!1!==r.public&&"Banner"!==r.type){var u=o._getPropertiesOverride(r,n);if(!0===u.removeProperty)return t.splice(c-l,1),void l++;e.extend(r,u),r.id&&!r.name&&(r.name=r.id);var h=["Group","CollapsibleSection","SingleLineLinks","Split",void 0];if("ColorPicker"===r.type&&r.paletteType)s.push(o.handleColorPickerProperty(r,n,i));else if("NewPalette"===r.type||"Palette"===r.type)r.type="NewPalette",s.push(o.handleNewPaletteProperty(r,n,i));else if("ToggledCombo"===r.type)o._handleToggledComboProperty(r,n);else if("IconPicker"===r.type)o._handleIconPickerProperty(r,n);else if(r.module&&r.module.indexOf("UiSlider")>=0)o._handleUISlider(r,n);else if("pageSizeWidth"===r.name||"pageSizeHeight"===r.name)o._getPropertyDisplayValueWithUnits(n,r);else if(h.indexOf(r.type)>-1)s.push(o.processProperties(r.items,n,i));else if(o._isALayoutPositionProperty(r.name))o._handleLayoutPositionalProperty(n,r);else if("rotateAngle"===r.id){var g=n.getPropertyValue(r.id);r.value=o.getRotateDisplayString(g)}else if(["text","icon","Separator","SectionLabel"].indexOf(r.type)<0){var f=n.getPropertyValue(r.id);if(null==f&&(f=r.value),"CheckBox"===r.type||"ToggleButton"===r.type)r.checked=!1!==f&&(!0===f||!0===r.defaultValue||f&&f===r.defaultValue);else if("DropDown"===r.type){var p=void 0;p=null!=f?f.hasOwnProperty("name")?f.name:f:r.defaultValue,r.defaultValue=p}else r.value=f||0===f?f:"";if(r.displayMultiplier&&r.value){var m=r.value*r.displayMultiplier;r.value=r.decimalPlaces?m.toFixed(r.decimalPlaces):Math.round(m)}r.onChange=r.onChange||A.bind(o,r)}d&&(r.onChange=function(e,t,n,i){d(t,n,i),a(e)}.bind(o,r)),e.extend(r,u)}})),Promise.all(s)},t.prototype._isALayoutPositionProperty=function(e){return-1!==["left","top","width","height"].indexOf(e)},t.prototype._getPropertiesOverride=function(e,t){var n={};return"function"==typeof e.preRenderCallback&&(n=e.preRenderCallback(e,t)),n},t.prototype._callPropertyOnChangeCallback=function(e,t,n){e.onChangeCallback&&e.onChangeCallback(t,n)},t.prototype._handleUISlider=function(e,t){var n=t.getPropertyValue(e.name);"percentage"===e.sliderType&&(n=n||0===n?n:e.defaultValue||1,n=parseInt(100*n,10)),e.start=n||0===n?[n]:[e.defaultValue],e.startLabels=[e.description||e.label],e.onChange=function(n,i,o){var r=n[0];e.format&&e.format.postfix&&(r=r.substring(0,r.indexOf(e.format.postfix))),"percentage"===e.sliderType&&(r*=.01),this._callPropertyOnChangeCallback(e,e.name,r,o),t.setPropertyValue(e.name,r,o)}.bind(this)},t.prototype._handleToggledComboProperty=function(e,t){var n=t.getPropertyValue(e.name);e.inputOptions||(e.inputOptions={}),e.checkBoxOptions||(e.checkBoxOptions={}),e.dropDownOptions||(e.dropDownOptions={}),e.useToggleButton=!0,n?(e.dropDownOptions.defaultValue=n.unit,e.inputOptions.value=n.value,e.checkBoxOptions.checked=n.autoRefresh):(e.inputOptions.value=e.inputOptions.defaultValue||"",e.checkBoxOptions.checked=!1),e.validateInput=this._validateToggleComboProperty.bind(this),e.onChange=function(n,i,o){this._callPropertyOnChangeCallback(e,n,i),t.setPropertyValue(n,i,o)}.bind(this)},t.prototype._handleIconPickerProperty=function(e,t){if(!e.values){var n=t.getPropertyValue(e.name);null!=n?e.values=n:void 0!==e.defaultValue&&(e.values=e.defaultValue)}e.onChange||(e.onChange=function(n,i,o){var r=i;i.length&&1===i.length?r=i[0].name:i.length&&(r=[],i.forEach((function(e){r.push(e.name)}))),this._callPropertyOnChangeCallback(e,n,r),t.setPropertyValue(n,r,o)}.bind(this))},t.prototype._getMaxMinRefreshValuesForUnits=function(e){var t=(Math.pow(2,31)-1)/1e3,n=void 0,i={};switch(e){case"minutes":i.min=1,n=t/60,i.max=Math.ceil(n-1);break;case"hours":i.min=1,n=t/3600,i.max=Math.ceil(n-1);break;default:i.min=5,i.max=Math.ceil(t-1)}return i},t.prototype._validateToggleComboProperty=function(t,n){if(!t||!n)return!1;var i=e.isNumeric(t);if(i){var o=this._getMaxMinRefreshValuesForUnits(n);i=t>=o.min&&t<=o.max}return i},t.prototype.handleNewPaletteProperty=function(e,t,n,i){var o=this;if(!e.paletteType)throw new Error('Palette property needs a "paletteType"',e);var r=n.getFeature("Colors"),a=t&&t.getPropertyValue(e.name)||e.defaultValue||r.getDefaultPaletteName(e.paletteType),A=!1!==e.allowPaletteReverse&&("HeatPalette"===e.paletteType||"ConditionalPalette"===e.paletteType),s="HeatPalette"===e.paletteType?"continuous":"standard",l=e.isReversed?e.isReversed:function(){return"DarkerForLowerValue"===(e.reversePalettePropName&&t.getPropertyValue(e.reversePalettePropName))&&A};return e.menuItems=[],A&&e.menuItems.push("reverse"),e.reverse=l(),e.createPaletteType=s,r.getPalette({paletteId:a,type:e.paletteType,defaultPaletteId:e.defaultValue,addMissingBaseColors:e.addMissingBaseColors,defaultIfNotFound:!0,forProperties:!0}).then((function(a){e.palette=a,e.hasSection=!0,e.readOnly=!0,a.my&&!a.public&&e.menuItems.push("edit"),e.onChangePalette||(e.onChangePalette=i||function(n,i,r){o._callPropertyOnChangeCallback(e,n,i.id),t.setPropertyValue(n,i.id,r)});var A=function(t){var n="__CM__"+t;return e.onChangePalette(e.name,{id:n}),n};return e.onCreatePalette=A,e.onReversePalette?e.onChange=e.onReversePalette:e.onChange=function(n,i){var r=!0===i.reverse?"DarkerForLowerValue":"DarkerForHigherValue";o._callPropertyOnChangeCallback(e,e.reversePalettePropName,r),t.setPropertyValue(e.reversePalettePropName,r)},e.changePaletteCb=function(){n.getDashboardSvc("propertiesManager").then((function(i){var o={label:e.linkLabel,overlay:!0,width:"320px",content:{module:"authoring-common/changePaletteView",selectedId:a.id,onCreatePalette:A,createPaletteType:s,name:e.name,getPalettes:function(){return r.getPalettes({type:e.paletteType,includeUserColorPalette:e.includeUserColorPalette,forProperties:!0,includePatternPalettes:e.includePatternPalettes})},getPaletteId:e.getPaletteId?e.getPaletteId:t.getPropertyValue.bind(t,e.id),reverse:l(),onChange:e.onChangePalette,component:"dashboard"}};n.prepareGlassOptions(o),i.addChild(o)}))},e}))},t.prototype.addCustomColorCapability=function(e,t){if(e.createCustomColor=function(e){var n=t.addCustomColor(e),i=t.createColorDefinition(n,e,e);return i.type="ColorCode",i.hidden=!0,i},t.isCustomColor(e.selectedName)&&e.items){var n=t.getHexColorFromClassName(e.selectedName),i=t.createColorDefinition(e.selectedName,n,n);i.hidden=!0,e.items.push(i)}return e},t.prototype._getColorPalettePropertyValue=function(e,t,n,i){return e.getPropertyValue(n)||t.getDefaultPaletteName(i)},t.prototype.handleColorPickerProperty=function(e,t,n){var i=this;if(!e.paletteType)throw new Error('Color picker property needs a "paletteType"',e);var o=n.getFeature("Colors");e.onChange=function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];var r=[].concat(i).filter((function(e){return void 0!==e}));if(3!==r.length)throw new Error("Invalid arguments passed.");var a=r[0],A=r[1],s=r[2];this._callPropertyOnChangeCallback(e,e.propertyName,A.name),t.setPropertyValue(a,A.name,s)}.bind(this);var r=t.getPropertyValue(e.name);return e.selectedName||("number"==typeof r||null==r?e.selectedName=!r&&0!==r&&e.defaultValue?e.defaultValue:r:"string"==typeof r&&(o.isCustomColor(r)?e.selectedName=r:(e.selectedName=o.getColorClassName(r),o.isCustomColor(e.selectedName)&&!1!==e.addButton&&(e.addButton=!0)))),this._getColorPickerColors(e,t,n).then((function(t){return e.palettePropertyName?(e.items=[],t.forEach((function(t,n){e.items.push({id:n,name:n,value:t.hexValue,type:"ColorCode",label:t.label})}))):e.items||(e.items=t),e.addButton&&(e=i.addCustomColorCapability(e,o)),e.selectedName>t.length?e.selectedName=0:e.selectedName||0===e.selectedName||void 0===e.defaultColorIndex||(e.selectedName=e.defaultColorIndex),e}))},t.prototype._getColorPickerColors=function(e,t,n){var i=n.getFeature("Colors");if("DashboardColorSet"===e.paletteType)return Promise.resolve(i.getDashboardColorSet().slice(0));var o=e.palettePropertyName?this._getColorPalettePropertyValue(t,i,e.palettePropertyName,e.paletteType):i.getColorSetId();return i.getPaletteColors({paletteId:o,type:e.paletteType,addMissingBaseColors:e.addMissingBaseColors}).then((function(e){return e.slice(0)}))},t.prototype.getGeneralProperties=function(e,t){var n=[{id:"fillColor",type:"ColorPicker",label:i.get("propFillColor"),showHexValue:!0,addButton:!0,open:!1,ariaLabel:i.get("propFillColor"),paletteType:"ColorPalette",defaultValue:"color1",tabName:i.get("tabName_general"),sectionName:i.get("sectionName_appearance")},{id:"borderColor",type:"ColorPicker",label:i.get("propBorderColor"),open:!1,showHexValue:!0,addButton:!0,ariaLabel:i.get("propBorderColor"),paletteType:"ColorPalette",defaultValue:"transparent",tabName:i.get("tabName_general"),sectionName:i.get("sectionName_appearance")}];return e?this.processProperties(n,e,t).then((function(){return n})):Promise.resolve(n)},t.prototype.propertyUIControlToPublicAPI=function(e,t,n){var i=this,o=[],r=function(e,t){if("authoring"!==n.getMode())return n.getGlassCoreSvc(".Logger").error("Trying to set a property without being in authoring mode."),!1;if(e.customValidatorCallback){var i=e.customValidatorCallback(t);if(i&&!1===i.isValid)return n.getGlassCoreSvc(".Logger").error(i.message),!1}if(e.onChange){if(e.module&&e.module.indexOf("UiSlider")>=0)e.onChange([t]);else if("ColorPicker"===e.type){var o=t&&t.startsWith("#")?n.getFeature("Colors").addCustomColor(t):t;e.onChange(e.name,{name:o})}else"NewPalette"===e.type?e.onChangePalette(e.name,{id:t}):e.onChange(e.name,t);return!0}},a=function(e,t){var n=t.getPropertyValue(e.name);return n||(void 0!==e.defaultValue?e.defaultValue:null)};return e.forEach((function(e){if("Banner"===e.type||!1===e.public||!e.onChange)return null;var n={name:e.name,getValue:a.bind(i,e,t),setValue:r.bind(i,e)};o.push(n)})),o},t.prototype.getPropertyDisplayString=function(e,t,n){return null!=e?(t&&(t=t.trim(),n&&(t=" "+t)),String(Number(e.toFixed(t===i.get("pixelUnit")?0:2)))+t):""},t.prototype._getPropertyDisplayValueWithUnits=function(e,t){var n=e.getPropertyValue(t.id);t.value=this.getPropertyDisplayString(n,i.get("pixelUnit"),!0)},t.prototype._handleLayoutPositionalProperty=function(e,t){var n=e.getPropertyValue(t.id),i=parseFloat(n);t.value=this.getPropertyDisplayString(i,n.replace(/[\d.-]/g,""),!0)},t.prototype.getRotateDisplayString=function(e){var t=String.fromCharCode(176);return null!=e?e+" "+t:""},t.prototype._isValidPropertyId=function(e){return/^[a-zA-Z0-9]*$/.test(e)},t}())})),define("dashboard-core/js/dashboard/contentpane/ExtendLayoutPropertiesV1Helper",[],(function(){var e=["general.layout.alignWidget"],t=["onChange","onChangePalette"];return function(){function n(e){var t=e.propertyLayoutSpec,i=void 0===t?[]:t,o=e.contents,r=void 0===o?[]:o,a=e.dashboard,A=e.transaction;if(_classCallCheck(this,n),i.length!==r.length)throw new Error("propertyLayoutSpec and contents array size do not match");return this.propertyLayoutSpec=i,this.contents=r,this.dashboard=a,this.transaction=A,this.callbackMap={},{extendLayoutProperties:this._extendLayoutProperties.bind(this)}}return n.prototype._extendLayoutProperties=function(){var e=this;this.propertyLayoutSpec.forEach((function(t,n){e._extendPropertyLayoutSpec(e.contents[n],t,[])}))},n.prototype._extendPropertyLayoutSpec=function(n,i,o){var r=this;Array.isArray(i)&&i.forEach((function(i){var a=JSON.parse(JSON.stringify(o));a.push(i.id);var A=a.join(".");t.forEach((function(t){if(i[t]&&-1===e.indexOf(A)){var o=A+"__"+t,a=i[t];r._addCallbackToMap(o,n,i,a),i[t]=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r._executeCallbacks.apply(r,[o].concat(t))}}})),r._extendPropertyLayoutSpec(n,i.items,a)}))},n.prototype._addCallbackToMap=function(e,t,n,i){this.callbackMap[e]||(this.callbackMap[e]=[]),this.callbackMap[e].push({content:t,callback:i,property:n})},n.prototype._executeCallbacks=function(e){var t=this.callbackMap[e]||[];if(t.length){for(var n=!1,i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];var a=[].concat(o);a.length>2&&(a.length=2);var A=this.transaction.startTransaction();t.forEach((function(e){var t=e.content,i=e.property,o=e.callback,r=t.getPropertyValue(i.id);o.apply(void 0,[].concat(a,[A]));var s=t.getPropertyValue(i.id);n||(n="InputLabel"===i.type&&(null!=r||null!=s)&&r===s)})),this.transaction.endTransaction(A),n&&this.dashboard.triggerDashboardEvent("properties:refreshPane")}},n}()})),define("dashboard-core/js/dashboard/contentpane/PropertyUIControlView",["../../lib/@waca/core-client/js/core-client/ui/core/View","../../lib/@waca/core-client/js/core-client/ui/properties/PropertyUIControl"],(function(e,t){var n=e.extend({init:function(e){n.inherited("init",this,arguments),this.options=e||{},this._propertyUIControl=null,this._isMainPropertyUIControl=this.options.items&&"Banner"===this.options.items[0].type,this.setFocus=this.options.onSetFocus,this.node=this.options.node,this.setPropertySpec(this.options.items)},setPropertySpec:function(e){this._propertySpec={el:this.node||this.$el,glassContext:this.options.glassContext,items:e},this._isMainPropertyUIControl&&e&&e.length&&(this._propertySpec.ariaLabel=e[0].value),this._propertySpec.primaryUIControl=!1,this.options&&(this._propertySpec.onCloseCb=this.options.onCloseCb||null,this._propertySpec.closeCallback=this.options.closeCallback||null)},render:function(e){var n=this;this.$el.parent().addClass("dashboardPropertiesPane");return(this._propertyUIControl?this._propertyUIControl.onClose().then((function(){n._propertyUIControl.remove(),n.$el.empty()})):Promise.resolve()).then((function(){return n._propertySpec&&n._propertySpec.items&&n._propertySpec.items.length?(n._propertyUIControl=new t(n._propertySpec),n._propertyUIControl.render().then((function(){return n._isMainPropertyUIControl&&!e&&n._propertyUIControl.focus(),n.options&&n.options.renderCallback&&n.options.renderCallback(),n._propertySpec&&n._showMissingTranslationsIcon(n._propertySpec.items),n._propertyUIControl}))):Promise.resolve()}))},getPropertyUIControl:function(){return this._propertyUIControl},onClose:function(){return this._propertyUIControl.onClose()},_showMissingTranslationsIcon:function(e){e.forEach(function(e){e.items?this._showMissingTranslationsIcon(e.items):!e.appendTranslationIcon||e.needsTranslationIcon&&!e.needsTranslationIcon()||e.translationIconNode&&0!==e.translationIconNode.length||!e.el||(e.translationIconNode=e.el.querySelector(".property_"+e.id),e.appendTranslationIcon(e.translationIconNode))}.bind(this))},remove:function(){this._propertyUIControl&&(this._propertyUIControl.remove(),this._propertyUIControl=null),this._propertySpec=null,this.options=null}});return n})),define("dashboard-core/js/dashboard/contentpane/PropertiesManager",["../../lib/@waca/core-client/js/core-client/ui/core/Class","./SlideoutHelper","jquery","underscore","../widgets/PropertyListUtil","./ExtendLayoutPropertiesV1Helper","../../app/nls/StringResources","../../lib/@waca/dashboard-common/dist/ui/interaction/Utils","@waca/dashboard-common/js/utils/ContentUtil","../contentpane/PropertyUIControlView"],(function(e,t,n,i,o,r,a,A,s,l){var c=e.extend([t],{init:function(e){c.inherited("init",this,arguments),i.extend(this,e),this.dashboard=this.canvasController.dashboardApi,this._layoutController=this.canvasController.layoutController,this._eventRouter=this.canvasController.eventRouter,this._eventRouter.on("properties:refreshPane",this.refreshApplicationPropertiesPane,this),this.canvas=this.dashboard.getFeature("Canvas"),this.canvas.on("change:content:property",this.onContentPropertyChange,this),this.canvas.on("change:property",this.onDashboardPropertyChange,this);var t=this.dashboard&&this.dashboard.getGlassCoreSvc(".FeatureChecker");this._isPropertiesV2Enabled=t&&t.checkValue("dashboard","PropertiesV2","enabled"),this._isPropertiesV2Enabled||(this._eventRouter.on("properties:refreshProperty",this.refreshProperty,this),this._eventRouter.on("properties:updateVisiblilty",this.updateVisiblilty,this),this._eventRouter.on("properties:updateEnabled",this.updateEnabled,this),this._eventRouter.on("properties:setValue",this.setPropertyValue,this),this._eventRouter.on("selection:ready",this.onPropertiesSelectionReady,this),this._eventRouter.on("properties:refreshChild",this.refreshChildProperty,this),this._eventRouter.on("properties:setChildValue",this.setChildValue,this)),this._lastEventId="",this._expandedSections={},this._defaultTabOrder=[a.get("tabName_visualization"),a.get("tabName_visDetails"),a.get("tabName_textDetails"),a.get("tabName_mediaDetails"),a.get("tabName_webDetails"),a.get("tabName_imageDetails"),a.get("tabName_animation"),a.get("tabName_general")],this.logger=e.glassContext.getCoreSvc(".Logger"),this._children=[]},_initPropertiesFeature:function(){this.slideoutFeature||(this.slideoutFeature=this.dashboard.getFeature("InAppSlideoutState")),this.slideoutDOMFeature||(this.slideoutDOMFeature=this.dashboard.getFeature("InAppSlideoutDOM"))},onContentPropertyChange:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.info){var n=[t.info],i=t.info.events;if(i){var o={};i.forEach((function(e){e.info&&e.info.contentId&&(o[e.info.contentId]=e.info)})),n=Object.values(o)}n.forEach((function(t){var n=t.contentId,i=n&&e.canvas.getContent(n);if(i&&"widget.live"!==i.getType()){var o=t.options||{};e.getCurrentChild()?e.refreshChildProperty(_extends({content:e.canvas.getContent(n)},o)):e.refreshApplicationPropertiesPane(_extends({},o))}}))}},onDashboardPropertyChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.info&&Array.isArray(e.info.events)&&!(!e.info.events.length>0)&&e.info.events[0].info&&e.info.events[0].info.supportsUndoRedo){var t=e.info.events[0].info;this.refreshApplicationPropertiesPane(_extends({},t))}},getPropertiesView:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this._isPropertiesV2Enabled)return Promise.resolve(!0);var n=this._getSelectedContents(t);return this.getPropertyLayoutList(n).then((function(t){var n=new l({node:document.createElement("div"),items:t,glassContext:e.glassContext,renderCallback:e._renderCallback.bind(e)});return e.contentView=n,n.render()}))},_renderCallback:function(){this._eventRouter&&this._eventRouter.trigger("properties:hasRendered",{})},getPropertyLayoutList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this._isPropertiesV2Enabled)return Promise.resolve([]);var n=[],a=0,A=void 0,s=[];return t.forEach((function(t){var r=t&&t.getPropertyLayoutList&&t.getPropertyLayoutList();if(!i.isEmpty(r)){if(!A){var l=i.find(r,(function(e){return"Banner"===e.type}));A=e._getCoreClientLayout(l)}var c=i.chain(r).filter((function(e){return"Group"===e.type})).sortBy((function(t){if(void 0!==t.position)return t.position;var n=e._defaultTabOrder.indexOf(t.label);return n>=0?n:10})).map(e._getCoreClientLayout.bind(e)).value();t.getType&&"group"===t.getType()?(a++,n.push(o.processProperties(c,t,e.dashboard).then((function(){return c})))):n.unshift(o.processProperties(c,t,e.dashboard).then((function(){return c}))),s.push(t)}})),Promise.all(n).then((function(t){var n=e.dashboard.getFeature("Transaction");for(new r({propertyLayoutSpec:t,contents:s,dashboard:e.dashboard,transaction:n}).extendLayoutProperties();t.length>1+a;)t[0]=e._mergePropertySpecs(t[1],t[0],!0),t.splice(1,1);var i=t[0],o=void 0;if(a>0){for(t.splice(0,1);t.length>1;)t[0]=e._mergePropertySpecs(t[1],t[0],!0),t.splice(1,1);o=t[0]}i&&(t[0]=e._mergeGroupPropertySpecs(i,o));var l=[];if(t.length<1)return l;if(l.push(A),t[0].length>1){var c={type:"TabControl",name:"tabControl",items:t[0],onTabChange:function(e,t){this._selectedTab=t.name}.bind(e)};l.push(c)}return 1===t[0].length&&l.push.apply(l,t[0][0].items),l}))},_getCoreClientLayout:function(e,t){var n=this,o=i.extend({},e);if(e)switch(e.items&&e.items.length&&i.extend(o,{items:i.chain(e.items).map((function(e,t){return n._getCoreClientLayout(e,t)})).flatten().value()}),o.type){case"Group":return this._processCoreClientTabControl(o);case"Section":return this._processCoreClientSectionControl(o,t);case"DropDown":return this._processCoreClientDropDownControl(o)}return o},_processCoreClientTabControl:function(e){return i.extend(e,{name:e.label,selected:this._selectedTab===e.label,module:"dashboard-core/js/dashboard/contentpane/PropertyUIControlView"})},_getSectionExpandState:function(e,t){if(void 0===this._expandedSections[e.id]){var n=e.open;void 0===n&&(n=0===t),this._expandedSections[e.id]=n}return this._expandedSections[e.id]},_processCoreClientSectionControl:function(e,t){e.id=this._encodePropertyId(e.id);var n=i.extend(e,{name:e.id,styleAsSimpleRow:!0,type:!1===e.collapsible?"SectionLabel":"CollapsibleSection",open:this._getSectionExpandState(e,t),onOpenChange:function(e,t){this._expandedSections[e]=t}.bind(this)}),o=t>0&&!e.noSeparator?[{type:"Separator"},n]:[n];return"SectionLabel"===n.type&&(o.push.apply(o,n.items),delete n.items),o},_processCoreClientDropDownControl:function(e){return e.name=e.id,!e.options&&e.getOptions&&(e.options=e.getOptions()),e},closeChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._isPropertiesV2Enabled)this.dashboard.getFeature("InternalProperties").reset();else{var t=this.getCurrentChild();t&&(e&&"function"==typeof e?e():t.node&&t.node.parentNode&&t.node.parentNode.contains(t.node)?(t.node.nextElementSibling.style.display="block",t.node.parentNode.removeChild(t.node)):t.$el&&t.parentNode&&t.parentNode.contains(t.$el[0])&&(t.$el.next().show(),t.parentNode.removeChild(t.$el[0])),this._children.pop(),t.remove&&t.remove())}},closeAllChild:function(){for(var e=this._children.length;e>0;)this.closeChild(),--e},getChildPropertiesView:function(e){var t=this;e.glassContext=this.glassContext,e.onCloseCb=this.closeChild.bind(this,e.onCloseCb);var n=e.module.split("/").pop();return new Promise((function(i,o){switch(n){case"PropertyUIControlView":i(t._createChildPropertyUIControlView(e.items));break;case"changePaletteView":require(["authoring-common"],(function(t){i(new t.ChangePaletteView(e))}),(function(e){o(e)}));break;case"ConditionalFormatting":case"ConditionalFormattingUI":require([e.module],(function(t){i(new t.CurrentConditionalPalette(e))}),(function(e){o(e)}));break;default:i()}})).then((function(n){return n?(n.options=e,t._children.push(n),n.render()):Promise.resolve()}))},getCurrentChild:function(){return this._children.length>0?this._children[this._children.length-1]:null},addChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._initPropertiesFeature(),this.childPropertyDisplayed=!0,this._isPropertiesV2Enabled?this._addChildContext({id:e.content.childPanelId,contents:e.content.content?[e.content.content]:[],propertyList:e.content.propertyList,propertyLayoutList:e.content.propertyLayoutList}):(e.content=e.content||{},e.content.isChild=!0,e.content.childPanelId=i.uniqueId("childPanelId_"),e.pageChildId&&(this.pageChildId=e.pageChildId),this.slideoutDOMFeature.render(e.content)),!0},_addChildContext:function(e){var t={id:e.id,contents:e.contents,propertyList:e.propertyList,propertyLayoutList:e.propertyLayoutList};this.dashboard.getFeature("InternalProperties").addContext(t)},_getPropertiesContainer:function(e,t){return e&&e.containers?e.containers.find((function(n){return n.id===(t||e.activeContainer)})):null},_removeNonPublicProperties:function(e){for(var t=0;t<e.length;t++){!1===e[t].public?(e.splice(t,1),t--):e.items&&this._removeNonPublicProperties(e.items)}},_groupIntoTabs:function(e){var t=this;if(e){var o={},r=null;this._sectionMap={};for(var a=0;a<e.length;a++){var A=e[a];if(A.tabName){if(o[A.tabName])void 0!==A.tabPosition&&(o[A.tabName].tabPosition=A.tabPosition);else{r||(r={type:"TabControl",name:"tabControl",onTabChange:function(e,t){this._selectedTab=t.name}.bind(this),items:[]},e.splice(a,0,r),a++);var s=this._genTabUIControlSpec(A);r.items.push(s),o[A.tabName]=s,this._sectionMap[A.tabName]={}}this._insertPropIntoTab(A,o[A.tabName]),e.splice(a,1),a--}}if(r)0===n.grep(r.items,(function(e){return!0===e.selected})).length&&(this._selectedTab=""),r.items=i.sortBy(r.items,(function(e){if(void 0!==e.tabPosition)return e.tabPosition;var n=t._defaultTabOrder.indexOf(e.name);return n>=0?n:10})),i.each(r.items,(function(e){if(e.items){e.items=i.sortBy(e.items,"sectionPosition");for(var n=!0,o=0;o<e.items.length;o++)if("CollapsibleSection"!==e.items[o].type||e.items[o].open||e.items[o].expansionRuleExists){n=!1;break}t._addSeparatorBetweenSections(e.items),n&&(e.items[0].open=!0)}}));this._sectionMap=null}},_addSeparatorBetweenSections:function(e){if(e)for(var t=0;t<e.length;t++){"CollapsibleSection"===e[t].type&&t<e.length-1&&e.splice(t+1,0,{type:"Separator"})}},_insertPropIntoTab:function(e,t){var n=t;if(e.sectionName){var i=e.tabName;if(this._sectionMap[i][e.sectionName])n=this._sectionMap[i][e.sectionName];else{var o=this._genSectionUIControlSpec(e);this._insertPropIntoItemContainer(o,t),this._sectionMap[i][e.sectionName]=o,n=o}void 0!==e.sectionPosition&&(n.sectionPosition=e.sectionPosition),void 0===e.sectionOpened||n.expansionRuleExists||(n.open=e.sectionOpened,n.expansionRuleExists=!0)}this._insertPropIntoItemContainer(e,n)},_insertPropIntoItemContainer:function(e,t){for(var n=!1,i=0;i<t.items.length;i++)if(!e.displayPos&&t.items[i].displayPos||(t.items[i].displayPos||-1)>(e.displayPos||-1)){t.items.splice(i,0,e),n=!0;break}n||t.items.push(e)},_genTabUIControlSpec:function(e){var t=e.tabModule?e.tabModule:"dashboard-core/js/dashboard/contentpane/PropertyUIControlView",n={name:e.tabName,module:t,items:[]};return e.tabName===this._selectedTab&&(n.selected=!0),void 0!==e.tabPosition&&(n.tabPosition=e.tabPosition),n},_genSectionUIControlSpec:function(e){var t=this,n=e.tabName+"|"+e.sectionName,i={label:e.sectionName,name:n,type:"CollapsibleSection",items:[],styleAsSimpleRow:!0,onOpenChange:function(e,n){t._expandedSections[e]=n}};return null!=this._expandedSections[n]&&(i.open=this._expandedSections[n],i.expansionRuleExists=!0),i},_mergeGroupPropertySpecs:function(e,t){var n=this;if(!t)return e;var i=[];return e.forEach((function(e){if(e.name){for(var o=null,r=0;r<t.length;r++)if(t[r].name===e.name){o=t[r];break}o?(o.items&&e.items&&(o.items=n._mergeGroupPropertySpecs(e.items,o.items)),i.push(o)):i.push(e)}else i.push(e)})),i},_mergePropertySpecs:function(e,t,n){if(!e)return t;if(!t)return e;var i=n?[]:e;return t.forEach(function(t){if(t.name){for(var o=null,r=0;r<e.length;r++)if(e[r].name===t.name){o=e[r];break}o?(o.items&&t.items&&(o.items=this._mergePropertySpecs(o.items,t.items,n)),n&&i.push(o)):n||i.push(t)}else i.push(t)}.bind(this)),i},updateVisiblilty:function(e){if(!e)return!1;var t=this.getPropertyControl(e.propertyName);return!!t&&(!0===e.visible?t.show():t.hide(),!0)},updateEnabled:function(e){if(!e)return!1;var t=this.getPropertyControl(e.propertyName);return!!t&&(!0===e.enabled?(t.readOnly=!1,t.enable()):t.disable(),!0)},refreshProperty:function(e){if(!e||!e.propertySpec)return!1;var t=this.getPropertyControl(e.propertySpec.name);return!!t&&(t.$el.empty(),!0!==e.removeProperty&&(i.extend(t,e.propertySpec),t.doRender()),!0)},setChildValue:function(e){if(this._isPropertiesPaneOpen()){var t=this.getCurrentChild();if(t&&this.pageChildId===e.contentId&&e.value){var n=this.getPropertyControl(e.propertyName,t);n&&n.setValue&&n.setValue(e.value)}}},refreshChildProperty:function(e){var t=this;return this._initPropertiesFeature(),Promise.resolve().then((function(){if(t._isPropertiesPaneOpen()){var n=t.getCurrentChild(),i=e&&e.content;i&&n&&t.pageChildId===i.getId()&&t.slideoutDOMFeature.render({content:i,refreshChild:!0,isChild:!0})}}))},updateChildPropertiesView:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.refreshChild&&t.content?this.getPropertyLayoutList([t.content]):Promise.resolve();return n.then((function(n){n&&(t.items=n);var i=e.getCurrentChild();return i&&i.options&&i.options.childPanelId===t.childPanelId&&(i instanceof l?(i.getPropertyUIControl()&&i.getPropertyUIControl().remove(),e._children.pop(),t.module=t.module||"dashboard-core/js/dashboard/contentpane/PropertyUIControlView"):t.onCloseCb()),t.onCloseCb=t.originalOnCloseCb,e.getChildPropertiesView(t)}))},_createChildPropertyUIControlView:function(e){return new l({node:document.createElement("div"),items:e,glassContext:this.glassContext,onCloseCb:this.closeChild,closeCallback:this.closeChild.bind(this),renderCallback:this._renderCallback.bind(this)})},setPropertyValue:function(e){if(!e||void 0===e.value)return!1;var t=this.getPropertyControl(e.propertyName);return!(!t||!t.setValue)&&(t.propertiesManagerChange=!0,e.subPropertyName?t.setValue(e.subPropertyName,e.value):t.setValue(e.value),t._lastChangedValue="undefined",t.propertiesManagerChange=!1,!0)},getPropertyControl:function(e,t){if(!this._isPropertiesPaneOpen())return null;t||(t=this._slideout);var n=(t||this.contentView).getPropertyUIControl();return this._getPropertyControlFromUIControl(e,n)},_getPropertyControlFromUIControl:function(e,t){if(!t)return null;var n,i=e;"string"!=typeof e&&e.length&&(i=(n=e.slice()).shift());var o=t.getProperty(i);return!o&&t.propertyUIControlLeft&&!(o=t.propertyUIControlLeft.getProperty(i))&&t.propertyUIControlRight&&(o=t.propertyUIControlRight.getProperty(i)),o?n&&n.length?this._getPropertyControlFromUIControl(n,o):o:null},_isPropertiesPaneOpen:function(){if(this._initPropertiesFeature(),!this.slideoutFeature)return!1;if(!this.slideoutFeature.isOpen())return!1;var e=this.slideoutFeature.getCurrent();return!(!e||"PropertiesPane"!==e.id)},refreshApplicationPropertiesPane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._initPropertiesFeature(),this._isPropertiesV2Enabled)this.dashboard.getFeature("InternalProperties").refresh();else if(this._isPropertiesPaneOpen()){e.selectedTab&&(this._selectedTab=e.selectedTab);var t=this.slideoutFeature.getCurrent().id,n=this.slideoutDOMFeature.getView(t).instance.getRenderNode();e.currentScrollTop=n.scrollTop,this.updatePropertiesPanel(e)}},onPropertiesSelectionReady:function(e){if(!this._isPropertiesV2Enabled){var t=e.selectedNodes.map((function(e){return e.id})).sort().join();if(t!==this._lastSelectedNodeIds){if(this._lastSelectedNodeIds=t,!this._isPropertiesPaneOpen())return;e.selectedNodes&&1===e.selectedNodes.length&&(this._selectedTab="",this._expandedSections={}),this.closeAllChild(),this.updatePropertiesPanel(e)}}},updatePropertiesPanel:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._isPropertiesV2Enabled){var n=i.uniqueId("eventQueue_");this._lastEventId=n,setTimeout((function(){if(e._isPropertiesPaneOpen()){var i=e._getSelectedContents();e.getPropertyLayoutList(i).then((function(i){n===e._lastEventId&&(e.contentView.setPropertySpec(i),e.contentView.render(!0).then((function(n){t.currentScrollTop&&(n.el.parentNode.scrollTop=t.currentScrollTop),t.focusSelector&&n.$el.find(t.focusSelector).focus(),e._updateChildPropertiesSelection()})))}))}}),0)}},getMostRecentChildOptions:function(e){if(!e||e.childPanelId)return e;var t=this.getCurrentChild();return t&&t.options&&t.options.childPanelId?i.clone(t.options):e},_clearSelectedNodeIds:function(){delete this._lastSelectedNodeIds},_updateChildPropertiesSelection:function(){var e=this.getCurrentChild();e&&e.updateSelection&&e.updateSelection()},_encodePropertyId:function(e){var t=this;return e.split("").map((function(e){if(!t._isValidPropertyId(e)){var n=e.charCodeAt().toString(16),i=n.length>2;return(i?"u":"x")+("0000"+n).slice(i?-4:-2)}return e})).join("")},_isValidPropertyId:function(e){return/^[a-zA-Z0-9]*$/.test(e)},_getSelectedContents:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return t.length?t.forEach((function(t){var i=e.canvas.getContent(t);i&&n.push(i)})):n.push.apply(n,this.canvas.getSelectedContentList()),n.length?s.getContentAndItsDescendants(n).contents:[this.canvas]}});return c})),define("dashboard-core/js/dashboard/CanvasController",["../lib/@waca/core-client/js/core-client/ui/core/Class","./layout/LayoutController","./UndoRedoController","./CopyPasteController","./contentpane/PropertiesManager","../app/EventRouter","../api/impl/LegacyViewControllers","jquery","underscore"],(function(e,t,n,i,o,r,a,A,s){return e.extend({_MAX_DATASET_REFRESH_RATE:5e3,_datasetRefreshInfo:{},init:function(e){this.$el=e.$el,this.glassContext=e.glassContext,this.services=e.services,this.dashboardApi=e.dashboardApi,this.model=e.boardModel,this.widgetLoader=e.widgetLoader,this.loader=e.widgetLoader,this.boardLoader=e.boardLoader,this._extensions={},this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this.addRemoveNotifier=new r,this.addRemoveNotifier.on("widget:removeDone",this.onWidgetRemoveDone,this),this.undoRedoController=this.dashboardApi.getFeature("UndoRedo.internal"),this.layoutController=new t({glassContext:this.glassContext,services:this.services,appSettings:e.appSettings,contentFeatureLoader:e.contentFeatureLoader,dashboardApi:this.dashboardApi,eventRouter:e.eventRouter,$el:this.$el,boardModel:this.model,widgetLoader:this.widgetLoader,canvasNotifier:this.addRemoveNotifier,layoutExtensions:e.layoutExtensions,gatewayUrl:e.gatewayUrl,cdnUrl:e.cdnUrl,canvasController:this,canvas:this.dashboardApi.getFeature("Canvas")}),this.layoutController.createLayoutModules();var n=new a({layoutController:this.layoutController});this.dashboardApi.getFeature("FeatureRegistry.internal").registerFeature("LegacyViewControllers",n),this.dashboardApi.registerDashboardSvc("boardService",this.getDeprecatedCanvas()),this.eventRouter=e.eventRouter,this.propertiesManager=new o({glassContext:this.glassContext,canvasController:this}),this.registerExtension("propertiesManager",this.propertiesManager),this.dashboardApi.registerDashboardSvc("propertiesManager",this.propertiesManager),this.copyPasteController=new i({layoutController:this.layoutController,dashboardApi:this.dashboardApi,logger:this.logger,model:this.model,api:this.getDeprecatedCanvas(),type:this.dashboardApi.getType().toUpperCase()}),this.model.on("change:datasetShaping",function(e){this.model.datasetShaping.each(function(t){t.eventInfo=e,this._onChangeShapingSpec(t)}.bind(this))}.bind(this)),A(document).on("keydown",this._onDocumentKeyDown),this._features={}},initialize:function(){return null!=this.layoutController?this.layoutController.initialize():Promise.reject()},_prepareAsyncCallback:function(e){return function(){return this._destroyed?Promise.reject("The live widget object was destroyed"):e.apply(void 0,arguments)}.bind(this)},getDeprecatedCanvas:function(){return null!=this.layoutController?this.layoutController.getDeprecatedCanvas():null},destroy:function(){this._destroyed=!0,this.layoutController.destroy(),this._features=null,this.widgetLoader=null,this.loader=null,this.boardLoader=void 0,this.layoutController=null,this.addRemoveNotifier&&(this.addRemoveNotifier.off(),this.addRemoveNotifier=null),this.eventRouter&&(this.eventRouter.off(),this.eventRouter=null),this.undoRedoController&&(this.undoRedoController.clearStack(),this.undoRedoController=null),s.each(this._datasetRefreshInfo,(function(e,t){this._stopDatasetRefresh(t)})),A(document).off("keydown",this._onDocumentKeyDown)},_getSelectedWidget:function(){var e=this.$el.find(".widget.nodeSelected:visible");return e.length?this.widgetLoader.getWidget(e[0]._layout.id):null},_addWidget:function(e,t){var n=this,i=this.dashboardApi.getFeature("Transaction"),o=i.startTransaction(),r=e.model,a={containerId:e.parentId,properties:e.layoutProperties.style,spec:r,type:"widget."+r.type};return this.dashboardApi.getCanvas().addContent(a,o).then((function(e){return i.endTransaction(o),n.layoutController.whenWidgetRenderComplete(e.getId())})).then((function(e){var i=n.layoutController.interactionController.selectionHandler;i.deselectAll(),i.selectNode(e.domNode,{isTouch:t})}))},addDataItemsOrAddWidget:function(e,t){var n=this,i=this._getSelectedWidget();return i&&i.accepts&&i.accepts(e)?Promise.resolve(i.onDrop(e)):this.getWidgetSpecFromDragObject(e).then((function(e){return n._addWidget(e,t)}))},getWidgetSpecFromDragObject:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={parentId:this.id,layoutProperties:t},i=this.dashboardApi.getFeature("CanvasDnD");return i.onDrop(e).then((function(e){return e&&(n.model=e),n}))},addPin:function(e,t){var n=this.getDeprecatedCanvas().addFragment(e);this.getDeprecatedCanvas().selectWidget(n,{isTouch:t})},onWidgetRemoveDone:function(e){this.widgetLoader.isLoaded(e.id)&&this.widgetLoader.unLoadWidget(e.id,void 0,e)},changeToAuthorMode:function(){return this.layoutController.pageReady.then(this._prepareAsyncCallback(this.layoutController.changeToAuthorMode.bind(this.layoutController,{canvasNotifier:this.addRemoveNotifier})))},changeToConsumeMode:function(){return this.layoutController.changeToConsumeMode()},changeToEventGroupMode:function(){return this.layoutController.pageReady.then(this._prepareAsyncCallback(this.layoutController.changeToEventGroupMode.bind(this.layoutController)))},addProviderForExtension:function(e,t){var n=this.getExtension(e);n?n.addProvider?n.addProvider(t):this.logger.debug("Extension with id "+e+' does not have a "addProvider" method'):(this._extensionProviders||(this._extensionProviders={}),this._extensionProviders[e]||(this._extensionProviders[e]=[]),this._extensionProviders[e].push(t))},registerExtension:function(e,t){this._extensions[e]=t,this._extensionProviders&&this._extensionProviders[e]&&(t.addProvider?this._extensionProviders[e].forEach((function(e){t.addProvider(e)})):this.logger.debug("Extension with id "+e+' does not have a "addProvider" method'))},getExtension:function(e){return this._extensions[e]||null},_onDocumentKeyDown:function(e){if(e&&8===e.keyCode&&!e.metaKey&&!e.shiftKey){var t=e.srcElement||e.target;t.tagName.toLowerCase().match(/input|textarea|select/gim)||"true"===t.getAttribute("contentEditable")||e.preventDefault()}},onPageRenderComplete:function(){return this.layoutController.onPageRenderComplete},onPageReady:function(){return this.layoutController.pageReady},getFeature:function(e){var t=this;return new Promise((function(n,i){t._features[e]?n(t._features[e]):i("Feature not found")}))},registerFeature:function(e,t){return this._features[e]=t,Promise.resolve()}})})),define("dashboard-core/js/api/LayoutAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.getChildrenList=function(){},e.prototype.getParentLayout=function(){},e.prototype.getWidget=function(){},e.prototype.render=function(){},e.prototype.getEditingActionList=function(){},e}()})),define("dashboard-core/js/api/deprecated/LayoutAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.getChildren=function(){},e.prototype.getId=function(){},e.prototype.getSelfRatio=function(){},e.prototype.getWidgetAPI=function(){},e}()})),define("dashboard-core/js/api/impl/Layout",["../../lib/@waca/core-client/js/core-client/ui/core/Class","underscore","../../lib/@waca/dashboard-common/dist/core/APIFactory","../LayoutAPI","../deprecated/LayoutAPI"],(function(e,t,n,i,o){return e.extend({model:null,controller:null,init:function(e){this.model=e.model,this.controller=e,this.layoutController=e.layoutController},destroy:function(){this.model=null,this.controller=null,this.layoutController=null},getId:function(){return this.model.id},getChildren:function(){var e=this;return this.model.items.map((function(t){var n=t.id,i=e.layoutController.getView(n);if(i&&i.view&&i.view.getAPI)return i.view.getAPI()})).filter((function(e){return!!e}))},render:function(e){this.controller.render(e)},getSelfRatio:function(){return this.controller.getSelfRatio()},getParentLayout:function(){return this.controller.getParentLayout()},getWidgetAPI:function(){return this.controller.widgetAPI},getAPI:function(){return n.createAPI(this,[i,o])},getChildrenList:function(){return this.getChildren()},getWidget:function(){return this.getWidgetAPI()},getEditingActionList:function(){return[]}})})),define("dashboard-core/js/dashboard/util/ContentRegistryUtil",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.getCapabilities=function(e){var t=void 0;return e&&e.getType()&&(t=e.getFeature("ContentRegistry.internal."+e.getType()+"Capabilities")),t},e}()})),define("dashboard-core/js/utils/FeatureFlagUtil",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.generateChecker=function(e,t){return function(n,i){t.hasOwnProperty(n)||Object.defineProperty(t,n,{get:function(){var t=void 0;try{var n;t=(n=e.getGlassCoreSvc(".FeatureChecker")).checkValue.apply(n,i)}catch(e){t=!1}return t}})}},e}()})),define("dashboard-core/js/app/util/UnderscoreExt",["underscore"],(function(e){e.objDifference=function(e,t,n){return e.filter((function(e){return 0===t.filter((function(t){return e[n]===t[n]})).length}))},e.doubleDebounce=function(e,t){var n=null,i=0,o=function(t){n=null,i=Date.now(),e(t)},r=function(r){Date.now()-i>t&&!n?(i=Date.now(),e(r)):(clearTimeout(n),n=setTimeout(o,t,r))};return r.cancel=function(){return clearTimeout(n)},r}})),define("dashboard-core/js/dashboard/layout/views/LayoutBaseView",["../../../lib/@waca/core-client/js/core-client/ui/core/Class","../../../view/features/content/contentViewDom/api/impl/ContentViewDomImpl","jquery","underscore","../../../app/nls/StringResources","react-dom","../../../lib/@waca/dashboard-common/dist/ui/CenterLoadingSpinner","../../../api/impl/Layout","../../widgets/PropertyListUtil","../../util/ContentRegistryUtil","../../../utils/FeatureFlagUtil","../../../app/util/UnderscoreExt"],(function(e,t,n,i,o,r,a,A,s,l,c){var d={"16:9":{width:1280,height:720},"4:3":{width:1280,height:960},letter:{width:612,height:792},legal:{width:612,height:1008},a4:{width:595,height:842},tabloid:{width:792,height:1224},infographic:{width:512,height:1024}},u=e.extend({init:function(e){u.inherited("init",this,arguments),this.layoutController=e.layoutController,this.isAuthoringMode=this.layoutController.isAuthoring,this.model=e.model,this.id=this.model.id,this.parentLayout=e.parentLayout,this.dashboardApi=e.dashboardApi,this.glass=e.glass,this._settings=e.settings,this.logger=e.logger,this.additionalWidgetData=e.additionalWidgetData,this.contentFeatureLoader=e.contentFeatureLoader,this.content=e.content,this.dashboardApi&&(this.colorsService=this.dashboardApi.getFeature("Colors"),this.translationService=this.dashboardApi.getDashboardCoreSvc("TranslationService"),this.contentTypeRegistry=this.dashboardApi.getFeature("ContentTypeRegistry"));var t=this.layoutController.modelIdToNodeId(this.id),o=!1;this.parentLayout?(this.domNode=n(this.parentLayout.domNode).find("#"+t)[0],this.domNode||(this.domNode=document.getElementById(t),this.domNode&&(o=!0))):this.domNode=document.getElementById(t),this._attachedHandles=[],this._isTopLevelPage()&&this._attachedHandles.push(this.model.on("change:pageSize",this.onPageSizeChange.bind(this),this));var r=e.services.getSvcSync("htmlTemplates");if(this.domNode){if(o){var a=n(this.domNode),s=a.children(),l=a;this.domNode=n(r.getHtml(this.model,this.model.boardModel.widgetInstances))[0];var d=n(this.domNode);s.appendTo(d),l.remove(),this.layoutController.layoutReady(this.model.id).then(this.onResize.bind(this))}}else this.domNode=n(r.getHtml(this.model,this.model.boardModel.widgetInstances))[0];this.domNode._layout=this,this.authorHelper=e.authorHelper,this.widgetChromeEventRouter=e.widgetChromeEventRouter,this.widgetChromeEventRouter_disposeEvents=[],this.$el=n(this.domNode),this.services=e.services,this.api=new A(this),this.eventRouter||(this.eventRouter=this.layoutController.eventRouter,this.eventRouter&&(this.eventRouter.on("properties:hasRendered",this.setInitialEnabledState,this),this._enableToggleEvents(),this.eventRouter.on("layout:resize",this._onResize,this))),this._debouncedOnResize=i.doubleDebounce(this._onResize.bind(this),200),this._subLayoutViews=[];var h=c.generateChecker(this.dashboardApi,this);h("_isPropertiesV2Enabled",["dashboard","PropertiesV2","enabled"]),this._registerListeners()},_registerListeners:function(){var e=this;this._registeredContentListeners={},"page"===this.content.getType()?this._registerContentListener(this.content):this.content.getChildren().forEach((function(t){return e._registerContentListener(t)}))},_unregisterListeners:function(){var e=this;Object.keys(this._registeredContentListeners).forEach((function(t){return e._unregisterContentListener(t)}))},_registerContentListener:function(e){this._registeredContentListeners[e.getId()]=e.on("change:property:backgroundColor",this._onChangeBackgroundColor.bind(this,e),this)},_unregisterContentListener:function(e){this._registeredContentListeners[e].remove(),delete this._registeredContentListeners[e]},_onChangeBackgroundColor:function(e,t){var n=t.info,i=t.tracking,o=e.getFeature("ContentViewDOM");if(o){var r=o.getNode();return i.undoActions[0].params[1]&&r.classList.remove("fill-"+i.undoActions[0].params[1]),n.value&&r.classList.add("fill-"+n.value),!0}},setInitialEnabledState:function(){"relative"!==this.model.getValueFromSelfOrParent("layoutPositioning")&&this.eventRouter.trigger("properties:updateEnabled",{propertyName:"fitPage",enabled:!1})},_enableToggleEvents:function(){this.model.on("change:fitPage",this._updatePropertiesPaneToggle,this),this.model.on("change:showGrid",this._updatePropertiesPaneToggle,this),this.model.on("change:snapGrid",this._updatePropertiesPaneToggle,this),this.model.on("change:snapObjects",this._updatePropertiesPaneToggle,this)},_disableToggleEvents:function(){this.model.off("change:fitPage",this._updatePropertiesPaneToggle.bind(this),this),this.model.off("change:showGrid",this._updatePropertiesPaneToggle.bind(this),this),this.model.off("change:snapGrid",this._updatePropertiesPaneToggle.bind(this),this),this.model.off("change:snapObjects",this._updatePropertiesPaneToggle.bind(this),this)},_updatePropertiesPaneToggle:function(e){var t=e.value||!1;this.eventRouter.trigger("properties:setValue",{propertyName:e.name,value:t})},getNodeId:function(e){return this.layoutController.modelIdToNodeId(e)},_destroyAuthoringHelper:function(){this.authorHelper&&(this.authorHelper.destroy(),this.authorHelper=null)},destroy:function(e){this._unregisterListeners(),this.setLoading(!1);for(var t=void 0,i=0;i<this._subLayoutViews.length;i++)(t=this._subLayoutViews[i].parentLayout)&&this.id===t.id&&this._subLayoutViews[i].destroy(e);if(this._subLayoutViews=[],this.widgetChromeEventRouter_disposeEvents.forEach((function(e){return e.remove()})),this.widgetChromeEventRouter_disposeEvents=[],this._debouncedOnResize&&this._debouncedOnResize.cancel(),this._destroyAuthoringHelper(),this.eventRouter&&(this.eventRouter.off("properties:hasRendered",this.setInitialEnabledState,this),this.model&&this._disableToggleEvents(),this.eventRouter.off("layout:resize",this._onResize,this)),this._attachedHandles.forEach((function(e){return e.remove()})),this._attachedHandles=[],this.domNode){var o=n(this.domNode);o.off(),o.remove(),this.domNode._layout=null}this._contentTitle&&(this._contentTitle=null),this.layoutController&&this.layoutController.removeView(this),this.api&&(this.api.destroy(),this.api=null),this.layoutController=null,this.model=null,this.id=null,this.parentLayout=null,this.dashboardApi=null,this.colorsService=null,this.translationService=null,this.additionalWidgetData=null,this.contentFeatureLoader=null,this.content=null,this.widgetChromeEventRouter=null,this.logger=null,this.services=null,this.authorHelper=null,this.domNode=null,this.layoutController=null,this._debouncedOnResize=null,this._settings=null,u.inherited("destroy",this,arguments)},_renderContentTitle:function(){var e=l.getCapabilities(this.content);if(!!e&&e.getCapabilities().title)return this._contentTitle=this.content.getFeature("ContentTitle.internal"),this.$el.addClass("titleSupported"),this._contentTitle.render({id:this.domNode.id,model:this.model,widgetChromeEventRouter:this.widgetChromeEventRouter,eventRouter:this.eventRouter})},renderContent:function(){var e=this;return this._preRenderContent(),this._waitForContentReady().then((function(){return e._renderContent()})).then((function(){return e._postRenderContent()}))},_preRenderContent:function(){this.setLoading(!1);var e=this.content.getFeature("state.internal");e.setStatus(e.STATUS.RENDERING)},_waitForContentReady:function(){var e=this.dashboardApi&&this.dashboardApi.getFeature("Canvas.internal");return e?e.whenContentReady(this.content.getId()):Promise.resolve()},_renderContent:function(){var e=this,t=[];if(this._isRendered)t=this._subLayoutViews.map((function(e){return e.renderContent()}));else{var n=this.content.getFeature("renderer");n?t=this._customRenderer(n):(this.model.items||[]).forEach((function(n){var i=n.id;t.push(e.renderChild(i))}))}return Promise.all(t)},_postRenderContent:function(){var e=this;return this.registerViewFeatures().then((function(){var t=e.content.getFeature("state.internal");t.setStatus(t.STATUS.RENDERED),e.layoutController.markViewAsReady(e),e._isRendered=!0}))},_customRenderer:function(e){var n=this,i=[],o=this.domNode;o.className="widget content "+this.content.getType(),this.content.getPropertyValue("canRotate")||(o.className+=" noRotate");var r=e.render({parent:o}).then((function(){var e=n._renderContentTitle();e&&o.prepend(e),n.contentFeatureLoader.registerFeature(n.content.getId(),"ContentViewDOM",new t(o))}));return i.push(r),(this.model.items||[]).forEach((function(e){var t=e.id;i.push(n.renderChild(t))})),i},renderChild:function(e){var t=this;return this.layoutController.createLayoutModule(e,this,this.additionalWidgetData).then((function(e){if(e)return t._subLayoutViews.push(e),e.renderContent()}))},registerViewFeatures:function(){var e=this;return this._viewFeatureRegistered?Promise.resolve():(this._viewFeatureRegistered=!0,this.contentFeatureLoader.registerFeature(this.id,"ContentViewDOM",new t(this.domNode)).then((function(){return e.contentFeatureLoader.registerFeatureCollection(e.id,"com.ibm.bi.dashboard.content-view-features")})))},onResize:function(e){this._debouncedOnResize(e)},_onResize:function(e){var t=this;this.model.items&&i.each(this.model.items,(function(n){var i=t.layoutController.getLayoutView(n.id);i&&i.onResize&&(i.$el.is(":hidden")?i.resizeOnShow():i.onResize(e))}))},onSelect:function(e){this.contentTypeRegistry.isTypeRegistered(this.content.getType())&&this.widgetChromeEventRouter&&this.isAuthoringMode&&!e&&this.widgetChromeEventRouter.trigger("title:chromeSelected")},onDeselect:function(){this.contentTypeRegistry.isTypeRegistered(this.content.getType())&&this.widgetChromeEventRouter&&this.isAuthoringMode&&this.widgetChromeEventRouter.trigger("title:chromeDeselected")},onShow:function(){this._callChildrenFunction("onShow"),this.isResizeOnShow&&(this.isResizeOnShow=!1,this.onResize())},onHide:function(){this._callChildrenFunction("onHide")},onTransition:function(e){return this._callChildrenFunctionAsync("onTransition",e)},afterTransition:function(e){return this._callChildrenFunctionAsync("afterTransition",e)},resizeOnShow:function(){this.isResizeOnShow=!0},_callChildrenFunctionAsync:function(e,t){var n=this,o=[];return i.each(this.model.items,(function(i){var r=n.layoutController.getLayoutView(i.id);r&&r[e]&&o.push(r[e](t))})),Promise.all(o)},_callChildrenFunction:function(e){var t=this;i.each(this.model.items,(function(n){var i=t.layoutController.getLayoutView(n.id);i&&i[e]&&i[e]()}))},_isTopLevelPage:function(){return this.model&&this.layoutController.boardModel&&this.model===this.layoutController.boardModel.layout},_getPageSizePreset:function(e,t){var n="custom",i=parseInt(e,10),o=parseInt(t,10);for(var r in d)if(d.hasOwnProperty(r)){var a=d[r];if(a.width===i&&a.height===o){n=r;break}}return n},_getPageSizeDisplayValues:function(){var e=this.model,t=e.pageSize&&e.pageSize.width?s.getPropertyDisplayString(e.pageSize.width,o.get("pixelUnit"),!0):"",n=e.pageSize&&e.pageSize.height?s.getPropertyDisplayString(e.pageSize.height,o.get("pixelUnit"),!0):"";return{width:t,height:n,preset:this._getPageSizePreset(t,n)}},onPageSizeChange:function(){var e=this._getPageSizeDisplayValues();this.eventRouter.trigger("properties:setValue",{propertyName:["pageSizeSplit","pageSizeWidth"],value:e.width}),this.eventRouter.trigger("properties:setValue",{propertyName:["pageSizeSplit","pageSizeHeight"],value:e.height}),this.eventRouter.trigger("properties:setValue",{propertyName:"pageSizePreset",value:e.preset})},reduce:function(e,t){return t=e(this,t),this.model.items&&this.model.items.forEach((function(n){var i=this.layoutController.getLayoutView(n.id);i&&i.reduce&&(t=i.reduce(e,t))}),this),t},setLoading:function(e){var t=this;return new Promise((function(i){t._$loadingIndicatorBlocker||e?t._$loadingIndicatorBlocker&&e?i(!0):(t._loadingTimer&&clearTimeout(t._loadingTimer),e?(t._$loadingIndicatorBlocker||(t._$loadingIndicatorBlocker=n("<div></div>")),t._loadingTimer=setTimeout((function(){t.$el.append(t._$loadingIndicatorBlocker),r.render(a({size:"normal",variant:"circle"}),t._$loadingIndicatorBlocker[0]),i(!0)}),1e3)):(r.unmountComponentAtNode(t._$loadingIndicatorBlocker[0]),t._$loadingIndicatorBlocker.remove(),t._$loadingIndicatorBlocker=null,i(!1))):i(!1)}))},getSelectedSubViewId:function(){return this.id},getSelectedSubViewTitle:function(){return null},getSelfRatio:function(){return{width:1/(this.parentLayout.model.getVisualizations().length||1),height:1}},getParentLayout:function(){return this.parentLayout.getAPI()},getAPI:function(){return this.api.getAPI()},render:function(e){this.onShow(e)}});return u})),define("dashboard-core/js/dashboard/layout/views/PageCollectionView",["./LayoutBaseView","../../../lib/@waca/core-client/js/core-client/utils/EventHelper"],(function(e){var t=null;return t=e.extend({init:function(){t.inherited("init",this,arguments),this._started=!0}})})),define("dashboard-core/js/dashboard/util/ColorUtils",[],(function(){return new function(){return{invertColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:180,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this._convertRGBToYUV(e);o.y=this._validateColor(o.y+(o.y>n?-t:t));var r=this._convertYUVToRGB(o);return i?r:this.contrastRatio(e,r)<4.5?this.contrastRatio(e,"#FFFFFF")<4.5?"#000000":"#FFFFFF":r},_convertRGBToYUV:function(e){var t=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5),16);return{y:this._validateColor(.299*t+.587*n+.114*i),u:this._validateColor(-.16874*t+-.33126*n+.5*i+128),v:this._validateColor(.5*t+-.41869*n+-.08131*i+128)}},_convertYUVToRGB:function(e){var t=this._validateColor(e.y+1.402*(e.v-128)),n=this._validateColor(e.y+-.34414*(e.u-128)+-.71414*(e.v-128)),i=this._validateColor(e.y+1.772*(e.u-128));return"#"+(t<16?"0"+t.toString(16):t.toString(16))+(n<16?"0"+n.toString(16):n.toString(16))+(i<16?"0"+i.toString(16):i.toString(16))},_validateColor:function(e){return e<0?0:e>255?255:Math.floor(e)},luminance:function(e){var t=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5),16);return n/=255,i/=255,.2126*(t=(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(i=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},contrastRatio:function(e,t){var n=this.luminance(e),i=this.luminance(t);return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}}}})),define("dashboard-core/js/lib/@waca/dashboard-common/dist/ui/dialogs/internal/ConfirmationComponent",["../../../nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,n,i,o){"use strict";var r=i.Dialog,a=function(t){function i(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i);var o=_possibleConstructorReturn(this,t.call(this,n)),r="dashboardConfirmationDialog";return n.className&&(r+=" "+n.className),o.dialogProps={size:n.size||"small",clickaway:!1,className:r},o.primaryButtonText=n.primaryButtonText||e.get("dlg_ok"),o.secondaryButtonText=n.secondaryButtonText||e.get("dlg_cancel"),o}return _inherits(i,t),i.prototype.render=function(){return n.createElement(r,_extends({},this.dialogProps,{onClose:this._onCancel.bind(this)}),n.createElement(r.Header,{title:this.props.title},this.props.title),n.createElement(r.Body,null,this.props.message||n.createElement("div",{className:"dialogBody"})),n.createElement(r.Footer,null,n.createElement(r.Button,{primary:!0,id:"ok",label:this.primaryButtonText,title:this.primaryButtonText,onClick:this._onOK.bind(this)}),n.createElement(r.Button,{label:this.secondaryButtonText,title:this.secondaryButtonText,id:"cancel",onClick:this._onCancel.bind(this)})))},i.prototype._onOK=function(e){e&&e.stopPropagation(),this.props.onOK&&this.props.onOK()},i.prototype._onCancel=function(e){e&&e.stopPropagation(),this.props.onCancel&&this.props.onCancel()},i}(n.Component);return a.propTypes={primaryButtonText:o.string,secondaryButtonText:o.string,className:o.string,size:o.string,title:o.string,message:o.string,onOK:o.func,onCancel:o.func},a})),define("dashboard-core/js/lib/@waca/dashboard-common/dist/ui/dialogs/ConfirmationDialog",["jquery","../../lib/@waca/core-client/js/core-client/ui/core/View","./internal/ConfirmationComponent","react-dom","react"],(function(e,t,n,i,o){"use strict";return function(t){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(r,t),r.prototype.init=function(){for(var e,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=t.prototype.init).call.apply(e,[this].concat(i));var r=i[0]||{};this.className=r.className,this.size=r.size,this.title=r.title,this.message=r.message,this.viewClass=r.viewClass,this.viewOptions=r.viewOptions,this.confirmCallback=r.confirmCallback,this.cancelCallback=r.cancelCallback,this.className=r.className,this.primaryButtonText=r.primaryButtonText,this.secondaryButtonText=r.secondaryButtonText,this.reactDomNode=this.$el[0]},r.prototype.render=function(){i.render(o.createElement(n,{title:this.title,message:this.message,size:this.size,onOK:this.onOK.bind(this),onCancel:this.onCancel.bind(this),className:this.className,primaryButtonText:this.primaryButtonText,secondaryButtonText:this.secondaryButtonText}),this.reactDomNode),this.viewClass&&(this.view=new this.viewClass(this.viewOptions),this.view.render(),e(".dashboardConfirmationDialog .dialogBody").append(this.view.$el))},r.prototype.remove=function(){this.reactDomNode&&i.unmountComponentAtNode(this.reactDomNode),this.view&&this.view.remove(),this.$el&&this.$el.remove(),this.$el=null,r.inherited("remove",this)},r.prototype.onOK=function(){this.remove(),this.confirmCallback&&this.confirmCallback()},r.prototype.onCancel=function(){this.remove(),this.cancelCallback&&this.cancelCallback()},r}(t)})),define("dashboard-core/js/lib/@waca/dashboard-common/dist/utils/TextEditorConstants",["../nls/StringResources"],(function(e){return{FONT_FAMILY_CHOICES:Object.freeze([{value:"anton",label:"Anton",cssClass:"rt_fontFamilyAnton"},{value:"cherrycreamsoda",label:"Cherry Cream Soda",cssClass:"rt_fontFamilyCherryCreamSoda"},{value:"condiment",label:"Condiment",cssClass:"rt_fontFamilyCondiment-Regular"},{value:"didactgothic",label:"Didact Gothic",cssClass:"rt_fontFamilyDidactGothic"},{value:"euphoriascript",label:"Euphoria Script",cssClass:"rt_fontFamilyEuphoriaScript-Regular"},{value:"helvneueforibm",label:"Helvetica Neue",cssClass:"rt_fontFamilyHelvNeueforIBM-Regular",subCssClasses:[{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyHelvNeueforIBM-Light"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyHelvNeueforIBM-LightItalic"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyHelvNeueforIBM-Regular"},{value:"italic",label:e.get("textFontFamilySubClassItalic"),cssClass:"rt_fontFamilyHelvNeueforIBM-Italic"},{value:"medium",label:e.get("textFontFamilySubClassMedium"),cssClass:"rt_fontFamilyHelvNeueforIBM-Medium"},{value:"mediumitalic",label:e.get("textFontFamilySubClassMediumItalic"),cssClass:"rt_fontFamilyHelvNeueforIBM-MediumItalic"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyHelvNeueforIBM-Bold"},{value:"bolditalic",label:e.get("textFontFamilySubClassBoldItalic"),cssClass:"rt_fontFamilyHelvNeueforIBM-BoldItalic"}]},{value:"kaushanscript",label:"Kaushan Script",cssClass:"rt_fontFamilyKaushanScript-Regular"},{value:"lobster",label:"Lobster",cssClass:"rt_fontFamilyLobster"},{value:"merriweather",label:"Merriweather",cssClass:"rt_fontFamilyMerriweather-Regular",subCssClasses:[{value:"italic",label:e.get("textFontFamilySubClassItalic"),cssClass:"rt_fontFamilyMerriweather-Italic"},{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyMerriweather-Light"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyMerriweather-Regular"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyMerriweather-Bold"},{value:"bolditalic",label:e.get("textFontFamilySubClassBoldItalic"),cssClass:"rt_fontFamilyMerriweather-BoldItalic"},{value:"black",label:e.get("textFontFamilySubClassBlack"),cssClass:"rt_fontFamilyMerriweather-Black"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyMerriweather-LightItalic"},{value:"heavyitalic",label:e.get("textFontFamilySubClassHeavyItalic"),cssClass:"rt_fontFamilyMerriweather-HeavyItalic"}]},{value:"merriweathersans",label:"Merriweather Sans",cssClass:"rt_fontFamilyMerriweatherSans-Regular",subCssClasses:[{value:"italic",label:e.get("textFontFamilySubClassItalic"),cssClass:"rt_fontFamilyMerriweatherSans-Italic"},{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyMerriweatherSans-Light"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyMerriweatherSans-LightItalic"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyMerriweatherSans-Regular"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyMerriweatherSans-Bold"},{value:"bolditalic",label:e.get("textFontFamilySubClassBoldItalic"),cssClass:"rt_fontFamilyMerriweatherSans-BoldItalic"},{value:"extrabold",label:e.get("textFontFamilySubClassExtraBold"),cssClass:"rt_fontFamilyMerriweatherSans-ExtraBold"},{value:"extrabolditalic",label:e.get("textFontFamilySubClassExtraBoldItalic"),cssClass:"rt_fontFamilyMerriweatherSans-ExtraBoldItalic"}]},{value:"monoton",label:"Monoton",cssClass:"rt_fontFamilyMonoton-Regular"},{value:"montserrat",label:"Montserrat",cssClass:"rt_fontFamilyMontserrat-Regular",subCssClasses:[{value:"hairline",label:e.get("textFontFamilySubClassHairline"),cssClass:"rt_fontFamilyMontserrat-Hairline"},{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyMontserrat-Light"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyMontserrat-Regular"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyMontserrat-Bold"},{value:"black",label:e.get("textFontFamilySubClassBlack"),cssClass:"rt_fontFamilyMontserrat-Black"}]},{value:"opensanscondensed",label:"Open Sans Condensed",cssClass:"rt_fontFamilyOpenSansCondensed-Light",subCssClasses:[{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyOpenSansCondensed-Light"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyOpenSansCondensed-LightItalic"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyOpenSansCondensed-Bold"}]},{value:"oswald",label:"Oswald",cssClass:"rt_fontFamilyOswald-Regular",subCssClasses:[{value:"extralight",label:e.get("textFontFamilySubClassExtraLight"),cssClass:"rt_fontFamilyOswald-ExtraLight"},{value:"extralightitalic",label:e.get("textFontFamilySubClassExtraLightItalic"),cssClass:"rt_fontFamilyOswald-ExtraLightItalic"},{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyOswald-Light"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyOswald-LightItalic"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyOswald-Regular"},{value:"regularitalic",label:e.get("textFontFamilySubClassRegularItalic"),cssClass:"rt_fontFamilyOswald-RegularItalic"},{value:"medium",label:e.get("textFontFamilySubClassMedium"),cssClass:"rt_fontFamilyOswald-Medium"},{value:"mediumitalic",label:e.get("textFontFamilySubClassMediumItalic"),cssClass:"rt_fontFamilyOswald-MediumItalic"},{value:"demibold",label:e.get("textFontFamilySubClassDemiBold"),cssClass:"rt_fontFamilyOswald-DemiBold"},{value:"demibolditalic",label:e.get("textFontFamilySubClassDemiBoldItalic"),cssClass:"rt_fontFamilyOswald-DemiBoldItalic"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyOswald-Bold"},{value:"bolditalic",label:e.get("textFontFamilySubClassBoldItalic"),cssClass:"rt_fontFamilyOswald-BoldItalic"},{value:"heavy",label:e.get("textFontFamilySubClassHeavy"),cssClass:"rt_fontFamilyOswald-Heavy"},{value:"heavyitalic",label:e.get("textFontFamilySubClassHeavyItalic"),cssClass:"rt_fontFamilyOswald-HeavyItalic"},{value:"stencil",label:e.get("textFontFamilySubClassStencil"),cssClass:"rt_fontFamilyOswald-Stencil"}]},{value:"playball",label:"Playball",cssClass:"rt_fontFamilyPlayball"},{value:"ibmplexsans",label:"IBM Plex",default:!0,cssClass:"rt_fontFamilyIBMPlexSans-Regular",subCssClasses:[{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyIBMPlexSans-Light"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyIBMPlexSans-LightItalic"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyIBMPlexSans-Regular"},{value:"italic",label:e.get("textFontFamilySubClassItalic"),cssClass:"rt_fontFamilyIBMPlexSans-Italic"},{value:"medium",label:e.get("textFontFamilySubClassMedium"),cssClass:"rt_fontFamilyIBMPlexSans-Medium"},{value:"mediumitalic",label:e.get("textFontFamilySubClassMediumItalic"),cssClass:"rt_fontFamilyIBMPlexSans-MediumItalic"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyIBMPlexSans-Bold"},{value:"bolditalic",label:e.get("textFontFamilySubClassBoldItalic"),cssClass:"rt_fontFamilyIBMPlexSans-BoldItalic"}]},{value:"roboto",label:"Roboto",cssClass:"rt_fontFamilyRoboto-Regular",subCssClasses:[{value:"thin",label:e.get("textFontFamilySubClassThin"),cssClass:"rt_fontFamilyRoboto-Thin"},{value:"thinitalic",label:e.get("textFontFamilySubClassThinItalic"),cssClass:"rt_fontFamilyRoboto-ThinItalic"},{value:"light",label:e.get("textFontFamilySubClassLight"),cssClass:"rt_fontFamilyRoboto-Light"},{value:"lightitalic",label:e.get("textFontFamilySubClassLightItalic"),cssClass:"rt_fontFamilyRoboto-LightItalic"},{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilyRoboto-Regular"},{value:"italic",label:e.get("textFontFamilySubClassItalic"),cssClass:"rt_fontFamilyRoboto-Italic"},{value:"medium",label:e.get("textFontFamilySubClassMedium"),cssClass:"rt_fontFamilyRoboto-Medium"},{value:"mediumitalic",label:e.get("textFontFamilySubClassMediumItalic"),cssClass:"rt_fontFamilyRoboto-MediumItalic"},{value:"bold",label:e.get("textFontFamilySubClassBold"),cssClass:"rt_fontFamilyRoboto-Bold"},{value:"bolditalic",label:e.get("textFontFamilySubClassBoldItalic"),cssClass:"rt_fontFamilyRoboto-BoldItalic"},{value:"black",label:e.get("textFontFamilySubClassBlack"),cssClass:"rt_fontFamilyRoboto-Black"},{value:"blackitalic",label:e.get("textFontFamilySubClassBlackItalic"),cssClass:"rt_fontFamilyRoboto-BlackItalic"}]},{value:"sortsmillgoudy",label:"Sorts Mill Goudy",cssClass:"rt_fontFamilySortsMillGoudy-Regular",subCssClasses:[{value:"regular",label:e.get("textFontFamilySubClassRegular"),cssClass:"rt_fontFamilySortsMillGoudy-Regular"},{value:"italic",label:e.get("textFontFamilySubClassItalic"),cssClass:"rt_fontFamilySortsMillGoudy-Italic"}]},{value:"specialelite",label:"Special Elite",cssClass:"rt_fontFamilySpecialElite"}]),FONT_SIZE_CHOICES:Object.freeze([{value:"auto",label:e.get("textDefaultFontSize")},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"14",label:"14"},{value:"16",label:"16"},{value:"18",label:"18"},{value:"20",label:"20"},{value:"22",label:"22"},{value:"24",label:"24"},{value:"26",label:"26"},{value:"28",label:"28"},{value:"30",label:"30"},{value:"36",label:"36"},{value:"48",label:"48"},{value:"60",label:"60"},{value:"72",label:"72"},{value:"96",label:"96"},{value:"120",label:"120"},{value:"170",label:"170"},{value:"230",label:"230"}]),LINE_HEIGHT_CHOICES:Object.freeze([{value:"default",label:e.get("textDefaultFontSize")},{value:"1.0",label:"1.0"},{value:"1.5",label:"1.5"},{value:"2.0",label:"2.0"},{value:"2.5",label:"2.5"},{value:"3.0",label:"3.0"},{value:"3.5",label:"3.5"},{value:"4.0",label:"4.0"},{value:"4.5",label:"4.5"},{value:"5.0",label:"5.0"}])}})),define("dashboard-core/js/features/content/mobileResponsiveLayout/TabsMenu",["react","prop-types","@ba/ba-ui-carbon-toolkit"],(function(e,t,n){var i=e.Component,o=n.Tabs,r=n.TabPanel,a=function(t){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(n,t),n.prototype.render=function(){var t=this._renderTabPanels(this.props.tabs);return e.createElement(o,{className:"responsive-tabs",selected:this.props.selectedTab,onChange:this._onTabChange.bind(this),vertical:!0,linePosition:"right"},t)},n.prototype._renderTabPanels=function(t){var n=[];return t.forEach((function(t){var i=t.icon?t.icon:null;n.push(e.createElement(r,{id:t.id,label:t.label,className:"responsive-tab-menu-item",icon:i}))})),n},n.prototype._onTabChange=function(e){this.props.onTabChange&&this.props.onTabChange(e)},n}(i);return a.propTypes={tabs:t.object.isRequired,selectedTab:t.string.isRequired,onTabChange:t.func.isRequired},a})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"));else if("function"==typeof define&&define.amd)define("js/gemini/lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/icons-js/menu_32",["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"],t);else{var n=t("object"==typeof exports?require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"):e["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"]);for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}("undefined"!=typeof self?self:this,(function(e){return webpackJsonPBaGraphics([523],{"37696b3d55d68e77676e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("6873601dfe1d9459c1a9"),o=(n.n(i),n("57fa632eb8a1db011986"));t.default=o.a},"57fa632eb8a1db011986":function(e,t,n){"use strict";var i=n("9689a9c94ae38b47fa2c"),o=n.n(i),r=n("9ce58a7deea14f49ef01"),a=n.n(r),A=new o.a({id:"menu_32_v7",use:"menu_32_v7-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="menu_32_v7"><path d="M4 24H28V26H4zM4 12H28V14H4zM4 18H28V20H4zM4 6H28V8H4z" /></symbol>'});a.a.add(A),t.a=A},"6873601dfe1d9459c1a9":function(t,n){t.exports=e}},["37696b3d55d68e77676e"])})),define("dashboard-core/js/features/content/mobileResponsiveLayout/TabsMenuBar",["react","prop-types","@ba/ba-ui-carbon-toolkit","./TabsMenu","@ba/ba-graphics/dist/icons-js/menu_32"],(function(e,t,n,i,o){var r=e.Component,a=n.TabItem,A=n.Container,s=n.SVGIcon,l=function(t){function n(){_classCallCheck(this,n);for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];var r=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(i)));return r.state={menuOpen:!1},r}return _inherits(n,t),n.prototype._renderHeader=function(t){if(t){var n=t.label,i=t.icon;return e.createElement(a,{label:n,icon:i,assignTabLabelRef:function(){},editable:!1})}return null},n.prototype._onMenuBarIconClicked=function(){this.setState({menuOpen:!this.state.menuOpen})},n.prototype._renderSVGIcon=function(){return e.createElement(A,{className:"responsive-tab-menu-bar-icon",onClick:this._onMenuBarIconClicked.bind(this)},e.createElement(s,{iconId:o.default.id,size:"large"}))},n.prototype._renderMenu=function(){var t={"background-color":this.props.backgroundColor},n=this.state.menuOpen?"responsive-tab-menu open":"responsive-tab-menu";return e.createElement(A,{className:n,style:t,onClick:this._onMenuBarIconClicked.bind(this)},e.createElement(i,{tabs:this.props.tabs,selectedTab:this.props.selectedTab,onTabChange:this._onTabChange.bind(this)}))},n.prototype._onTabChange=function(e){this.props.onTabChange&&this.props.onTabChange(e)},n.prototype.render=function(){var t=this,n=this.props.tabs.find((function(e){return e.id===t.props.selectedTab})),i=this._renderHeader(n),o=this._renderMenu(),r=this._renderSVGIcon(),a={"background-color":this.props.backgroundColor};return e.createElement(A,{className:"responsive-tab-menu-content"},e.createElement(A,{className:"responsive-tab-menu-bar",style:a},r,i),o)},n}(r);return l.propTypes={tabs:t.object.isRequired,selectedTab:t.string.isRequired,onTabChange:t.func.isRequired,backgroundColor:t.string.isRequired},l})),define("dashboard-core/js/features/content/mobileResponsiveLayout/ResponsiveMenuController",["react","react-dom","./TabsMenuBar"],(function(e,t,n){return function(){function i(e){_classCallCheck(this,i),this._content=e.content,this._features=e.features}return i.prototype.destroy=function(){this._menuBarContainer&&(this._features.Canvas.off("change:selections:select",this._onSelectionChange,this),t.unmountComponentAtNode(this._menuBarContainer[0]),this._menuBarContainer=null,this._tabsInfo=null)},i.prototype.getContainer=function(){return this._container},i.prototype.setContainer=function(e){this._container=e},i.prototype._init=function(){var e=document.createElement("div");e.className="mediaQueryMarker";var t=document.createElement("div");t.className="responsive-tab-menu-bar-container",this.getContainer().prepend(t),this.getContainer().prepend(e),this.updateMenuBar(),this._registerSelectionChangeListener()},i.prototype._onSelectionChange=function(e){var t=e.info.value[0],n=this._features.Canvas.getContent(t);n&&"page"===n.getType()&&n.getContainer()===this._content&&this.updateMenuBar(t)},i.prototype._registerSelectionChangeListener=function(){this._features.Canvas.on("change:selections:select",this._onSelectionChange,this)},i.prototype._getTabsInfo=function(){var e=this;if(!this._tabsInfo){var t=this._getSelectedPage(),n=[],o=null;this._content.getChildren().forEach((function(r){var a={},A=i._getLayoutModel(r);a.label=r.getPropertyValue("title")||A.get("title");var s=A.get("tabIcon");s&&"transparent"!==s&&(a.icon=e._features.Icons.getIcon(s).id),a.id=r.getId(),n.push(a),t!==r&&t.getId()!==r.getId()||(o=r.getId())})),this._tabsInfo={tabs:n,selectedTab:o}}return this._tabsInfo},i.prototype.updateMenuBar=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=this._getTabsInfo();o.selectedTab=i||o.selectedTab,t.render(e.createElement(n,{tabs:o.tabs,selectedTab:o.selectedTab,onTabChange:this._onTabChange.bind(this),backgroundColor:this._getMenuColor()}),this._getMenuBarContainer()[0])},i.prototype._getMenuColor=function(){var e=window.getComputedStyle(this.getContainer()).backgroundColor;return"rgba(0, 0, 0, 0)"===e?"white":e},i.prototype._getMenuBarContainer=function(){return this._menuBarContainer||(this._menuBarContainer=this.getContainer().getElementsByClassName("responsive-tab-menu-bar-container")),this._menuBarContainer},i.prototype._getSelectedPage=function(){return this._features.Canvas.getSelectedContentList({type:"page"})[0]},i._getLayoutModel=function(e){return e.getFeature("Models.internal").getLayoutModel()},i.prototype._onTabChange=function(e){this._features.Canvas.selectContent([e])},i.prototype.renderResponsiveMenuUI=function(){!this.isResponsiveMenuRendered&&this._content.getPropertyValue("showTabsInPreview")&&(this.isResponsiveMenuRendered=!0,this._init())},i}()})),define("dashboard-core/js/dashboard/layout/views/Tab",["./PageCollectionView","jquery","underscore","react","react-dom","classnames","corsair_ship/ba-react-html5-dnd","@ba/ba-ui-carbon-toolkit","../../util/ColorUtils","../../../app/nls/StringResources","../../../lib/@waca/dashboard-common/dist/ui/dialogs/ConfirmationDialog","../../../app/util/EventChainLocal","../../../lib/@waca/core-client/js/core-client/utils/BidiUtil","../../../lib/@waca/dashboard-common/dist/utils/TextEditorConstants","../../../features/content/mobileResponsiveLayout/ResponsiveMenuController"],(function(e,t,n,i,o,r,a,A,s,l,c,d,u,h,g){var f={top:"bottom",left:"right",bottom:"top",right:"left"},p=[{modelPropertyName:"tabTextColor",toolkitPropertyName:"textColor"},{modelPropertyName:"tabSelectedLineColor",toolkitPropertyName:"lineColor"},{modelPropertyName:"tabBackgroundColor",toolkitPropertyName:"backgroundColor"},{modelPropertyName:"tabIconColor",toolkitPropertyName:"iconColor"}],m=e.extend({init:function(e){m.inherited("init",this,arguments),this.eventRouter=e.eventRouter,this.canvas=e.canvas,this.colorsService=this.dashboardApi.getFeature("Colors"),this._icons=this.dashboardApi.getFeature("Icons"),this._dashboardState=this.dashboardApi.getFeature("DashboardState"),this._registerEvents(),this._initialContentTab=this._initializeTabContent(),this._setTabsVisibility(),this._TabsWidget=null,Object.defineProperty(this,"tabWidget",{get:function(){return this._TabsWidget},configurable:!0}),this._delayedRendering={},this._renderingMountingNode={},this._mountedNodesArePopulated={}},_initializeTabContent:function(){if(this.model.getParent())return this.content.getChildren()[0];var e=this.canvas.getContent().getChildren(),t=this.canvas.getSelectedContentList({type:e[0].getType()});return this.selectedModel=this.model.items.find((function(n){return n.id===(t.length&&t[0].id||e[0].getId())})),t.length?t[0]:e[0]},renderContent:function(){var e=this;return this.rendered?Promise.resolve(!1):m.inherited("renderContent",this,arguments).then((function(){var t=e._initialContentTab&&e._initialContentTab.getId();e._renderTabs(t),e._renderResponsiveMenu(),e.showView(e.model.findModel(t)),e.rendered=!0}))},_renderResponsiveMenu:function(){var e=this.dashboardApi.getFeature("Renderer.internal");e&&e.isMobile()&&!this.model.getParent()&&(this._menuController=new g({content:this.content,features:{Canvas:this.canvas,Icons:this._icons}}),this._menuController.setContainer(this.domNode),this._menuController.renderResponsiveMenuUI())},_getTabNode:function(e,t){var n=e.parentElement;return n||((n=document.createElement("div")).id=t+"_tab",n.classList.add("pageTabContent"),n.append(e)),this.selectedModel&&this.selectedModel.id===t?n.classList.add("selected"):n.classList.remove("selected"),n},renderChild:function(e,t){var n=this,i=this._initialContentTab&&this._initialContentTab.getId();return e===i||this.selectedModel&&e===this.selectedModel.id||t?(this._delayedRendering[e]&&delete this._delayedRendering[e],m.inherited("renderChild",this,arguments).then((function(){if(t)return n.layoutController.getLayoutViewWhenReady(e).then((function(t){if(t&&!t.domNode.parentElement){var i=n._getTabNode(t.domNode,e),o=n.domNode.querySelectorAll(".tabPageHolder");o.length&&o.forEach((function(e){return e.append(i)}))}}))}))):(this._delayedRendering[e]=!0,Promise.resolve())},destroy:function(){this._menuController&&(this._menuController.destroy(),this._menuController=null),this._unregisterEvents(),this.selectedModel=null,delete this.tabWidget,o.unmountComponentAtNode(this.$el.find(".tabCntr")[0]),t(".tabLabel",this.$el).remove(),m.inherited("destroy",this,arguments),this._TabsWidget=null,this._delayedRendering=null,this._renderingMountingNode=null,this._mountedNodesArePopulated=null},_registerEvents:function(){this.colorsService&&(this.colorsService.on("theme:changed",this.applyTheme,this),this.colorsService.on("colorSet:changed",this.applyTheme,this)),this.model&&(this.model.on("change:tabTextColor",this.applyTheme,this),this.model.on("change:tabSelectedLineColor",this.applyTheme,this),this.model.on("change:tabBackgroundColor",this.applyTheme,this),this.content.on("add:child",this.onTabAdded,this),this.content.on("remove:child",this.onTabRemoved,this),this.model.on("change:hideTab",this.updateHideTabState,this),this.model.on("change:fillColor",this.applyTheme,this),this.model.on("change:tabPosition",this.updateTabPosition,this),this.model.on("change:tabIconPosition",this.updateTabIconPosition,this),this.model.on("change:showDropDown",this._updateProperties,this),this.model.on("change:tabFontFamily",this._updateFontFamily,this),this.model.on("change:tabFontFamilySubClass",this._updateFontFamily,this)),this.eventRouter&&this.eventRouter.on("properties:hasRendered",this.setInitialEnabledState,this),this.canvas.on("change:selections:select",this.onSelection,this),this._boundSetTabsVisibility=this._setTabsVisibility.bind(this),this._dashboardState.onUiStateChange(this._boundSetTabsVisibility),this.model.on("change:showDropDown",this._updateProperties,this)},_unregisterEvents:function(){this.colorsService&&(this.colorsService.off("theme:changed",this.applyTheme,this),this.colorsService.off("colorSet:changed",this.applyTheme,this)),this.model&&(this.model.off("change:tabTextColor",this.applyTheme,this),this.model.off("change:tabSelectedLineColor",this.applyTheme,this),this.model.off("change:tabBackgroundColor",this.applyTheme,this),this.content.off("add:child",this.onTabAdded,this),this.content.off("remove:child",this.onTabRemoved,this),this.model.off("change:hideTab",this.updateHideTabState,this),this.model.off("change:fillColor",this.applyTheme,this),this.model.off("change:tabPosition",this.updateTabPosition,this),this.model.off("change:tabIconPosition",this.updateTabIconPosition,this),this.model.off("change:showDropDown",this._updateProperties,this),this.model.off("change:tabFontFamily",this._updateFontFamily,this),this.model.off("change:tabFontFamilySubClass",this._updateFontFamily,this)),this.eventRouter&&this.eventRouter.off("properties:hasRendered",this.setInitialEnabledState,this),this.canvas.off("change:selections:select",this.onSelection,this),this._dashboardState.offUiStateChange(this._boundSetTabsVisibility)},_onChangeBackgroundColor:function(){this._TabsWidget&&m.inherited("_onChangeBackgroundColor",this,arguments)&&this.applyTheme()},_getPanelId:function(e){return e+"_tabpanel"},_getModelIdFromPanel:function(e){return e.slice(0,-9)},_getDefaultLinePostion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"top";return f[e]},_getDashboardColorProperties:function(){var e=this,t={};return p.forEach((function(i){n.extend(t,e._getColorProperty(i))})),t},_getColorProperty:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.model,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.modelPropertyName,o={},r=void 0;if(n&&this.selectedModel){var a=this.content.getContent(this.selectedModel.id).getPropertyValue("backgroundColor");r=a&&"transparent"!==a?a:t.get("fillColor")||this.model.get("fillColor")}var A=t.get("tabBackgroundColor")||this.model.get("tabBackgroundColor")||r,s=this.colorsService.getForegroundColorPropertiesForUIElement(A,"tabs"),l=void 0;if(t.get(i)&&(l=this.colorsService.getHexColorFromDashboardColorSet(t.get(i))),l||"tabBackgroundColor"!==i||(l=this.colorsService.getHexColorFromDashboardColorSet(A)),l)o[e.toolkitPropertyName]={hexColor:l,isThemeColor:!1};else if(s&&s.length){var c=s.find((function(e){return e.id===i}));c&&(o[e.toolkitPropertyName]={hexColor:c.value,isThemeColor:!0})}return o},_getColorProperties:function(e){var t=this,n={},i=this._getDashboardColorProperties();if(Object.keys(i).forEach((function(e){n[e]=i[e].hexColor})),e){var o=this.selectedModel&&this.selectedModel.id||e.id,r=this.content.getContent(o),a=this._getChangedPageColorPropertyList(e,r);a.length>0&&(a.find((function(e){return"tabBackgroundColor"===e.modelPropertyName}))&&(a=p),a.forEach((function(o){var a=t._getColorProperty(o,e,r),A=o.toolkitPropertyName;if(a[A]){var s=!a[A].isThemeColor,l=i[A]&&!i[A].isThemeColor;n[A]=s?a[A].hexColor:l?i[A].hexColor:a[A].hexColor}}))),e.get("tabIconColor")||(n.iconColor=n.textColor)}return this._setDeleteColors(n),n},_setDeleteColors:function(e){var t=e.backgroundColor;"transparent"===t&&(t=this.colorsService.getValueForPropertyOfUIElement("board","backgroundColor")),t&&(e.hoverColor=s.invertColor(t,20,100,!0),e.deleteBackgroundColor=s.invertColor(t,40,100,!0),e.deleteIconColor=e.textColor)},_renderTabContent:function(e,n,i){var o=this;return this._ensureDelayedChildIsCreated(n,(function(){return o.layoutController.getLayoutViewWhenReady(n).then((function(r){if(r){var a=o._getTabNode(r.domNode,n);if(i+1===o._renderingMountingNode[n].length)return o._renderingMountingNode[n]=[],o._mountedNodesArePopulated[n]=!0,t(e).append(a),o.eventRouter.trigger("tab:tabChanged",{modelId:o.selectedModel.id,isTabWidget:!!o.model.getParent()}),r.onShow(),o._invokeLifeCycleHandlers("tabs.onShow",{$el:o.$el,model:o.selectedModel}).then((function(){return o._updateHeader()}));o.$el.children(".tabPageHolder").append(a)}}))}))},_createTabPanel:function(e){var t=this,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=A.TabPanel,a=e.id,s=this._getColorProperties(o?e:null),l=e.get("tabIcon"),c=l&&"transparent"!==l?this._icons.getIcon(l).id:null,d={id:this._getPanelId(e.id),label:e.get("title"),icon:c,keepTabContent:!0,tooltipOrient:"top"};return n.extend(d,s),i.createElement(r,d,[i.createElement("div",{ref:function(e){if(e)if(t._renderingMountingNode[a]||(t._renderingMountingNode[a]=[]),0===t._renderingMountingNode[a].length)t._renderingMountingNode[a][0]=t._renderTabContent(e,a,0);else{var n=t._renderingMountingNode[a].length,i=t._renderingMountingNode[a][n-1];t._renderingMountingNode[a][n]=new Promise((function(o){i.finally((function(){o(t._renderTabContent(e,a,n))}))}))}else t._mountedNodesArePopulated[a]=!1}})])},_getFontClass:function(){var e=this.content.getPropertyValue("tabFontFamily")||"ibmplexsans",t=this.content.getPropertyValue("tabFontFamilySubClass")||"regular",n=h.FONT_FAMILY_CHOICES.find((function(t){return e===t.value})),i=n.cssClass;if(n.subCssClasses&&n.subCssClasses.length>0){var o=n.subCssClasses.find((function(e){return t===e.value}));o&&(i=o.cssClass)}return i},_getFontFamilyStyles:function(){var e=this._getFontClass(),t=document.createElement("div"),n=document.createElement("div");t.append(n),t.classList.add("widget"),n.classList.add(e),document.body.append(t);var i=["font-family","font-style","font-weight"].reduce((function(e,t){var i;return _extends({},e,((i={})[t]=window.getComputedStyle(n).getPropertyValue(t),i))}),{});return t.remove(),i},_updateFontFamily:function(){this.$el.find(".ba-common-tabList").first().css(this._getFontFamilyStyles())},_renderTabs:function(e){var s=this;this.content.getContainer()&&this.$el.addClass("widget noRotate forcePageFit");var l=A.Tabs,c=[],d=[];this.model.items.forEach((function(e){var t=s._createTabPanel(e);c.push(t),d.push(t)}));var h=this.model.get("tabPosition"),g=this.model.get("tabIconPosition"),f=this,p=f.canvas.getContent(this.model.id),m=!(!p||!p.getPropertyValue("showDropDown")),C=function(o){function a(t){_classCallCheck(this,a);var n=_possibleConstructorReturn(this,o.call(this,t));return n.state={selectedTabId:e,selectedTab:f._getPanelId(e),tabs:c,editable:!1,vertical:!0,draggable:!1,addable:!1,deleteable:!1,placement:h||"top",linePosition:f._getDefaultLinePostion(h),tabIconPosition:g,isDropDownHeader:m},n._tabsMirror=d,n._icons=f._icons,n.tabListNode=null,n.toolBarElementsList=[],n}return _inherits(a,o),a.prototype.componentDidUpdate=function(e,t){if(this._updatedTabs&&(this._updatedTabs=!1,this.state.tabs.length<this._tabsMirror.length))try{f.deleteView(f._getModelIdFromPanel(n.difference(this._tabsMirror,this.state.tabs)[0].props.id))}catch(e){console.log(e)}this._tabsMirror=this.state.tabs.slice(),t.selectedTab!==this.state.selectedTab&&f.showView(f.model.findModel(f._getModelIdFromPanel(this.state.selectedTab)))},a.prototype.componentDidMount=function(){var e=f.$el.find(".ba-common-tabList").first();e.on("click.dbTab",f._tabClick.bind(f)),e.on("keydown.dbTab",f._tabKeydown.bind(f)),e.on("dblclick.dbTab",f._tabDoubleClick.bind(f)),this.tabListNode=e},a.prototype.componentWillUnmount=function(){var e=f.$el.find(".ba-common-tabList").first();e.off("click.dbTab"),e.off("keydown.dbTab"),e.off("dblckick.dbTab"),this.tabListNode=null,this.hasUnmounted=!0},a.prototype.updateTheme=function(){var e=this,t=[];this.state.tabs.forEach((function(n,i){t.push(e._createTabElements(n,i))})),this.setState({tabs:t})},a.prototype.editTabLabel=function(e,i){var o=this,r=!!e,a=void 0;(a=this.tabListNode?t(this.tabListNode):f.$el.find(".ba-common-tabList").first()).find("[role=tab][aria-selected=true]").focus(),this.setState({editable:r},(function(){if(r){var e=a.find("[contentEditable=true]"),A=f._getPanelId(i.id),s=void 0,l=n.find(o.state.tabs,(function(e){return A===e.props.id}));l&&(s=l.props.label);var c=new MutationObserver((function(){t.contains(f.$el,e)||(c.disconnect(),(e=a.find("[contentEditable=true]")).on("blur.dashboardtabs",(function(){e.off("blur.dashboardtabs"),o.setState({editable:!1},(function(){var e=n.find(o.state.tabs,(function(e){return A===e.props.id}));if(e){var t=e.props.label;s!==t&&(e.props.title=t,f.updateViewLabel(i,t))}}))})),e.focus())}));c.observe(f.$el[0],{childList:!0,subtree:!0}),e.focus()}}))},a.prototype.updateTabLabel=function(e){for(var t=[],n=f._getPanelId(e.id),o=0;o<this.state.tabs.length;o++){var r=this.state.tabs[o],a=e.get("title");r.props.id==n&&r.props.label!==a?t.push(i.cloneElement(r,{label:a,title:a})):t.push(r)}JSON.stringify(this.state.tabs)!==JSON.stringify(t)&&this.setState({tabs:t})},a.prototype.updateTabIcon=function(e){for(var t=[],n=!1,o=f._getPanelId(e.id),r=0;r<this.state.tabs.length;r++){var a=this.state.tabs[r],A=e.get("tabIcon"),s=void 0;s=A&&"transparent"!==A?this._icons.getIcon(A).id:null,a.props.id!==o||a.props.icon===s||this.translationMode?t.push(a):(t.push(i.cloneElement(a,{icon:s})),n=!0)}n&&this.setState({tabs:t})},a.prototype.updateTranslationIcon=function(e,t){var n=f.dashboardApi.getFeature("Icons");this.translationMode=t;for(var o=[],r=!1,a=0,A=f._getPanelId(e.id),s=e.get("title"),l=0;l<this.state.tabs.length;l++){var c=this.state.tabs[l];if(c.props.id==A){if(t)o.push(i.cloneElement(c,{icon:n.getIcon("warning").id,className:"translateIcon",label:s,title:s})),r=!0,a++;else if(c.props.icon){var d=e.get("tabIcon");o.push(i.cloneElement(c,{icon:d?d.name:void 0,className:void 0,label:s,title:s})),r=!0,a++}}else o.push(c)}return r&&this.setState({tabs:o}),a},a.prototype._createTabElements=function(e,t){var n=f.model.items[t],o=f._getColorProperties(n);return o.iconPosition=this.state.tabIconPosition,i.cloneElement(e,o)},a.prototype.render=function(){var e=this,t=f._getColorProperties(),n=[];this.state.tabs.forEach((function(t,i){n.push(e._createTabElements(t,i))})),f._TabsWidget=this;var o=r("ba-theme-default",f._getContentBackgroundProperty(this.state.selectedTabId));return i.createElement("div",{className:o,style:{}},[i.createElement(A.Select,{selected:f.selectedItem||f.getSelectedSubViewId(),options:f.model.items.map((function(e){return{value:e.get("id"),label:e.get("title")}})),variant:"frameless",onChange:function(e){f.selectedItem=e,f.onSelection({info:{value:[e]}})}}),i.createElement(l,{draggable:this.state.draggable,selected:this.state.selectedTab,stateTabs:this.state.tabs,editable:this.state.editable,addable:this.state.addable,textDir:u.userPreferredTextDir,onChange:function(e){var t=f._getModelIdFromPanel(e);f.canvas.selectContent([t])},setState:function(t){e._updatedTabs=!0,e.setState({tabs:t})},onAddButtonClick:function(){return f.onAddClick()},onReorder:function(e,t){f.onReorder(n,e,t)},scrollButtonsBackgroundColor:f.colorsService.getLayoutBackgroundColorHex(f.model.get("fillColor")),scrollButtonsTextColor:t.textColor,placement:this.state.placement,linePosition:this.state.linePosition},n)])},a}(i.Component),B=a(C);o.render(i.createElement(B),this.$el.find(".tabCntr")[0])},_getContentBackgroundProperty:function(e){var t=this.content.getContent(e);if(!t)return"";var n=void 0,i=t.getPropertyValue("backgroundColor");return(n=i&&"transparent"!==i?i:this.model.get("fillColor"))?"fill-"+n:""},_getPanelFromNode:function(e){if(e){var t=this.$el.find(".ba-common-tabList").first().find("[role=tab]").index(e);if(t>-1)return this._TabsWidget.state.tabs[t]}return null},_getEventModelInfo:function(e){var n=this,i=void 0,o=t(e.target).closest("[role=tab]")[0];if(o){var r=this._getPanelFromNode(o);if(r){var a=r.props.id;i={selected:this._TabsWidget.state.selectedTab===a,node:o,model:this.model.findModel(this._getModelIdFromPanel(a)),editing:function(){return n._TabsWidget.state.editable}}}}return i},_tabClick:function(e){var n=this;new d(e).setProperty("preventDefaultContextBar",!0);var i=this._getEventModelInfo(e);i&&i.selected&&!i.editing()&&setTimeout((function(){t(i.node).closest(".ba-common-tabList").length&&!i.editing()&&n.showContextMenu(i.model,i.node)}),10)},_tabKeydown:function(e){var t=this._getEventModelInfo(e);t&&t.selected&&this._handleKeydown(t.model,e,t.node)},_tabDoubleClick:function(e){var n=this,i=this._getEventModelInfo(e);i&&i.selected&&!i.editing()&&setTimeout((function(){t(i.node).closest(".ba-common-tabList").length&&n.editViewTitle(i.model)}),50)},_attachView:function(){},onAddClick:function(){},onReorder:function(){},onDeletePrompt:function(){new c({title:l.get("tabDeleteDialogTitle"),message:l.get("tabDeleteDialogMessage"),confirmCallback:this._deleteCallbackFn.bind(this),primaryButtonText:l.get("tabDeleteDialogPrimaryButton")}).render()},_deleteCallbackFn:function(){var e=this._TabsWidget.state.selectedTab;if(e){var t=this._TabsWidget.state.tabs.filter((function(t){return t.props.id!==e}));this._TabsWidget.setState({tabs:t}),this.deleteView(this._getModelIdFromPanel(e))}},deleteView:function(){},updateViewLabel:function(){},getSelectedSubViewId:function(){return this.selectedModel&&this.selectedModel.id},onSelection:function(e){var t=this,n=e.info.value;("change:selections:select"!==e.name||n.find((function(e){return t.model.id===e||t.model.items.find((function(t){return t.getId()===e}))})))&&e.info.value.forEach((function(e){var n=t.canvas.getContent(e);n&&"page"===n.getType()&&(t.selectedModel&&t.selectedModel.id!==e&&t._updateSelectedModel(t.model.items.find((function(t){return t.getId()===e})),!0),t._TabsWidget&&(t._TabsWidget.setState({selectedTabId:e,selectedTab:t._getPanelId(e)}),t._TabsWidget.updateTheme()))}))},getSelectedSubViewTitle:function(){return this.selectedModel.get("title")},_updateSelectedModel:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.selectedModel){t&&this.canvas.deselectContent([this.selectedModel.id]);var n=this.layoutController.getLayoutView(this.selectedModel.id);n&&n.onHide()}this.selectedModel=e},showView:function(e){var n=this,i=this._getViewId(e);this._currentViewId!==i&&(this._currentViewId=i,this._updateSelectedModel(e),this.$el.find(".pageTabContent.selected").first().removeClass("selected"),t("#"+i,this.$el).addClass("selected"),this._mountedNodesArePopulated[e.id]&&(this.eventRouter.trigger("tab:tabChanged",{modelId:this.selectedModel.id,isTabWidget:!!this.model.getParent()}),this.layoutController.getLayoutView(e.id).onShow(),this._invokeLifeCycleHandlers("tabs.onShow",{$el:this.$el,model:e}).then((function(){return n._updateHeader()}))))},_updateHeader:function(){var e=this.$el.find(".bx--form-item").first();this.model.getParent()&&this.model.get("showDropDown")?(this.$el.addClass("tabsHidden"),e.removeClass("hide")):(this.$el.removeClass("tabsHidden"),e.addClass("hide"))},_updateProperties:function(){this._updateHeader(),this.eventRouter.trigger("properties:refreshPane")},_ensureDelayedChildIsCreated:function(e,t){return this._delayedRendering[e]?this.renderChild(e).then((function(){return t()})):t()},_getLabelId:function(e){return e.id+"_tablabel"},_handleKeydown:function(){},showContextMenu:function(){},editViewTitle:function(){},_showView:function(e){this.showView(e)},_getViewId:function(e){return e.id+"_tab"},_invokeLifeCycleHandlers:function(e,t){return this.dashboardApi.getDashboardSvc(".LifeCycleManager").then((function(n){return n.invokeLifeCycleHandlers(e,t)}))},applyTheme:function(){this._TabsWidget.updateTheme()},onTabAdded:function(e){var t=this;this._updateHideTabProperty();var n=this.canvas.getContent(e.info.newContentId);this._registerContentListener(n);var i=n.getFeature("state");return i.whenStatusChanges(i.STATUS.RENDERED).then((function(){t._TabsWidget.updateTheme(),t.eventRouter.trigger("properties:refreshPane")}))},onTabRemoved:function(e){this._unregisterContentListener(e.info.value),this._updateHideTabProperty(),this.eventRouter.trigger("properties:refreshPane")},_updateHideTabProperty:function(){if(!this.content.getPropertyValue("allowHidingMultipleTabs")){var e=this.model.items.length>1;this.eventRouter.trigger("properties:updateEnabled",{propertyName:"showTabsInPreview",enabled:!e}),e&&this.content.setPropertyValue("showTabsInPreview",!0)}},updateHideTabState:function(){var e=!this.model.get("hideTab");this.eventRouter.trigger("properties:setValue",{propertyName:"showTabsInPreview",value:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabPosition",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabIconPosition",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabTextColor",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabSelectedLineColor",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabBackgroundColor",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabRestoreDefaults",enabled:e}),this._setTabsVisibility()},updateTabPosition:function(e){if(this._TabsWidget&&e){var t=e.value||"top";this._TabsWidget.setState({placement:t,linePosition:this._getDefaultLinePostion(t)});var n={propertyName:"tabPosition",value:t};this.eventRouter.trigger("properties:setValue",n)}},updateTabIconPosition:function(e){if(this._TabsWidget&&e&&e.value){var t=e.value;this._TabsWidget.setState({tabIconPosition:t})}},setInitialEnabledState:function(){var e=!this.model.get("hideTab");this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabPosition",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabIconPosition",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabTextColor",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabSelectedLineColor",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabBackgroundColor",enabled:e}),this.eventRouter.trigger("properties:updateEnabled",{propertyName:"tabRestoreDefaults",enabled:e})},updateState:function(e){this._TabsWidget.hasUnmounted||this._TabsWidget.setState(e)},_onTabColorChange:function(e,t){var i=this.model,o={undoRedoTransactionId:n.uniqueId("layout_"+e+"Changed_")},r={};r[e]="transparent"==t.name?null:t.name,this.colorsService.prepareForColorModelChange(r,e),i.set(r,{sender:this.senderId,payloadData:o})},_getChangedPageColorPropertyList:function(e,t){var n=this;return p.filter((function(i){var o=e.get(i.modelPropertyName);return"tabBackgroundColor"===i.modelPropertyName&&t&&(t.getPropertyValue("backgroundColor")||n.model.get("fillColor"))||o}))},_setTabsVisibility:function(){var e=this.model.get("showDropDown")||!this.content.getPropertyValue("showTabsInPreview")&&!this._dashboardState.getUiState().authoring;this.$el.toggleClass("tabsHidden",e)}});return m})),define("dashboard-core/js/dashboard/layout/views/GenericPage",["./LayoutBaseView","jquery"],(function(e,t){var n=e.extend({aspectRatio:0,init:function(){n.inherited("init",this,arguments),this.layoutController.topLayoutModel.on("change:pageSize",this._onChangePageSize,this),this.layoutController.topLayoutModel.on("change:fitPage",this._onFitPage,this),this.layoutController.topLayoutModel.on("change:layoutPositioning",this._onChangeLayoutPositioning,this),this._setPageLayoutStyling()},destroy:function(){this.layoutController.topLayoutModel.off("change:pageSize",this._onChangePageSize,this),this.layoutController.topLayoutModel.off("change:fitPage",this._onFitPage,this),this.layoutController.topLayoutModel.off("change:layoutPositioning",this._onChangeLayoutPositioning,this);var e=this.layoutController.topLayoutModel.findDescendantsWithType("genericPage");0===e.length&&this._clearPageSize(),n.inherited("destroy",this,arguments)},onShow:function(){n.inherited("onShow",this,arguments),this.$el.is(":visible")&&(this._setPageFitStyling(),this._applyPageSize(),this._setPageLayoutStyling())},_applyPageSize:function(){var e=this._getLayoutPositioning();if("absolute"===e){var t=this.model.getValueFromSelfOrParent("pageSize");this._setAbsolutePageSize(t)}else if("relative"===e){var n=this.model.getValueFromSelfOrParent("pageSize");this._setRelativeAspectRatio(n)}},_clearPageSize:function(e){var t=e||this._getLayoutPositioning();"absolute"===t?this.$el.css({width:"",height:""}):"relative"===t&&this._removeDynamicStyles("dashboardRelativeAspectRatio")},_getLayoutPositioning:function(){return this.model.getLayoutPositioning(!1)},_onChangePageSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$el.is(":visible")&&(this._clearPageSize(e.prevValue),this._applyPageSize())},_onFitPage:function(){this.$el.is(":visible")&&(this._setPageFitStyling(),this._onChangePageSize()),this.onResize()},_onChangeLayoutPositioning:function(e){this._clearPageSize(e.prevValue),this.$el.is(":visible")&&(this._setPageLayoutStyling(),this._setPageFitStyling(),this._applyPageSize()),this.onResize()},_getFitPage:function(){var e=!1;return"absolute"!==this.model.getValueFromSelfOrParent("layoutPositioning")&&(e=this.model.getValueFromSelfOrParent("fitPage")||!1),e},_setPageFitStyling:function(){var e="relative"===this._getLayoutPositioning()&&this._getFitPage();this.$el.toggleClass("fitToPage",e)},_setPageLayoutStyling:function(){var e="relative"===this._getLayoutPositioning();this.$el.toggleClass("templateBox",e)},_setAbsolutePageSize:function(e){this.$el.width(e.width),this.$el.height(e.height)},_setRelativeAspectRatio:function(e){this.aspectRatio=e.height/e.width,this._getFitPage()?this._addAspectRatioForFitToPage():this._createStyleNode(".aspectRatio_default:before { padding-top:"+100*this.aspectRatio+"%; }","dashboardRelativeAspectRatio")},onResize:function(){if(this.$el.is(":visible")){var e=this._getFitPage();e&&this._addAspectRatioForFitToPage()}n.inherited("onResize",this,arguments)},_addAspectRatioForFitToPage:function(){var e=this.$el.parent().height(),t=this.$el.parent().width(),n=".page.pagecontainer .pagegenericPage { width: "+t+"px; height:"+this.aspectRatio*t+"px; max-height: "+e+"px; max-width:"+1/this.aspectRatio*e+"px;}";this._createStyleNode(n,"dashboardRelativeAspectRatio")},_createStyleNode:function(e,n){if(t("#"+n).html()!==e){this._removeDynamicStyles(n);var i=t('<style class=\'dashboardLayoutStyles\' type="text/css" id="'+n+'"></style>');i.html(e),i.appendTo("head")}},_removeDynamicStyles:function(e){t("#"+e).remove()}});return n})),define("dashboard-core/js/dashboard/layout/views/SinglePage",["./LayoutBaseView"],(function(e){var t=null;return t=e.extend({init:function(){t.inherited("init",this,arguments),this.layoutController.layoutReady(this.model.id).done(function(){this.layoutController.getLayoutView(this.model.id).onShow()}.bind(this))},getSelectedLayout:function(){return this.model.items[0]}})})),define("dashboard-core/js/dashboard/layout/views/all",["./LayoutBaseView","./Tab","./GenericPage","./SinglePage"],(function(){})),function(e){"function"==typeof define&&define.amd?define("dashboard-core/js/lib/@waca/textwidget/dist/summernote",["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}((function($){"use strict";var func=(idCounter=0,{eq:function(e){return function(t){return e===t}},eq2:function(e,t){return e===t},peq2:function(e){return function(t,n){return t[e]===n[e]}},ok:function(){return!0},fail:function(){return!1},self:function(e){return e},not:function(e){return function(){return!e.apply(e,arguments)}},and:function(e,t){return function(n){return e(n)&&t(n)}},invoke:function(e,t){return function(){return e[t].apply(e,arguments)}},uniqueId:function(e){var t=++idCounter+"";return e?e+t:t},rect2bnd:function(e){var t=$(document);return{top:e.top+t.scrollTop(),left:e.left+t.scrollLeft(),width:e.right-e.left,height:e.bottom-e.top}},invertObject:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t},namespaceToCamel:function(e,t){return(t=t||"")+e.split(".").map((function(e){return e.substring(0,1).toUpperCase()+e.substring(1)})).join("")},debounce:function(e,t,n){var i;return function(){var o=this,r=arguments,a=function(){i=null,n||e.apply(o,r)},A=n&&!i;clearTimeout(i),i=setTimeout(a,t),A&&e.apply(o,r)}}}),idCounter,list=(head=function(e){return e[0]},last=function(e){return e[e.length-1]},tail=function(e){return e.slice(1)},indexOf=function(e,t){return $.inArray(t,e)},contains=function(e,t){return-1!==indexOf(e,t)},{head:head,last:last,initial:function(e){return e.slice(0,e.length-1)},tail:tail,prev:function(e,t){var n=indexOf(e,t);return-1===n?null:e[n-1]},next:function(e,t){var n=indexOf(e,t);return-1===n?null:e[n+1]},find:function(e,t){for(var n=0,i=e.length;n<i;n++){var o=e[n];if(t(o))return o}},contains:contains,all:function(e,t){for(var n=0,i=e.length;n<i;n++)if(!t(e[n]))return!1;return!0},sum:function(e,t){return t=t||func.self,e.reduce((function(e,n){return e+t(n)}),0)},from:function(e){for(var t=[],n=-1,i=e.length;++n<i;)t[n]=e[n];return t},isEmpty:function(e){return!e||!e.length},clusterBy:function(e,t){return e.length?tail(e).reduce((function(e,n){var i=last(e);return t(last(i),n)?i[i.length]=n:e[e.length]=[n],e}),[[head(e)]]):[]},compact:function(e){for(var t=[],n=0,i=e.length;n<i;n++)e[n]&&t.push(e[n]);return t},unique:function(e){for(var t=[],n=0,i=e.length;n<i;n++)contains(t,e[n])||t.push(e[n]);return t}}),head,last,tail,indexOf,contains,isSupportAmd="function"==typeof define&&define.amd,isFontInstalled=function(e){var t="Comic Sans MS"===e?"Courier New":"Comic Sans MS",n=$("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),i=n.css("fontFamily",t).width(),o=n.css("fontFamily",e+","+t).width();return n.remove(),i!==o},userAgent=navigator.userAgent,isMSIE=/MSIE|Trident/i.test(userAgent),browserVersion;if(isMSIE){var matches=/MSIE (\d+[.]\d+)/.exec(userAgent);matches&&(browserVersion=parseFloat(matches[1])),matches=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(userAgent),matches&&(browserVersion=parseFloat(matches[1]))}var isEdge=/Edge\/\d+/.test(userAgent),hasCodeMirror=!!window.CodeMirror;if(!hasCodeMirror&&isSupportAmd&&"undefined"!=typeof require)if(void 0!==require.resolve)try{require.resolve("codemirror"),hasCodeMirror=!0}catch(e){}else void 0!==eval("require").specified&&(hasCodeMirror=eval("require").specified("codemirror"));var agent={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:isMSIE,isEdge:isEdge,isFF:!isEdge&&/firefox/i.test(userAgent),isPhantom:/PhantomJS/i.test(userAgent),isWebkit:!isEdge&&/webkit/i.test(userAgent),isChrome:!isEdge&&/chrome/i.test(userAgent),isSafari:!isEdge&&/safari/i.test(userAgent),browserVersion:browserVersion,jqueryVersion:parseFloat($.fn.jquery),isSupportAmd:isSupportAmd,hasCodeMirror:hasCodeMirror,isFontInstalled:isFontInstalled,isW3CRangeSupport:!!document.createRange},NBSP_CHAR=String.fromCharCode(160),ZERO_WIDTH_NBSP_CHAR="\ufeff",dom=(isEditable=function(e){return e&&$(e).hasClass("note-editable")},makePredByNodeName=function(e){return e=e.toUpperCase(),function(t){return t&&t.nodeName.toUpperCase()===e&&!((n=t.className)&&-1!==n.toUpperCase().indexOf("TEXTFITTED"));var n}},isText=function(e){return e&&3===e.nodeType},isVoid=function(e){return e&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(e.nodeName.toUpperCase())},isPara=function(e){return!isEditable(e)&&e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName.toUpperCase())},isPre=makePredByNodeName("PRE"),isLi=makePredByNodeName("LI"),isTable=makePredByNodeName("TABLE"),isData=makePredByNodeName("DATA"),isInline=function(e){return!(isBodyContainer(e)||isList(e)||isHr(e)||isPara(e)||isTable(e)||isBlockquote(e)||isData(e))},isList=function(e){return e&&/^UL|^OL/.test(e.nodeName.toUpperCase())},isHr=makePredByNodeName("HR"),isCell=function(e){return e&&/^TD|^TH/.test(e.nodeName.toUpperCase())},isBlockquote=makePredByNodeName("BLOCKQUOTE"),isBodyContainer=function(e){return isCell(e)||isBlockquote(e)||isEditable(e)},isAnchor=makePredByNodeName("A"),isBody=makePredByNodeName("BODY"),blankHTML=agent.isMSIE&&agent.browserVersion<11?"&nbsp;":"<br>",nodeLength=function(e){return isText(e)?e.nodeValue.length:e?e.childNodes.length:0},isEmpty=function(e){var t=nodeLength(e);return 0===t||!(isText(e)||1!==t||e.innerHTML!==blankHTML&&e.firstChild.innerHTML!==blankHTML)||!(!list.all(e.childNodes,isText)||""!==e.innerHTML)},paddingBlankHTML=function(e){isVoid(e)||nodeLength(e)||(e.innerHTML=blankHTML)},ancestor=function(e,t){for(;e;){if(t(e))return e;if(isEditable(e))break;e=e.parentNode}return null},listAncestor=function(e,t){t=t||func.fail;var n=[];return ancestor(e,(function(e){return isEditable(e)||n.push(e),t(e)})),n},listNext=function(e,t){t=t||func.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.nextSibling;return n},insertAfter=function(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e},appendChildNodes=function(e,t){return $.each(t,(function(t,n){e.appendChild(n)})),e},isLeftEdgePoint=function(e){return 0===e.offset},isRightEdgePoint=function(e){return e.offset===nodeLength(e.node)},isEdgePoint=function(e){return isLeftEdgePoint(e)||isRightEdgePoint(e)},isLeftEdgeOf=function(e,t){for(;e&&e!==t;){if(0!==position(e))return!1;e=e.parentNode}return!0},isRightEdgeOf=function(e,t){if(!t)return!1;for(;e&&e!==t;){if(position(e)!==nodeLength(e.parentNode)-1)return!1;e=e.parentNode}return!0},position=function(e){for(var t=0;e=e.previousSibling;)t+=1;return t},hasChildren=function(e){return!!(e&&e.childNodes&&e.childNodes.length)},prevPoint=function(e,t){var n,i;if(0===e.offset){if(isEditable(e.node))return null;n=e.node.parentNode,i=position(e.node)}else hasChildren(e.node)?(n=e.node.childNodes[e.offset-1],i=nodeLength(n)):(n=e.node,i=t?0:e.offset-1);return{node:n,offset:i}},nextPoint=function(e,t){var n,i;if(nodeLength(e.node)===e.offset){if(isEditable(e.node))return null;n=e.node.parentNode,i=position(e.node)+1}else hasChildren(e.node)?(n=e.node.childNodes[e.offset],i=0):(n=e.node,i=t?nodeLength(e.node):e.offset+1);return{node:n,offset:i}},isSamePoint=function(e,t){return e.node===t.node&&e.offset===t.offset},splitNode=function(e,t){var n=t&&t.isSkipPaddingBlankHTML,i=t&&t.isNotSplitEdgePoint;if(isEdgePoint(e)&&(isText(e.node)||i)){if(isLeftEdgePoint(e))return e.node;if(isRightEdgePoint(e))return e.node.nextSibling}if(isText(e.node))return e.node.splitText(e.offset);var o=e.node.childNodes[e.offset],r=insertAfter(e.node.cloneNode(!1),e.node);return appendChildNodes(r,listNext(o)),n||(paddingBlankHTML(e.node),paddingBlankHTML(r)),r},splitTree=function(e,t,n){var i=listAncestor(t.node,func.eq(e));return i.length?1===i.length?splitNode(t,n):i.reduce((function(e,i){return e===t.node&&(e=splitNode(t,n)),splitNode({node:i,offset:e?dom.position(e):nodeLength(i)},n)})):null},create=function(e){return document.createElement(e)},remove=function(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var n=e.parentNode;if(!t){var i,o,r=[];for(i=0,o=e.childNodes.length;i<o;i++)r.push(e.childNodes[i]);for(i=0,o=r.length;i<o;i++)n.insertBefore(r[i],e)}n.removeChild(e)}},isTextarea=makePredByNodeName("TEXTAREA"),value=function(e,t){var n=isTextarea(e[0])?e.val():e.html();return t?n.replace(/[\n\r]/g,""):n},{NBSP_CHAR:NBSP_CHAR,ZERO_WIDTH_NBSP_CHAR:ZERO_WIDTH_NBSP_CHAR,blank:blankHTML,emptyPara:"<p>"+blankHTML+"</p>",makePredByNodeName:makePredByNodeName,isEditable:isEditable,isControlSizing:function(e){return e&&$(e).hasClass("note-control-sizing")},isText:isText,isElement:function(e){return e&&1===e.nodeType},isVoid:isVoid,isPara:isPara,isPurePara:function(e){return isPara(e)&&!isLi(e)},isHeading:function(e){return e&&/^H[1-7]/.test(e.nodeName.toUpperCase())},isInline:isInline,isBlock:func.not(isInline),isBodyInline:function(e){return isInline(e)&&!ancestor(e,isPara)},isBody:isBody,isParaInline:function(e){return isInline(e)&&!!ancestor(e,isPara)},isPre:isPre,isList:isList,isTable:isTable,isData:isData,isCell:isCell,isBlockquote:isBlockquote,isBodyContainer:isBodyContainer,isAnchor:isAnchor,isDiv:makePredByNodeName("DIV"),isLi:isLi,isBR:makePredByNodeName("BR"),isSpan:makePredByNodeName("SPAN"),isB:makePredByNodeName("B"),isU:makePredByNodeName("U"),isS:makePredByNodeName("S"),isI:makePredByNodeName("I"),isImg:makePredByNodeName("IMG"),isTextarea:isTextarea,isEmpty:isEmpty,isEmptyAnchor:func.and(isAnchor,isEmpty),isClosestSibling:function(e,t){return e.nextSibling===t||e.previousSibling===t},withClosestSiblings:function(e,t){t=t||func.ok;var n=[];return e.previousSibling&&t(e.previousSibling)&&n.push(e.previousSibling),n.push(e),e.nextSibling&&t(e.nextSibling)&&n.push(e.nextSibling),n},nodeLength:nodeLength,isLeftEdgePoint:isLeftEdgePoint,isRightEdgePoint:isRightEdgePoint,isEdgePoint:isEdgePoint,isLeftEdgeOf:isLeftEdgeOf,isRightEdgeOf:isRightEdgeOf,isLeftEdgePointOf:function(e,t){return isLeftEdgePoint(e)&&isLeftEdgeOf(e.node,t)},isRightEdgePointOf:function(e,t){return isRightEdgePoint(e)&&isRightEdgeOf(e.node,t)},prevPoint:prevPoint,nextPoint:nextPoint,isSamePoint:isSamePoint,isVisiblePoint:function(e){if(isText(e.node)||!hasChildren(e.node)||isEmpty(e.node))return!0;var t=e.node.childNodes[e.offset-1],n=e.node.childNodes[e.offset];return!(t&&!isVoid(t)||n&&!isVoid(n))},prevPointUntil:function(e,t){for(;e;){if(t(e))return e;e=prevPoint(e)}return null},nextPointUntil:function(e,t){for(;e;){if(t(e))return e;e=nextPoint(e)}return null},isCharPoint:function(e){if(!isText(e.node))return!1;var t=e.node.nodeValue.charAt(e.offset-1);return t&&" "!==t&&t!==NBSP_CHAR},walkPoint:function(e,t,n,i){for(var o=e;o&&(n(o),!isSamePoint(o,t));){var r=i&&e.node!==o.node&&t.node!==o.node;o=nextPoint(o,r)}},ancestor:ancestor,singleChildAncestor:function(e,t){for(e=e.parentNode;e&&1===nodeLength(e);){if(t(e))return e;if(isEditable(e))break;e=e.parentNode}return null},listAncestor:listAncestor,lastAncestor:function(e,t){var n=listAncestor(e);return list.last(n.filter(t))},listNext:listNext,listPrev:function(e,t){t=t||func.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.previousSibling;return n},listDescendant:function(e,t){var n=[];return t=t||func.ok,function i(o){e!==o&&t(o)&&n.push(o);for(var r=0,a=o.childNodes.length;r<a;r++)i(o.childNodes[r])}(e),n},commonAncestor:function(e,t){for(var n=listAncestor(e),i=t;i;i=i.parentNode)if($.inArray(i,n)>-1)return i;return null},wrap:function(e,t){var n=e.parentNode,i=$("<"+t+">")[0];return n.insertBefore(i,e),i.appendChild(e),i},insertAfter:insertAfter,appendChildNodes:appendChildNodes,position:position,hasChildren:hasChildren,makeOffsetPath:function(e,t){return listAncestor(t,func.eq(e)).map(position).reverse()},fromOffsetPath:function(e,t){for(var n=e,i=0,o=t.length;i<o;i++)n=n.childNodes.length<=t[i]?n.childNodes[n.childNodes.length-1]:n.childNodes[t[i]];return n},splitTree:splitTree,splitPoint:function(e,t){var n,i,o=t?isPara:isBodyContainer,r=listAncestor(e.node,o),a=list.last(r)||e.node;o(a)?(n=r[r.length-2],i=a):i=(n=a).parentNode;var A=n&&splitTree(n,e,{isSkipPaddingBlankHTML:t,isNotSplitEdgePoint:t});return A||i!==e.node||(A=e.node.childNodes[e.offset]),{rightNode:A,container:i}},create:create,createText:function(e){return document.createTextNode(e)},remove:remove,removeWhile:function(e,t){for(;e&&!isEditable(e)&&t(e);){var n=e.parentNode;remove(e),e=n}},replace:function(e,t){if(e.nodeName.toUpperCase()===t.toUpperCase())return e;var n=create(t);return e.style.cssText&&(n.style.cssText=e.style.cssText),appendChildNodes(n,list.from(e.childNodes)),insertAfter(n,e),remove(e),n},html:function(e,t){var n=value(e);return t&&(n=n.replace(/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g,(function(e,t,n){n=n.toUpperCase();var i=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!t,o=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return e+(i||o?"\n":"")})),n=$.trim(n)),n},value:value,posFromPlaceholder:function(e){var t=$(e),n=t.offset(),i=t.outerHeight(!0);return{left:n.left,top:n.top+i}},attachEvents:function(e,t){Object.keys(t).forEach((function(n){e.on(n,t[n])}))},detachEvents:function(e,t){Object.keys(t).forEach((function(n){e.off(n,t[n])}))}}),isEditable,makePredByNodeName,isText,isVoid,isPara,isPre,isLi,isTable,isData,isInline,isList,isHr,isCell,isBlockquote,isBodyContainer,isAnchor,isBody,blankHTML,nodeLength,isEmpty,paddingBlankHTML,ancestor,listAncestor,listNext,insertAfter,appendChildNodes,isLeftEdgePoint,isRightEdgePoint,isEdgePoint,isLeftEdgeOf,isRightEdgeOf,position,hasChildren,prevPoint,nextPoint,isSamePoint,splitNode,splitTree,create,remove,isTextarea,value,Context=function(e,t){var n=this,i=$.summernote.ui;return this.memos={},this.modules={},this.layoutInfo={},this.options=t,this.initialize=function(){return this.layoutInfo=i.createLayout(e,t),this._initialize(),e.hide(),this},this.destroy=function(){this._destroy(),e.removeData("summernote"),i.removeLayout(e,this.layoutInfo)},this.reset=function(){var e=n.isDisabled();this.code(dom.emptyPara),this._destroy(),this._initialize(),e&&n.disable()},this._initialize=function(){var e=$.extend({},this.options.buttons);Object.keys(e).forEach((function(t){n.memo("button."+t,e[t])}));var t=$.extend({},this.options.modules,$.summernote.plugins||{});Object.keys(t).forEach((function(e){n.module(e,t[e],!0)})),Object.keys(this.modules).forEach((function(e){n.initializeModule(e)}))},this._destroy=function(){Object.keys(this.modules).reverse().forEach((function(e){n.removeModule(e)})),Object.keys(this.memos).forEach((function(e){n.removeMemo(e)})),this.triggerEvent("destroy",this)},this.code=function(t){var n=this.invoke("codeview.isActivated");if(void 0===t)return this.invoke("codeview.sync"),n?this.layoutInfo.codable.val():this.layoutInfo.editable.html();n?this.layoutInfo.codable.val(t):this.layoutInfo.editable.html(t),e.val(t),this.triggerEvent("change",t)},this.isDisabled=function(){return"false"===this.layoutInfo.editable.attr("contenteditable")},this.enable=function(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0)},this.disable=function(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.invoke("toolbar.deactivate",!0)},this.triggerEvent=function(){var t=list.head(arguments),n=list.tail(list.from(arguments)),i=this.options.callbacks[func.namespaceToCamel(t,"on")];i&&i.apply(e[0],n),e.trigger("summernote."+t,n)},this.initializeModule=function(t){var n=this.modules[t];n.shouldInitialize=n.shouldInitialize||func.ok,n.shouldInitialize()&&(n.initialize&&n.initialize(),n.events&&dom.attachEvents(e,n.events))},this.module=function(e,t,n){if(1===arguments.length)return this.modules[e];this.modules[e]=new t(this),n||this.initializeModule(e)},this.removeModule=function(t){var n=this.modules[t];n.shouldInitialize()&&(n.events&&dom.detachEvents(e,n.events),n.destroy&&n.destroy()),delete this.modules[t]},this.memo=function(e,t){if(1===arguments.length)return this.memos[e];this.memos[e]=t},this.removeMemo=function(e){this.memos[e]&&this.memos[e].destroy&&this.memos[e].destroy(),delete this.memos[e]},this.createInvokeHandler=function(e,t){return function(i){i.preventDefault(),n.invoke(e,t||$(i.target).closest("[data-value]").data("value"))}},this.invoke=function(){var e=list.head(arguments),t=list.tail(list.from(arguments)),n=e.split("."),i=n.length>1,o=i&&list.head(n),r=i?list.last(n):list.head(n),a=this.modules[o||"editor"];return!o&&this[r]?this[r].apply(this,t):a&&a[r]&&a.shouldInitialize()?a[r].apply(a,t):void 0},this.initialize()};$.fn.extend({summernote:function(){var e=$.type(list.head(arguments)),t="string"===e,n="object"===e,i=n?list.head(arguments):{};(i=$.extend({},$.summernote.options,i)).langInfo=$.extend(!0,{},$.summernote.lang["en-US"],$.summernote.lang[i.lang]),i.icons=$.extend(!0,{},$.summernote.options.icons,i.icons),this.each((function(e,t){var n=$(t);if(!n.data("summernote")){var o=new Context(n,i);n.data("summernote",o),n.data("summernote").triggerEvent("init",o.layoutInfo)}}));var o=this.first();if(o.length){var r=o.data("summernote");if(t)return r.invoke.apply(r,list.from(arguments));i.focus&&r.invoke("editor.focus")}return this}});var Renderer=function(e,t,n,i){this.render=function(o){var r=$(e);if(n&&n.contents&&r.html(n.contents),n&&n.className&&r.addClass(n.className),n&&n.data&&$.each(n.data,(function(e,t){r.attr("data-"+e,t)})),n&&n.click&&r.on("click",n.click),t){var a=r.find(".note-children-container");t.forEach((function(e){e.render(a.length?a:r)}))}return i&&i(r,n),n&&n.callback&&n.callback(r),o&&o.append(r),r}},renderer={create:function(e,t){return function(){var n=$.isArray(arguments[0])?arguments[0]:[],i="object"==typeof arguments[1]?arguments[1]:arguments[0];return i&&i.children&&(n=i.children),new Renderer(e,n,i,t)}}},editor=renderer.create('<div class="note-editor note-frame panel panel-default"/>'),toolbar=renderer.create('<div class="note-toolbar panel-heading"/>'),editingArea=renderer.create('<div class="note-editing-area"/>'),codable=renderer.create('<textarea class="note-codable"/>'),editable=renderer.create('<div class="note-editable panel-body" contentEditable="true"/>'),statusbar=renderer.create(['<div class="note-statusbar">','  <div class="note-resizebar">','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>',"  </div>","</div>"].join("")),airEditor=renderer.create('<div class="note-editor"/>'),airEditable=renderer.create('<div class="note-editable" contentEditable="true"/>'),buttonGroup=renderer.create('<div class="note-btn-group btn-group">'),button=renderer.create('<button type="button" class="note-btn btn btn-default btn-sm" tabindex="-1">',(function(e,t){t&&t.tooltip&&e.attr({title:t.tooltip}).tooltip({container:"body",trigger:"hover",placement:"bottom"})})),dropdown=renderer.create('<div class="dropdown-menu">',(function(e,t){var n=$.isArray(t.items)?t.items.map((function(e){return'<li><a href="#" data-value="'+("string"==typeof e?e:e.value||"")+'">'+(t.template?t.template(e):e)+"</a></li>"})).join(""):t.items;e.html(n)})),dropdownCheck=renderer.create('<div class="dropdown-menu note-check">',(function(e,t){var n=$.isArray(t.items)?t.items.map((function(e){var n="string"==typeof e?e:e.value||"",i=t.template?t.template(e):e;return'<li><a href="#" data-value="'+n+'">'+icon(t.checkClassName)+" "+i+"</a></li>"})).join(""):t.items;e.html(n)})),palette=renderer.create('<div class="note-color-palette"/>',(function(e,t){for(var n=[],i=0,o=t.colors.length;i<o;i++){for(var r=t.eventName,a=t.colors[i],A=[],s=0,l=a.length;s<l;s++){var c=a[s];A.push(['<button type="button" class="note-color-btn"','style="background-color:',c,'" ','data-event="',r,'" ','data-value="',c,'" ','title="',c,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}n.push('<div class="note-color-row">'+A.join("")+"</div>")}e.html(n.join("")),e.find(".note-color-btn").tooltip({container:"body",trigger:"hover",placement:"bottom"})})),dialog=renderer.create('<div class="modal" aria-hidden="false" tabindex="-1"/>',(function(e,t){t.fade&&e.addClass("fade"),e.html(['<div class="modal-dialog">','  <div class="modal-content">',t.title?'    <div class="modal-header">      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>      <h4 class="modal-title">'+t.title+"</h4>    </div>":"",'    <div class="modal-body">'+t.body+"</div>",t.footer?'    <div class="modal-footer">'+t.footer+"</div>":"","  </div>","</div>"].join(""))})),popover=renderer.create(['<div class="note-popover popover in">','  <div class="arrow"/>','  <div class="popover-content note-children-container"/>',"</div>"].join(""),(function(e,t){var n=void 0!==t.direction?t.direction:"bottom";e.addClass(n),t.hideArrow&&e.find(".arrow").hide()})),icon=function(e,t){return"<"+(t=t||"i")+' class="'+e+'"/>'},ui={editor:editor,toolbar:toolbar,editingArea:editingArea,codable:codable,editable:editable,statusbar:statusbar,airEditor:airEditor,airEditable:airEditable,buttonGroup:buttonGroup,button:button,dropdown:dropdown,dropdownCheck:dropdownCheck,palette:palette,dialog:dialog,popover:popover,icon:icon,toggleBtn:function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)},toggleBtnActive:function(e,t){e.toggleClass("active",t)},onDialogShown:function(e,t){e.one("shown.bs.modal",t)},onDialogHidden:function(e,t){e.one("hidden.bs.modal",t)},showDialog:function(e){e.modal("show")},hideDialog:function(e){e.modal("hide")},createLayout:function(e,t){var n=(t.airMode?ui.airEditor([ui.editingArea([ui.airEditable()])]):ui.editor([ui.toolbar(),ui.editingArea([ui.codable(),ui.editable()]),ui.statusbar()])).render();return n.insertAfter(e),{note:e,editor:n,toolbar:n.find(".note-toolbar"),editingArea:n.find(".note-editing-area"),editable:n.find(".note-editable"),codable:n.find(".note-codable"),statusbar:n.find(".note-statusbar")}},removeLayout:function(e,t){e.html(t.editable.html()),t.editor.remove(),e.show()}};$.summernote=$.summernote||{lang:{}},$.extend($.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",p:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});var key=(keyMap={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221},{isEdit:function(e){return list.contains([keyMap.BACKSPACE,keyMap.TAB,keyMap.ENTER,keyMap.SPACE],e)},isMove:function(e){return list.contains([keyMap.LEFT,keyMap.UP,keyMap.RIGHT,keyMap.DOWN],e)},nameFromCode:func.invertObject(keyMap),code:keyMap}),keyMap,range=(textRangeToPoint=function(e,t){var n,i,o=e.parentElement(),r=document.body.createTextRange(),a=list.from(o.childNodes);for(n=0;n<a.length;n++)if(!dom.isText(a[n])){if(r.moveToElementText(a[n]),r.compareEndPoints("StartToStart",e)>=0)break;i=a[n]}if(0!==n&&dom.isText(a[n-1])){var A=document.body.createTextRange(),s=null;A.moveToElementText(i||o),A.collapse(!i),s=i?i.nextSibling:o.firstChild;var l=e.duplicate();l.setEndPoint("StartToStart",A);for(var c=l.text.replace(/[\r\n]/g,"").length;c>s.nodeValue.length&&s.nextSibling;)c-=s.nodeValue.length,s=s.nextSibling;s.nodeValue,t&&s.nextSibling&&dom.isText(s.nextSibling)&&c===s.nodeValue.length&&(c-=s.nodeValue.length,s=s.nextSibling),o=s,n=c}return{cont:o,offset:n}},pointToTextRange=function(e){var t=function(e,n){var i,o;if(dom.isText(e)){var r=dom.listPrev(e,func.not(dom.isText)),a=list.last(r).previousSibling;i=a||e.parentNode,n+=list.sum(list.tail(r),dom.nodeLength),o=!a}else{if(i=e.childNodes[n]||e,dom.isText(i))return t(i,0);n=0,o=!1}return{node:i,collapseToStart:o,offset:n}},n=document.body.createTextRange(),i=t(e.node,e.offset);return n.moveToElementText(i.node),n.collapse(i.collapseToStart),n.moveStart("character",i.offset),n},WrappedRange=function(e,t,n,i){this.sc=e,this.so=t,this.ec=n,this.eo=i;var o=function(){if(agent.isW3CRangeSupport){var o=document.createRange();return o.setStart(e,t),o.setEnd(n,i),o}var r=pointToTextRange({node:e,offset:t});return r.setEndPoint("EndToEnd",pointToTextRange({node:n,offset:i})),r};this.getPoints=function(){return{sc:e,so:t,ec:n,eo:i}},this.getStartPoint=function(){return{node:e,offset:t}},this.getEndPoint=function(){return{node:n,offset:i}},this.select=function(){var e=o();if(agent.isW3CRangeSupport){var t=document.getSelection();t.rangeCount>0&&t.removeAllRanges(),t.addRange(e)}else e.select();return this},this.scrollIntoView=function(e){var t=$(e).height();return e.scrollTop+t<this.sc.offsetTop&&(e.scrollTop+=Math.abs(e.scrollTop+t-this.sc.offsetTop)),this},this.normalize=function(){var e=function(e,t){if(dom.isVisiblePoint(e)&&!dom.isEdgePoint(e)||dom.isVisiblePoint(e)&&dom.isRightEdgePoint(e)&&!t||dom.isVisiblePoint(e)&&dom.isLeftEdgePoint(e)&&t||dom.isVisiblePoint(e)&&dom.isBlock(e.node)&&dom.isEmpty(e.node))return e;var n=dom.ancestor(e.node,dom.isBlock);if((dom.isLeftEdgePointOf(e,n)||dom.isVoid(dom.prevPoint(e).node))&&!t||(dom.isRightEdgePointOf(e,n)||dom.isVoid(dom.nextPoint(e).node))&&t){if(dom.isVisiblePoint(e))return e;t=!t}return(t?dom.nextPointUntil(dom.nextPoint(e),dom.isVisiblePoint):dom.prevPointUntil(dom.prevPoint(e),dom.isVisiblePoint))||e},t=e(this.getEndPoint(),!1),n=this.isCollapsed()?t:e(this.getStartPoint(),!0);return new WrappedRange(n.node,n.offset,t.node,t.offset)},this.nodes=function(e,t){e=e||func.ok;var n=t&&t.includeAncestor,i=t&&t.fullyContains,o=this.getStartPoint(),r=this.getEndPoint(),a=[],A=[];return dom.walkPoint(o,r,(function(t){var o;dom.isEditable(t.node)||(i?(dom.isLeftEdgePoint(t)&&A.push(t.node),dom.isRightEdgePoint(t)&&list.contains(A,t.node)&&(o=t.node)):o=n?dom.ancestor(t.node,e):t.node,o&&e(o)&&a.push(o))}),!0),list.unique(a)},this.commonAncestor=function(){return dom.commonAncestor(e,n)},this.expand=function(o){var r=dom.ancestor(e,o),a=dom.ancestor(n,o);if(!r&&!a)return new WrappedRange(e,t,n,i);var A=this.getPoints();return r&&(A.sc=r,A.so=0),a&&(A.ec=a,A.eo=dom.nodeLength(a)),new WrappedRange(A.sc,A.so,A.ec,A.eo)},this.collapse=function(o){return o?new WrappedRange(e,t,e,t):new WrappedRange(n,i,n,i)},this.splitText=function(){var o=e===n,r=this.getPoints();return dom.isText(n)&&!dom.isEdgePoint(this.getEndPoint())&&n.splitText(i),dom.isText(e)&&!dom.isEdgePoint(this.getStartPoint())&&(r.sc=e.splitText(t),r.so=0,o&&(r.ec=r.sc,r.eo=i-t)),new WrappedRange(r.sc,r.so,r.ec,r.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var e=this.splitText(),t=e.nodes(null,{fullyContains:!0}),n=dom.prevPointUntil(e.getStartPoint(),(function(e){return!list.contains(t,e.node)})),i=[];return $.each(t,(function(e,t){var o=t.parentNode;n.node!==o&&1===dom.nodeLength(o)&&i.push(o),dom.remove(t,!1)})),$.each(i,(function(e,t){dom.remove(t,!1)})),new WrappedRange(n.node,n.offset,n.node,n.offset).normalize()};var r=function(t){return function(){var i=dom.ancestor(e,t);return!!i&&i===dom.ancestor(n,t)}};this.isOnEditable=r(dom.isEditable),this.isOnList=r(dom.isList),this.isOnAnchor=r(dom.isAnchor),this.isOnCell=r(dom.isCell),this.isOnData=r(dom.isData),this.isLeftEdgeOf=function(e){if(!dom.isLeftEdgePoint(this.getStartPoint()))return!1;var t=dom.ancestor(this.sc,e);return t&&dom.isLeftEdgeOf(this.sc,t)},this.isCollapsed=function(){return e===n&&t===i},this.wrapBodyInlineWithPara=function(){if(dom.isBodyContainer(e)&&dom.isEmpty(e))return e.innerHTML=dom.emptyPara,new WrappedRange(e.firstChild,0,e.firstChild,0);var t,n=this.normalize();if(dom.isParaInline(e)||dom.isPara(e))return n;if(dom.isInline(n.sc)){var i=dom.listAncestor(n.sc,func.not(dom.isInline));t=list.last(i),dom.isInline(t)||(t=i[i.length-2]||n.sc.childNodes[n.so])}else t=n.sc.childNodes[n.so>0?n.so-1:0];var o=dom.listPrev(t,dom.isParaInline).reverse();if((o=o.concat(dom.listNext(t.nextSibling,dom.isParaInline))).length){var r=dom.wrap(list.head(o),"p");dom.appendChildNodes(r,list.tail(o))}return this.normalize()},this.insertNode=function(e){var t=this.wrapBodyInlineWithPara().deleteContents(),n=dom.splitPoint(t.getStartPoint(),dom.isInline(e));return n.rightNode?n.rightNode.parentNode.insertBefore(e,n.rightNode):n.container.appendChild(e),e},this.pasteHTML=function(e){var t=$("<div></div>").html(e)[0],n=list.from(t.childNodes),i=this.wrapBodyInlineWithPara().deleteContents();return n.reverse().map((function(e){return i.insertNode(e)})).reverse()},this.toString=function(){var e=o();return agent.isW3CRangeSupport?e.toString():e.text},this.getWordRange=function(e){var t=this.getEndPoint();if(!dom.isCharPoint(t))return this;var n=dom.prevPointUntil(t,(function(e){return!dom.isCharPoint(e)}));return e&&(t=dom.nextPointUntil(t,(function(e){return!dom.isCharPoint(e)}))),new WrappedRange(n.node,n.offset,t.node,t.offset)},this.bookmark=function(o){return{s:{path:dom.makeOffsetPath(o,e),offset:t},e:{path:dom.makeOffsetPath(o,n),offset:i}}},this.paraBookmark=function(o){return{s:{path:list.tail(dom.makeOffsetPath(list.head(o),e)),offset:t},e:{path:list.tail(dom.makeOffsetPath(list.last(o),n)),offset:i}}},this.getClientRects=function(){return o().getClientRects()}},{create:function(e,t,n,i){if(4===arguments.length)return new WrappedRange(e,t,n,i);if(2===arguments.length)return new WrappedRange(e,t,n=e,i=t);var o=this.createFromSelection();return o||1!==arguments.length?o:(o=this.createFromNode(arguments[0])).collapse(dom.emptyPara===arguments[0].innerHTML)},createFromSelection:function(){var e,t,n,i;if(agent.isW3CRangeSupport){var o=document.getSelection();if(!o||0===o.rangeCount)return null;try{if(dom.isBody(o.anchorNode))return null}catch(e){return null}var r=o.getRangeAt(0);e=r.startContainer,t=r.startOffset,n=r.endContainer,i=r.endOffset}else{var a=document.selection.createRange(),A=a.duplicate();A.collapse(!1);var s=a;s.collapse(!0);var l=textRangeToPoint(s,!0),c=textRangeToPoint(A,!1);dom.isText(l.node)&&dom.isLeftEdgePoint(l)&&dom.isTextNode(c.node)&&dom.isRightEdgePoint(c)&&c.node.nextSibling===l.node&&(l=c),e=l.cont,t=l.offset,n=c.cont,i=c.offset}return new WrappedRange(e,t,n,i)},createFromNode:function(e){var t=e,n=0,i=e,o=dom.nodeLength(i);return dom.isVoid(t)&&(n=dom.listPrev(t).length-1,t=t.parentNode),dom.isBR(i)?(o=dom.listPrev(i).length-1,i=i.parentNode):dom.isVoid(i)&&(o=dom.listPrev(i).length,i=i.parentNode),this.create(t,n,i,o)},createFromNodeBefore:function(e){return this.createFromNode(e).collapse(!0)},createFromNodeAfter:function(e){return this.createFromNode(e).collapse()},createFromBookmark:function(e,t){var n=dom.fromOffsetPath(e,t.s.path),i=t.s.offset,o=dom.fromOffsetPath(e,t.e.path),r=t.e.offset;return new WrappedRange(n,i,o,r)},createFromParaBookmark:function(e,t){var n=e.s.offset,i=e.e.offset,o=dom.fromOffsetPath(list.head(t),e.s.path),r=dom.fromOffsetPath(list.last(t),e.e.path);return new WrappedRange(o,n,r,i)}}),textRangeToPoint,pointToTextRange,WrappedRange,async={readFileAsDataURL:function(e){return $.Deferred((function(t){$.extend(new FileReader,{onload:function(e){var n=e.target.result;t.resolve(n)},onerror:function(){t.reject(this)}}).readAsDataURL(e)})).promise()},createImage:function(e){return $.Deferred((function(t){var n=$("<img>");n.one("load",(function(){n.off("error abort"),t.resolve(n)})).one("error abort",(function(){n.off("load").detach(),t.reject(n)})).css({display:"none"}).appendTo(document.body).attr("src",e)})).promise()}},History=function(e){var t=[],n=-1,i=e[0],o=function(t){null!==t.contents&&e.html(t.contents),null!==t.bookmark&&range.createFromBookmark(i,t.bookmark).select()};this.rewind=function(){e.html()!==t[n].contents&&this.recordUndo(),o(t[n=0])},this.reset=function(){t=[],n=-1,e.html(""),this.recordUndo()},this.undo=function(){e.html()!==t[n].contents&&this.recordUndo(),0<n&&(n--,o(t[n]))},this.redo=function(){t.length-1>n&&(n++,o(t[n]))},this.recordUndo=function(){var o;n++,t.length>n&&(t=t.slice(0,n)),t.push((o=range.create(i),{contents:e.html(),bookmark:o?o.bookmark(i):{s:{path:[],offset:0},e:{path:[],offset:0}}}))}},Style=function(){this.fromNode=function(e){var t=function(e,t){if(agent.jqueryVersion<1.9){var n={};return $.each(t,(function(t,i){n[i]=e.css(i)})),n}return e.css.call(e,t)}(e,["font-family","font-size","text-align","list-style-type","line-height","color"])||{};return t["font-size"]=parseInt(t["font-size"],10),t},this.stylePara=function(e,t){$.each(e.nodes(dom.isPara,{includeAncestor:!0}),(function(e,n){$(n).css(t)}))},this.styleNodes=function(e,t){e=e.splitText();var n=t&&t.nodeName||"SPAN",i=!(!t||!t.expandClosestSibling),o=!(!t||!t.onlyPartialContains);if(e.isCollapsed())return[e.insertNode(dom.create(n))];var r=dom.makePredByNodeName(n),a=e.nodes(dom.isText,{fullyContains:!0}).map((function(e){return dom.singleChildAncestor(e,r)||dom.wrap(e,n)}));if(i){if(o){var A=e.nodes();r=func.and(r,(function(e){return list.contains(A,e)}))}return a.map((function(e){var t=dom.withClosestSiblings(e,r),n=list.head(t),i=list.tail(t);return $.each(i,(function(e,t){dom.appendChildNodes(n,t.childNodes),dom.remove(t)})),list.head(t)}))}return a},this.current=function(e){var t=$(dom.isElement(e.sc)?e.sc:e.sc.parentNode),n=this.fromNode(t);try{n=$.extend(n,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal"})}catch(e){}if(e.isOnList()){var i=$.inArray(n["list-style-type"],["circle","disc","disc-leading-zero","square"])>-1;n["list-style"]=i?"unordered":"ordered"}else n["list-style"]="none";var o=dom.ancestor(e.sc,dom.isPara);if(o&&o.style["line-height"])n["line-height"]=o.style.lineHeight;else{var r=parseInt(n["line-height"],10)/parseInt(n["font-size"],10);n["line-height"]=r.toFixed(1)}return n.anchor=e.isOnAnchor()&&dom.ancestor(e.sc,dom.isAnchor),n.ancestors=dom.listAncestor(e.sc,dom.isEditable),n.range=e,n}},Bullet=function(){var e=this;this.insertOrderedList=function(e){this.toggleList("OL",e)},this.insertUnorderedList=function(e){this.toggleList("UL",e)},this.indent=function(e){var t=this,n=range.create(e).wrapBodyInlineWithPara(),i=n.nodes(dom.isPara,{includeAncestor:!0}),o=list.clusterBy(i,func.peq2("parentNode"));$.each(o,(function(e,n){var i=list.head(n);dom.isLi(i)?t.wrapList(n,i.parentNode.nodeName):$.each(n,(function(e,t){$(t).css("marginLeft",(function(e,t){return(parseInt(t,10)||0)+25}))}))})),n.select()},this.outdent=function(e){var t=this,n=range.create(e).wrapBodyInlineWithPara(),i=n.nodes(dom.isPara,{includeAncestor:!0}),o=list.clusterBy(i,func.peq2("parentNode"));$.each(o,(function(e,n){var i=list.head(n);dom.isLi(i)?t.releaseList([n]):$.each(n,(function(e,t){$(t).css("marginLeft",(function(e,t){return(t=parseInt(t,10)||0)>25?t-25:""}))}))})),n.select()},this.toggleList=function(t,n){var i=range.create(n).wrapBodyInlineWithPara(),o=i.nodes(dom.isPara,{includeAncestor:!0}),r=i.paraBookmark(o),a=list.clusterBy(o,func.peq2("parentNode"));if(list.find(o,dom.isPurePara)){var A=[];$.each(a,(function(n,i){A=A.concat(e.wrapList(i,t))})),o=A}else{var s=i.nodes(dom.isList,{includeAncestor:!0}).filter((function(e){return!$.nodeName(e,t)}));s.length?$.each(s,(function(e,n){dom.replace(n,t)})):o=this.releaseList(a,!0)}range.createFromParaBookmark(r,o).select()},this.wrapList=function(e,t){var n=list.head(e),i=list.last(e),o=dom.isList(n.previousSibling)&&n.previousSibling,r=dom.isList(i.nextSibling)&&i.nextSibling,a=o||dom.insertAfter(dom.create(t||"UL"),i);return e=e.map((function(e){return dom.isPurePara(e)?dom.replace(e,"LI"):e})),dom.appendChildNodes(a,e),r&&(dom.appendChildNodes(a,list.from(r.childNodes)),dom.remove(r)),e},this.releaseList=function(e,t){var n=[];return $.each(e,(function(e,i){var o=list.head(i),r=list.last(i),a=t?dom.lastAncestor(o,dom.isList):o.parentNode,A=a.childNodes.length>1?dom.splitTree(a,{node:r.parentNode,offset:dom.position(r)+1},{isSkipPaddingBlankHTML:!0}):null,s=dom.splitTree(a,{node:o.parentNode,offset:dom.position(o)},{isSkipPaddingBlankHTML:!0});i=t?dom.listDescendant(s,dom.isLi):list.from(s.childNodes).filter(dom.isLi),!t&&dom.isList(a.parentNode)||(i=i.map((function(e){return dom.replace(e,"P")}))),$.each(list.from(i).reverse(),(function(e,t){dom.insertAfter(t,a)}));var l=list.compact([a,s,A]);$.each(l,(function(e,t){var n=[t].concat(dom.listDescendant(t,dom.isList));$.each(n.reverse(),(function(e,t){dom.nodeLength(t)||dom.remove(t,!0)}))})),n=n.concat(i)})),n}},Typing=function(){var e=new Bullet;this.insertTab=function(e,t){var n=dom.createText(new Array(t+1).join(dom.NBSP_CHAR));(e=e.deleteContents()).insertNode(n,!0),(e=range.create(n,t)).select()},this.insertParagraph=function(t){var n=range.create(t);n=(n=n.deleteContents()).wrapBodyInlineWithPara();var i,o=dom.ancestor(n.sc,dom.isPara);if(o){if(dom.isEmpty(o)&&dom.isLi(o))return void e.toggleList(o.parentNode.nodeName);if(dom.isEmpty(o)&&dom.isPara(o)&&dom.isBlockquote(o.parentNode))dom.insertAfter(o,o.parentNode),i=o;else{i=dom.splitTree(o,n.getStartPoint());var r=dom.listDescendant(o,dom.isEmptyAnchor);r=r.concat(dom.listDescendant(i,dom.isEmptyAnchor)),$.each(r,(function(e,t){dom.remove(t)})),(dom.isHeading(i)||dom.isPre(i))&&dom.isEmpty(i)&&(i=dom.replace(i,"p"))}}else{var a=n.sc.childNodes[n.so];i=$(dom.emptyPara)[0],a?n.sc.insertBefore(i,a):n.sc.appendChild(i)}range.create(i,0).normalize().select().scrollIntoView(t)}},Table=function(){this.tab=function(e,t){var n=dom.ancestor(e.commonAncestor(),dom.isCell),i=dom.ancestor(n,dom.isTable),o=dom.listDescendant(i,dom.isCell),r=list[t?"prev":"next"](o,n);r&&range.create(r,0).select()},this.createTable=function(e,t,n){for(var i,o=[],r=0;r<e;r++)o.push("<td>"+dom.blank+"</td>");i=o.join("");for(var a,A=[],s=0;s<t;s++)A.push("<tr>"+i+"</tr>");a=A.join("");var l=$("<table>"+a+"</table>");return n&&n.tableClassName&&l.addClass(n.tableClassName),l[0]}},KEY_BOGUS="bogus",Editor=function(e){var t=this,n=e.layoutInfo.note,i=e.layoutInfo.editor,o=e.layoutInfo.editable,r=e.options,a=r.langInfo,A=o[0],s=null,l=new Style,c=new Table,d=new Typing,u=new Bullet,h=new History(o);this.initialize=function(){o.on("keydown",(function(n){n.keyCode===key.code.ENTER&&e.triggerEvent("enter",n),e.triggerEvent("keydown",n),n.isDefaultPrevented()||(r.shortcuts?t.handleKeyMap(n):t.preventDefaultEditableShortCuts(n))})).on("keyup",(function(t){e.triggerEvent("keyup",t)})).on("focus",(function(t){e.triggerEvent("focus",t)})).on("blur",(function(t){e.triggerEvent("blur",t)})).on("mousedown",(function(t){e.triggerEvent("mousedown",t)})).on("mouseup",(function(t){e.triggerEvent("mouseup",t)})).on("scroll",(function(t){e.triggerEvent("scroll",t)})).on("paste",(function(t){e.triggerEvent("paste",t)})),o.html(dom.html(n)||dom.emptyPara);var a=agent.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";o.on(a,func.debounce((function(){e.triggerEvent("change",o.html())}),250)),i.on("focusin",(function(t){e.triggerEvent("focusin",t)})).on("focusout",(function(t){e.triggerEvent("focusout",t)})),r.airMode||(r.width&&i.outerWidth(r.width),r.height&&o.outerHeight(r.height),r.maxHeight&&o.css("max-height",r.maxHeight),r.minHeight&&o.css("min-height",r.minHeight)),h.recordUndo()},this.destroy=function(){o.off()},this.handleKeyMap=function(t){var n=r.keyMap[agent.isMac?"mac":"pc"],i=[];t.metaKey&&i.push("CMD"),t.ctrlKey&&!t.altKey&&i.push("CTRL"),t.shiftKey&&i.push("SHIFT");var o=key.nameFromCode[t.keyCode];o&&i.push(o);var a=n[i.join("+")];a?(t.preventDefault(),e.invoke(a)):key.isEdit(t.keyCode)&&this.afterCommand()},this.preventDefaultEditableShortCuts=function(e){(e.ctrlKey||e.metaKey)&&list.contains([66,73,85],e.keyCode)&&e.preventDefault()},this.createRange=function(){return this.focus(),range.create(A)},this.saveRange=function(e){s=this.createRange(),e&&s.collapse().select()},this.restoreRange=function(){s&&(s.select(),this.focus())},this.saveTarget=function(e){o.data("target",e)},this.clearTarget=function(){o.removeData("target")},this.restoreTarget=function(){return o.data("target")},this.currentStyle=function(){var e=range.create();return e&&(e=e.normalize()),e?l.current(e):l.fromNode(o)},this.styleFromNode=function(e){return l.fromNode(e)},this.undo=function(){e.triggerEvent("before.command",o.html()),h.undo(),e.triggerEvent("change",o.html())},e.memo("help.undo",a.help.undo),this.redo=function(){e.triggerEvent("before.command",o.html()),h.redo(),e.triggerEvent("change",o.html())},e.memo("help.redo",a.help.redo);for(var g=this.beforeCommand=function(){e.triggerEvent("before.command",o.html()),t.focus()},f=this.afterCommand=function(t){h.recordUndo(),t||e.triggerEvent("change",o.html())},p=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"],m=0,C=p.length;m<C;m++)this[p[m]]=function(e){return function(t){g(),document.execCommand(e,!1,t),f(!0)}}(p[m]),e.memo("help."+p[m],a.help[p[m]]);this.tab=function(){var e=this.createRange();e.isCollapsed()&&e.isOnCell()?c.tab(e):(g(),d.insertTab(e,r.tabSize),f())},e.memo("help.tab",a.help.tab),this.untab=function(){var e=this.createRange();e.isCollapsed()&&e.isOnCell()&&c.tab(e,!0)},e.memo("help.untab",a.help.untab),this.updateClassToSelection=function(e,t){var n;if(""!==(n=t||this.createRange()).toString()||e.add){var i=l.styleNodes(n);if(n&&e.remove&&$(i).each((function(){$(this).removeClass(e.remove)})),n&&e.add&&$(i).each((function(){$(this).addClass(e.add)})),n&&n.isCollapsed()){var r=list.head(i);r&&!dom.nodeLength(r)&&(r.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR,range.createFromNodeAfter(r.firstChild).select(),o.data(KEY_BOGUS,r))}}},this.wrapCommand=function(e){return function(){g(),e.apply(t,arguments),f()}},this.insertParagraph=this.wrapCommand((function(){d.insertParagraph(A)})),e.memo("help.insertParagraph",a.help.insertParagraph),this.insertOrderedList=this.wrapCommand((function(){u.insertOrderedList(A)})),e.memo("help.insertOrderedList",a.help.insertOrderedList),this.insertUnorderedList=this.wrapCommand((function(){u.insertUnorderedList(A)})),e.memo("help.insertUnorderedList",a.help.insertUnorderedList),this.indent=this.wrapCommand((function(){u.indent(A)})),e.memo("help.indent",a.help.indent),this.outdent=this.wrapCommand((function(){u.outdent(A)})),e.memo("help.outdent",a.help.outdent),this.insertImage=function(t,n){return async.createImage(t,n).then((function(e){g(),"function"==typeof n?n(e):("string"==typeof n&&e.attr("data-filename",n),e.css("width",Math.min(o.width(),e.width()))),e.show(),range.create(A).insertNode(e[0]),range.createFromNodeAfter(e[0]).select(),f()})).fail((function(t){e.triggerEvent("image.upload.error",t)}))},this.insertImages=function(n){$.each(n,(function(n,i){var o=i.name;r.maximumImageFileSize&&r.maximumImageFileSize<i.size?e.triggerEvent("image.upload.error",a.image.maximumFileSizeError):async.readFileAsDataURL(i).then((function(e){return t.insertImage(e,o)})).fail((function(){e.triggerEvent("image.upload.error")}))}))},this.insertImagesOrCallback=function(t){r.callbacks.onImageUpload?e.triggerEvent("image.upload",t):this.insertImages(t)},this.insertNode=this.wrapCommand((function(e){this.createRange().insertNode(e),range.createFromNodeAfter(e).select()})),this.insertText=this.wrapCommand((function(e){var t=this.createRange().insertNode(dom.createText(e));range.create(t,dom.nodeLength(t)).select()})),this.getSelectedText=function(){var e=this.createRange();return e.isOnAnchor()&&(e=range.createFromNode(dom.ancestor(e.sc,dom.isAnchor))),e.toString()},this.pasteHTML=this.wrapCommand((function(e){var t=this.createRange().pasteHTML(e);range.createFromNodeAfter(list.last(t)).select()})),this.formatBlock=this.wrapCommand((function(e){e=agent.isMSIE?"<"+e+">":e,document.execCommand("FormatBlock",!1,e)})),this.formatPara=function(){this.formatBlock("P")},e.memo("help.formatPara",a.help.formatPara);for(m=1;m<=6;m++)this["formatH"+m]=function(e){return function(){this.formatBlock("H"+e)}}(m),e.memo("help.formatH"+m,a.help["formatH"+m]);this.fontSize=function(e){var t=this.createRange(),n=l.styleNodes(t);if(t&&t.isCollapsed()){var i=list.head(n);$(n).css({"font-size":e+"px"}),i&&!dom.nodeLength(i)&&(i.innerHTML=dom.ZERO_WIDTH_NBSP_CHAR,range.createFromNodeAfter(i.firstChild).select(),o.data(KEY_BOGUS,i))}else g(),$(n).css({"font-size":e+"px"}),f()},this.insertHorizontalRule=this.wrapCommand((function(){var e=this.createRange().insertNode(dom.create("HR"));e.nextSibling&&range.create(e.nextSibling,0).normalize().select()})),e.memo("help.insertHorizontalRule",a.help.insertHorizontalRule),this.removeBogus=function(){var e=o.data(KEY_BOGUS);if(e){var t=list.find(list.from(e.childNodes),dom.isText),n=t.nodeValue.indexOf(dom.ZERO_WIDTH_NBSP_CHAR);-1!==n&&t.deleteData(n,1),dom.isEmpty(e)&&dom.remove(e),o.removeData(KEY_BOGUS)}},this.lineHeight=this.wrapCommand((function(e){l.stylePara(this.createRange(),{lineHeight:e})})),this.unlink=function(){var e=this.createRange();if(e.isOnAnchor()){var t=dom.ancestor(e.sc,dom.isAnchor);(e=range.createFromNode(t)).select(),g(),document.execCommand("unlink"),f()}},this.createLink=this.wrapCommand((function(e){var t=e.url,n=e.text,i=e.isNewWindow,o=e.range||this.createRange(),a=o.toString()!==n;"string"==typeof t&&(t=t.trim()),t=r.onCreateLink?r.onCreateLink(t):/^[A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?/.test(t)?t:"http://"+t;var A=[];if(a){var s=(o=o.deleteContents()).insertNode($("<A>"+n+"</A>")[0]);A.push(s)}else A=l.styleNodes(o,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});$.each(A,(function(e,n){$(n).attr("href",t),i?$(n).attr("target","_blank"):$(n).removeAttr("target")}));var c=range.createFromNodeBefore(list.head(A)).getStartPoint(),d=range.createFromNodeAfter(list.last(A)).getEndPoint();range.create(c.node,c.offset,d.node,d.offset).select()})),this.getLinkInfo=function(){var e=this.createRange().expand(dom.isAnchor),t=$(list.head(e.nodes(dom.isAnchor)));return{range:e,text:e.toString(),isNewWindow:!!t.length&&"_blank"===t.attr("target"),url:t.length?t.attr("href"):""}},this.color=this.wrapCommand((function(e){var t=e.foreColor,n=e.backColor;t&&document.execCommand("foreColor",!1,t),n&&document.execCommand("backColor",!1,n)})),this.insertTable=this.wrapCommand((function(e){var t=e.split("x");this.createRange().deleteContents().insertNode(c.createTable(t[0],t[1],r))})),this.floatMe=this.wrapCommand((function(e){$(this.restoreTarget()).css("float",e)})),this.resize=this.wrapCommand((function(e){$(this.restoreTarget()).css({width:100*e+"%",height:""})})),this.resizeTo=function(e,t,n){var i;if(n){var o=e.y/e.x,r=t.data("ratio");i={width:r>o?e.x:e.y/r,height:r>o?e.x*r:e.y}}else i={width:e.x,height:e.y};t.css(i)},this.removeMedia=this.wrapCommand((function(){var t=$(this.restoreTarget()).detach();e.triggerEvent("media.delete",t,o)})),this.hasFocus=function(){return o.is(":focus")},this.focus=function(){this.hasFocus()||o.focus()},this.isEmpty=function(){return dom.isEmpty(o[0])||dom.emptyPara===o.html()},this.empty=function(){e.invoke("code",dom.emptyPara)}},Clipboard=function(e){var t=this,n=e.layoutInfo.editable;this.events={"summernote.keydown":function(n,i){t.needKeydownHook()&&(i.ctrlKey||i.metaKey)&&i.keyCode===key.code.V&&(e.invoke("editor.saveRange"),t.$paste.focus(),setTimeout((function(){t.pasteByHook()}),0))}},this.needKeydownHook=function(){return agent.isMSIE&&agent.browserVersion>10||agent.isFF},this.initialize=function(){this.needKeydownHook()?(this.$paste=$('<div tabindex="-1" />').attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),n.before(this.$paste),this.$paste.on("paste",(function(t){e.triggerEvent("paste",t)}))):n.on("paste",this.pasteByEvent)},this.destroy=function(){this.needKeydownHook()&&(this.$paste.remove(),this.$paste=null)},this.pasteByHook=function(){var t=this.$paste[0].firstChild;if(dom.isImg(t)){for(var n=t.src,i=atob(n.split(",")[1]),o=new Uint8Array(i.length),r=0;r<i.length;r++)o[r]=i.charCodeAt(r);var a=new Blob([o],{type:"image/png"});a.name="clipboard.png",e.invoke("editor.restoreRange"),e.invoke("editor.focus"),e.invoke("editor.insertImagesOrCallback",[a])}else{var A=$("<div />").html(this.$paste.html()).html();e.invoke("editor.restoreRange"),e.invoke("editor.focus"),A&&e.invoke("editor.pasteHTML",A)}this.$paste.empty()},this.pasteByEvent=function(t){var n=t.originalEvent.clipboardData;if(n&&n.items&&n.items.length){var i=list.head(n.items);"file"===i.kind&&-1!==i.type.indexOf("image/")&&e.invoke("editor.insertImagesOrCallback",[i.getAsFile()]),e.invoke("editor.afterCommand")}}},Dropzone=function(e){var t=$(document),n=e.layoutInfo.editor,i=e.layoutInfo.editable,o=e.options,r=o.langInfo,a={},A=$(['<div class="note-dropzone">','  <div class="note-dropzone-message"/>',"</div>"].join("")).prependTo(n);this.initialize=function(){o.disableDragAndDrop?(a.onDrop=function(e){e.preventDefault()},t.on("drop",a.onDrop)):this.attachDragAndDropEvent()},this.attachDragAndDropEvent=function(){var o=$(),s=A.find(".note-dropzone-message");a.onDragenter=function(t){var i=e.invoke("codeview.isActivated"),a=n.width()>0&&n.height()>0;i||o.length||!a||(n.addClass("dragover"),A.width(n.width()),A.height(n.height()),s.text(r.image.dragImageHere)),o=o.add(t.target)},a.onDragleave=function(e){(o=o.not(e.target)).length||n.removeClass("dragover")},a.onDrop=function(){o=$(),n.removeClass("dragover")},t.on("dragenter",a.onDragenter).on("dragleave",a.onDragleave).on("drop",a.onDrop),A.on("dragenter",(function(){A.addClass("hover"),s.text(r.image.dropImage)})).on("dragleave",(function(){A.removeClass("hover"),s.text(r.image.dragImageHere)})),A.on("drop",(function(t){var n=t.originalEvent.dataTransfer;n&&n.files&&n.files.length?(t.preventDefault(),i.focus(),e.invoke("editor.insertImagesOrCallback",n.files)):$.each(n.types,(function(t,i){var o=n.getData(i);i.toLowerCase().indexOf("text")>-1?e.invoke("editor.pasteHTML",o):$(o).each((function(){e.invoke("editor.insertNode",this)}))}))})).on("dragover",!1)},this.destroy=function(){Object.keys(a).forEach((function(e){t.off(e.substr(2).toLowerCase(),a[e])})),a={}}},CodeMirror;agent.hasCodeMirror&&(agent.isSupportAmd?require(["codemirror"],(function(e){CodeMirror=e})):CodeMirror=window.CodeMirror);var Codeview=function(e){var t=e.layoutInfo.editor,n=e.layoutInfo.editable,i=e.layoutInfo.codable,o=e.options;this.sync=function(){this.isActivated()&&agent.hasCodeMirror&&i.data("cmEditor").save()},this.isActivated=function(){return t.hasClass("codeview")},this.toggle=function(){this.isActivated()?this.deactivate():this.activate(),e.triggerEvent("codeview.toggled")},this.activate=function(){if(i.val(dom.html(n,o.prettifyHtml)),i.height(n.height()),e.invoke("toolbar.updateCodeview",!0),t.addClass("codeview"),i.focus(),agent.hasCodeMirror){var r=CodeMirror.fromTextArea(i[0],o.codemirror);if(o.codemirror.tern){var a=new CodeMirror.TernServer(o.codemirror.tern);r.ternServer=a,r.on("cursorActivity",(function(e){a.updateArgHints(e)}))}r.setSize(null,n.outerHeight()),i.data("cmEditor",r)}},this.deactivate=function(){if(agent.hasCodeMirror){var r=i.data("cmEditor");i.val(r.getValue()),r.toTextArea()}var a=dom.value(i,o.prettifyHtml)||dom.emptyPara,A=n.html()!==a;n.html(a),n.height(o.height?i.height():"auto"),t.removeClass("codeview"),A&&e.triggerEvent("change",n.html(),n),n.focus(),e.invoke("toolbar.updateCodeview",!1)},this.destroy=function(){this.isActivated()&&this.deactivate()}},EDITABLE_PADDING=24,Statusbar=function(e){var t=$(document),n=e.layoutInfo.statusbar,i=e.layoutInfo.editable,o=e.options;this.initialize=function(){o.airMode||o.disableResizeEditor?this.destroy():n.on("mousedown",(function(e){e.preventDefault(),e.stopPropagation();var n=i.offset().top-t.scrollTop();t.on("mousemove",(function(e){var t=e.clientY-(n+EDITABLE_PADDING);t=o.minheight>0?Math.max(t,o.minheight):t,t=o.maxHeight>0?Math.min(t,o.maxHeight):t,i.height(t)})).one("mouseup",(function(){t.off("mousemove")}))}))},this.destroy=function(){n.off(),n.remove()}},Fullscreen=function(e){var t=e.layoutInfo.editor,n=e.layoutInfo.toolbar,i=e.layoutInfo.editable,o=e.layoutInfo.codable,r=$(window),a=$("html, body");this.toggle=function(){var A=function(e){i.css("height",e.h),o.css("height",e.h),o.data("cmeditor")&&o.data("cmeditor").setsize(null,e.h)};t.toggleClass("fullscreen"),this.isFullscreen()?(i.data("orgHeight",i.css("height")),r.on("resize",(function(){A({h:r.height()-n.outerHeight()})})).trigger("resize"),a.css("overflow","hidden")):(r.off("resize"),A({h:i.data("orgHeight")}),a.css("overflow","visible")),e.invoke("toolbar.updateFullscreen",this.isFullscreen())},this.isFullscreen=function(){return t.hasClass("fullscreen")}},Handle=function(e){var t=this,n=$(document),i=e.layoutInfo.editingArea,o=e.options;this.events={"summernote.mousedown":function(e,n){t.update(n.target)&&n.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){t.update()}},this.initialize=function(){this.$handle=$(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',o.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',o.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(i),this.$handle.on("mousedown",(function(i){if(dom.isControlSizing(i.target)){i.preventDefault(),i.stopPropagation();var o=t.$handle.find(".note-control-selection").data("target"),r=o.offset(),a=n.scrollTop();n.on("mousemove",(function(n){e.invoke("editor.resizeTo",{x:n.clientX-r.left,y:n.clientY-(r.top-a)},o,!n.shiftKey),t.update(o[0])})).one("mouseup",(function(t){t.preventDefault(),n.off("mousemove"),e.invoke("editor.afterCommand")})),o.data("ratio")||o.data("ratio",o.height()/o.width())}}))},this.destroy=function(){this.$handle.remove()},this.update=function(t){var n=dom.isImg(t),i=this.$handle.find(".note-control-selection");if(e.invoke("imagePopover.update",t),n){var o=$(t),r=o.position(),a={w:o.outerWidth(!0),h:o.outerHeight(!0)};i.css({display:"block",left:r.left,top:r.top,width:a.w,height:a.h}).data("target",o);var A=a.w+"x"+a.h;i.find(".note-control-selection-info").text(A),e.invoke("editor.saveTarget",t)}else this.hide();return n},this.hide=function(){e.invoke("editor.clearTarget"),this.$handle.children().hide()}},AutoLink=function(e){var t=this,n=/^([A-Za-z][A-Za-z0-9+-.]*\:[\/\/]?|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i;this.events={"summernote.keyup":function(e,n){n.isDefaultPrevented()||t.handleKeyup(n)},"summernote.keydown":function(e,n){t.handleKeydown(n)}},this.initialize=function(){this.lastWordRange=null},this.destroy=function(){this.lastWordRange=null},this.replace=function(){if(this.lastWordRange){var t=this.lastWordRange.toString(),i=t.match(n);if(i&&(i[1]||i[2])){var o=i[1]?t:"http://"+t,r=$("<a />").html(t).attr("href",o)[0];this.lastWordRange.insertNode(r),this.lastWordRange=null,e.invoke("editor.focus")}}},this.handleKeydown=function(t){if(list.contains([key.code.ENTER,key.code.SPACE],t.keyCode)){var n=e.invoke("editor.createRange").getWordRange();this.lastWordRange=n}},this.handleKeyup=function(e){list.contains([key.code.ENTER,key.code.SPACE],e.keyCode)&&this.replace()}},AutoSync=function(e){var t=e.layoutInfo.note;this.events={"summernote.change":function(){t.val(e.invoke("code"))}},this.shouldInitialize=function(){return dom.isTextarea(t[0])}},Placeholder=function(e){var t=this,n=e.layoutInfo.editingArea,i=e.options;this.events={"summernote.init summernote.change":function(){t.update()},"summernote.codeview.toggled":function(){t.update()}},this.shouldInitialize=function(){return!!i.placeholder},this.initialize=function(){this.$placeholder=$('<div class="note-placeholder">'),this.$placeholder.on("click",(function(){e.invoke("focus")})).text(i.placeholder).prependTo(n)},this.destroy=function(){this.$placeholder.remove()},this.update=function(){var t=!e.invoke("codeview.isActivated")&&e.invoke("editor.isEmpty");this.$placeholder.toggle(t)}},Buttons=function(e){var t=this,n=$.summernote.ui,i=e.layoutInfo.toolbar,o=e.options,r=o.langInfo,a=func.invertObject(o.keyMap[agent.isMac?"mac":"pc"]),A=this.representShortcut=function(e){var t=a[e];return o.shortcuts&&t?(agent.isMac&&(t=t.replace("CMD","⌘").replace("SHIFT","⇧"))," ("+(t=t.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]"))+")"):""};this.initialize=function(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons(),this.fontInstalledMap={}},this.destroy=function(){delete this.fontInstalledMap},this.isFontInstalled=function(e){return t.fontInstalledMap.hasOwnProperty(e)||(t.fontInstalledMap[e]=agent.isFontInstalled(e)||list.contains(o.fontNamesIgnoreCheck,e)),t.fontInstalledMap[e]},this.addToolbarButtons=function(){e.memo("button.style",(function(){return n.buttonGroup([n.button({className:"dropdown-toggle",contents:n.icon(o.icons.magic)+" "+n.icon(o.icons.caret,"span"),tooltip:r.style.style,data:{toggle:"dropdown"}}),n.dropdown({className:"dropdown-style",items:e.options.styleTags,template:function(e){"string"==typeof e&&(e={tag:e,title:r.style.hasOwnProperty(e)?r.style[e]:e});var t=e.tag,n=e.title;return"<"+t+(e.style?' style="'+e.style+'" ':"")+(e.className?' class="'+e.className+'"':"")+">"+n+"</"+t+">"},click:e.createInvokeHandler("editor.formatBlock")})]).render()})),e.memo("button.bold",(function(){return n.button({className:"note-btn-bold",contents:n.icon(o.icons.bold),tooltip:r.font.bold+A("bold"),click:e.createInvokeHandler("editor.bold")}).render()})),e.memo("button.italic",(function(){return n.button({className:"note-btn-italic",contents:n.icon(o.icons.italic),tooltip:r.font.italic+A("italic"),click:e.createInvokeHandler("editor.italic")}).render()})),e.memo("button.underline",(function(){return n.button({className:"note-btn-underline",contents:n.icon(o.icons.underline),tooltip:r.font.underline+A("underline"),click:e.createInvokeHandler("editor.underline")}).render()})),e.memo("button.clear",(function(){return n.button({contents:n.icon(o.icons.eraser),tooltip:r.font.clear+A("removeFormat"),click:e.createInvokeHandler("editor.removeFormat")}).render()})),e.memo("button.strikethrough",(function(){return n.button({className:"note-btn-strikethrough",contents:n.icon(o.icons.strikethrough),tooltip:r.font.strikethrough+A("strikethrough"),click:e.createInvokeHandler("editor.strikethrough")}).render()})),e.memo("button.superscript",(function(){return n.button({className:"note-btn-superscript",contents:n.icon(o.icons.superscript),tooltip:r.font.superscript,click:e.createInvokeHandler("editor.superscript")}).render()})),e.memo("button.subscript",(function(){return n.button({className:"note-btn-subscript",contents:n.icon(o.icons.subscript),tooltip:r.font.subscript,click:e.createInvokeHandler("editor.subscript")}).render()})),e.memo("button.fontname",(function(){return n.buttonGroup([n.button({className:"dropdown-toggle",contents:'<span class="note-current-fontname"/> '+n.icon(o.icons.caret,"span"),tooltip:r.font.name,data:{toggle:"dropdown"}}),n.dropdownCheck({className:"dropdown-fontname",checkClassName:o.icons.menuCheck,items:o.fontNames.filter(t.isFontInstalled),template:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},click:e.createInvokeHandler("editor.fontName")})]).render()})),e.memo("button.fontsize",(function(){return n.buttonGroup([n.button({className:"dropdown-toggle",contents:'<span class="note-current-fontsize"/>'+n.icon(o.icons.caret,"span"),tooltip:r.font.size,data:{toggle:"dropdown"}}),n.dropdownCheck({className:"dropdown-fontsize",checkClassName:o.icons.menuCheck,items:o.fontSizes,click:e.createInvokeHandler("editor.fontSize")})]).render()})),e.memo("button.color",(function(){return n.buttonGroup({className:"note-color",children:[n.button({className:"note-current-color-button",contents:n.icon(o.icons.font+" note-recent-color"),tooltip:r.color.recent,click:function(t){var n=$(t.currentTarget);e.invoke("editor.color",{backColor:n.attr("data-backColor"),foreColor:n.attr("data-foreColor")})},callback:function(e){e.find(".note-recent-color").css("background-color","#FFFF00"),e.attr("data-backColor","#FFFF00")}}),n.button({className:"dropdown-toggle",contents:n.icon(o.icons.caret,"span"),tooltip:r.color.more,data:{toggle:"dropdown"}}),n.dropdown({items:["<li>",'<div class="btn-group">','  <div class="note-palette-title">'+r.color.background+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="backColor" data-value="inherit">',r.color.transparent,"    </button>","  </div>",'  <div class="note-holder" data-event="backColor"/>',"</div>",'<div class="btn-group">','  <div class="note-palette-title">'+r.color.foreground+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="removeFormat" data-value="foreColor">',r.color.resetToDefault,"    </button>","  </div>",'  <div class="note-holder" data-event="foreColor"/>',"</div>","</li>"].join(""),callback:function(e){e.find(".note-holder").each((function(){var e=$(this);e.append(n.palette({colors:o.colors,eventName:e.data("event")}).render())}))},click:function(t){var n=$(t.target),i=n.data("event"),o=n.data("value");if(i&&o){var r="backColor"===i?"background-color":"color",a=n.closest(".note-color").find(".note-recent-color"),A=n.closest(".note-color").find(".note-current-color-button");a.css(r,o),A.attr("data-"+i,o),e.invoke("editor."+i,o)}}})]}).render()})),e.memo("button.ul",(function(){return n.button({contents:n.icon(o.icons.unorderedlist),tooltip:r.lists.unordered+A("insertUnorderedList"),click:e.createInvokeHandler("editor.insertUnorderedList")}).render()})),e.memo("button.ol",(function(){return n.button({contents:n.icon(o.icons.orderedlist),tooltip:r.lists.ordered+A("insertOrderedList"),click:e.createInvokeHandler("editor.insertOrderedList")}).render()}));var i=n.button({contents:n.icon(o.icons.alignLeft),tooltip:r.paragraph.left+A("justifyLeft"),click:e.createInvokeHandler("editor.justifyLeft")}),a=n.button({contents:n.icon(o.icons.alignCenter),tooltip:r.paragraph.center+A("justifyCenter"),click:e.createInvokeHandler("editor.justifyCenter")}),s=n.button({contents:n.icon(o.icons.alignRight),tooltip:r.paragraph.right+A("justifyRight"),click:e.createInvokeHandler("editor.justifyRight")}),l=n.button({contents:n.icon(o.icons.alignJustify),tooltip:r.paragraph.justify+A("justifyFull"),click:e.createInvokeHandler("editor.justifyFull")}),c=n.button({contents:n.icon(o.icons.outdent),tooltip:r.paragraph.outdent+A("outdent"),click:e.createInvokeHandler("editor.outdent")}),d=n.button({contents:n.icon(o.icons.indent),tooltip:r.paragraph.indent+A("indent"),click:e.createInvokeHandler("editor.indent")});e.memo("button.justifyLeft",func.invoke(i,"render")),e.memo("button.justifyCenter",func.invoke(a,"render")),e.memo("button.justifyRight",func.invoke(s,"render")),e.memo("button.justifyFull",func.invoke(l,"render")),e.memo("button.outdent",func.invoke(c,"render")),e.memo("button.indent",func.invoke(d,"render")),e.memo("button.paragraph",(function(){return n.buttonGroup([n.button({className:"dropdown-toggle",contents:n.icon(o.icons.alignLeft)+" "+n.icon(o.icons.caret,"span"),tooltip:r.paragraph.paragraph,data:{toggle:"dropdown"}}),n.dropdown([n.buttonGroup({className:"note-align",children:[i,a,s,l]}),n.buttonGroup({className:"note-list",children:[c,d]})])]).render()})),e.memo("button.height",(function(){return n.buttonGroup([n.button({className:"dropdown-toggle",contents:n.icon(o.icons.textHeight)+" "+n.icon(o.icons.caret,"span"),tooltip:r.font.height,data:{toggle:"dropdown"}}),n.dropdownCheck({items:o.lineHeights,checkClassName:o.icons.menuCheck,className:"dropdown-line-height",click:e.createInvokeHandler("editor.lineHeight")})]).render()})),e.memo("button.table",(function(){return n.buttonGroup([n.button({className:"dropdown-toggle",contents:n.icon(o.icons.table)+" "+n.icon(o.icons.caret,"span"),tooltip:r.table.table,data:{toggle:"dropdown"}}),n.dropdown({className:"note-table",items:['<div class="note-dimension-picker">','  <div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"/>','  <div class="note-dimension-picker-highlighted"/>','  <div class="note-dimension-picker-unhighlighted"/>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(n){n.find(".note-dimension-picker-mousecatcher").css({width:o.insertTableMaxSize.col+"em",height:o.insertTableMaxSize.row+"em"}).mousedown(e.createInvokeHandler("editor.insertTable")).on("mousemove",t.tableMoveHandler)}}).render()})),e.memo("button.link",(function(){return n.button({contents:n.icon(o.icons.link),tooltip:r.link.link+A("linkDialog.show"),click:e.createInvokeHandler("linkDialog.show")}).render()})),e.memo("button.picture",(function(){return n.button({contents:n.icon(o.icons.picture),tooltip:r.image.image,click:e.createInvokeHandler("imageDialog.show")}).render()})),e.memo("button.video",(function(){return n.button({contents:n.icon(o.icons.video),tooltip:r.video.video,click:e.createInvokeHandler("videoDialog.show")}).render()})),e.memo("button.hr",(function(){return n.button({contents:n.icon(o.icons.minus),tooltip:r.hr.insert+A("insertHorizontalRule"),click:e.createInvokeHandler("editor.insertHorizontalRule")}).render()})),e.memo("button.fullscreen",(function(){return n.button({className:"btn-fullscreen",contents:n.icon(o.icons.arrowsAlt),tooltip:r.options.fullscreen,click:e.createInvokeHandler("fullscreen.toggle")}).render()})),e.memo("button.codeview",(function(){return n.button({className:"btn-codeview",contents:n.icon(o.icons.code),tooltip:r.options.codeview,click:e.createInvokeHandler("codeview.toggle")}).render()})),e.memo("button.redo",(function(){return n.button({contents:n.icon(o.icons.redo),tooltip:r.history.redo+A("redo"),click:e.createInvokeHandler("editor.redo")}).render()})),e.memo("button.undo",(function(){return n.button({contents:n.icon(o.icons.undo),tooltip:r.history.undo+A("undo"),click:e.createInvokeHandler("editor.undo")}).render()})),e.memo("button.help",(function(){return n.button({contents:n.icon(o.icons.question),tooltip:r.options.help,click:e.createInvokeHandler("helpDialog.show")}).render()}))},this.addImagePopoverButtons=function(){e.memo("button.imageSize100",(function(){return n.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:r.image.resizeFull,click:e.createInvokeHandler("editor.resize","1")}).render()})),e.memo("button.imageSize50",(function(){return n.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:r.image.resizeHalf,click:e.createInvokeHandler("editor.resize","0.5")}).render()})),e.memo("button.imageSize25",(function(){return n.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:r.image.resizeQuarter,click:e.createInvokeHandler("editor.resize","0.25")}).render()})),e.memo("button.floatLeft",(function(){return n.button({contents:n.icon(o.icons.alignLeft),tooltip:r.image.floatLeft,click:e.createInvokeHandler("editor.floatMe","left")}).render()})),e.memo("button.floatRight",(function(){return n.button({contents:n.icon(o.icons.alignRight),tooltip:r.image.floatRight,click:e.createInvokeHandler("editor.floatMe","right")}).render()})),e.memo("button.floatNone",(function(){return n.button({contents:n.icon(o.icons.alignJustify),tooltip:r.image.floatNone,click:e.createInvokeHandler("editor.floatMe","none")}).render()})),e.memo("button.removeMedia",(function(){return n.button({contents:n.icon(o.icons.trash),tooltip:r.image.remove,click:e.createInvokeHandler("editor.removeMedia")}).render()}))},this.addLinkPopoverButtons=function(){e.memo("button.linkDialogShow",(function(){return n.button({contents:n.icon(o.icons.link),tooltip:r.link.edit,click:e.createInvokeHandler("linkDialog.show")}).render()})),e.memo("button.unlink",(function(){return n.button({contents:n.icon(o.icons.unlink),tooltip:r.link.unlink,click:e.createInvokeHandler("editor.unlink")}).render()}))},this.build=function(t,i){for(var o=0,r=i.length;o<r;o++){for(var a=i[o],A=a[0],s=a[1],l=n.buttonGroup({className:"note-"+A}).render(),c=0,d=s.length;c<d;c++){var u=e.memo("button."+s[c]);u&&l.append("function"==typeof u?u(e):u)}l.appendTo(t)}},this.updateCurrentStyle=function(){var n=e.invoke("editor.currentStyle");if(this.updateBtnStates({".note-btn-bold":function(){return"bold"===n["font-bold"]},".note-btn-italic":function(){return"italic"===n["font-italic"]},".note-btn-underline":function(){return"underline"===n["font-underline"]},".note-btn-subscript":function(){return"subscript"===n["font-subscript"]},".note-btn-superscript":function(){return"superscript"===n["font-superscript"]},".note-btn-strikethrough":function(){return"strikethrough"===n["font-strikethrough"]}}),n["font-family"]){var o=n["font-family"].split(",").map((function(e){return e.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")})),r=list.find(o,t.isFontInstalled);i.find(".dropdown-fontname li a").each((function(){var e=$(this).data("value")+""==r+"";this.className=e?"checked":""})),i.find(".note-current-fontname").text(r)}if(n["font-size"]){var a=n["font-size"];i.find(".dropdown-fontsize li a").each((function(){var e=$(this).data("value")+""==a+"";this.className=e?"checked":""})),i.find(".note-current-fontsize").text(a)}if(n["line-height"]){var A=n["line-height"];i.find(".dropdown-line-height li a").each((function(){var e=$(this).data("value")+""==A+"";this.className=e?"checked":""}))}},this.updateBtnStates=function(e){$.each(e,(function(e,t){n.toggleBtnActive(i.find(e),t())}))},this.tableMoveHandler=function(e){var t,n=$(e.target.parentNode),i=n.next(),r=n.find(".note-dimension-picker-mousecatcher"),a=n.find(".note-dimension-picker-highlighted"),A=n.find(".note-dimension-picker-unhighlighted");if(void 0===e.offsetX){var s=$(e.target).offset();t={x:e.pageX-s.left,y:e.pageY-s.top}}else t={x:e.offsetX,y:e.offsetY};var l=Math.ceil(t.x/18)||1,c=Math.ceil(t.y/18)||1;a.css({width:l+"em",height:c+"em"}),r.data("value",l+"x"+c),3<l&&l<o.insertTableMaxSize.col&&A.css({width:l+1+"em"}),3<c&&c<o.insertTableMaxSize.row&&A.css({height:c+1+"em"}),i.html(l+" x "+c)}},Toolbar=function(e){var t=$.summernote.ui,n=e.layoutInfo.note,i=e.layoutInfo.toolbar,o=e.options;this.shouldInitialize=function(){return!o.airMode},this.initialize=function(){o.toolbar=o.toolbar||[],o.toolbar.length?e.invoke("buttons.build",i,o.toolbar):i.hide(),o.toolbarContainer&&i.appendTo(o.toolbarContainer),n.on("summernote.keyup summernote.mouseup summernote.change",(function(){e.invoke("buttons.updateCurrentStyle")})),e.invoke("buttons.updateCurrentStyle")},this.destroy=function(){i.children().remove()},this.updateFullscreen=function(e){t.toggleBtnActive(i.find(".btn-fullscreen"),e)},this.updateCodeview=function(e){t.toggleBtnActive(i.find(".btn-codeview"),e),e?this.deactivate():this.activate()},this.activate=function(e){var n=i.find("button");e||(n=n.not(".btn-codeview")),t.toggleBtn(n,!0)},this.deactivate=function(e){var n=i.find("button");e||(n=n.not(".btn-codeview")),t.toggleBtn(n,!1)}},LinkDialog=function(e){var t=this,n=$.summernote.ui,i=e.layoutInfo.editor,o=e.options,r=o.langInfo;this.shouldInitialize=function(){return!o.airMode},this.initialize=function(){var e=o.dialogsInBody?$(document.body):i,t='<div class="form-group"><label>'+r.link.textToDisplay+'</label><input class="note-link-text form-control" type="text" /></div><div class="form-group"><label>'+r.link.url+'</label><input class="note-link-url form-control" type="text" value="http://" /></div>'+(o.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+r.link.openInNewWindow+"</label></div>"),a='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+r.link.insert+"</button>";this.$dialog=n.dialog({className:"link-dialog",title:r.link.insert,fade:o.dialogsFade,body:t,footer:a}).render().appendTo(e)},this.destroy=function(){n.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(e,t){e.on("keypress",(function(e){e.keyCode===key.code.ENTER&&t.trigger("click")}))},this.toggleLinkBtn=function(e,t,i){n.toggleBtn(e,t.val()&&i.val())},this.showLinkDialog=function(i){return $.Deferred((function(o){var r=t.$dialog.find(".note-link-text"),a=t.$dialog.find(".note-link-url"),A=t.$dialog.find(".note-link-btn"),s=t.$dialog.find("input[type=checkbox]");n.onDialogShown(t.$dialog,(function(){e.triggerEvent("dialog.shown"),i.url||(i.url=i.text),r.val(i.text);var n=function(){t.toggleLinkBtn(A,r,a),i.text=r.val()};r.on("input",n).on("paste",(function(){setTimeout(n,0)}));var l=function(){t.toggleLinkBtn(A,r,a),i.text||r.val(a.val())};a.on("input",l).on("paste",(function(){setTimeout(l,0)})).val(i.url).trigger("focus"),t.toggleLinkBtn(A,r,a),t.bindEnterKey(a,A),t.bindEnterKey(r,A),s.prop("checked",i.isNewWindow),A.one("click",(function(e){e.preventDefault(),o.resolve({range:i.range,url:a.val(),text:r.val(),isNewWindow:s.is(":checked")}),t.$dialog.modal("hide")}))})),n.onDialogHidden(t.$dialog,(function(){r.off("input paste keypress"),a.off("input paste keypress"),A.off("click"),"pending"===o.state()&&o.reject()})),n.showDialog(t.$dialog)})).promise()},this.show=function(){var t=e.invoke("editor.getLinkInfo");e.invoke("editor.saveRange"),this.showLinkDialog(t).then((function(t){e.invoke("editor.restoreRange"),e.invoke("editor.createLink",t)})).fail((function(){e.invoke("editor.restoreRange")}))},e.memo("help.linkDialog.show",o.langInfo.help["linkDialog.show"])},LinkPopover=function(e){var t=this,n=$.summernote.ui,i=e.options;this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){t.update()},"summernote.dialog.shown":function(){t.hide()}},this.shouldInitialize=function(){return!list.isEmpty(i.popover.link)},this.initialize=function(){this.$popover=n.popover({className:"note-link-popover",callback:function(e){e.find(".popover-content").prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo("body");var t=this.$popover.find(".popover-content");e.invoke("buttons.build",t,i.popover.link)},this.destroy=function(){this.$popover.remove()},this.update=function(){if(e.invoke("editor.hasFocus")){var t=e.invoke("editor.createRange");if(t.isCollapsed()&&t.isOnAnchor()){var n=dom.ancestor(t.sc,dom.isAnchor),i=$(n).attr("href");this.$popover.find("a").attr("href",i).html(i);var o=dom.posFromPlaceholder(n);this.$popover.css({display:"block",left:o.left,top:o.top})}else this.hide()}else this.hide()},this.hide=function(){this.$popover.hide()}},ImageDialog=function(e){var t=this,n=$.summernote.ui,i=e.layoutInfo.editor,o=e.options,r=o.langInfo;this.shouldInitialize=function(){return!o.airMode},this.initialize=function(){var e=o.dialogsInBody?$(document.body):i,t="";if(o.maximumImageFileSize){var a=Math.floor(Math.log(o.maximumImageFileSize)/Math.log(1024)),A=1*(o.maximumImageFileSize/Math.pow(1024,a)).toFixed(2)+" "+" KMGTP"[a]+"B";t="<small>"+r.image.maximumFileSize+" : "+A+"</small>"}var s='<div class="form-group note-group-select-from-files"><label>'+r.image.selectFromFiles+'</label><input class="note-image-input form-control" type="file" name="files" accept="image/*" multiple="multiple" />'+t+'</div><div class="form-group note-group-image-url" style="overflow:auto;"><label>'+r.image.url+'</label><input class="note-image-url form-control col-md-12" type="text" /></div>',l='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+r.image.insert+"</button>";this.$dialog=n.dialog({title:r.image.insert,fade:o.dialogsFade,body:s,footer:l}).render().appendTo(e)},this.destroy=function(){n.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(e,t){e.on("keypress",(function(e){e.keyCode===key.code.ENTER&&t.trigger("click")}))},this.show=function(){e.invoke("editor.saveRange"),this.showImageDialog().then((function(i){n.hideDialog(t.$dialog),e.invoke("editor.restoreRange"),"string"==typeof i?e.invoke("editor.insertImage",i):e.invoke("editor.insertImagesOrCallback",i)})).fail((function(){e.invoke("editor.restoreRange")}))},this.showImageDialog=function(){return $.Deferred((function(i){var o=t.$dialog.find(".note-image-input"),r=t.$dialog.find(".note-image-url"),a=t.$dialog.find(".note-image-btn");n.onDialogShown(t.$dialog,(function(){e.triggerEvent("dialog.shown"),o.replaceWith(o.clone().on("change",(function(){i.resolve(this.files||this.value)})).val("")),a.click((function(e){e.preventDefault(),i.resolve(r.val())})),r.on("keyup paste",(function(){var e=r.val();n.toggleBtn(a,e)})).val("").trigger("focus"),t.bindEnterKey(r,a)})),n.onDialogHidden(t.$dialog,(function(){o.off("change"),r.off("keyup paste keypress"),a.off("click"),"pending"===i.state()&&i.reject()})),n.showDialog(t.$dialog)}))}},ImagePopover=function(e){var t=$.summernote.ui,n=e.options;this.shouldInitialize=function(){return!list.isEmpty(n.popover.image)},this.initialize=function(){this.$popover=t.popover({className:"note-image-popover"}).render().appendTo("body");var i=this.$popover.find(".popover-content");e.invoke("buttons.build",i,n.popover.image)},this.destroy=function(){this.$popover.remove()},this.update=function(e){if(dom.isImg(e)){var t=dom.posFromPlaceholder(e);this.$popover.css({display:"block",left:t.left,top:t.top})}else this.hide()},this.hide=function(){this.$popover.hide()}},VideoDialog=function(e){var t=this,n=$.summernote.ui,i=e.layoutInfo.editor,o=e.options,r=o.langInfo;this.shouldInitialize=function(){return!o.airMode},this.initialize=function(){var e=o.dialogsInBody?$(document.body):i,t='<div class="form-group row-fluid"><label>'+r.video.url+' <small class="text-muted">'+r.video.providers+'</small></label><input class="note-video-url form-control span12" type="text" /></div>',a='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+r.video.insert+"</button>";this.$dialog=n.dialog({title:r.video.insert,fade:o.dialogsFade,body:t,footer:a}).render().appendTo(e)},this.destroy=function(){n.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(e,t){e.on("keypress",(function(e){e.keyCode===key.code.ENTER&&t.trigger("click")}))},this.createVideoNode=function(e){var t,n=e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/),i=e.match(/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/),o=e.match(/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/),r=e.match(/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/),a=e.match(/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/),A=e.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),s=e.match(/^.+.(mp4|m4v)$/),l=e.match(/^.+.(ogg|ogv)$/),c=e.match(/^.+.(webm)$/);if(n&&11===n[1].length){var d=n[1];t=$("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+d).attr("width","640").attr("height","360")}else if(i&&i[0].length)t=$("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+i[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(o&&o[0].length)t=$("<iframe>").attr("frameborder",0).attr("src",o[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(r&&r[3].length)t=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+r[3]).attr("width","640").attr("height","360");else if(a&&a[2].length)t=$("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+a[2]).attr("width","640").attr("height","360");else if(A&&A[1].length)t=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+A[1]);else{if(!(s||l||c))return!1;t=$("<video controls>").attr("src",e).attr("width","640").attr("height","360")}return t.addClass("note-video-clip"),t[0]},this.show=function(){var i=e.invoke("editor.getSelectedText");e.invoke("editor.saveRange"),this.showVideoDialog(i).then((function(i){n.hideDialog(t.$dialog),e.invoke("editor.restoreRange");var o=t.createVideoNode(i);o&&e.invoke("editor.insertNode",o)})).fail((function(){e.invoke("editor.restoreRange")}))},this.showVideoDialog=function(i){return $.Deferred((function(o){var r=t.$dialog.find(".note-video-url"),a=t.$dialog.find(".note-video-btn");n.onDialogShown(t.$dialog,(function(){e.triggerEvent("dialog.shown"),r.val(i).on("input",(function(){n.toggleBtn(a,r.val())})).trigger("focus"),a.click((function(e){e.preventDefault(),o.resolve(r.val())})),t.bindEnterKey(r,a)})),n.onDialogHidden(t.$dialog,(function(){r.off("input"),a.off("click"),"pending"===o.state()&&o.reject()})),n.showDialog(t.$dialog)}))}},HelpDialog=function(e){var t=this,n=$.summernote.ui,i=e.layoutInfo.editor,o=e.options,r=o.langInfo;this.shouldInitialize=function(){return!o.airMode},this.createShortCutList=function(){var t=o.keyMap[agent.isMac?"mac":"pc"];return Object.keys(t).map((function(n){var i=t[n],o=$('<div><div class="help-list-item"/></div>');return o.append($("<label><kbd>"+n+"</kdb></label>").css({width:180,"margin-right":10})).append($("<span/>").html(e.memo("help."+i)||i)),o.html()})).join("")},this.initialize=function(){var e=o.dialogsInBody?$(document.body):i,t=['<p class="text-center">','<a href="http://summernote.org/" target="_blank">Summernote 16.0.0</a> · ','<a href="https://github.com/summernote/summernote" target="_blank">Project</a> · ','<a href="https://github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=n.dialog({title:r.options.help,fade:o.dialogsFade,body:this.createShortCutList(),footer:t,callback:function(e){e.find(".modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo(e)},this.destroy=function(){n.hideDialog(this.$dialog),this.$dialog.remove()},this.showHelpDialog=function(){return $.Deferred((function(i){n.onDialogShown(t.$dialog,(function(){e.triggerEvent("dialog.shown"),i.resolve()})),n.showDialog(t.$dialog)})).promise()},this.show=function(){e.invoke("editor.saveRange"),this.showHelpDialog().then((function(){e.invoke("editor.restoreRange")}))}},AirPopover=function(e){var t=this,n=$.summernote.ui,i=e.options;this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){t.update()},"summernote.change summernote.dialog.shown":function(){t.hide()},"summernote.focusout":function(e,n){agent.isFF||n.relatedTarget&&dom.ancestor(n.relatedTarget,func.eq(t.$popover[0]))||t.hide()}},this.shouldInitialize=function(){return i.airMode&&!list.isEmpty(i.popover.air)},this.initialize=function(){this.$popover=n.popover({className:"note-air-popover"}).render().appendTo("body");var t=this.$popover.find(".popover-content");e.invoke("buttons.build",t,i.popover.air)},this.destroy=function(){this.$popover.remove()},this.update=function(){var t=e.invoke("editor.currentStyle");if(t.range&&!t.range.isCollapsed()){var n=list.last(t.range.getClientRects());if(n){var i=func.rect2bnd(n);this.$popover.css({display:"block",left:Math.max(i.left+i.width/2,0)-20,top:i.top+i.height})}}else this.hide()},this.hide=function(){this.$popover.hide()}},HintPopover=function(e){var t=this,n=$.summernote.ui,i=e.options.hint||[],o=e.options.hintDirection||"bottom",r=$.isArray(i)?i:[i];this.events={"summernote.keyup":function(e,n){n.isDefaultPrevented()||t.handleKeyup(n)},"summernote.keydown":function(e,n){t.handleKeydown(n)},"summernote.dialog.shown":function(){t.hide()}},this.shouldInitialize=function(){return r.length>0},this.initialize=function(){this.lastWordRange=null,this.$popover=n.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo("body"),this.$popover.hide(),this.$content=this.$popover.find(".popover-content"),this.$content.on("click",".note-hint-item",(function(){t.$content.find(".active").removeClass("active"),$(this).addClass("active"),t.replace()}))},this.destroy=function(){this.$popover.remove()},this.selectItem=function(e){this.$content.find(".active").removeClass("active"),e.addClass("active"),this.$content[0].scrollTop=e[0].offsetTop-this.$content.innerHeight()/2},this.moveDown=function(){var e=this.$content.find(".note-hint-item.active"),t=e.next();if(t.length)this.selectItem(t);else{var n=e.parent().next();n.length||(n=this.$content.find(".note-hint-group").first()),this.selectItem(n.find(".note-hint-item").first())}},this.moveUp=function(){var e=this.$content.find(".note-hint-item.active"),t=e.prev();if(t.length)this.selectItem(t);else{var n=e.parent().prev();n.length||(n=this.$content.find(".note-hint-group").last()),this.selectItem(n.find(".note-hint-item").last())}},this.replace=function(){var t=this.$content.find(".note-hint-item.active");if(t.length){var n=this.nodeFromItem(t);this.lastWordRange.insertNode(n),range.createFromNode(n).collapse().select(),this.lastWordRange=null,this.hide(),e.invoke("editor.focus")}},this.nodeFromItem=function(e){var t=r[e.data("index")],n=e.data("item"),i=t.content?t.content(n):n;return"string"==typeof i&&(i=dom.createText(i)),i},this.createItemTemplates=function(e,t){var n=r[e];return t.map((function(t,i){var o=$('<div class="note-hint-item"/>');return o.append(n.template?n.template(t):t+""),o.data({index:e,item:t}),0===e&&0===i&&o.addClass("active"),o}))},this.handleKeydown=function(e){this.$popover.is(":visible")&&(e.keyCode===key.code.ENTER?(e.preventDefault(),this.replace()):e.keyCode===key.code.UP?(e.preventDefault(),this.moveUp()):e.keyCode===key.code.DOWN&&(e.preventDefault(),this.moveDown()))},this.searchKeyword=function(e,t,n){var i=r[e];if(i&&i.match.test(t)&&i.search){var o=i.match.exec(t);i.search(o[1],n)}else n()},this.createGroup=function(e,n){var i=$('<div class="note-hint-group note-hint-group-'+e+'"/>');return this.searchKeyword(e,n,(function(n){(n=n||[]).length&&(i.html(t.createItemTemplates(e,n)),t.show())})),i},this.handleKeyup=function(n){if(list.contains([key.code.ENTER,key.code.UP,key.code.DOWN],n.keyCode)){if(n.keyCode===key.code.ENTER&&this.$popover.is(":visible"))return}else{var i=e.invoke("editor.createRange").getWordRange(),a=i.toString();if(r.length&&a){this.$content.empty();var A=func.rect2bnd(list.last(i.getClientRects()));A&&(this.$popover.hide(),this.lastWordRange=i,r.forEach((function(e,n){e.match.test(a)&&t.createGroup(n,a).appendTo(t.$content)})),"top"===o?this.$popover.css({left:A.left,top:A.top-this.$popover.outerHeight()-5}):this.$popover.css({left:A.left,top:A.top+A.height+5}))}else this.hide()}},this.show=function(){this.$popover.show()},this.hide=function(){this.$popover.hide()}};$.summernote=$.extend($.summernote,{version:"16.0.0",ui:ui,dom:dom,plugins:{},options:{modules:{editor:Editor,clipboard:Clipboard,dropzone:Dropzone,codeview:Codeview,statusbar:Statusbar,fullscreen:Fullscreen,handle:Handle,hintPopover:HintPopover,autoLink:AutoLink,autoSync:AutoSync,placeholder:Placeholder,buttons:Buttons,toolbar:Toolbar,linkDialog:LinkDialog,linkPopover:LinkPopover,imageDialog:ImageDialog,imagePopover:ImagePopover,videoDialog:VideoDialog,helpDialog:HelpDialog,airPopover:AirPopover},buttons:{},lang:"en-US",toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},airMode:!1,width:null,height:null,focus:!1,tabSize:4,styleWithSpan:!0,shortcuts:!0,textareaAutoSync:!0,direction:null,styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onEnter:null,onKeyup:null,onKeydown:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"note-icon-align",alignCenter:"note-icon-align-center",alignJustify:"note-icon-align-justify",alignLeft:"note-icon-align-left",alignRight:"note-icon-align-right",indent:"note-icon-align-indent",outdent:"note-icon-align-outdent",arrowsAlt:"note-icon-arrows-alt",bold:"note-icon-bold",caret:"note-icon-caret",circle:"note-icon-circle",close:"note-icon-close",code:"note-icon-code",eraser:"note-icon-eraser",font:"note-icon-font",frame:"note-icon-frame",italic:"note-icon-italic",link:"note-icon-link",unlink:"note-icon-chain-broken",magic:"note-icon-magic",menuCheck:"note-icon-check",minus:"note-icon-minus",orderedlist:"note-icon-orderedlist",pencil:"note-icon-pencil",picture:"note-icon-picture",question:"note-icon-question",redo:"note-icon-redo",square:"note-icon-square",strikethrough:"note-icon-strikethrough",subscript:"note-icon-subscript",superscript:"note-icon-superscript",table:"note-icon-table",textHeight:"note-icon-text-height",trash:"note-icon-trash",underline:"note-icon-underline",undo:"note-icon-undo",unorderedlist:"note-icon-unorderedlist",video:"note-icon-video"}}})})),define("dashboard-core/js/dashboard/widgets/staticwidget/text/NormalizedPosition",["../../../../lib/@waca/core-client/js/core-client/ui/core/Class","jquery","underscore"],(function(e,t,n){var i=0,o=1,r=2,a=1,A=3;return e.extend({init:function(e,t){this.container=e,this.offset=t,this._normalize()},_normalize:function(){var e=null;this._setCursorPosition(),this.position===i?(this.container=this._findDeepestDescendant(this.container),(e=this._ensureNodeIsNontrivial(this.container))||(e=this._findNontrivialNode(this.container,!0),this.position=r),this.container=e):this.position===o?this.container.nodeType===a&&(this.container=this._findDeepestDescendant(this.container.childNodes[this.offset]),this.position=i):(this.container=this._findDeepestDescendant(this.container,!0),(e=this._findNontrivialNode(this.container))?this.position=i:e=this._ensureNodeIsNontrivial(this.container,!0),this.container=e),this._updateOffset()},_setCursorPosition:function(){this.container.nodeType===A?0===this.offset?this.position=i:this.offset===this.container.data.length?this.position=r:this.position=o:0===this.offset?this.position=i:this.container.childNodes.length&&this.offset===this.container.childNodes.length?this.position=r:this.container.childNodes.length||1!==this.offset?this.position=o:this.position=r},_updateOffset:function(){this.position===i?this.offset=0:this.position===r&&(this.offset=this.container.nodeType===A?this.container.data.length:this.container.childNodes.length)},_findDeepestDescendant:function(e,t){for(;e.firstChild;)e=t?e.lastChild:e.firstChild;return e},_isTrivialNode:function(e){return e&&e.nodeType===A&&""===e.data.trim()},_collectEquivalentNodes:function(e,t){var n=[];function i(e,t){n.push({container:e,offset:t?e.nodeType===A?e.data.length:e.childNodes.length:0})}i(e,!t);for(var o=null;!o&&e;)(o=t?e.previousSibling:e.nextSibling)?(o.childNodes.length&&(o=this._findDeepestDescendant(o,t)),this._isTrivialNode(o)&&(e=o,o=null,i(e,!1))):e=e.parentNode;return i(e?o:null,t),n},_findNontrivialNode:function(e,t){return this._collectEquivalentNodes(e,t).pop().container},_ensureNodeIsNontrivial:function(e,t){return this._isTrivialNode(e)?this._findNontrivialNode(e,t):e},equals:function(e){return this.container===e.container&&this.offset===e.offset},chooseDocumentPosition:function(e,r){r=r||"*";var a=[];return this.position===o?a.push(this):this.position===i?(a=this._collectEquivalentNodes(this.container,!0),e&&a.reverse()):((a=this._collectEquivalentNodes(this.container,!1)).splice(a.length-1,1),e||a.reverse()),n.find(a,(function(e){var n=e.container;return n.nodeType===A&&(n=n.parentNode),t(n).is(r)}))}})})),define("dashboard-core/js/dashboard/widgets/staticwidget/text/NormalizedRange",["../../../../lib/@waca/core-client/js/core-client/ui/core/Class","./NormalizedPosition"],(function(e,t){return e.extend({init:function(e){this.original=e,this.start=new t(e.startContainer,e.startOffset),this.end=new t(e.endContainer,e.endOffset)},isCursor:function(){return this.start.equals(this.end)},toDocumentRange:function(e){var t=document.createRange(),n=this.start.chooseDocumentPosition(!1,e);if(!n)return null;t.setStart(n.container,n.offset);var i=null;return i=this.isCursor()?n:this.end.chooseDocumentPosition(!0,e),t.setEnd(i.container,i.offset),t}})})),define("dashboard-core/js/dashboard/widgets/staticwidget/text/NormalizedSelection",["../../../../lib/@waca/core-client/js/core-client/ui/core/Class","./NormalizedRange"],(function(e,t){return e.extend({init:function(e){this.original=e,this.isCursor=e.isCollapsed,this.ranges=[];for(var n=0;n<e.rangeCount;n++)this.ranges.push(new t(e.getRangeAt(n)))}})})),define("dashboard-core/js/dashboard/widgets/staticwidget/text/ContentEditableSelectionManager",["../../../../lib/@waca/core-client/js/core-client/ui/core/Class","./NormalizedPosition","./NormalizedSelection","jquery","underscore"],(function(e,t,n,i,o){return e.extend({init:function(e,t){this.node=i(e),this.editableNodesSelector=t},_getEditableNodes:function(){return this.node.find(this.editableNodesSelector)},_isInEditableNode:function(e){return!!this._getEditableNodes().filter((function(t,n){return n===e||i.contains(n,e)})).length},filterKeypress:function(e){var r=!1,a=!1,A=!1;if(8===e.which?(r=!0,a=!0):(e.ctrlKey||e.metaKey)&&(A=83===e.which||90===e.which||89===e.which),r){var s,l=new n(document.getSelection());s=i(this.node[0]).find(".note-editable")?new t(i(this.node[0]).find(".note-editable").get(0),0):new t(this.node[0],0),A=o.find(l.ranges,(function(e){return e.isCursor()===a&&e.start.equals(s)}))}A&&e.preventDefault()}})})),define("dashboard-core/js/dashboard/util/textEditor/TextEditorToolbar",["../../../lib/@waca/dashboard-common/dist/ui/dialogs/TextToolbarCompactDialog"],(function(e){return function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var i=_possibleConstructorReturn(this,e.call(this,n));return i.textEditor=n.textEditor,i}return _inherits(t,e),t.prototype.remove=function(){this.textEditor.removeTextToolbar()},t}(e)})),define("dashboard-core/js/dashboard/util/textEditor/SelectedTextRange",[],(function(){var e=function(e){return e.nodeType===window.Node.TEXT_NODE},t=function(e){return-1!==Array.from(e.classList).indexOf("textFitted")},n=function(e){var t=e.startContainer,n=e.endContainer,i=window.getSelection(),o=document.createRange();o.setStart(t,0),n?o.setEnd(n,n.length):o.setEnd(t,t.length),i.removeAllRanges(),i.addRange(o)},i=["b","B","i","I","u","U"],o=function(){function t(){_classCallCheck(this,t)}return t.prototype.select=function(){},t.prototype.findTextNode=function(t,n){var i=void 0;if(t)if(e(t)&&t.nodeValue===n)i=t;else for(var o=Array.from(t.childNodes),r=0;r<o.length;r++){var a=o[r];if(i=this.findTextNode(a,n))break}return i},t}(),r=function(e){function t(n){var i=n.range;_classCallCheck(this,t);var o=_possibleConstructorReturn(this,e.call(this));return o.node=i.commonAncestorContainer,o}return _inherits(t,e),t.prototype.select=function(){var e,t,n;e=this.node,t=window.getSelection(),(n=document.createRange()).selectNodeContents(e),t.removeAllRanges(),t.addRange(n)},t}(o),a=function(t){function i(n){var o=n.range;_classCallCheck(this,i);var r=_possibleConstructorReturn(this,t.call(this));return e(o.startContainer)&&e(o.endContainer)&&(r.startContainer=new A({selectedText:o.startContainer.nodeValue.slice(o.startOffset),range:{commonAncestorContainer:o.startContainer}}),r.endContainer=new A({selectedText:o.endContainer.nodeValue.slice(0,o.endOffset),range:{commonAncestorContainer:o.endContainer}})),r}return _inherits(i,t),i.prototype.select=function(){if(this._isValidRange()){var e=this.findTextNode(this.startContainer.getNode(),this.startContainer.getSelectedText()),t=this.findTextNode(this.endContainer.getNode(),this.endContainer.getSelectedText());e&&t&&n({startContainer:e,endContainer:t})}},i.prototype._isValidRange=function(){return this.startContainer&&this.endContainer},i}(o),A=function(e){function o(n){var r=n.selectedText,a=n.range;_classCallCheck(this,o);var A=_possibleConstructorReturn(this,e.call(this));A.selectedText=r,A.commonAncestorContainer=a.commonAncestorContainer;for(var s=a.commonAncestorContainer.parentNode;s;){if(t(s))s=null;else if(-1===i.indexOf(s.nodeName))break;s=s.parentNode}return A.node=s,A}return _inherits(o,e),o.prototype.getNode=function(){return this.node},o.prototype.getSelectedText=function(){return this.selectedText},o.prototype.setSelectedText=function(e){this.selectedText=e},o.prototype.select=function(){var e=this.findTextNode(this.node,this.selectedText);e&&n({startContainer:e})},o.prototype._getNodeClassListAsString=function(e){return JSON.stringify(e&&e.classList?Array.from(e.classList).sort():[])},o}(o);return function(){function t(n){var i=n.selectedText,o=n.range;(_classCallCheck(this,t),o&&!o.collapsed)&&(e(o.commonAncestorContainer)?this.selectRange=new A({selectedText:i,range:o}):o.startContainer&&o.startContainer===o.endContainer?this.selectRange=new r({range:o}):this.selectRange=new a({range:o}));return{select:this.select.bind(this)}}return t.prototype.select=function(){this.selectRange&&this.selectRange.select()},t}()})),define("dashboard-core/js/dashboard/util/TextFitUtil",["textfit"],(function(e){return function(){function t(){_classCallCheck(this,t)}return t.fillText=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{e(t,n)}catch(e){this._forceFitText(t)}},t._forceFitText=function(e){var t=e.innerHTML,n=e.getElementsByClassName("textFitted");if(n[0])return n[0].style.fontSize="0.1px";(n=document.createElement("span")).className="textFitted",n.style.display="inline-block",n.innerHTML=t,n.style.fontSize="0.1px",e.innerHTML="",e.appendChild(n)},_createClass(t,null,[{key:"_textFit",set:function(t){e=t}}]),t}()})),define("dashboard-core/js/dashboard/util/TextEditorPropertiesUtil",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.getTextColorChoices=function(e){if(!e)throw new Error("Invalid colorsService feature");return e.getDashboardColorSet().filter((function(e){return"transparent"!==e.id}))},e.convertCssToFontId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.replace(/["\s]+/g,"");return(t=(t=t.toLowerCase().split(",")).length?t[0].split("-"):null).length&&"helveticaneueforibm"===t[0]&&(t[0]="helvneueforibm"),t},e.findFontFamilyItemFromValue=function(t,n){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=void 0,r=0;r<i.length;r++){if(i[r].value===n)return i[r];t&&t["font-family"]&&i[r].value===e.convertCssToFontId(t["font-family"])[0]&&(o=i[r])}if(o){var a=e.findFontFamilyItemFromValue(t,n,o.subCssClasses||[]);if(a)return a}return null},e.findFontFamilySubclass=function(e,t){if(e&&e.subCssClasses&&t){var n=e.subCssClasses.find((function(e){return e.value===t}));return n?n.cssClass:null}return null},e}()})),define("dashboard-core/js/lib/@waca/textwidget/src/js/base/core/agent",["jquery"],(function($){var isSupportAmd="function"==typeof define&&define.amd,isFontInstalled=function(e){var t="Comic Sans MS"===e?"Courier New":"Comic Sans MS",n=$("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),i=n.css("fontFamily",t).width(),o=n.css("fontFamily",e+","+t).width();return n.remove(),i!==o},userAgent=navigator.userAgent,isMSIE=/MSIE|Trident/i.test(userAgent),browserVersion;if(isMSIE){var matches=/MSIE (\d+[.]\d+)/.exec(userAgent);matches&&(browserVersion=parseFloat(matches[1])),matches=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(userAgent),matches&&(browserVersion=parseFloat(matches[1]))}var isEdge=/Edge\/\d+/.test(userAgent),hasCodeMirror=!!window.CodeMirror;if(!hasCodeMirror&&isSupportAmd&&"undefined"!=typeof require)if(void 0!==require.resolve)try{require.resolve("codemirror"),hasCodeMirror=!0}catch(e){}else void 0!==eval("require").specified&&(hasCodeMirror=eval("require").specified("codemirror"));var agent={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:isMSIE,isEdge:isEdge,isFF:!isEdge&&/firefox/i.test(userAgent),isPhantom:/PhantomJS/i.test(userAgent),isWebkit:!isEdge&&/webkit/i.test(userAgent),isChrome:!isEdge&&/chrome/i.test(userAgent),isSafari:!isEdge&&/safari/i.test(userAgent),browserVersion:browserVersion,jqueryVersion:parseFloat($.fn.jquery),isSupportAmd:isSupportAmd,hasCodeMirror:hasCodeMirror,isFontInstalled:isFontInstalled,isW3CRangeSupport:!!document.createRange};return agent})),define("dashboard-core/js/dashboard/util/TextEditor",["underscore","../../lib/@waca/core-client/js/core-client/utils/BrowserUtils","../../lib/@waca/core-client/js/core-client/ui/core/Class","../../lib/@waca/core-client/js/core-client/utils/Utils","../../lib/@waca/textwidget/dist/summernote","../../lib/@waca/dashboard-common/dist/utils/HtmlXSSUtils","../widgets/staticwidget/text/ContentEditableSelectionManager","./textEditor/TextEditorToolbar","./textEditor/SelectedTextRange","../../lib/@waca/dashboard-common/dist/api/ContentActionsProviderAPI","../../app/nls/StringResources","jquery","./TextFitUtil","./TextEditorPropertiesUtil","../../lib/@waca/textwidget/src/js/base/core/agent","../../lib/@waca/dashboard-common/dist/utils/TextEditorConstants"],(function(e,t,n,i,o,r,a,A,s,l,c,d,u,h,g,f){var p=["<div>","<p>","<span>","<b>","<u>","<i>","<br>","<font>","<strong>","<em>","<ul>","<ol>","<li>"],m=Object.freeze(["color","font-bold","font-family","font-italic","font-size","font-strikethrough","font-subscript","font-superscript","font-underline","insertOrderedList","insertUnorderedList","text-align","text-format"]),C=Object.freeze({pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"","SHIFT+TAB":"","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+NUM7":"","CTRL+SHIFT+NUM8":""},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"","SHIFT+TAB":"","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+NUM7":"","CMD+SHIFT+NUM8":""}}),B=["bold","underline","italic"],v=["innerMarginsTop","innerMarginsRight","innerMarginsBottom","innerMarginsLeft"],w=n.extend({init:function(e){this.savedSel=null,this.isResponsive=!1,this.autoSaveInterval=2e3,this.isBold=!1,this.node=e.node,this.isResponsive=e.isResponsive,this.initSummernote(),this.getEditingArea().attr("contenteditable",!1),this.container=e.container,this.widget=e.widget;var t=this.widget.getDashboardApi();this.colorsService=t.getFeature("Colors");var n=t.getFeature("DashboardSettings").get("fonts"),i=t.getGlassCoreSvc(".FeatureChecker");this.isPropertiesV2Enabled=i&&i.checkValue&&i.checkValue("dashboard","PropertiesV2","enabled");var o,r,a=(o=this.isPropertiesV2Enabled?{omitCssClass:!0}:null,r=f.FONT_FAMILY_CHOICES,o&&o.omitCssClass&&r.forEach((function(e){e.subCssClasses&&delete e.subCssClasses})),r),A=Array.isArray(n)?n.concat(a):a;this._toolbarDock=t.getFeature("ToolbarDock"),this._contentActions=t.getFeature("ContentActions"),this.toolbarNode=e.toolbarNode,this._fontFamilyChoices=e.fonts?Object.freeze(JSON.parse(JSON.stringify(e.fonts))):A,this._fontSizeChoices=e.fontSizes?Object.freeze(JSON.parse(JSON.stringify(e.fontSizes))):f.FONT_SIZE_CHOICES,this._fontSizeForTextWidget=this._fontSizeChoices.map((function(e){var t=e.label;return"auto"===e.value&&(t=c.get("textAutoFontSize")),{value:e.value,label:t}})),this.shouldResizeViz=e.shouldResizeViz,this.numberOfLines=1,this.initialState=e.initialState,this.supportsTextWrap=!1,this._ext=e.extension||{},this._ext.isTextWrapOn&&(this.supportsTextWrap=!0),this.fillText();var s=this._ext.onInit;s&&s(this),this.lastSavedData=this.getContent(),this.widget.eventRouter.on("widget:onExitEditMode",this._onExitEditMode,this),this.isTextWidgetContext=e.isTextWidgetContext||!1},initSummernote:function(){var e,t=this.node.children(".summernote");if(t.length||(this.node.children().length&&(e=this.node.html(),this.node.children().remove()),t=this.node.append('<div class="summernote"></div>').children(".summernote")),!!!t.data("summernote")&&(e=e||this.getEditingArea().remove().html(),this.node.find(".note-editor").remove(),t.summernote({airMode:!0,popover:{},disableDragAndDrop:!0,lineWrapping:!0,keyMap:C}),e&&r.isValidHtmlContent(e))){var n=this.getEditingArea();n.html(r.cleanseContentElements(e,p,!0)),n.find(">p").css("font-size","")}},setTextPropertiesInstance:function(e){this.textProperties=e},getDefaultFont:function(){var e="";return this._fontFamilyChoices.forEach((function(t){!0===t.default&&(e+=t.value)})),{id:e}},getFontFamilyChoices:function(){return this._fontFamilyChoices},_onExitEditMode:function(e){var t=e.closest(".widget");t&&t.getAttribute("id")===this.widget.id&&(this.getEditingArea()[0].contains(e)||(this.toggleEditing(!1),this.container.focus(),this.widget.placeholder&&this.widget._shouldShowPlaceholder&&this.widget._shouldShowPlaceholder()&&this.widget._showPlaceholder()))},destroy:function(){this.textToolbar&&(this.textToolbar.remove(),this.textToolbar=null),this.detachEnterEditEvents(),this.unbindNodeEvents(),this.autoSaverInterval&&(clearInterval(this.autoSaverInterval),this.autoSaverInterval=null),this.selectionManager=null,this._getSummerNote().summernote("destroy"),this.widget&&this.widget.eventRouter&&this.widget.eventRouter.off("widget:onExitEditMode")},initContentEditable:function(e){this.selectionManager=new a(this.node,e)},setText:function(e){this.getEditingArea().html(r.cleanseContentElements(e,p,!0)),this.editingAreaHeight=this._getHeight();var t=this._ext.onSetText;t&&t(this)},getNode:function(){return this.node},setFocus:function(){this._getSummerNote().summernote("focus")},selectionBindNodeEvents:function(){this.fnSelectionOnKeyDown=this.selectionOnKeyDown.bind(this),this.node.on("keydown",this.fnSelectionOnKeyDown)},selectionUnbindNodeEvents:function(){this.fnSelectionOnKeyDown&&(this.node.off("keydown",this.fnSelectionOnKeyDown),this.fnSelectionOnKeyDown=null)},selectionOnKeyDown:function(e){this.selectionManager.filterKeypress(e)},addEditingEvents:function(e){this.detachEnterEditEvents(),this.bindNodeEvents(),this._startAutoSaver(e);var t=this._ext.onEditStart;t&&t(this)},removeEditingEvents:function(e){this.unbindNodeEvents(),this._stopAutoSaver(e),this.attachEnterEditEvents();var t=this._ext.onEditEnd;t&&t(this)},onInitialTouchDown:function(){this.hasInitiallyTouchedDown=!0},onInitialTouchUp:function(){this.hasInitiallyTouchedDown&&(this.hasInitiallyTouchedDown=!1,this.toggleEditing(!0))},attachEnterEditEvents:function(){!this.fnTouchDown&&this.widget.isAuthoringMode&&this.widget.chromeSelected&&(this.fnTouchDown=this.onInitialTouchDown.bind(this),this.fnTouchUp=this.onInitialTouchUp.bind(this),this.node.on("touchstart",this.fnTouchDown).on("touchend",this.fnTouchUp).on("mousedown",this.fnTouchDown).on("mouseup",this.fnTouchUp))},detachEnterEditEvents:function(){this.fnTouchDown&&(this.node.off("touchstart",this.fnTouchDown).off("touchend",this.fnTouchUp).off("mousedown",this.fnTouchDown).off("mouseup",this.fnTouchUp),this.fnTouchDown=null,this.fnTouchUp=null)},save:function(t){var n=this.getContent(),i=this.lastSavedData;if(this.isResponsive){var o=function(e){var t=d("<div>"+e+"</div>");return t.find(".textFitted").css("font-size",""),t.html()};n=o(n),i=o(i)}if((n=this._clearTruncateStyle(n))!==(i=this._clearTruncateStyle(i))){if(t)t.category="saveTitle",this.widget.onPropertyUpdate(t);else{var r=e.uniqueId("_text_");this.widget.onPropertyUpdate({category:"saveTitle",transactionId:r})}this.fillText()}},setTruncateOn:function(){this.getEditingArea().find(".textFitted").addClass("truncateTextOn"),this.getEditingArea().find("p").addClass("truncateText")},setTruncateOff:function(){this.getEditingArea().find(".textFitted").removeClass("truncateTextOn"),this.getEditingArea().find("p").removeClass("truncateText")},updateLastSavedText:function(e){this.lastSavedData!==e&&(this.lastSavedData=e)},_clearTruncateStyle:function(e){var t=d("<div>"+e+"</div>");return t.find("p").removeClass("truncateText"),t.html()},updateCssOnParagraphs:function(e,t){this.getEditingArea().find("p").removeClass(t),this.getEditingArea().find("p").addClass(e)},_startAutoSaver:function(e){this.autoSaverInterval||(this.save(e),this.autoSaverInterval=setInterval(this.save.bind(this),this.autoSaveInterval))},_stopAutoSaver:function(e){this.autoSaverInterval&&(this.save(e),clearInterval(this.autoSaverInterval),this.autoSaverInterval=null)},_isModifierKey:function(e){return e.ctrlKey||e.metaKey},onKeyDown:function(e){var t=this;if(e.stopPropagation(),!this.textIsEmpty()||8!==e.which&&46!==e.which||e.preventDefault(),13===e.which&&this._resizeViz(),9===e.which){var n=!1,i=!1,o=this.getSelectedListItems(),r=this._getRefinedSelectionRange();o.forEach((function(e){var o=d(e);!n&&o.parentsUntil(".note-editable","ul, ol").length>3&&(n=!0),!i&&t._isNodeStartSelected(e,r)&&(i=!0)})),o.length&&i?e.shiftKey?this._getSummerNote().summernote("outdent"):n||this._getSummerNote().summernote("indent"):e.shiftKey?this._focusToolbar():this._getSummerNote().summernote("tab"),e.preventDefault(),this.fillText(),this.save()}this.isTextWidgetContext&&(55===e.which||56===e.which)&&this._isModifierKey(e)&&e.shiftKey&&(this.modifyList(55===e.which?"insertUnorderedList":"insertOrderedList"),this.fillText(),this.save(),this.textProperties.updatePropertiesIfNecessary()),this.selectionOnKeyDown(e)},_focusToolbar:function(){this._toolbarDock.focusODT()},show:function(e){this.node.show(),this.fillText(),e&&this.toggleEditing(!0)},hide:function(){this.toggleEditing(!1),this.node.hide()},_getNumberOfLines:function(){return this.getEditingArea().find("p").length},_getHeight:function(){return this.getEditingArea().height()},_resizeVizIfHeightChanged:function(){this._getHeight()!==this.editingAreaHeight&&(this._resizeViz(),this.editingAreaHeight=this._getHeight())},_resizeViz:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hideToolbar:!1};this.shouldResizeViz&&this.widget.widgetChromeEventRouter.trigger("title:resizeViz",e)},onKeyUp:function(e){27===e.which||123===e.which&&e.shiftKey?(e.stopPropagation(),this.toggleEditing(!1),this.container.focus()):8!==e.which&&46!==e.which||e.stopPropagation(),this._resizeVizIfHeightChanged(),this.numberOfLines=this._getNumberOfLines(),this.fillText(),this.textProperties.updatePropertiesIfNecessary()},onMouseMove:function(e){this.hasMouseDownInside&&e.stopPropagation()},onMouseUp:function(e){this.hasMouseDownInside&&(this.hasMouseDownInside=!1,e.stopPropagation(),this.fnMouseMove&&(d(document).off("mousemove",this.fnMouseMove),this.fnMouseMove=null),this.fnMouseUp&&(d(document).off("mouseup",this.fnMouseUp),this.fnMouseUp=null))},onMouseDown:function(e){var t=e.target;"SELECT"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||e.preventDefault()},onBlur:function(){this.selection=this.saveSelection()},onMouseDownInside:function(e){e.stopPropagation(),this.hasMouseDownInside=!0,this.fnMouseMove=this.onMouseMove.bind(this),this.fnMouseUp=this.onMouseUp.bind(this),d(document).on("mousemove",this.fnMouseMove).on("mouseup",this.fnMouseUp)},onTouchStart:function(e){e.stopPropagation()},keepTextSelected:function(){i.isIpad()&&(this.savedSel=this.saveSelection())},onTextSelected:function(){var e=this;if(this._textSelectedIsReady=Promise.resolve(),!this.getEditingArea().is(document.activeElement))return this._textSelectedIsReady;this.selection&&(this.selection=null);var t=this._getSummerNote().summernote("createRange"),n=t?t.toString():null;if(!n||n!==this.selectedText){var o=this.lastActiveStyles,r=this.selectCurrentActiveStyles();this.showTextToolbar(r),this.delayedPropertyUpdate&&(delete this._textSelectedIsReady,clearTimeout(this.delayedPropertyUpdate)),this._textSelectedIsReady=new Promise((function(t){e.delayedPropertyUpdate=setTimeout((function(){i.isIpad()&&d("SELECT:focus").length>0||(e.delayedPropertyUpdate=null,e.textProperties.updatePropertiesIfNecessary(o)),t()}),0)})),this.selectedText=n,this.selection=this.saveSelection(),this.selectedTextRange=this._createSelectedTextRange(),i.isIpad()&&(this.savedSel=this.selection)}return this._textSelectedIsReady},textSelectedIsReady:function(){return this._textSelectedIsReady?this._textSelectedIsReady:Promise.resolve()},bindNodeEvents:function(){this.fnOnKeyDown=this.onKeyDown.bind(this),this.fnOnKeyUp=this.onKeyUp.bind(this),this.fnOnPaste=this.onPaste.bind(this),this.node.on("keydown",this.fnOnKeyDown).on("keyup",this.fnOnKeyUp).on("paste",this.fnOnPaste),this.fnOnMouseDownInside=this.onMouseDownInside.bind(this),this.fnOnBlur=this.onBlur.bind(this),this.fnOnTouchStart=this.onTouchStart.bind(this),this.fnkeepTextSelected=this.keepTextSelected.bind(this),this.getEditingArea().on("mousedown",this.fnOnMouseDownInside).on("blur",this.fnOnBlur).on("touchstart",this.fnOnTouchStart).on("focusout",this.fnkeepTextSelected),this.fnMouseDown=this.onMouseDown.bind(this),this.fnSelectionChange=this.onTextSelected.bind(this),d(document).on("mousedown",this.fnMouseDown).on("selectionchange",this.fnSelectionChange),this.hasBindedNodeEvents=!0},unbindNodeEvents:function(){this.hasBindedNodeEvents&&(this.node.off("keydown",this.fnOnKeyDown).off("keyup",this.fnOnKeyUp).off("paste",this.fnOnPaste),this.getEditingArea().off("mousedown",this.fnOnMouseDownInside).off("touchstart",this.fnOnTouchStart).off("blur",this.fnOnBlur).off("focusout",this.fnkeepTextSelected),d(document).off("selectionchange",this.fnSelectionChange),d(document).off("mousedown",this.fnMouseDown),this.hasBindedNodeEvents=!1,this.fnOnKeyDown=null,this.fnOnKeyUp=null,this.fnOnPaste=null,this.fnOnMouseDownInside=null,this.fnOnTouchStart=null,this.fnOnBlur=null,this.fnkeepTextSelected=null,this.fnMouseDown=null,this.fnSelectionChange=null)},_replaceContent:function(e){var t=this.node.find(".note-editable"),n=d(e.value).find(".note-editable"),i=!1,o=void 0;this.isTextWidgetContext&&(i=(t.find(".textFitted")[0].getAttribute("data-inner-margins")||"10px 10px 10px 10px")!==(o=n.find(".textFitted")[0].getAttribute("data-inner-margins")||"10px 10px 10px 10px"));t.html(n.html()),i&&o&&this._setInnerMargins(o),this._resizeVizIfHeightChanged()},_didContentChange:function(e){if(e){var t=d(e).find(".note-editable").html(),n=this.getContent();return t&&n&&t!==n}return!1},applyContent:function(e){this.initSummernote(),this._didContentChange(e.value)?(this._replaceContent(e),"TranslationService"===e.sender&&this.fillText(),this.lastSavedData=this.getContent(),"UndoRedoController"===e.sender&&(this.textProperties.refresh(),this._updateToolbarAfterUndoRedo(),this.widget.placeholder&&this.widget.updatePlaceholder())):this.lastSavedData=this.getContent()},_updateToolbarAfterUndoRedo:function(){if(!this.textIsEmpty()){var e=this.saveSelection();this._selectContent();var t=this.getActiveStyles();this.updateTextToolbar(t),e&&(this._clearSelection(window.getSelection()),this.restoreSelection(e))}},onPaste:function(e){this._pasteTextExtractedFromHTML(e),this.fillText()},_getWindow:function(){return window},_pasteTextExtractedFromHTML:function(e){var t;if(e.preventDefault(),e.originalEvent.clipboardData)t=e.originalEvent.clipboardData.getData("Text"),this._getWindow().document.execCommand("insertText",!1,t);else{t=this._getWindow().clipboardData.getData("Text");var n=this._getWindow().getSelection().getRangeAt(0);n.deleteContents(),n.insertNode(this._getWindow().document.createTextNode(t))}},isEditing:function(){return this.container.hasClass("editing")},onToolbarStateChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t&&t.restoreDefaults;for(var i in n&&this._getSummerNote().summernote("removeFormat"),e)"underline"===i||"bold"===i||"italic"===i?this._onToolbarTextFormatChange({restoreDefaults:n,toggleOn:e[i],styleToToggle:i}):"fontSize"===i?this.isPropertiesV2Enabled?this.onFontSizeUpdate(e.fontSize):this.onFontSizeUpdate_V1(i,e.fontSize):"font"===i?this.isPropertiesV2Enabled?this.onFontFamilyUpdate(e.font):this.onFontFamilyUpdate_V1("fontFamily",e.font):"color"===i?this._isHexColor(e.color)?this.modifyTextColor(this._findColorIdFromHex(e.color)):this.modifyTextColor(e.color):"justifyLeft"===i||"justifyRight"===i||"justifyCenter"===i?e[i]&&this.modifyTextAlignment(i):"insertUnorderedList"===i||"insertOrderedList"===i?this.modifyList(i,e[i]):"textWrap"===i&&this._ext.onTextWrapChanged(e[i]);this.textProperties.updatePropertiesIfNecessary(),t&&t.silent||(this.selectCurrentActiveStyles(),this.fillText(),this.save(),this.textProperties.refreshProperties())},_findColorHexFromId:function(t){var n=h.getTextColorChoices(this.colorsService),i=e.find(n,(function(e){return e.id===t}));return!i&&this.colorsService.isCustomColor(t)?this.colorsService.getHexColorFromClassName(t):i?i.hexValue:i},_findColorIdFromHex:function(t){var n=h.getTextColorChoices(this.colorsService),i=e.find(n,(function(e){return e.hexValue.toUpperCase()===t.toUpperCase()}));return i?i?i.id:i:this.colorsService.getColorClassName(t)},convertStyleToToolbarState:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={};return t["font-size"]&&(n.fontSize=t["font-size"]+""),t.color&&(n.color=this._findColorHexFromId(t.color)),t["font-family"]&&(n.font=h.convertCssToFontId(t["font-family"])[0]),t["text-align"]&&(n[t["text-align"]]=!0),n.insertUnorderedList=t.insertUnorderedList,n.insertOrderedList=t.insertOrderedList,n.bold=n.underline=n.italic=!1,e.each(t["text-format"],(function(e){n[e]=!0})),n},showTextToolbar:function(e){var t=this._getTextToolbar(e);if(t.isRendered)t.setState(t.currentState);else{var n=[this.widget.getId()];this._toolbarDock.updateODTState([{name:"textStyle",type:"SubView",responsive:!0,editable:!1,changedAction:null,subView:t,removeThenApplyAction:!0,section:l.ACTION_SECTION.SELECTION_TEXT,order:10,action:function(){}}],n)}},getEditingActionList:function(){return this.isEditing()?[{name:"textStyle",type:"SubView",responsive:!0,editable:!1,changedAction:null,subView:this._getTextToolbar(),removeThenApplyAction:!0,section:l.ACTION_SECTION.SELECTION_TEXT,order:10,action:function(){}}]:[]},_setTextWrapState:function(e){this._ext&&this._ext.isTextWrapOn&&(e.textWrap=this._ext.isTextWrapOn())},_selectContent:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,n=document.createRange();if(e)t=this.getEditingArea().find("span.textFitted").get(0);else{var i=0===this.getEditingArea().find("p").length;t=i?this.getEditingArea().get(0):this.getEditingArea().find("p").get(0)}n.selectNodeContents(t);var o=window.getSelection();this._clearSelection(o),o.addRange(n)},_focusOnText:function(){this._selectContent(),this.getEditingArea().focus();var e=this.selectCurrentActiveStyles();this.showTextToolbar(e),this._selectContent(),this.getEditingArea().focus(),this.textProperties.refreshProperties({selectedTab:c.get("propText")})},toggleEditing:function(e,t){var n=this.isEditing(this.container),i=void 0===e?!n:e;if(this.container.toggleClass("editing",i),this.getEditingArea().attr("contenteditable",i),i!==n&&this._resizeViz(),i)this._deselectOtherWidgets(),n||this.addEditingEvents(t),this._focusOnText();else if(n){this.removeTextToolbar(),this._clearSelection(window.getSelection()),this.removeEditingEvents(t);var o=this.widget.getDashboardApi().getCanvas().getSelectedContentList().map((function(e){return e.getId()}));this._toolbarDock.updateODTState(this._contentActions.getContentActionList(o),o),this.textProperties.refreshProperties()}},getContentId:function(){return this.widget.getId()},_removeClassFromSelection:function(e){var t={fontSize:/rt_fontSize(\d+|\w+)/g,fontFamily:/rt_fontFamily\w+(-\w+)?/g,textColor:/customColor.+|color\d+|grayShade\d+|responsiveColor/g};if(e&&t[e])return function(n,i){return(i.match(t[e])||[]).join(" ")}},_addClassToSelection:function(e,t){return{fontSize:"rt_fontSize",fontFamily:"",textColor:""}[e]+t},getFontSizeChoices:function(){return this.widget&&this.widget.getType&&"text"===this.widget.getType()?this._fontSizeForTextWidget:this._fontSizeChoices},getToolbarProperties:function(){var t=h.getTextColorChoices(this.colorsService),n=[];return e.each(t,(function(e){n.push(e.hexValue)})),{fonts:this._fontFamilyChoices,fontSizes:this.getFontSizeChoices(),colors:n}},updateTextToolbar:function(e){this.isEditing()&&this.showTextToolbar(e)},filterActiveStyles:function(t){return e.pick(t,m)},getFontFamilySubClassSpec:function(e,t){if(!e)return[];if(!t&&e.subCssClasses)for(var n=0;n<e.subCssClasses.length;n++)if(e.subCssClasses[n].cssClass===e.cssClass){t=e.subCssClasses[n].value;break}var i={type:"DropDown",name:"fontFamilySubClass",id:"fontFamilyGroup",ariaDescribedby:c.get("textFontFamily"),defaultValue:t,options:e.subCssClasses,onChange:this.onFontFamilyUpdate_V1.bind(this),style:"width:80px;",responsive:!1};return e.subCssClasses&&0!==e.subCssClasses.length||(i.hidden=!0),i},_modifyTextFormat:function(e){this.canSetTextDetailsProperties()&&(!g.isFF||"bold"!=e&&"underline"!=e?e&&this._getSummerNote().summernote(e):this._patchUnderline(e),this.fillText())},onListUpdate:function(e){if(e&&e[0]&&e[0].name)this.modifyList(e[0].name);else{var t=this.getActiveStyles().insertUnorderedList?"insertUnorderedList":"insertOrderedList";this.modifyList(t)}this.fillText(),this.updateTextToolbar()},onListUpdate_V1:function(e,t){this.onListUpdate(t)},modifyList:function(e,t){if(this.canSetTextDetailsProperties()&&this.getActiveStyles()[e]!==t){this._getSummerNote().summernote(e);var n=this._createSelectedTextRange();this._styleListItems(),this.isEditing()&&n&&n.select()}},_patchUnderline:function(e){"bold"==e?(this.isBold=!this.isBold,this._getSummerNote().summernote(e)):"underline"==e&&(this.isBold?(this._getSummerNote().summernote("bold"),this._getSummerNote().summernote("underline"),this._getSummerNote().summernote("bold")):this._getSummerNote().summernote("underline"))},modifyFontFamily:function(e){if(this.canSetTextDetailsProperties()){var t=this._removeClassFromSelection("fontFamily"),n=this._addClassToSelection("fontFamily",e);this._getSummerNote().summernote("updateClassToSelection",{remove:t,add:n}),this._styleListItems(),this.getEditingArea().focus(),this.fillText()}},_cleanInlineStyle:function(){this.getEditingArea().find("span, li").css("font-size","")},modifyFontSize:function(e){if(this.canSetTextDetailsProperties()){this.isResponsive="auto"===e;var t=this._removeClassFromSelection("fontSize");if(this.isResponsive)this._cleanInlineStyle();else{this.unFillText();var n=this._createSelectedTextRange();this._getSummerNote().summernote("fontSize",parseInt(e)),this._styleListItems(),this.isEditing()&&n&&n.select()}this._getSummerNote().summernote("updateClassToSelection",{remove:t}),this.fillText(),this.getEditingArea().focus(),this._resizeViz()}},_isHexColor:function(e){return 0===e.indexOf("#")&&7===e.length},modifyTextColor:function(e){if(this.canSetTextDetailsProperties()){var t=void 0,n=this._removeClassFromSelection("textColor");"transparent"!==e&&(t=this._addClassToSelection("textColor",e));var i=this._createSelectedTextRange();this._getSummerNote().summernote("updateClassToSelection",{remove:n,add:t}),this._styleListItems(),this.getEditingArea().focus(),this.isEditing()&&i&&i.select()}},_getCurrentSelectedFontFamily:function(){var e=this._getCurrentActiveStyles(!1),t=h.convertCssToFontId(e["font-family"])[0];return h.findFontFamilyItemFromValue(e,t,this._fontFamilyChoices)||h.findFontFamilyItemFromValue(e,this.getDefaultFont().id,this._fontFamilyChoices)},_callFontFamilySubClassUpdate:function(e,t){this.isPropertiesV2Enabled?this.onFontFamilyUpdate(e):this.onFontFamilyUpdate_V1("fontFamilySubClass",e,t)},onTextFormatUpdate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.getActiveStyles()["text-format"],i=[],o=!1;B.forEach((function(r){var a=t.filter((function(e){return e.name===r&&"underline"!==r&&(r,i.push(r)),e.name===r})),A=a.length>0&&-1===n.indexOf(r),s=0===a.length&&n.indexOf(r)>-1;(A||s)&&(e._modifyTextFormat(r),o=!0)})),o&&(this._callFontFamilySubClassUpdate(i,{skipStyleUpdate:!0}),this.textProperties.refreshProperties(),this.fillText(),this.updateTextToolbar())},onTextFormatUpdate_V1:function(e,t){this.onTextFormatUpdate(t)},onTextAlignmentUpdate:function(e){e&&e[0]&&e[0].name&&this.modifyTextAlignment(e[0].name),this.fillText(),this.updateTextToolbar()},onTextAlignmentUpdate_V1:function(e,t){this.onTextAlignmentUpdate(t)},modifyTextAlignment:function(e){if(this.canSetTextDetailsProperties()){var t=e.replace("justify",""),n=this.getSelectedParagraphs(),i=Array.isArray(n),o=0;for(n=i?n:n[Symbol.iterator]();;){var r;if(i){if(o>=n.length)break;r=n[o++]}else{if((o=n.next()).done)break;r=o.value}r.style.textAlign=t}this.getEditingArea().focus()}},onFontSizeUpdate_V1:function(e,t){this.onFontSizeUpdate(t)},onFontSizeUpdate:function(e){this.modifyFontSize(e),this.fillText(),i.isIpad()&&this.restoreSelection(),this.getEditingArea().focus(),this.updateTextToolbar()},selectTextStyleFromFontFamily:function(e){var t=this,n=this.getActiveStyles()["text-format"];e.indexOf("bolditalic")>-1?(-1===n.indexOf("bold")&&this._modifyTextFormat("bold"),-1===n.indexOf("italic")&&this._modifyTextFormat("italic")):e.indexOf("bold")>-1?(-1===n.indexOf("bold")&&this._modifyTextFormat("bold"),-1!==n.indexOf("italic")&&this._modifyTextFormat("italic")):e.indexOf("italic")>-1?(-1!==n.indexOf("bold")&&this._modifyTextFormat("bold"),-1===n.indexOf("italic")&&this._modifyTextFormat("italic")):n.forEach((function(e){"underline"!==e&&t._modifyTextFormat(e)})),this.textProperties.refreshProperties()},onFontFamilyUpdate:function(e){if(e){var t=h.findFontFamilyItemFromValue(this.lastActiveStyles,e,this._fontFamilyChoices);if(!t)return;this.modifyFontFamily(t.cssClass),this.selectTextStyleFromFontFamily(e),this.fillTextAfterDelay(500),i.isIpad()&&this.restoreSelection(),this.getEditingArea().focus(),this.updateTextToolbar()}},onFontFamilyUpdate_V1:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!1,r=void 0;try{var a="fontFamilySubClass"===e,A=[];Array.isArray(t)?(A.push.apply(A,t),t=null):a&&A.push(t),(r=this._findFontFamilyCssClasss({isFontFamilySubclassRequest:a,fontFamilyId:t,textFormatStyles:A}))&&(this.modifyFontFamily(r.fontFamilyCssClass),n.skipStyleUpdate="boolean"==typeof n.skipStyleUpdate&&n.skipStyleUpdate,r.fontStyle.length&&!n.skipStyleUpdate&&this.selectTextStyleFromFontFamily(r.fontStyle),this.textProperties.refreshProperties(),this.fillTextAfterDelay(500),i.isIpad()&&this.restoreSelection(),this.getEditingArea().focus(),this.updateTextToolbar(),o=!0)}finally{this.restoreSelectedText=o&&this.isEditing()&&this.selectedTextRange,this.restoreSelectedText&&this.selectedTextRange.select()}},onTextColorUpdate_V1:function(e,t){this.onTextColorUpdate(t.name)},onTextColorUpdate:function(e){this.selection&&(this.restoreSelection(this.selection),this.selection=null),this.modifyTextColor(e),this.fillText(),this.updateTextToolbar()},textIsEmpty:function(){return this._getSummerNote().summernote("isEmpty")||0===this.getEditingArea().get(0).textContent.length&&1==this.numberOfLines},getEditingArea:function(){return this.node.find(".note-editable")},_getSummerNote:function(){return this.initSummernote(),this.node.children(".summernote")},getContent:function(){return this.getEditingArea().html()},getTitleFromHtml:function(e){var t="";return d(e).find("p, li").each((function(e,n){t=t+" "+n.textContent})),t.trim()},fillText:function(){if(this.node.is(":visible")&&this.isResponsive){this.node.addClass("textFillNoScroll"),this.node.find(".textFitted").css("word-wrap","normal");var e=[];t.isIE()&&this.getEditingArea().find("p, li").each((function(t,n){e.push(n.style.textAlign),n.style.textAlign="left"}));var n={maxFontSize:Math.ceil(this.node.height()),minFontSize:1,multiLine:!0,detectMultiLine:!1};u.fillText(this.getEditingArea()[0],n),e.length&&this.getEditingArea().find("p, li").each((function(t,n){n.style.textAlign=e[t]}))}},fillTextAfterDelay:function(e){setTimeout(this.fillText.bind(this),e)},unFillText:function(){this.node.find(".textFitted").css({"font-size":"","word-wrap":""}),this.node.removeClass("textFillNoScroll")},selectCurrentActiveStyles:function(){var e=!this.isEditing();return e&&(this.getEditingArea().attr("contenteditable",!0),this._selectContent(!0)),this.lastActiveStyles=this.getActiveStyles(),e&&(this.getEditingArea().attr("contenteditable",!1),this._clearSelection(window.getSelection())),this.lastActiveStyles},getActiveStyles:function(){var e=this._getSummerNote().summernote("currentStyle");return this._getActiveTextFormat(e),this._getActiveTextAlignment(e),this._getActiveTextColor(e),this._getActiveFontSize(e),this._getActiveLists(e),e},getLastActiveStyles:function(){return this.lastActiveStyles},setLastActiveStyles:function(e){this.lastActiveStyles=e},_getActiveLists:function(e){e.insertUnorderedList="unordered"===e["list-style"],e.insertOrderedList="ordered"===e["list-style"]},_getActiveTextFormat:function(e){var t=e["text-format"];t||(e["text-format"]=t=[]),"bold"===e["font-bold"]&&t.push("bold"),"underline"===e["font-underline"]&&t.push("underline"),"italic"===e["font-italic"]&&t.push("italic")},_getActiveTextAlignment:function(e){var t=this.getSelectedParagraphs();if(t&&t.length>0){var n=t[0].style.textAlign,i=t,o=Array.isArray(i),r=0;for(i=o?i:i[Symbol.iterator]();;){var a;if(o){if(r>=i.length)break;a=i[r++]}else{if((r=i.next()).done)break;a=r.value}if(a.style.textAlign!==n)return void(e["text-align"]="")}switch(n){case"center":e["text-align"]="justifyCenter";break;case"right":e["text-align"]="justifyRight";break;default:e["text-align"]="justifyLeft"}}else this.isTextWidgetContext&&!this.isEditing()&&(e["text-align"]="justifyLeft")},_getActiveTextColor:function(e){if(e.color){var t=this._getActiveTextColor_Checker(e.color);t&&(e.color=t)}},_getActiveTextColor_Checker:function(e){var t=null;if(e){var n=h.getTextColorChoices(this.colorsService),i=this._rgbToHex(e),o=n,r=Array.isArray(o),a=0;for(o=r?o:o[Symbol.iterator]();;){var A;if(r){if(a>=o.length)break;A=o[a++]}else{if((a=o.next()).done)break;A=a.value}var s=A;if(i&&i===s.hexValue){t=s.id;break}}!t&&i&&(t=this.colorsService.getColorClassName(i))}return t},_getActiveFontSize:function(e){e["font-size"]&&this.isResponsive&&(e["font-size"]="auto")},_rgbToHex:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},_copyTextStyles:function(e,t){var n=Array.from(e[0].classList).find((function(e){return e.match(/customColor.+|color\d+|grayShade\d+|responsiveColor/g)}));if(!n){var i=this._rgbToHex(e.css("color"));n=this._findColorIdFromHex(i)}var o=e.css("font-family");t.removeClass(),n&&t.addClass(n);var r=h.convertCssToFontId(o)||[];if(r.length){var a=h.findFontFamilyItemFromValue(null,r[0],this._fontFamilyChoices);if(a){var A=r.length>1&&h.findFontFamilySubclass(a,r[1])||a.cssClass;A&&t.addClass(A)}}this.isResponsive||t.css({"font-size":e.css("font-size")})},_getRefinedSelectionRange:function(){for(var e=window.getSelection().getRangeAt(0).cloneRange(),t=e.startContainer,n=t.firstChild?0:e.startOffset;t.firstChild;)t=t.firstChild;if(n>0&&"\ufeff"===t.textContent[n-1]&&0===(n-=1)){for(var i=document.createTreeWalker(d(t).closest("p, li")[0],window.NodeFilter.SHOW_TEXT);t!==i.nextNode(););for(var o=i.previousNode();o&&"\ufeff"===o.textContent[o.textContent.length-1];)if(o.textContent=o.textContent.slice(0,-1),""===o.parentNode.innerText){var r=o.parentNode;o=i.previousNode(),r.remove()}}return e.setStart(t,n),e},_isNodeStartSelected:function(e,t){for(;e.firstChild;)e=e.firstChild;var n=document.createRange();return n.setStart(e,0),1!==t.compareBoundaryPoints(window.Range.START_TO_START,n)},_styleListItems:function(){var e=this,t=this.getSelectedListItems();if(t.length){var n=this._getRefinedSelectionRange();t.forEach((function(t){var i=d(t);if(e._isNodeStartSelected(t,n)){for(i.contents().each((function(t,n){var o=d(n);if(n.nodeType===window.Node.TEXT_NODE){var r=d("<span></span>");e._copyTextStyles(i,r),o.wrap(r)}else e._copyTextStyles(o,o)}));t.firstChild;)t=t.firstChild;e._copyTextStyles(d(t.parentNode),i)}}))}},getSelectedListItems:function(){return this.getSelectedParagraphs().filter((function(e){return"LI"===e.nodeName}))},getSelectedParagraphs:function(){if(!this.isEditing())return this.getEditingArea().find("p, li").toArray();var e=window.getSelection();if(!e.rangeCount)return[];var t=e.getRangeAt(0);if(t.startContainer===this.getEditingArea()[0])return this.getEditingArea().find("p, li").toArray();var n=d(t.startContainer).closest("p, li").get(0),i=d(t.endContainer).closest("p, li").get(0);if(n===i)return n?[n]:[];var o=[],r=!1;return d(t.commonAncestorContainer).find("p, li").each((function(){this===n&&(r=!0),r&&o.push(this),this===i&&(r=!1)})),o},saveSelection:function(){if(window.getSelection){var e=window.getSelection();if(e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},_createSelectedTextRange:function(){return this.selection=this.saveSelection(),this.selection?new s({selectedText:this.selectedText||"",range:this.selection}):null},_clearSelection:function(e){if(document.body.createTextRange){var t=document.body.createTextRange();t.collapse(),t.select()}else e.removeAllRanges()},restoreSelection:function(e){if(e)if(window.getSelection){var t=window.getSelection();this._clearSelection(t),t.addRange(e)}else document.selection&&e.select&&e.select()},hasContent:function(){var e=this.getEditingArea();return!!e.text().length||!!e.find("li").length},hasText:function(){return!!this.getEditingArea().text().length},onVerticalAlignChange_V1:function(e,t){this.onVerticalAlignChange(t)},onVerticalAlignChange:function(e){var t=e&&e.length&&e[0].name,n=this._getTextFittedNode();if(n&&t){n.style.display="table";var i=this._getVerticalAlignWrapper(n);if(i)i.style["vertical-align"]=t;else{var o=this._createVerticalAlignWrapper(t);this._insertVerticalAlignWrapper(o,n)}}},_getVerticalAlignWrapper:function(e){var t=e.children.length&&e.children[0];return t&&"div"===t.nodeName.toLowerCase()&&t.classList.contains("vertical-align-wrapper")?t:null},_createVerticalAlignWrapper:function(e){var t=document.createElement("div");return t.classList.add("vertical-align-wrapper"),t.style.display="table-cell",t.style["vertical-align"]=e,t},_insertVerticalAlignWrapper:function(e,t){for(var n=[],i=t.children.length,o=0;o<i;o++)n.push(t.children[o].cloneNode(!0));n.forEach((function(t){e.appendChild(t)}));for(var r=0;r<i;r++)t.removeChild(t.children[0]);t.appendChild(e)},getVerticalAlignValues:function(){var e=this._getTextFittedNode();if(e){var t=this._getVerticalAlignWrapper(e);if(t)return t.style["vertical-align"]}return"top"},onIndentationChange_V1:function(e,t){this.onIndentationChange(t)},onIndentationChange:function(e){var t=e&&e.length&&e[0].name;t&&("indentMore"===t?this._getSummerNote().summernote("indent"):(this._getSummerNote().summernote("outdent"),(this.getSelectedParagraphs()||[]).some((function(e){return e.style["margin-left"]}))||this.textProperties.refreshProperties()))},onLineHeightChange_V1:function(e,t){this.onLineHeightChange(t)},onLineHeightChange:function(e){"default"===e?(this.getSelectedParagraphs()||[]).forEach((function(e){e.style.removeProperty("line-height")})):this._getSummerNote().summernote("lineHeight",e)},_getTextFittedNode:function(){var e=this.getEditingArea(),t=void 0;return(t=e?e&&e.find("span.textFitted"):this.node.find(".textFitted"))&&t.length?t[0]:null},_normalizeMargin:function(e){var t=e.split(" "),n=t;switch(t.length){case 1:n=[t[0],t[0],t[0],t[0]];break;case 2:n=[t[0],t[1],t[0],t[1]];break;case 3:n=[t[0],t[1],t[2],t[1]]}return n},_getCurrentMargin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getEditingArea(),n=void 0;if((n=t?t[0].style.padding:this.getNode()[0].style.padding)||(n="10px 10px 10px 10px"),n=this._normalizeMargin(n),e){var i=v.indexOf(e);return n[i]}return n},onInnerMarginsChange:function(e,t){var n=this._getCurrentMargin();n[v.indexOf(e)]=t+"px",this._setInnerMargins(n.join(" ")),this.selection&&(this._clearSelection(window.getSelection()),this.restoreSelection(this.selection))},setInnerMargins:function(){var e=this._getStaticContentNodes();if(e.length){var t=this._getTextFittedNode().getAttribute("data-inner-margins");t||(t="10px 10px 10px 10px");var n=e[0].querySelector(".note-editable");n&&this._setInnerMarginsOnNode(t,n),e.length>1&&this._setInnerMarginsOnNode(t,e[1])}},_setInnerMargins:function(e){var t=this;this._getStaticContentNodes().forEach((function(n){var i=n.querySelector(".note-editable");i?t._setInnerMarginsOnNode(e,i):t._setInnerMarginsOnNode(e,n)}))},_setInnerMarginsOnNode:function(e,t){t.style.padding=e;var n=t.querySelector(".textFitted");n&&(n.setAttribute("data-inner-margins",e),this.fillText())},_getStaticContentNodes:function(){var e=this.container[0];return e&&e.querySelectorAll(".staticContent")||[]},getInnerMarginsValue:function(e){var t=this._getCurrentMargin(e);return parseInt(t)},canSetTextDetailsProperties:function(){return this.isTextWidgetContext||this.isEditing()},updateTextDetailStyle:function(e){if(!e)throw new Error("Invalid function to update text detail style");var t=this.selection;try{this.selection=null;var n=this.isTextWidgetContext&&!this.isEditing();n&&(this.getEditingArea().attr("contenteditable",!0),this._selectContent(!0));for(var i=arguments.length,o=Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];if(e.apply(void 0,o),n){var a=this._getTransactionToken.apply(this,o);this.save(a),this.getEditingArea().attr("contenteditable",!1),this._clearSelection(window.getSelection())}}finally{this.selection=t}},_getTransactionToken:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=[].concat(t),o=i.find((function(e){return e&&e.transactionId}));return o},_getTextToolbar:function(e){this.textToolbar||(this.textToolbar=new A({onStateChange:this.onToolbarStateChange.bind(this),textNode:this.getEditingArea(),properties:this.getToolbarProperties(),initialState:this.initialState,supportsLists:this.isTextWidgetContext,supportsTextWrap:this.supportsTextWrap,textEditor:this}));var t=e||this._getCurrentActiveStyles(),n=this.convertStyleToToolbarState(t);return this.textToolbar.currentState=n,this.textToolbar.properties=this.getToolbarProperties(),this.textToolbar},_deselectOtherWidgets:function(){var e=this.getContentId(),t=this.widget.getDashboardApi().getCanvas().getSelectedContentList().filter((function(t){return t.getId()!==e}));if(t.length){var n=t.map((function(e){return e.getId()}));this.widget.getDashboardApi().getCanvas().deselectContent(n)}},removeTextToolbar:function(){this.textToolbar=null},getTextFormatOptions:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._textFormatOptionsMap||(this._textFormatOptionsMap={bold:{name:"bold",label:c.get("propToolbarPickBold"),value:"common-text-bold"},italic:{name:"italic",label:c.get("propToolbarPickItalic"),value:"common-text-italic"},underline:{name:"underline",label:c.get("propToolbarPickUnderline"),value:"common-text-underline"}}),e?[this._textFormatOptionsMap.bold,this._textFormatOptionsMap.italic,this._textFormatOptionsMap.underline]:this._textFormatOptionsMap},_getTextFormatOption:function(e){return this.getTextFormatOptions(!1)[e]},_findFontFamilyCssClasss:function(e){var t=e.isFontFamilySubclassRequest,n=e.fontFamilyId,i=e.textFormatStyles,o=void 0===i?[]:i,r=void 0,a=void 0,A=void 0,s=void 0,l=void 0;if(t){if(!(r=this._getCurrentSelectedFontFamily()))throw new Error("Invalid font");l=o}else{r=h.findFontFamilyItemFromValue(null,n,this._fontFamilyChoices),l=this._getCurrentActiveStyles()["text-format"].filter((function(e){return"underline"!==e}))}if(r&&(A=r&&r.cssClass,r.subCssClasses)){l.sort((function(e,t){return e.localeCompare(t)}));var c=l.join("");c.length&&-1===l.indexOf(c)&&l.unshift(c);for(var d=0;d<l.length;d++)if(a=l[d],s=r.subCssClasses.find((function(e){return e.value===a}))){A=s.cssClass;break}}return{fontFamilyCssClass:A,fontStyle:a||""}},_getCurrentActiveStyles:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.isEditing()&&(e||!this.lastActiveStyles)?this.selectCurrentActiveStyles():this.lastActiveStyles},_onToolbarTextFormatChange:function(e){var t=this,n=e.restoreDefaults,i=e.toggleOn,o=e.styleToToggle;if(!n||i){var r=[];if(!n){var a,A=this._getCurrentActiveStyles();(a=r).push.apply(a,A["text-format"]);var s=r.indexOf(o);i?-1===s&&r.push(o):-1!==s&&r.splice(s,1),r=r.map((function(e){return t._getTextFormatOption(e)}))}this.onTextFormatUpdate(r)}}});return w.cleanContentElements=function(e){return r.cleanseContentElements(e,p,!0)},w.getTextHTML=function(t){var n=t.text?"<span>"+e.escape(t.text)+"</span>":"<br>";return'<span class="textFitted '+t.style+"Color "+t.style+"FontSize "+t.style+'FontFamily"><p>'+n+"</p></span>"},w.FONTSIZE_CHOICES=f.FONT_SIZE_CHOICES,w})),define("dashboard-core/js/dashboard/util/TextEditorProperties",["underscore","../../app/nls/StringResources","../../lib/@waca/dashboard-common/dist/utils/TextEditorConstants","./TextEditorPropertiesUtil"],(function(e,t,n,i){var o=t.get("text_label"),r=t.get("sectionName_details"),a={fontFamily:1,fontFamilySubClass:2,fontSize:3,textColor:4,textFormat:5,alignmentPicker:6,listPicker:7,verticalAlignPicker:8,indentationPicker:9,lineHeight:10,innerMargins:11,innerMarginsTop:12,innerMarginsBottom:13,innerMarginsLeft:14,innerMarginsRight:15},A=function e(t){var n=t.refreshCallback,i=t.refreshPropertiesCallback,o=t.updatePropertiesIfNecessaryCallback;_classCallCheck(this,e),this.refreshProperties=i,this.refresh=n,this.updatePropertiesIfNecessary=o};return function(){function s(e){var t=e.dashboard,n=e.isTextWidgetContext,i=void 0!==n&&n,a=e.propertiesOptions,l=void 0===a?{}:a,c=e.textEditor,d=e.widget;_classCallCheck(this,s),this.dashboard=t,this.colorsService=this.dashboard.getFeature("Colors"),this._icons=this.dashboard.getFeature("Icons"),this.isTextWidgetContext=i,this.textEditor=c,this.widget=d,this.bannerLabel=l.bannerLabel||o,this.sectionLabel=l.sectionLabel||r,this.textEditor.setTextPropertiesInstance(new A({refreshCallback:this._refreshProperties.bind(this),refreshPropertiesCallback:this._refreshPropertiesPane.bind(this),updatePropertiesIfNecessaryCallback:this.updatePropertiesIfNecessary.bind(this)})),this.canvas=this.dashboard.getFeature("Canvas"),this.canvas&&(this.canvas.on("change:selections:select",this._onChangeSelectionsHandler,this),this.canvas.on("change:selections:deselect",this._updateSelectedTextWidgets,this))}return s.prototype.destroy=function(){this.canvas&&(this.canvas.off("change:selections:select",this._onChangeSelectionsHandler,this),this.canvas.off("change:selections:deselect",this._updateSelectedTextWidgets,this),this.canvas=null)},s.prototype.getPropertyLayoutList=function(){return this._canSetTextDetailsProperties()?[{id:"textDetail",type:"Group",label:t.get("tabName_textDetails"),position:1},{id:"fontFamily",type:"Section",collapsible:!1,label:t.get("textFontFamily"),position:1},{id:"fontFamilyLine",type:"SingleLineLinks",items:[{id:"left",align:"left",items:[]},{id:"right",align:"right",items:[]}]}].concat(this._getV1PropertyLayoutControlList()):[]},s.prototype.getPropertyList=function(){return[]},s.prototype.getCustomColorList=function(){var e=[],t=[];this.textEditor.getEditingArea().find("span").each((function(e,n){t.push(n.className)}));var n=t.join(" ");return this.colorsService.getCustomColorSet().forEach((function(t){-1!==n.indexOf(t.id)&&e.push(t.hexValue)})),e},s.prototype.isEditing=function(){return this.textEditor.isEditing()},s.prototype.getEditingActionList=function(){return this.textEditor.getEditingActionList()},s.prototype._getV1PropertyLayoutControlList=function(){if(!this._canSetTextDetailsProperties())return[];var e=[],t=this._selectCurrentActiveStyles();return e.push.apply(e,this._getFontFamilyProperties(t)),e.push(this._getFontSizeProperty(t)),e.push(this._getTextColorProperty(t)),e.push(this._getFontWeightProperty(t)),e.push(this._getTextAlignmentProperty(t)),this.isTextWidgetContext&&this._addPropertiesForTextWidget(e,t),e},s.prototype._getFontFamilyProperties=function(e){var n=this._getSelectedFamilyFont(e),i=n.selected,o=n.fontFamilyChoices,r=n.cssClass,A=n.subCssClass;return[{id:"fontFamily",editor:{sectionId:"textDetail.fontFamily.fontFamilyLine.left",position:a.fontFamily,uiControl:{type:"DropDown",ariaDescribedby:t.get("textFontFamily"),options:o,responsive:!1,style:"width: 156px;",value:i[0],onChange:this._getOnStyleChangeCallback({fnName:"onFontFamilyUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}}},{id:"fontFamilySubClass",editor:{sectionId:"textDetail.fontFamily.fontFamilyLine.left",position:a.fontFamilySubClass,hidden:!r||!r.subCssClasses||0===r.subCssClasses.length,uiControl:{type:"DropDown",ariaDescribedby:t.get("textFontFamily"),options:r&&r.subCssClasses,value:A&&A.value,onChange:this._getOnStyleChangeCallback({fnName:"onFontFamilyUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext}),style:"width:80px;",responsive:!1}}}]},s.prototype._getSelectedFamilyFont=function(t){var n=t["font-family"],o=n?i.convertCssToFontId(n):[],r=this._getFontFamilyChoices(),a=i.findFontFamilyItemFromValue(t,o[0],r);a||(o=[this._getDefaultFont().id],a=i.findFontFamilyItemFromValue(t,o[0],r));var A=e.find(a.subCssClasses,(function(e){return o.length>1?e.value===o[1]:e.cssClass===a.cssClass}));return{selected:o,fontFamilyChoices:r,cssClass:a,subCssClass:A}},s.prototype._getFontSizeProperty=function(e){return{id:"fontSize",editor:{sectionId:"textDetail",position:a.fontSize,uiControl:{type:"DropDown",label:t.get("textFontSize"),ariaDescribedby:t.get("textFontSize"),options:this.textEditor.getFontSizeChoices(),onChange:this._getOnStyleChangeCallback({fnName:"onFontSizeUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext}),value:this.isResponsive?"auto":e["font-size"]+""}}}},s.prototype._getTextColorProperty=function(e){var n=i.getTextColorChoices(this.colorsService),o=n.find((function(t){return t.id===e.color}))||{name:e.color,value:""};return{id:"textColor",editor:{sectionId:"textDetail",position:a.textColor,uiControl:{paletteType:"DashboardColorSet",type:"ColorPicker",showHexValue:!0,addButton:!0,label:t.get("propTextColor"),open:!1,ariaLabel:t.get("propTextColor"),items:n,allowSameSelection:!0,selectedName:o?o.name:"",value:o?o.value:"",onChange:this._getOnStyleChangeCallback({fnName:"onTextColorUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}}}},s.prototype._getFontWeightProperty=function(e){var n=this._getFontWeightPropertyContext(),i=n.sectionId,o=n.onChange;return{id:"textFormat",editor:{sectionId:i,position:a.textFormat,uiControl:{type:"IconPicker",label:t.get("textStyle"),useToggling:!0,allowMultiple:!0,items:this.textEditor.getTextFormatOptions(),values:e["text-format"],onChange:o}}}},s.prototype._getFontWeightPropertyContext=function(){return{sectionId:"textDetail",onChange:this._getOnStyleChangeCallback({fnName:"onTextFormatUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}},s.prototype._getTextAlignmentProperty=function(e){var n=this._getTextAlignmentPropertyContext(),i=n.sectionId,o=n.onChange;return{id:"alignmentPicker",editor:{sectionId:i,position:a.alignmentPicker,uiControl:{type:"IconPicker",label:t.get("propAlignPicker"),items:[{name:"justifyLeft",label:t.get("propAlignPickLeft"),value:"common-left-align"},{name:"justifyCenter",label:t.get("propAlignPickCenter"),value:"common-center-align"},{name:"justifyRight",label:t.get("propAlignPickRight"),value:"common-right-align"}],values:e["text-align"],onChange:o}}}},s.prototype._getTextAlignmentPropertyContext=function(){return{sectionId:"textDetail",onChange:this._getOnStyleChangeCallback({fnName:"onTextAlignmentUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}},s.prototype._addPropertiesForTextWidget=function(e,t){e.push(this._getListProperty(t)),e.push(this._getVerticalAlignProperty()),e.push(this._getIndentationProperty()),e.push(this._getLineHeightProperty(t)),e.push.apply(e,this._getInnerMarginsProperty())},s.prototype._getListProperty=function(e){var n=void 0,i=this._getListPropertyContext("listPicker"),o=i.sectionId,r=i.position,a=i.onChange;return e.insertUnorderedList?n="insertUnorderedList":e.insertOrderedList&&(n="insertOrderedList"),{id:"listPicker",editor:{sectionId:o,position:r,uiControl:{type:"IconPicker",label:t.get("propList"),useToggling:!0,items:[{name:"insertUnorderedList",label:t.get("propUnorderedList"),value:this._icons.getIcon("bullet-list").id},{name:"insertOrderedList",label:t.get("propOrderedList"),value:this._icons.getIcon("number-list").id}],values:n,onChange:a}}}},s.prototype._getListPropertyContext=function(e){return{sectionId:"textDetail",position:a[e],onChange:this._getOnStyleChangeCallback({fnName:"onListUpdate",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}},s.prototype._getVerticalAlignProperty=function(){var e="verticalAlignPicker",n=this._getVerticalAlignPropertyContext(),i=n.sectionId,o=n.onChange;return{id:e,editor:{sectionId:i,position:a[e],uiControl:{type:"IconPicker",label:t.get("propVerticalAlignPicker"),items:[{name:"top",label:t.get("propAlignPickTop"),value:this._icons.getIcon("align-top-center").id},{name:"middle",label:t.get("propAlignPickMiddle"),value:this._icons.getIcon("align-middle-center").id},{name:"bottom",label:t.get("propAlignPickBottom"),value:this._icons.getIcon("align-bottom-center").id}],values:this._getVerticalAlignValues(),onChange:o}}}},s.prototype._getVerticalAlignPropertyContext=function(){return{sectionId:"textDetail",onChange:this._getOnStyleChangeCallback({fnName:"onVerticalAlignChange",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}},s.prototype._getIndentationProperty=function(){var e=this._getIndentationPropertyContext(),n=e.sectionId,i=e.onChange;return{id:"indentationPicker",editor:{sectionId:n,position:a.indentationPicker,uiControl:{type:"IconPicker",label:t.get("textIndentation"),items:[{name:"indentMore",label:t.get("textIncreaseIndentation"),value:this._icons.getIcon("text-indent-more").id},{name:"indentLess",label:t.get("textDecreaseIndentation"),value:this._icons.getIcon("text-indent-less").id}],onChange:i}}}},s.prototype._getIndentationPropertyContext=function(){return{sectionId:"textDetail",onChange:this._getOnStyleChangeCallback({fnName:"onIndentationChange",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}},s.prototype._getLineHeightProperty=function(e){var i=this._getLineHeightPropertyContext(),o=i.sectionId,r=i.onChange;return{id:"lineHeight",editor:{sectionId:o,position:a.lineHeight,uiControl:{type:"DropDown",label:t.get("textLineHeight"),ariaDescribedby:t.get("textLineHeight"),options:n.LINE_HEIGHT_CHOICES,onChange:r,value:this._getLineHeightValue(e)}}}},s.prototype._getLineHeightPropertyContext=function(){return{sectionId:"textDetail",onChange:this._getOnStyleChangeCallback({fnName:"onLineHeightChange",suffix:"_V1",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext})}},s.prototype._getInnerMarginsProperty=function(){var e=this,n=[{id:"innerMargins",type:"Section",collapsible:!0,label:t.get("textInnerMargins"),position:a.innerMargins}];return["Top","Bottom","Left","Right"].forEach((function(i){var o="innerMargins"+i,r=t.get("prop"+i),A=a["innerMargins"+i];n.push(e._getInnerMarginSpec(o,A,r,"textDetail.innerMargins"))})),n},s.prototype._getInnerMarginSpec=function(e,t,n,i){var o=this._validatePositiveNumber.bind(this);return{id:e,defaultValue:10,editor:{sectionId:i,position:t,uiControl:{type:"InputLabel",inputType:"number",label:n,ariaLabel:n,handleReturnKey:!0,showInlineError:!0,value:this.textEditor.getInnerMarginsValue(e),customValidatorCallback:o,onChange:this._getOnStyleChangeCallback({fnName:"onInnerMarginsChange",textEditor:this.textEditor,isTextWidgetContext:this.isTextWidgetContext}),decimalPlaces:0,min:0,multiline:!0}}}},s.prototype._validatePositiveNumber=function(e){var n={isValid:!0};return(e<0||""===e)&&(n.message=t.get("notPositiveNumberError"),n.isValid=!1),n},s.prototype._getLineHeightValue=function(e){var t=e&&e["line-height"],i=n.LINE_HEIGHT_CHOICES;if(t&&!isNaN(t)){-1===t.indexOf(".")&&(t+=".0");var o=i.find((function(e){return e.value===t}));if(o)return o.value}return i[0].value},s.prototype._getDefaultFont=function(){return this.textEditor.getDefaultFont()},s.prototype._getFontFamilyChoices=function(){return this._fontFamilyChoices||(this._fontFamilyChoices=this.textEditor.getFontFamilyChoices()),this._fontFamilyChoices},s.prototype._getActiveStyles=function(){return this.textEditor.getActiveStyles()||{}},s.prototype._getLastActiveStyles=function(){return this.textEditor.getLastActiveStyles()||{}},s.prototype._setLastActiveStyles=function(e){return this.textEditor.setLastActiveStyles(e)},s.prototype._selectCurrentActiveStyles=function(){return this.textEditor.selectCurrentActiveStyles()},s.prototype._getVerticalAlignValues=function(){return this.textEditor.getVerticalAlignValues()},s.prototype._supportTextWidgetContext=function(){return this.isTextWidgetContext},s.prototype.updatePropertiesIfNecessary=function(t){if(this._canSetTextDetailsProperties()){var n=this._getActiveStyles(),i=t||this._getLastActiveStyles(),o=this._filterActiveStyles(n),r=this._filterActiveStyles(i);e.isEqual(o,r)||(this._setLastActiveStyles(n),this._updateTextToolbar(n),this._refreshPropertiesPane())}},s.prototype._canSetTextDetailsProperties=function(){return this.textEditor.canSetTextDetailsProperties()},s.prototype._getOnStyleChangeCallback=function(e){var t=e.fnName,n=e.suffix,i=void 0===n?"":n,o=e.textEditor,r=e.isTextWidgetContext;if(!o)throw new Error("Invalid textEditor");var a=o[""+t+i].bind(o);if("function"!=typeof a)throw new Error("Function "+t+i+" does not exist in textEditor");if("function"!=typeof o.updateTextDetailStyle)throw new Error("Function updateTextDetailStyle does not exist in textEditor");return r&&!this.isEditing()?o.updateTextDetailStyle.bind(o,a):a},s.prototype._filterActiveStyles=function(e){return this.textEditor.filterActiveStyles(e)},s.prototype._updateTextToolbar=function(e){this.textEditor.updateTextToolbar(e)},s.prototype._onChangeSelectionsHandler=function(){var e=this,t=(this.canvas?this.canvas.getSelectedContentList():[]).map((function(e){return e.getId()}));t.length>1&&t.forEach((function(t){e.textEditor.getContentId()===t&&e.textEditor.isEditing()&&(e.textEditor.toggleEditing(!1),e.widget.showPlaceHolder&&e.widget.showPlaceHolder())}))},s.prototype._updateSelectedTextWidgets=function(){},s.prototype._refreshPropertiesPane=function(e){this.widget.refreshPropertiesPane(e)},s.prototype._refreshProperties=function(){},s}()})),define("dashboard-core/js/dashboard/util/TextPropertiesV2",["../../app/nls/StringResources","./TextEditorProperties"],(function(e,t){var n={textDetailSection:0,fontFamilyLine:1,styline:2,listAndVerticalAlignLine:3,indentationAndLineHeightLine:4,innerMarginsSection:5,innerMarginsTopBottom:6,innerMarginsLeftRight:7};return function(t){function i(){_classCallCheck(this,i);for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];var r=_possibleConstructorReturn(this,t.call.apply(t,[this].concat(n)));return r.selectedTextWidgets=[],r.controller=r.dashboard.getFeature("InteractionController.internal"),r}return _inherits(i,t),i.prototype.destroy=function(){this.selectedTextWidgets=[],t.prototype.destroy.call(this)},i.prototype.getPropertyList=function(){return[]},i.prototype.getPropertyLayoutList=function(){if(!this._canSetTextDetailsProperties())return[];var e=this._selectCurrentActiveStyles(),t=[];return t.push(this._getFontFamilyLineSpec(e)),t.push(this._getStyleLineSpec(e)),this._supportTextWidgetContext()&&(t.push(this._getListAndVerticalAlignLineSpec(e)),t.push(this._getIndentationAndLineHeightLineSpec(e)),t.push.apply(t,this._getInnerMarginsSectionSpec())),[{id:"textDetailBanner",type:"Banner",value:this.bannerLabel},{id:"textDetail",type:"Section",label:this.sectionLabel,position:n.textDetailSection,items:t,expanded:!0}]},i.prototype._getFontFamilyLineSpec=function(e){var t=this._getFontFamilyProperties(e),i=this._getFontSizeProperty(e),o=this._getTextColorProperty(e);return{id:"fontFamilyLine",editor:{position:n.fontFamilyLine,uiControl:{type:"FontCombo",fontFamily:t,fontSize:i,textColor:o}}}},i.prototype._getStyleLineSpec=function(e){var t=this._getFontWeightProperty(e),i=this._getTextAlignmentProperty(e);return{id:"styleLine",position:n.styleLine,type:"Split",items:[{id:"left",align:"left",items:[t]},{id:"right",align:"right",items:[i]}]}},i.prototype._getListAndVerticalAlignLineSpec=function(e){var t=this,i=this._getListProperty(e);i.setPropertyValue=function(e){t.textEditor.onListUpdate(e),t.widget.getDashboardApi().getFeature("InternalProperties").refresh()};var o=this._getVerticalAlignProperty();return o.getPropertyValue=function(){t.getVerticalAlignValues()},o.setPropertyValue=function(e){t.textEditor.onVerticalAlignChange(e),t.widget.getDashboardApi().getFeature("InternalProperties").refresh()},{id:"listAndVerticalAlignLine",type:"Split",position:n.listAndVerticalAlignLine,items:[{id:"left",align:"left",items:[i]},{id:"right",align:"right",items:[o]}]}},i.prototype._getIndentationAndLineHeightLineSpec=function(e){var t=this,i=this._getIndentationProperty();i.getPropertyValue=function(){return null},i.setPropertyValue=function(e){t.textEditor.onIndentationChange(e),t.widget.getDashboardApi().getFeature("InternalProperties").refresh()};var o=this._getLineHeightProperty(e);return o.getPropertyValue=function(){t._getLineHeightValue()},o.setPropertyValue=function(e){t.textEditor.onLineHeightChange(e)},{id:"indentationAndLineHeightLine",type:"Split",position:n.indentationAndLineHeightLine,items:[{id:"left",align:"left",items:[i]},{id:"right",align:"right",items:[o]}]}},i.prototype._getInnerMarginsSectionSpec=function(){var t=this,i={};return["Top","Bottom","Left","Right"].forEach((function(o){var r="innerMargins"+o,a=void 0;"Top"!==o&&"Bottom"!==o||(a="textDetail.innerMargins.innerMarginsTopBottom."+("Top"===o?"left":"right"));"Left"!==o&&"Right"!==o||(a="textDetail.innerMargins.innerMarginsLeftRight."+o.toLowerCase());var A=e.get("prop"+o),s=n["innerMargins"+o];i[o]=t._getInnerMarginSpec(r,s,A,a)})),[{id:"innerMargins",type:"Section",collapsible:!1,label:e.get("textInnerMargins"),position:n.innerMarginsSection},{id:"innerMarginsTopBottom",position:n.innerMarginsTopBottom,type:"Split",items:[{id:"left",align:"left",items:[i.Top]},{id:"right",align:"right",items:[i.Bottom]}]},{id:"innerMarginsLeftRight",position:n.innerMarginsLeftRight,type:"Split",items:[{id:"left",align:"left",items:[i.Left]},{id:"right",align:"right",items:[i.Right]}]}]},i.prototype._getInnerMarginSpec=function(e,t,n,i){var o=this;return{id:e,defaultValue:10,value:this.textEditor.getInnerMarginsValue(e),getPropertyValue:function(){o.textEditor.getInnerMarginsValue(e)},setPropertyValue:function(t,n){o._onStyleChange("onInnerMarginsChange")(e,t,n)},editor:{sectionId:i,position:t,uiControl:{type:"InputLabel",inputType:"number",label:n,decimalPlaces:0,min:0}}}},i.prototype._getFontFamilyProperties=function(e){return{id:"fontFamily",value:this._getSelectedFamilyFont(e).selected[0],onChange:this._onStyleChange("onFontFamilyUpdate")}},i.prototype._getFontSizeProperty=function(e){return{id:"fontSize",onChange:this._onStyleChange("onFontSizeUpdate"),value:this.isResponsive?"auto":e["font-size"]+""}},i.prototype._getTextColorProperty=function(t){var n=this;return{id:"textColor",paletteTitle:e.get("themeLabel"),value:t.color,paletteType:"DashboardColorSet",ignoreTransparentColor:!0,onChange:function(e){n._onStyleChange("onTextColorUpdate")(e),n.widget.getDashboardApi().getFeature("InternalProperties").refresh()}}},i.prototype._getFontWeightPropertyContext=function(){var e=this;return{sectionId:"textDetail.styleLine.style",onChange:function(t){e._onStyleChange("onTextFormatUpdate")(t),e.widget.getDashboardApi().getFeature("InternalProperties").refresh()}}},i.prototype._getListPropertyContext=function(e){var t=this;return{sectionId:"textDetail",position:6,onChange:function(e){t._onStyleChange("onListUpdate")(e),t.widget.getDashboardApi().getFeature("InternalProperties").refresh()}}},i.prototype._getVerticalAlignPropertyContext=function(){var e=this;return{sectionId:"textDetail.verticalAlignLine.right",onChange:function(t){e._onStyleChange("onVerticalAlignChange")(t),e.widget.getDashboardApi().getFeature("InternalProperties").refresh()}}},i.prototype._getIndentationPropertyContext=function(){var e=this;return{sectionId:"textDetail.indentationAndLineHeightLine.left",onChange:function(t){e._onStyleChange("onIndentationChange")(t),e.widget.getDashboardApi().getFeature("InternalProperties").refresh()}}},i.prototype._getLineHeightPropertyContext=function(){var e=this;return{sectionId:"textDetail.indentationAndLineHeightLine.right",onChange:function(t){e._onStyleChange("onLineHeightChange")(t)}}},i.prototype._getTextAlignmentPropertyContext=function(){var e=this;return{sectionId:"textDetail.styleLine.alignment",onChange:function(t){e._onStyleChange("onTextAlignmentUpdate")(t),e.widget.getDashboardApi().getFeature("InternalProperties").refresh()}}},i.prototype._refreshPropertiesPane=function(){this.widget.getDashboardApi().getFeature("InternalProperties").reset()},i.prototype._refreshProperties=function(){this.widget.getDashboardApi().getFeature("InternalProperties").refresh()},i.prototype._onChangeSelectionsHandler=function(){t.prototype._onChangeSelectionsHandler.call(this),this._updateSelectedTextWidgets()},i.prototype._updateSelectedTextWidgets=function(){var e=this;this.selectedTextWidgets.length=0,(this.canvas?this.canvas.getSelectedContentList({type:"widget.text"}):[]).forEach((function(t){var n=e._getTextWidget(t.getId());n&&e.selectedTextWidgets.push(n)}))},i.prototype._getTextWidget=function(e){var t=this.controller.layoutController.getLayoutView(e),n=t&&t.getAPI().getWidgetAPI();return n?n.widget:null},i.prototype._onStyleChange=function(e){var t=this;return function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];if(t.selectedTextWidgets.length>1){var r=t.dashboard.getFeature("Transaction"),a=r.startTransaction();t.selectedTextWidgets.forEach((function(t){var n=t.getTextEditorProperties();if(!n)throw new Error("Invalid textEditorProperties");n._getOnStyleChangeCallback({fnName:e,textEditor:n.textEditor,isTextWidgetContext:n.isTextWidgetContext}).apply(void 0,i.concat([a]))}))}else{var A=t._getOnStyleChangeCallback({fnName:e,textEditor:t.textEditor,isTextWidgetContext:t.isTextWidgetContext});A.apply(void 0,i)}}},i}(t)})),define("dashboard-core/js/dashboard/util/StaticTextHelper",["underscore","jquery","../../lib/@waca/dashboard-common/dist/utils/TextEditorConstants"],(function(e,t,n){var i=["font-size"];return function(){function o(e){var t=e.Colors;_classCallCheck(this,o),this.Colors=t,this.colourClassNames=null}return o.prototype.titleContainsSize=function(e){var n=this;return!!this._extractVisibleTitleLines(t(e)).find((function(e){return n._titleLineContainsSize(e)}))},o.prototype._extractVisibleTitleLines=function(e){return e.find("p").toArray().map((function(e){return t(e)}))},o.prototype._titleLineContainsSize=function(e){return this._getTitleLineSizeAttribute(e).length>0},o.prototype._getTitleLineSizeAttribute=function(e){var t=this;return this._getElementsWithFormatAttributes(e).map((function(e){var n=e.$e,i=e.classNames,o=e.style;return{$e:n,styles:t._getFontSizeStyles(o),classNames:t._getFontSizeClassNames(i)}})).filter((function(e){var t=e.classNames,n=e.styles;return t.length>0||n.length>0}))},o.prototype._getElementsWithFormatAttributes=function(e){return e.find("span, font").toArray().map((function(e){return t(e)})).map((function(e){return{$e:e,classNames:e.attr("class")||"",style:e.attr("style")||""}}))},o.prototype._getFontSizeStyles=function(e){return i.filter((function(t){return e.indexOf(t)>=0}))},o.prototype._getFontSizeClassNames=function(t){var i=t.split(/\s+/g),o=this._getColourClassNames(),r=e.pluck(n.FONT_FAMILY_CHOICES,"cssClass");return e.chain(i).filter((function(e){return e&&e.length})).difference(o,r).value()},o.prototype._getColourClassNames=function(){if(!this.colourClassNames){var e=this.Colors.getDashboardColorSet();this.colourClassNames=(e||[]).map((function(e){return e.id})),this.colourClassNames.push("responsiveColor")}return this.colourClassNames},o.prototype.stripTitleOfSize=function(e){var n=this,i=t(e);return this._extractVisibleTitleLines(i).forEach((function(e){return n._getTitleLineSizeAttribute(e).forEach((function(e){var t=e.$e,i=e.styles,o=e.classNames;return n._stripFontSizeFormatting({$e:t,styles:i,classNames:o})}))})),i[0].outerHTML},o.prototype._stripFontSizeFormatting=function(e){var t=e.$e,n=e.styles,i=e.classNames;n.forEach((function(e){return t.css(e,"")})),i.forEach((function(e){return t.toggleClass(e,!1)}))},o}()})),define("dashboard-core/js/app/util/LocaleUtil",[],(function(){var e=null,t=null;return(t=function(){if(t.prototype._singletonInstance)return t.prototype._singletonInstance;this.locale=this.getLocale(),this.isRTL=this.isLocaleRTL(this.locale),t.prototype._singletonInstance=this}).prototype.getLocale=function(){return this.locale||(this.locale=document.documentElement.getAttribute("lang")),this.locale},t.prototype.isLocaleRTL=function(e){if(!this.isRTL){this.isRTL=["ar","he"].indexOf(e)>=0}return this.isRTL},function(){return e||(e=new t),e}()})),define("dashboard-core/js/dashboard/layout/views/WidgetTitleView",["../../../lib/@waca/core-client/js/core-client/ui/core/View","../../../lib/@waca/core-client/js/core-client/utils/BidiUtil","../../../dashboard/util/TextEditor","../../../dashboard/util/TextEditorProperties","../../../dashboard/util/TextPropertiesV2","../../../dashboard/util/StaticTextHelper","../../../app/util/LocaleUtil","../../../app/nls/StringResources","jquery","underscore"],(function(e,t,n,i,o,r,a,A,s,l){var c=["smallTitle","mediumTitle"],d=function(e){return"object"===(void 0===e?"undefined":_typeof(e))?e[document.getElementsByTagName("html")[0].getAttribute("lang")]||e.en||e[Object.keys(e)[0]]:e},u=e.extend({init:function(e){this.titleId=e.id+"Title",this.canEditTitle=e.canEditTitle,this.widgetModel=e.widgetModel,this.widgetChromeEventRouter=e.widgetChromeEventRouter,this.header=e.header,this.dashboardApi=e.dashboardApi,this.lastSizeClass="";var t=this.dashboardApi.getGlassCoreSvc(".FeatureChecker");this.isPropertiesV2Enabled=t&&t.checkValue&&t.checkValue("dashboard","PropertiesV2","enabled"),this.registerEvents()},registerEvents:function(){this.widgetChromeEventRouter.on("title:chromeSelected",this.onChromeSelected,this),this.widgetChromeEventRouter.on("title:chromeDeselected",this.onChromeDeselected,this),this.widgetChromeEventRouter.on("title:containerReady",this.onContainerReady,this),this.widgetChromeEventRouter.on("title:enterContainer",this.onEnterContainer,this),this.widgetChromeEventRouter.on("title:updateModel",this.updateModelContent,this),this.widgetChromeEventRouter.on("widget:clearWidgetArialabel",this.clearWidgetArialabel,this),this.widgetChromeEventRouter.on("widget:updateWidgetArialabel",this.updateWidgetArialabel,this),this._isTitleModeEnabled()?this.widgetModel.on("change:titleMode",this._showTitle,this):this.widgetModel.on("change:showTitle",this._showTitle,this)},_registerContentEvents:function(e){e.on("change:property:responsiveTitle",this.onResponsiveTitleChange,this)},getHtmlRender:function(){return this.getStyleNode().get(0).outerHTML},_getTextProperties:function(e){return{style:"responsive",text:e}},_getSizeClass:function(){return this.widget&&this.widget.content&&!0===this.widget.content.getPropertyValue("responsiveTitle")?"small"===this._getResponsiveSize()?"smallTitle":"mediumTitle":""},_getResponsiveSize:function(){var e=this.widget.content.getFeature("ContentViewDOM");if(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;if(n<240||i<180)return"small"}return"medium"},render:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,i="";this.widgetModel&&this.widgetModel.get&&(t=n.cleanContentElements(this.widgetModel.get("titleHtml")),i=this.widgetModel.get("name"));var o=i?d(i):"",r=this._getSizeClass();this.lastSizeClass=r;var a=["widgetTitle",r].filter((function(e){return e.length>0})).join(" ");t?(this.$el=s(t),this.$el.length||(this.$el=s('<div class="'+a+'" title="'+o+'">'+t+"</div>")),this._nTitle=this.$el.find(".textArea")):(this.$el=s("<div></div>",{class:a,title:o}),this.$el.attr("aria-labelledby",this.titleId),this._nTitle=s("<div></div>",{class:"textArea"}),this.$el.prepend(this._nTitle)),this.$el.attr("walkme-data-id","widgetTitle"),this.$el.toggleClass("titleShown",!(!o||!o.length));var A=this._shouldShowTitle();this._nTitle.toggleClass("hidden",e&&!A)},remove:function(){this.widgetChromeEventRouter.off("title:chromeSelected",this.onChromeSelected,this),this.widgetChromeEventRouter.off("title:chromeDeselected",this.onChromeDeselected,this),this.widgetChromeEventRouter.off("title:containerReady",this.onContainerReady,this),this.widgetChromeEventRouter.off("title:enterContainer",this.onEnterContainer,this),this.widgetChromeEventRouter.off("title:updateModel",this.updateModelContent,this),this.widgetChromeEventRouter.off("widget:clearWidgetArialabel",this.clearWidgetArialabel,this),this.widgetChromeEventRouter.off("widget:updateWidgetArialabel",this.updateWidgetArialabel,this),this._isTitleModeEnabled()?this.widgetModel.off("change:titleMode",this._showTitle,this):this.widgetModel.off("change:showTitle",this._showTitle,this),this.widgetModel.off("change:titleHtml",this._onTitleHtmlChange,this),this.textEditor&&(this.textEditor.destroy(),this.textEditor=null),u.inherited("remove",this,arguments)},onContainerReady:function(e){var r=this,s=e&&e.content&&e.content.getFeature,l=s&&s("WidgetTitleTruncate"),c=l&&l.getExtensionHooks();l&&l.setUpdateModelContent(this.updateModelContent.bind(this)),l&&l.setTitleHighlighter(this._highlightTitle.bind(this)),this._handleEditUpdateTruncation=c&&c.onEditUpdate,this.widget=e,this._registerContentEvents(this.widget.content);var d=s&&s("Visualization"),u=d&&d.getDefinition(),h=u&&u.getLabel();this.textEditor=new n({node:this._nTitle,container:this.header,widget:e,toolbarNode:e.$widgetContainer,shouldResizeViz:!0,initialState:{fontSize:"16",color:"responsiveColor"},extension:c,propertiesOptions:{bannerLabel:h,sectionLabel:A.get("textTitleStyle")}});var g={dashboard:this.dashboardApi,propertiesOptions:{bannerLabel:h,sectionLabel:A.get("textTitleStyle")},textEditor:this.textEditor,widget:e};return this.textEditorProperties=this.isPropertiesV2Enabled?new o(g):new i(g),a.isLocaleRTL()&&t.initElementForBidi(this._nTitle),this.textEditor.isResponsive=!1,this.widgetModel.on("change:titleHtml",this._onTitleHtmlChange,this),this.textEditor.initContentEditable("p"),this.textEditor.selectionBindNodeEvents(),this._applyTitle(),this._updateAriaInfo(),this.dashboardApi.getCanvasWhenReady().then((function(t){var n=t.getContent(e.id);n.getFeature("Properties").registerProvider(r.textEditorProperties),n.getFeature("TextEditor").registerProvider({textEditor:r.textEditorProperties})}))},getEditingActionList:function(){return this.textEditorProperties?this.textEditorProperties.getEditingActionList():[]},_updateAriaInfo:function(){var e=this.widgetModel.id+"Title";this.$el.find(".note-editable").attr("id",e)},_onTitleHtmlChange:function(e){if(!(e=e||{})||null!==e.value&&""!==e.value&&void 0!==e.value){if(this.textEditorProperties){var t=this.textEditor.applyContent(e),n=this.textEditor.getTitleFromHtml(this.getHtmlRender());return this.$el.prop("title",n),t}}else this._setTitleHtmlFromName()},_applyTitle:function(){var e=this;if(this.textEditor){var t=this._getSizeClass();t!==this.lastSizeClass&&(this.$el.toggleClass(c,!1),this.$el.toggleClass(t,!0),this.lastSizeClass=t,this.widgetChromeEventRouter.trigger("title:resizeViz"),this.textEditorProperties.updatePropertiesIfNecessary());var i=this.dashboardApi.getFeature("TranslationService");if(this.widgetModel.get("name"))this.widgetModel.get("titleHtml")?i.isInTranslationMode()&&this._updateTextEditor():(this.widgetModel.name&&this.widgetModel.name.translationTable&&l.each(this.widgetModel.name.translationTable,(function(t,n){e.widgetModel.set({name:{locale:n,value:t}}),e._setTitleHtmlFromName(n)})),this._setTitleHtmlFromName());else{var o=!0;if(this._isTitleModeEnabled()){var r=this.widget&&this.widget.content&&this.widget.content.getPropertyValue("titleMode");o=r&&"customTitle"===r}if(this.canEditTitle&&o){var a=this._getTextProperties(A.get("titlePlaceHolder"));this.textEditor.setText(n.getTextHTML(a)),this._isTitleModeEnabled()&&this.textEditor.toggleEditing(!0)}else this.textEditor.setText(" ")}}},_setTitleHtmlFromName:function(e){if(this.textEditor){var t=this._updateTextEditor(e);t.text&&(this.$el.prop("title",t.text),this.$el.find(".ariaLabelNode").html(n.cleanContentElements(t.text)));var i=n.cleanContentElements(this.getHtmlRender()),o=this.dashboardApi.getFeature("internal").getBoardModel().getLanguageModelOptions();l.extend(o,{silent:!0}),this.widgetModel.set({titleHtml:{value:i,locale:e}},o)}},_updateTextEditor:function(e){var t=this.widgetModel.get("name");e&&this.widgetModel.name&&(t=this.widgetModel.name.getValue(e));var i=this._getTextProperties(t),o=n.getTextHTML(i);return this.textEditor.setText(o),this.textEditor.updateLastSavedText(o),i},_showTitle:function(e){this.updateTitle(e);var t=this.widgetModel.showTitle,n=this.widget.content.getPropertyValue("titleMode");t||"customTitle"!==n||(t=!(!e||"noTitle"!==e.prevValue)),this.canEditTitle&&t&&this.textEditor&&this.widget&&this.widget.chromeSelected&&this.widget.isAuthoringMode&&this.textEditor.toggleEditing(!(e&&e.data&&!1===e.data.edit),e)},_hasHeader:function(){return!!(this.widget&&this.widget.$el&&this.widget.$el.parent()&&this.widget.$el.parent().find)&&0!==this.widget.$el.parent().find(".widgetHeader").length},_getHeader:function(){return this._hasHeader()?this.widget.$el.parent().find(".widgetHeader")[0]:null},_toggleEdit:function(e){this.textEditor&&(this.textEditor.isEditing()&&this.textEditor.textIsEmpty()&&!1===e&&(this._isTitleModeEnabled()?this.widget.content.setPropertyValue("titleMode","noTitle"):this.widget.content.setPropertyValue("showTitle",!1)),this.textEditor.toggleEditing(e))},checkAndRecreateHeader:function(){this.widget&&(this.widget.isWidgetMaximized&&this.widget.isWidgetMaximized()||this._hasHeader()||this.widgetChromeEventRouter.trigger("title:resetTitle",{widgetTitleView:this}))},_shouldShowTitle:function(){return this._isTitleModeEnabled()?void 0===this.widgetModel.titleMode?!!this.widgetModel.showTitle:"noTitle"!==(this.widgetModel.titleMode||"smartTitle"):!!this.widgetModel.showTitle},_isWidgetReady:function(){var e=!0;if(this._isTitleModeEnabled()){var t=this.widget&&this.widget.content&&this.widget.content.getFeature("Visualization");t&&t.getSlots()&&!1===t.getSlots().isMappingComplete()&&(e=!1)}return e},_canHideHeader:function(){return"dropdownList"===this.widget.getVisId()&&0===this.widget.$el.parent().find(".dataWidgetIcon:visible").length},updateTitle:function(e){var t=this._isWidgetReady(),n=this._shouldShowTitle()&&t,i=!this._nTitle.hasClass("hidden");if(n){this.checkAndRecreateHeader(),this._applyTitle(),this._nTitle.removeClass("hidden");var o=this._getHeader();o&&this._canHideHeader()&&s(o).removeClass("hidden")}else{var r=this._getHeader();r&&this._canHideHeader()&&s(r).addClass("hidden"),this._nTitle.addClass("hidden"),this.textEditor&&this.textEditor.toggleEditing(!1,e)}n!==i&&this.widgetChromeEventRouter.trigger("title:resizeViz")},onChromeSelected:function(){u.inherited("onChromeSelected",this,arguments),this.textEditor&&this.canEditTitle&&this.textEditor.attachEnterEditEvents()},onChromeDeselected:function(){u.inherited("onChromeDeselected",this,arguments),this._toggleEdit(!1),this.textEditor&&this.textEditor.detachEnterEditEvents()},onChromeOffFocus:function(){this._toggleEdit(!1)},onEnterContainer:function(){this.textEditor&&this.canEditTitle&&this.textEditor.toggleEditing(!0)},onResponsiveTitleChange:function(e){if(!0===e.info.value){var t=this.getModelContent().titleHtml,n=this.dashboardApi.getFeature("Colors"),i=new r({Colors:n});if(i.titleContainsSize(t)){var o={transactionId:e.transactionToken.transactionId},a=i.stripTitleOfSize(t);this.updateModelContent({titleHtml:a,transactionId:o.transactionId,transactionToken:o})}}this.widgetChromeEventRouter.trigger("widget:onResize",{reRender:!0})},getModelContent:function(){return{titleHtml:this.widgetModel.get("titleHtml")}},updateModelContent:function(e){if(this.textEditor){var t=this.dashboardApi.getFeature("internal").getBoardModel().getLanguageModelOptions();e.transactionId?l.extend(t,{payloadData:{undoRedoTransactionId:e.transactionId,transactionToken:e.transactionToken}}):l.extend(t,{silent:!0});var i=e.titleHtml||this.getHtmlRender(),o=this.textEditor.getTitleFromHtml(i),r=null;this.widgetModel&&this.widgetModel.get&&(r=this.widgetModel.get("name"));var a=r?d(r):"",A=s(i);A.prop("title",o),i=A[0].outerHTML;var c=n.cleanContentElements(i);this._handleEditUpdateTruncation&&this._handleEditUpdateTruncation(a,c,o,e.transactionId),this.widgetModel.set({titleHtml:c,name:o},t)}},_highlightTitle:function(){this.textEditor.toggleEditing(!0)},updateWidgetArialabel:function(e){this._nAriaLabel&&this._nAriaLabel.text(e.value)},clearWidgetArialabel:function(){this._nAriaLabel&&this._nAriaLabel.empty()},getStyleNode:function(){return this.$el},_isTitleModeEnabled:function(){var e=this.dashboardApi.getFeature("DashboardSettings"),t=!1;if(e){var n=e.get("applicationSettings");t=n&&n.options&&n.options.config&&!0===n.options.config.smartTitle}return t}});return u})),define("dashboard-core/js/dashboard/layout/views/Widget",["./LayoutBaseView","jquery","underscore","./WidgetTitleView","../../../lib/@waca/core-client/js/core-client/utils/Deferred","../../../lib/@waca/core-client/js/core-client/ui/KeyCodes","../../../lib/@waca/core-client/js/core-client/ui/core/Events","../../../app/util/EventChainLocal"],(function(e,t,n,i,o,r,a,A){var s=e.extend({init:function(e){s.inherited("init",this,arguments),this._layoutEvents=new a,this._widgetReady=new o,this._widgetRenderComplete=new o,this.canvasNotifier=e.canvasNotifier,this.widgetModel=e.widgetModel,this.widgetRegistry=e.widgetRegistry,this.visPreferredSize=null,this.icons={},this._savedTransform=null,this.$widgetContentWrapper=this.$el.find(".widgetContentWrapper"),this._registerWidgetChromeEvents(),this._createHeader(),this._createAttachedView(),this._createFilterGroupOverlay(),this.isTouchDevice="ontouchstart"in document.documentElement,this._removeHandlers=[],this.additionalWidgetData=e.additionalWidgetData,this.$el.attr("walkme-data-id","widget"),t(this.domNode).on("keydown.widgetKeydown",this.onKeyDown.bind(this))},renderContent:function(){var e=this;return!this._isRendered&&this.widgetModel&&(this._isRendered=!0,this.registerViewFeatures().then((function(){e.canvasNotifier&&e._establishCanvasConnection(e.additionalWidgetData),e.renderWidget()}))),this.layoutController.markViewAsReady(this),Promise.resolve()},renderWidget:function(){var e=this;return this.setLoading(!1),new Promise((function(t,n){if(e.layoutController.widgetLoader.isLoaded(e.id))e._widgetAlreadyLoadedCallback(),t();else{var i=e.additionalWidgetData&&e.additionalWidgetData.addPayloadData,o=i&&i.undoRedoTransactionId;e.layoutController.widgetLoader.loadWidget(e.id,e.widgetModel.toJSON(),e.domNode,e._prepareAsyncCallback((function(t){t&&t.widget&&(t.widget.onContainerReady&&t.widget.onContainerReady({model:e.widgetModel,widgetChromeEventRouter:e.widgetChromeEventRouter,isAuthoringMode:e.layoutController.isAuthoring,additionalWidgetData:e.additionalWidgetData,layoutAPI:e.getAPI()}),e._triggerChromeEvents(t.widget,e.widgetChromeEventRouter))})),e._prepareAsyncCallback((function(i){i.errorCode===(e.layoutController.widgetLoader&&e.layoutController.widgetLoader.ERROR.WIDGET_ALREADY_LOADED)?(e._widgetAlreadyLoadedCallback(),t()):i.exception?n(i.exception):n(new Error(i.errorCode))})),o,i).then((function(){t()}))}}))},_widgetAlreadyLoadedCallback:function(){var e=this.layoutController.widgetLoader.getWidget(this.id);e&&(e.onContainerReady&&e.onContainerReady({model:this.widgetModel,widgetChromeEventRouter:this.widgetChromeEventRouter,isAuthoringMode:this.layoutController.isAuthoring,layoutAPI:this.getAPI()}),this._triggerChromeEvents(e))},_triggerChromeEvents:function(e){this.widgetChromeEventRouter&&(this.widgetChromeEventRouter.trigger("widget:ready",{widget:e,widgetAPI:e.getAPI()}),this._triggerRenderComplete(e))},_triggerRenderComplete:function(e){e.whenRenderComplete?e.whenRenderComplete().then(this._prepareAsyncCallback(function(){this.widgetChromeEventRouter.trigger("widget:renderComplete",{widget:e}),this.eventRouter.trigger("widget:renderComplete",{widget:e})}.bind(this))):(this.widgetChromeEventRouter.trigger("widget:renderComplete",{widget:e}),this.eventRouter.trigger("widget:renderComplete",{widget:e}))},_prepareAsyncCallback:function(e){return function(){return this._destroyed?Promise.reject("The live widget object was destroyed"):e.apply(void 0,arguments)}.bind(this)},getAPI:function(){var e=this,t=s.inherited("getAPI",this,arguments);return this.widgetTitleView&&(t.updateTitle=this.widgetTitleView.updateTitle.bind(this.widgetTitleView),t.setTitleBadge=this.setTitleBadge.bind(this),t.onTitleBadgeClick=this.onTitleBadgeClick.bind(this),t.offTitleBadgeClick=this.offTitleBadgeClick.bind(this),t.offFocus=this.widgetTitleView.onChromeOffFocus.bind(this.widgetTitleView)),t.getEditingActionList=function(){return e.widgetTitleView?e.widgetTitleView.getEditingActionList():e.widget&&e.widget.getEditingActionList?e.widget.getEditingActionList():[]},t},setTitleBadge:function(e,n){var i=this;if(this.$badgeContainer.empty(),e){var o=t("<div></div>",{tabindex:0,class:"titleBadge","aria-label":n,"walkme-data-id":"titleBadge"});o.text(e),this.$badgeContainer.append(o),o.on("clicktap keydown",(function(e){"keydown"===e.type&&13!==e.which||i._layoutEvents.trigger("titlebadge:click",{event:e})}))}},onTitleBadgeClick:function(e,t){this._layoutEvents.on("titlebadge:click",e,t)},offTitleBadgeClick:function(e,t){this._layoutEvents.off("titlebadge:click",e,t)},onFocusOut:function(){var e=!1,n=function(t){t.target!==this.domNode&&(e=!0)}.bind(this);t(this.domNode).on("focusin.widgetFocus",n),setTimeout(function(){e||this._exitContainer()}.bind(this),10)},onKeyDown:function(e){return e.keyCode===r.F10||e.ctrlKey&&e.keyCode===r.X?(this.onMaximize(),!1):e.keyCode===r.F12&&!e.shiftKey||e.ctrlKey&&e.keyCode===r.NUM1?(this.isEnterContainer=!0,this.widgetChromeEventRouter.trigger("widget:onEnterContainer"),t(this.domNode).on("focusout.widgetFocus",this.onFocusOut.bind(this)),e.stopPropagation(),e.preventDefault(),!1):e.keyCode===r.F12&&e.shiftKey||e.ctrlKey&&e.keyCode===r.NUM0?(this._exitContainer(),t(this.domNode).focus(),e.stopPropagation(),e.preventDefault(),!1):e.keyCode!==r.SPACE&&e.keyCode!==r.ENTER||!t.contains(this.domNode,e.target)?e.keyCode!==r.LEFT_ARROW&&e.keyCode!==r.RIGHT_ARROW&&e.keyCode!==r.UP_ARROW&&e.keyCode!==r.DOWN_ARROW||!t.contains(this.domNode,e.target)?void 0:(new A(e).setProperty("preventMoveAction",!0),!0):(new A(e).setProperty("preventWidgetSelection",!0),!0)},_exitContainer:function(){this.isEnterContainer&&(this.widgetChromeEventRouter.trigger("widget:onExitContainer"),this.isEnterContainer=!1,t(this.domNode).off("focusout"))},notifyWidget:function(e,t){this.widgetChromeEventRouter.trigger(e,t)},widgetReady:function(){return this._widgetReady.promise},whenRenderComplete:function(){return this._widgetRenderComplete.promise},_registerWidgetChromeEvents:function(){this.widgetChromeEventRouter_disposeEvents.push(this.widgetChromeEventRouter.on("widget:updateLayout",this.updateModel,this),this.widgetChromeEventRouter.on("layout:getPageFillColor",this.getPageFillColor,this),this.widgetChromeEventRouter.on("widget:setPreferredSize",this.setPreferredSize,this),this.widgetChromeEventRouter.on("widget:getSize",this.getSize,this),this.widgetChromeEventRouter.on("widget:showError",this.sizeToErrorContainer,this),this.widgetChromeEventRouter.on("widget:clearError",this.resizeToModel,this),this.widgetChromeEventRouter.on("widget:updateDescription",this.updateDescription,this),this.widgetChromeEventRouter.on("widget:addIcon",this.addIcon,this),this.widgetChromeEventRouter.on("widget:onShowAttachedView",this.onShowAttachedView,this),this.widgetChromeEventRouter.on("widget:onHideAttachedView",this.onHideAttachedView,this),this.widgetChromeEventRouter.on("widget:setLayoutProperties",this.setLayoutProperties,this),this.widgetChromeEventRouter.on("title:resizeViz",(function(){this.onResize({force:!0})}),this),this.widgetChromeEventRouter.on("title:resetTitle",this.recreateHeader,this),this.widgetChromeEventRouter.on("widget:ready",this.onWidgetReady,this),this.widgetChromeEventRouter.on("widget:renderComplete",this.onWidgetRenderComplete,this))},onWidgetReady:function(e){this.widget=e.widget,this.widgetAPI=e.widgetAPI,this._widgetReady.resolve(e.widgetAPI)},onWidgetRenderComplete:function(){this._widgetRenderComplete.resolve()},getPageFillColor:function(e){for(var t=this.model.getParent(),n=null;t&&!n;)t.fillColor&&"transparent"!==t.fillColor&&(n=t.fillColor),t=t.getParent();e.fillColor=n},sizeToErrorContainer:function(e){var t=this;n.isUndefined(this._errorStyle)&&(this._errorStyle={}),n.each(e,(function(e,n){t._errorStyle[n]=e})),n.isEmpty(this._errorStyle)?this.logger.warn("no error style to apply"):this.$el.css(this._errorStyle)},resizeToModel:function(){var e=this.model.style,t={};this._errorStyle&&(t=n.clone(this._errorStyle),n.each(t,(function(e,n){t[n]=""})),delete this._errorStyle),e&&(t.height=e.height,t.width=e.width,this.model.style.opacity&&(t.opacity=this.model.style.opacity)),n.isEmpty(t)||this.$el.css(t)},setPreferredSize:function(e){var t=e.preferredSize.height+"px",i=e.preferredSize.width+"px",o=this.visPreferredSize&&!n.isEqual(this.visPreferredSize,e.preferredSize),r=this.model.style;!!!(r&&r.height&&r.width)||o&&!this._isWidgetInDropZone()?e.options.undoRedoTransactionId?this._updateModel({undoRedoTransactionId:e.options.undoRedoTransactionId,transactionToken:e.options&&e.options.transactionToken,triggerResize:!1},this,{height:t,width:i}):this._updateModel({triggerResize:!1},null,{height:t,width:i}):this.$el.css({height:this.model.style.height,width:this.model.style.width}),this.visPreferredSize=e.preferredSize},getSize:function(e){var t,n,i=this.$el.find(".widgetContent"),o=this.model.style;this._getHiddenLayoutParents().length>0?(t=o.width,n=o.height):(t=i.innerWidth(),n=i.innerHeight()),e.deferred&&e.deferred.resolve({top:o.top||0,left:o.left||0,width:t,height:n})},_getHiddenLayoutParents:function(){return this.$el.parents().filter((function(){return"none"===t(this).css("display")}))},_isWidgetInDropZone:function(){for(var e=this.model,t=this.model.getParent(),n=!1;t&&"genericPage"!==t.type;)e=t,t=t.getParent();t&&e.relatedLayouts&&("templateDropZone"===t.findChildItem(t.items,e.relatedLayouts).type&&(n=!0));return n},updateModel:function(e){this.model.updateModel({updateArray:[{id:this.id,style:{height:t(this.domNode).outerHeight()+"px",width:t(this.domNode).outerWidth()+"px"}}]},this,e.payloadData)},_updateModel:function(e,t,n){if(n){var i={height:n.height,width:n.width};void 0!==n.opacity&&(i.opacity=n.opacity),this.model.updateModel({updateArray:[{id:this.model.id,style:i}]},t,e)}},_establishCanvasConnection:function(e){this.widgetOwnsTitle=!this.widgetRegistry||this.widgetRegistry.ownTitle,this.canvasNotifier.trigger("widget:addDone",{id:this.id,widgetChromeEventRouter:this.widgetChromeEventRouter,isAuthoringMode:this.isAuthoringMode,domNode:this.domNode,additionalWidgetData:e,layoutAPI:this.getAPI(),widget:this})},updateDescription:function(e){this._nWidgetDescription?this._nWidgetDescription.text(e.value):this.$el.attr("aria-label",e.value)},_getDescriptionDomNodeId:function(){return this.domNode.id+"Description"},recreateHeader:function(e){this._removeHandlers.forEach((function(e){return e.remove()})),this._removeHandlers=[],this._createHeader(e.widgetTitleView)},_processHeaderMode:function(e){var t=this,n=this.dashboardApi.getFeature("Canvas.internal");n&&n.whenContentReady(this.content.getId()).then((function(){t._destroyed?console.info("widget was destroyed before the associated content is ready"):t._showHideTitleBasedOnHeaderMode(e)}))},_showHideTitleBasedOnHeaderMode:function(e){var t=this,n=this.content,i=n.getPropertyValue("headerMode"),o=n.getPropertyValue("showTitle");if("titleOnly"===i&&"boolean"==typeof o){!1===o&&e.classList.add("hidden");var r=n.on("change:property:showTitle",(function(e){var i=n.getFeature("ContentViewDOM").getNode().getElementsByClassName("widgetHeader")[0];!0===e.info.value?i.classList.remove("hidden"):i.classList.add("hidden"),t.widgetChromeEventRouter.trigger("title:resizeViz")}));this._removeHandlers.push(r)}},_createHeader:function(e){this.widgetRegistry?(this.createContentNode=this.widgetRegistry.createContentNode,this.supportsTitle=this.createContentNode&&!this.widgetRegistry.disableTitle,this.createDescriptionNode=this.createContentNode||!!this.widgetRegistry.createDescriptionNode):this.createContentNode=this.supportsTitle=this.createDescriptionNode=!0;var n=void 0;if(this.createDescriptionNode&&(this._nWidgetDescription=t("<div></div>",{id:this._getDescriptionDomNodeId(),class:"ariaLabelNode hidden"}),this.$el.append(this._nWidgetDescription),n=this._getDescriptionDomNodeId()),this.createContentNode){var o=t("<div></div>",{class:"widgetHeader"});if(this.supportsTitle){var r=this.dashboardApi.getAppConfig("interactions")||{},a=void 0===r.editTitle||!0===r.editTitle||"true"===r.editTitle;if(this._processHeaderMode(o[0]),e)this.widgetTitleView=e;else{this.widgetTitleView=new i({id:this.domNode.id,header:o,canEditTitle:a,widgetModel:this.widgetModel,widgetChromeEventRouter:this.widgetChromeEventRouter,dashboardApi:this.dashboardApi});var A=!(!this.widgetModel||this.widgetModel.showTitle);this.widgetTitleView.render(A)}this.$el.addClass("titleSupported"),n+=" "+this.widgetTitleView.titleId,o.prepend(this.widgetTitleView.getStyleNode());var s=t("<div></div>",{class:"widgetIcons"});this.$badgeContainer=t("<div></div>",{class:"badgeContainer"}),o.append(this.$badgeContainer),o.append(s)}this.$widgetContentWrapper.prepend(o)}n&&this.$el.attr("aria-labelledby",n)},_createAttachedView:function(){var e=this.domNode.id+"_attachedView",n=t("<div></div>",{id:e,class:"attachedView"});this.$widgetContentWrapper.append(n),this.$attachedView=n},_createFilterGroupOverlay:function(){var e=this.domNode.id+"_eventGroupOverlay",n=t("<div></div>",{id:e,class:"eventGroupOverlay"}),i=t("<div></div>",{class:"eventGroupOverlayContent"});n.append(i),this.$widgetContentWrapper.append(n)},onShowAttachedView:function(e){this.$attachedView.html(e.$el).addClass("expanded")},onHideAttachedView:function(){this.$attachedView.removeClass("expanded").empty()},destroy:function(e){t(this.domNode).off("keydown.widgetKeydown"),t(this.domNode).off(".widgetFocus"),this._destroyAuthoringHelper(),this._removeHandlers.forEach((function(e){return e.remove()})),this._removeHandlers=[],this.nHandle=null,this.canvasNotifier&&this.canvasNotifier.trigger("widget:removeDone",n.extend(e||{},{id:this.model.id,widget:this})),this.widgetTitleView&&(this.widgetTitleView.remove(),this.widgetTitleView=null),this.widget=null,this.widgetAPI=null,this._destroyed=!0,s.inherited("destroy",this,arguments)},_triggerWidgetChromeEvent:function(e,t){this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger(e,t)},onResize:function(){s.inherited("onResize",this,arguments),this._triggerWidgetChromeEvent("widget:onResize","object"===_typeof(arguments[0])?arguments[0]:{})},onSelect:function(){this._triggerWidgetChromeEvent("widgetchrome:selected")},onDeselect:function(){this._triggerWidgetChromeEvent("widgetchrome:deselected")},onShow:function(e){s.inherited("onShow",this,arguments),this._triggerWidgetChromeEvent("widget:onShow",e)},onHide:function(){s.inherited("onHide",this,arguments),this._triggerWidgetChromeEvent("widget:onHide")},onMaximize:function(){this._triggerWidgetChromeEvent("widget:onMaximize")},setLayoutProperties:function(e){this.$el.toggleClass("noRotate",!!e.noRotate),this.$el.toggleClass("mobilePannable",!!e.mobilePannable),this.$el.toggleClass("pannable",!!e.pannable),this.$el.toggleClass("maximizable",!!e.maximizable)},addIcon:function(e){this.icons[e.name]&&this.icons[e.name].widgetIcon.detach(),e.location?e.location.append(e.widgetIcon):this.$el.find(".widgetIcons").append(e.widgetIcon),this.icons[e.name]=e},getContextToolbarItems:function(){var e=[];if(this.widgetAPI&&!this.widgetAPI.getError()){var t=this.widgetAPI.getContextToolbarItems();e=e.concat(t)}return{items:e}},_getLayoutOpacity:function(){return this.model.style.opacity||0===this.model.style.opacity?this.model.style.opacity:"1"},getWidgetAPI:function(){return this.widgetAPI}});return s})),define("dashboard-core/js/dashboard/layout/views/LayoutApi",["../../../lib/@waca/core-client/js/core-client/ui/core/Class"],(function(e){var t=e.extend({model:null,controller:null,init:function(e){this.model=e.model,this.controller=e,this.layoutController=e.layoutController},getId:function(){return this.model.id},getChildren:function(){var e=this;return this.model.items.map((function(t){var n=t.id,i=e.layoutController.getView(n);if(i&&i.view&&i.view.getAPI)return i.view.getAPI()})).filter((function(e){return!!e}))},render:function(e){this.controller.render(e)},getSelfRatio:function(){return this.controller.getSelfRatio()},getParentLayout:function(){return this.controller.getParentLayout()},getWidgetAPI:function(){return this.controller.widgetAPI}});return t.API_METHODS=["getId","getChildren","render","getSelfRatio","getParentLayout","getWidgetAPI"],t})),define("dashboard-core/js/dashboard/glass/services/DashboardPinningService",["../../../lib/@waca/core-client/js/core-client/ui/core/Events","../../../app/nls/StringResources","underscore","../../../lib/@waca/core-client/js/core-client/i18n/Formatter","moment-timezone"],(function(e,t,n,i,o){return function(e){function r(){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,e.call(this,arguments));return t.PIN_VERSION="3",t.PIN_URL="v1/users/~/pins",t.TIMEOUT=6e3,t.EXTENDEDTIMEOUT=1e3,t._pinIdsToUpgradeInCM=[],t._timeframePinBuckets=null,t._timeframePinBucketNames=["all","today","yesterday","pastWeek","pastMonth","earlier"],t._pinIdMap={},t}return _inherits(r,e),r.prototype.initialize=function(e){var t=this,n=e.appController;return this._glassContext=n.glassContext,this._glassContext.getSvc(".UpgradeService").then((function(e){t._latestDashboardSpecVersion=e.getLatestDashboardSpecVersion();var n=t._glassContext.getCoreSvc(".UserProfile");t._timezone=n.preferences.timeZoneID||"America/New_York",t._today=o().tz(t._timezone).startOf("day"),t._yesterday=t._today.clone().subtract(1,"days"),t._pastWeek=t._today.clone().subtract(7,"days"),t._pastMonth=t._today.clone().subtract(31,"days")}))},r.prototype.getCachedPins=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return this._timeframePinBuckets[e]||[]},r.prototype.getPins=function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return this._timeframePinBuckets?Promise.resolve(this._timeframePinBuckets[n]):this._glassContext.getCoreSvc(".Ajax").ajax({url:this.PIN_URL,type:"GET",contentType:"application/json; charset=utf-8",dataType:"json"}).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e._timeframePinBuckets={all:[],today:[],yesterday:[],pastWeek:[],pastMonth:[],earlier:[]},e._upgradePinsLocally(t.data)})).then((function(t){var i=e._sortPins(t);return e._prepPinsForUI(i),e._cachePinsInAppropriateTimeFrameBuckets(i),e._slowlySaveUpgradedPinsInCM(),e._timeframePinBuckets[n]})).catch((function(n){e._glassContext.getCoreSvc(".Logger").error("Failed to get pins",n);var i=e._retrieveErrorMessage({result:n,defaultMessage:t.get("pinRetrieveError")});return e._glassContext.appController.showErrorMessage(i,t.get("pinErrorTitle")),[]}))},r.prototype.getPin=function(e){return this._pinIdMap[e]?Promise.resolve(this._pinIdMap[e]):this.getPins().then((function(t){return n.find(t,(function(t){return t.id===e}))}))},r.prototype.addPin=function(e){var n=this;e.version=this.PIN_VERSION;var i=JSON.stringify(e);return this._glassContext.getCoreSvc(".Ajax").ajax({type:"POST",url:this.PIN_URL,contentType:"application/json; charset=utf-8",dataType:"json",data:i}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;return n._prepPinsForUI([t]),n._addPinToCache(t,["all","today","pastWeek","pastMonth"],!0),n.trigger("pin:created",t),t})).catch((function(e){var i=n._retrieveErrorMessage({result:e,defaultMessage:t.get("contentPinFailOld")}),o=new Error(i);throw n._glassContext.getCoreSvc(".Logger").error("addPin error",o),o}))},r.prototype.deletePin=function(e,n){var i=this;return new Promise((function(o,r){try{if(i._glassContext.getCoreSvc(".UserProfile").preferences.accessibilityFeatures)i._glassContext.appController.showMessage(t.get("deletePinConfirmationMessage"),t.get("deletePinConfirm"),"info",["ok","cancel"],void 0,(function(t){"ok"===t.btn&&(i._removePinFromCache(e),i._completePinDelete(e)),o()}));else{var a=i._removePinFromCache(e);a.removedPin||i._glassContext.getCoreSvc(".Logger").error("Trying to remove a pin that is not in our array",e,i);var A=!1;i._glassContext.appController.showToast(t.get("pinDeletedToast"),{type:"info",btnLabel:t.get("undo"),callback:function(){A=!0,i._addPinToCache(a.removedPin,a.timeframeBucketNames,!1,!0),n(e)},newestOnTop:!0,preventDuplicates:!1,timeOut:i.TIMEOUT,extendedTimeOut:i.EXTENDEDTIMEOUT,onHidden:function(){A||i._completePinDelete(e),o(A)}})}}catch(e){r(e)}}))},r.prototype.renamePin=function(e,n,i){var o=this;return new Promise((function(r,a){try{var A=o._renamePinInCache(e,n),s=!1;o._glassContext.appController.showToast(t.get("pinRenamedToast"),{type:"info",btnLabel:t.get("undo"),callback:function(){s=!0,o._renamePinInCache(e,A.prevName),i()},newestOnTop:!0,preventDuplicates:!1,timeOut:o.TIMEOUT,extendedTimeOut:o.EXTENDEDTIMEOUT,onHidden:function(){s||o._completePinRename(e),r(s)}})}catch(e){a(e)}}))},r.prototype._completePinDelete=function(e){var n=this;return this._pinIdsToUpgradeInCM=this._pinIdsToUpgradeInCM.filter((function(t){return t!==e})),this._glassContext.getCoreSvc(".Ajax").ajax({type:"DELETE",url:this.PIN_URL+"/"+e,contentType:"application/json; charset=utf-8",dataType:"json"}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).catch((function(e){var i=n._retrieveErrorMessage({result:e,defaultMessage:t.get("pinDeleteErrorOld")}),o=new Error(i);throw n._glassContext.appController.showErrorMessage(i,t.get("pinErrorTitle")),n._glassContext.getCoreSvc(".Logger").error("deletePin error",o),o}))},r.prototype._completePinRename=function(e){var n=this;return this.getPin(e).then((function(i){var o=JSON.stringify(i);return n._glassContext.getCoreSvc(".Ajax").ajax({type:"PUT",url:n.PIN_URL+"/"+e,contentType:"application/json; charset=utf-8",dataType:"json",data:o}).catch((function(e){var i=n._retrieveErrorMessage({result:e,defaultMessage:t.get("pinRenameFail")}),o=new Error(i);throw n._glassContext.getCoreSvc(".Logger").error("renamePin error",o),o}))}))},r.prototype._slowlySaveUpgradedPinsInCM=function(){var e=this,t=this._pinIdsToUpgradeInCM.shift();return t?this.getPin(t).then((function(n){return e._glassContext.getCoreSvc(".Logger").info("Updating upgraded pin spec in CM",n),e._glassContext.getCoreSvc(".Ajax").ajax({type:"PUT",url:e.PIN_URL+"/"+t,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(n)}).then((function(){return e._slowlySaveUpgradedPinsInCM()})).catch((function(t){e._glassContext.getCoreSvc(".Logger").error("Pin upgrade failed to save in CM.",t)}))})):Promise.resolve()},r.prototype._removePinFromCache=function(e){var t=this;this._pinIdMap&&delete this._pinIdMap[e];var n=[],i=null;if(this._timeframePinBuckets){this._timeframePinBucketNames.forEach((function(o){t._timeframePinBuckets[o]=t._timeframePinBuckets[o].filter((function(t){return function(t,o){return t.id!==e||(i=t,n.push(o),!1)}(t,o)}))}))}return{removedPin:i,timeframeBucketNames:n}},r.prototype._renamePinInCache=function(e,t){var n={newName:t};return this._pinIdMap&&this._pinIdMap[e]&&t&&(n.prevName=this._pinIdMap[e].displayName,this._pinIdMap[e].displayName=t,n.updatedPin=this._pinIdMap[e]),n},r.prototype._addPinToCache=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._timeframePinBucketNames,n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._timeframePinBuckets&&(this._pinIdMap[e.id]=e,t.forEach((function(t){i?n._timeframePinBuckets[t].unshift(e):n._timeframePinBuckets[t].push(e),o&&n._sortPins(n._timeframePinBuckets[t])})))},r.prototype._retrieveErrorMessage=function(e){var t=(e=e||{}).defaultMessage;try{t=JSON.parse(e.result.responseText).error}catch(e){}return t},r.prototype._prepPinsForUI=function(e){var t=this,n=this._getCurrentContentViewDashboardApi().getDashboardCoreSvc(".SmartNamingSvc");e.forEach((function(e){e.timestamp&&(e.pinAge=i.formatDateTime(e.timestamp,{type:"datetime",formatLength:"short",timezone:t._timezone})),e.displayName||(e.displayName=n.getPinName(e)),e.thumbUri||(e.defaultImage="wfg_pin")}))},r.prototype._cachePinsInAppropriateTimeFrameBuckets=function(e){var t=this;e.forEach((function(e){var n=o.tz(e.timestamp,t._timezone);t._timeframePinBuckets.all.push(e);var i=null;i=n.isSame(t._today,"day")?["today","pastWeek","pastMonth"]:n.isSame(t._yesterday,"day")?["yesterday","pastWeek","pastMonth"]:n.isAfter(t._pastWeek)?["pastWeek","pastMonth"]:n.isAfter(t._pastMonth)?["pastMonth"]:["earlier"],t._addPinToCache(e,i)}))},r.prototype._sortPins=function(e){return e.sort((function(e,t){var n=e.timestamp,i=t.timestamp;return n>i?-1:n<i?1:0}))},r.prototype._upgradePinsLocally=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={ajaxSvc:this._glassContext.getCoreSvc(".Ajax"),services:this._getCurrentContentViewServices(),logger:this._glassContext.getCoreSvc(".Logger"),pinUpgrade:!0,glassContext:this._glassContext,dashboardApi:this._getCurrentContentViewDashboardApi(),showErrorToast:!1},i=[];return this._glassContext.getSvc(".UpgradeService").then((function(o){return t.forEach((function(t){t.content&&t.content.specVersion!==e._latestDashboardSpecVersion&&i.push(t)})),i.length>0&&console.log(i.length+" pins to upgrade."),new Promise((function(r){i.reduce((function(t,i){return t.then((function(){try{return e._upgradePinSpec(i,o,n).then((function(){e._pinIdsToUpgradeInCM.push(i.id)})).catch((function(t){e._glassContext.getCoreSvc(".Logger").error("Unable to upgrade pin:",i,"Failed with error: ",t)}))}catch(t){e._glassContext.getCoreSvc(".Logger").error("Unable to upgrade pin:",i,"Failed with error: ",t)}}))}),Promise.resolve([])).then((function(){r(t)}))}))}))},r.prototype._upgradePinSpec=function(e,t,i){var o=this,r={version:e.version?e.content.specVersion:6,layout:e.content.layout,widgets:this._getObjectFromArrayById(e.content.widgets)};e.content.datasetShapings?r.datasetShaping=this._getObjectFromArrayById(e.content.datasetShapings):e.content.datasetShaping&&(r.datasetShaping=this._getObjectFromArrayById(e.content.datasetShaping)),e.content.dataSources&&(r.dataSources=e.content.dataSources),e.content.episodes&&(r.timeline={episodes:this._getObjectFromArrayById(e.content.episodes)});var a=e.content.upgrades||[],A=r.version;return-1===a.indexOf(A)?(a.push(A),e.content.upgrades=a):this._glassContext.getCoreSvc(".Logger").warn('Pin spec with id "'+e.id+'" and board spec version "'+e.content.specVersion+'" being upgraded to an previously upgraded spec version: ',A),t.upgrade(r,null,i).then((function(t){var i={layout:t.layout,widgets:n.toArray(t.widgets),specVersion:t.version,upgrades:a};return t.dataSources&&(i.dataSources=t.dataSources),e.content.episodes&&(i.episodes=n.toArray(t.timeline.episodes)),t.datasetShaping&&(i.datasetShaping=n.toArray(t.datasetShaping)),e.content=i,e.version=o.PIN_VERSION,e})).catch((function(t){if(t.obj)return o._glassContext.getCoreSvc(".Logger").warn("Pin spec did not fully upgrade",t,e),t.obj;throw t}))},r.prototype._getObjectFromArrayById=function(e){return n.object(n.map(e,(function(e){return[e.id,e]})))},r.prototype._getCurrentContentViewDashboardApi=function(){try{return this._glassContext.appController.currentAppView.currentContentView.getDashboardApi()}catch(e){this._glassContext.getCoreSvc(".Logger").error("Trying to use the pinning service outside of a dashboard.",e)}},r.prototype._getCurrentContentViewServices=function(){try{return this._glassContext.appController.currentAppView.currentContentView.services}catch(e){this._glassContext.getCoreSvc(".Logger").error("Trying to use the pinning service outside of a dashboard.",e)}},r}(e)})),define("dashboard-core/js/dashboard/services/thumbnail/ThumbnailStore",["../../../lib/@waca/core-client/js/core-client/ui/core/Events"],(function(e){var t=e.extend({_items:null,init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.inherited("init",this,[]),this._items=e},exists:function(e){return void 0!==this._items[e]},set:function(e,t){var n={data:t.data,cacheId:t.cacheId};return this._items[e]=n,this.trigger("thumbnailStore:set",{id:e,item:n}),this},setError:function(e,t){var n=t.message,i=void 0;return this.exists(e)?(i=this.getLocal(e)).error={message:n}:(i={error:{message:n}},this._items[e]=i),this.trigger("thumbnailStore:set",{id:e,item:i}),this},setWarning:function(e,t){var n=t.message,i=void 0;return this.exists(e)?(i=this.getLocal(e)).warning={message:n}:(i={warning:{message:n}},this._items[e]=i),this.trigger("thumbnailStore:set",{id:e,item:i}),this},getLocal:function(e){return this._items[e]},getAllLocal:function(){var e=this;return Object.keys(this._items).map((function(t){return{id:t,item:e._items[t]}}))},get:function(e,t){return this.exists(e)?Promise.resolve(this.getLocal(e)):this.getVisTypeDefault(t)},delete:function(e){return delete this._items[e],this.trigger("thumbnailStore:delete",{id:e}),this},getVisTypeDefault:function(){return Promise.resolve()}});return t})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("jquery"),require("underscore"),require("canvgModule"),require("baglass/core-client/js/core-client/utils/BrowserUtils"));else if("function"==typeof define&&define.amd)define("dashboard-core/js/lib/@waca/image-capture/dist/js/bundles/image-capture.min",["jquery","underscore","canvgModule","baglass/core-client/js/core-client/utils/BrowserUtils"],t);else{var n="object"==typeof exports?t(require("jquery"),require("underscore"),require("canvgModule"),require("baglass/core-client/js/core-client/utils/BrowserUtils")):t(e.jquery,e.underscore,e.canvgModule,e["baglass/core-client/js/core-client/utils/BrowserUtils"]);for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}("undefined"!=typeof self?self:this,(function(e,t,n,i){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/bundles",t(t.s=0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=i(n(1)),A=i(n(2)),s=i(n(3)),l=i(n(4)),c=i(n(6)),d={"box-sizing":!0,border:!0,background:!0,color:!0,"clip-path":"none","fill-opacity":!0,fill:"rgb(0, 0, 0)","font-family":!0,"font-size":!0,"font-style":"normal",height:"auto",left:"auto","line-height":!0,opacity:!0,overflow:!0,position:!0,"shape-rendering":"auto","stroke-width":!0,stroke:!0,"text-align":!0,"text-anchor":"start","text-size-adjust":"100%",top:"auto","transform-origin":!0,"transform-style":!0,transform:"none","vertical-align":!0,visibility:"visible",width:"auto"},u={transparent:!0,"rgba(0, 0, 0, 0)":!0},h=/url\("?([^)"]+)"?\)/i,g=/(^http[s]?:\/\/)|(^\/\/)|(^data:image\/)|(^blob:)/i,f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=t.UniqueId,i=t.elementMap,r=t.excludeClassList,a=t.html2canvas,d=t.canvg,u=t.logging;this.isSafari=c.default.isSafari(),this._uniqueId=n||A.default.uniqueId,this.elementMap=i||{},this.excludeClassList=r||[],this.imgWithSVG=["snapshot","clsVcSlotImg"],this.html2canvas=a||l.default,this.canvg=d||s.default,this.logging=u||!1,this.glassLogger=t.glassLogger,this.proxy=t.proxy,window&&window.getComputedStyle?this._fComputeStyle=window.getComputedStyle.bind(window):this._fComputeStyle=function(e){return e.currentStyle||e.style},this.patchSVG=this.isSafari?function(e){return e.replace(/ NS[0-9]+:href/gi," href")}:function(e){return e}}return r(e,[{key:"serialize",value:function(e){return e.outerHTML}},{key:"destroy",value:function(){}},{key:"generateImage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(i,o){var r=null,a=e.ownerDocument,s=a.location,l=s.pathname.split("/");l[l.length-1]="";var c=A.default.extend({resolve:i,reject:o,node:e,attribute:t._uniqueId.get("data-generate-image-"),origin:s.origin||s.protocol+"//"+s.host,pathname:l.join("/"),waits:[]},n);e.setAttribute(c.attribute,"true"),a.querySelector("base")||((r=a.createElement("base")).href=t._makeAbsoluteUrl(c.origin,c.pathname,""),a.head.insertBefore(r,a.head.firstElementChild));var d={async:!0,onclone:t._html2canvas_onCloned.bind(t,c),ignoreElements:t._html2canvas_onIgnoreElements.bind(t,c),allowTaint:!1,scale:1,useCORS:!1,logging:t.logging,proxy:t.proxy,width:n.width,height:n.height,backgroundColor:null},u=function(t){return r&&r.remove(),e.removeAttribute(c.attribute),t};t._log("calling html2canvas..."),t.html2canvas(e,d).then(u,u).then(t._html2canvas_onRendered.bind(t,c)).catch(o)}))}},{key:"_processNodeClass",value:function(e,t,n){var i=(0,a.default)(n),o=this._createCanvas(i);i.children().detach(),i.append(o),this._svg2canvg(o,t)}},{key:"_processIMGWithSVG",value:function(e,t){var n=this,i=t.getAttribute("src");if(i){var o=this._makeAbsoluteUrl(e.origin,e.pathname,i);e.waits.push(a.default.ajax({url:o,type:"GET",dataType:"text"}).then((function(e){e=e.replace(/(\r\n|\n|\r|\t)/gm,"");var i=(0,a.default)(e);if(i.is("svg")){var o=(0,a.default)(t);i[0].setAttribute("height",t.offsetHeight+"px"),i[0].setAttribute("width",t.offsetWidth+"px");var r=n._svg2canvas(i[0],!0);(0,a.default)(r).attr("class",o.attr("class")).css("height","auto"),t.parentNode.replaceChild(r,t)}else n._log("warning: resource url is not an svg.")})).catch((function(e){n._log("warning: failed to retrieve resource from url "+o+".",e)})))}}},{key:"_removeNode",value:function(e){e&&e.remove()}},{key:"_processNodeIMG",value:function(e,t){var n=this;if(!this.imgWithSVG.some((function(e){return t.classList.contains(e)}))){var i=t.getAttribute("src");i&&!g.test(i)&&e.waits.push(new Promise((function(o){t.complete&&t.naturalWidth>0?o():(t.addEventListener("load",o),t.addEventListener("error",o),t.src=n._makeAbsoluteUrl(e.origin,e.pathname,i))})))}}},{key:"_processNodeSVG",value:function(e,t){this._replaceSvgWithBackground(e,t)||this._svg2canvas(t)}},{key:"_processNodeLINK",value:function(e,t){var n=this,i=t.getAttribute("href");i&&!g.test(i)&&e.waits.push(new Promise((function(o){t.sheet&&t.sheet.cssRules&&t.sheet.cssRules.length?o():(t.addEventListener("load",o),t.addEventListener("error",o),t.href=n._makeAbsoluteUrl(e.origin,e.pathname,i))})))}},{key:"_svg2canvas",value:function(e,t){var n=(0,a.default)(e);if((t||n.is(":visible"))&&!this._hasOnlyDefs(n)){var i=this._svg2text(e,t),o=this._createCanvas(n),r=n.attr("class");return r&&o.setAttribute("class",r),this._svg2canvg(o,i),e.parentNode.replaceChild(o,e),o}return null}},{key:"_applyStyles",value:function(e,t){var n=this;if(e.style.cssText=this._inlineStyles(e),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),t)return e;for(var i=e.getElementsByTagName("*"),o={},r=[],a=0,s=i.length;a<s;a++){var l=i[a];switch(l.style&&(l.style.cssText=this._inlineStyles(l)),l.tagName.toLowerCase()){case"clippath":"defs"!==l.parentNode.tagName.toLowerCase()&&r.push(l);break;case"use":for(var c=0,d=l.attributes.length;c<d;c++){var u=l.attributes[c],h=u.name,g=u.value;if("href"==h||h.match(/:href$/)){if("#"===g[0]&&!o[g]){var f=g.substr(1),p=e.ownerDocument.getElementById(f);if(p){if("symbol"!==p.tagName.toLowerCase()){var m=e.ownerDocument.createElement("symbol");p.removeAttribute("id"),p.parentNode.replaceChild(m,p),m.appendChild(p),m.setAttribute("overflow","visible"),m.setAttribute("id",f),p=m}o[g]=p}else this._log("Warning: did not found svg symbol with id",f)}break}}}}if(!A.default.isEmpty(o)||r.length>0){var C=e.ownerDocument.createElement("defs"),B=[];Object.keys(o).forEach((function(e){var t=o[e].cloneNode(!0);C.appendChild(t),B.push(t)})),r.forEach((function(e){return C.appendChild(e)})),e.insertBefore(C,e.childNodes[0]),r.length>0?e.style.cssText=this._inlineStyles(e,["fill"]):B.forEach((function(e){return n._applyStyles(e)}))}return e}},{key:"_svg2text",value:function(e,t){return this.patchSVG(this.serialize(this._applyStyles(e,t)))}},{key:"_svg2canvg",value:function(e,t){try{this.canvg(e,t,{ignoreMouse:!0,ignoreAnimation:!0})}catch(e){this._log("canvg is throwing an error",e)}e.svg.stop()}},{key:"_inlineStyles",value:function(e,t){var n=[],i=this._fComputeStyle(e);t=t||[];for(var o=0,r=i.length;o<r;o++){var a=i[o];!d[a]||!0!==d[a]&&d[a]===i[a]||-1!==t.indexOf(a)||n.push(a+":"+i[a])}return n.join(";")}},{key:"_createCanvas",value:function(e){var t=e[0].ownerDocument.createElement("canvas");return t.width=e.width(),t.height=e.height(),t}},{key:"_replaceSvgWithBackground",value:function(e,t){if(t.style.backgroundImage){var n=t.style.backgroundImage.match(h);if(n&&2===n.length){var i=n[1],o=t.ownerDocument.createElement("div");return o.style.display="inline-block",o.style.width=t.style.width,o.style.height=t.style.height,o.className=t.className.baseValue?t.className.baseValue:t.className,o.style.backgroundImage="url("+i+")",t.parentNode.replaceChild(o,t),!0}}return!1}},{key:"_hasOnlyDefs",value:function(e){var t=e.children();return 1===t.length&&"defs"===t[0].tagName}},{key:"_hasOnlySvgs",value:function(e){return(0,a.default)(e).children("svg").length>0}},{key:"_makeAbsoluteUrl",value:function(e,t,n){return"/"===n[0]?e+n:e+t+n}},{key:"_html2canvas_onCloned",value:function(e,t){var n=this;return new Promise((function(i,o){try{n._log("document was cloned, now processing the nodes");var r=t.querySelector("["+e.attribute+"]");if(e.onClone&&e.onClone(t,r),t.body.style.margin="0",t.body.style.padding="0",e.transparentBackground)r.style.backgroundColor="transparent";else for(var s=r;s&&u[window.getComputedStyle(s).getPropertyValue("background-color")];)s.style.backgroundColor="inherit",s=s.parentElement;t.body.clientWidth,t.body.clientHeight;var l=(0,a.default)(r),c=1;n._log(c+++": remove all descendent nodes from cloned DOM identified by excludeClassList"),n.excludeClassList.forEach((function(e){l.find("."+e).get().forEach(n._removeNode.bind(n))})),n._log(c+++": converts special images with SVG source"),A.default.each(n.imgWithSVG,(function(t){l.find("img."+t).get().forEach(n._processIMGWithSVG.bind(n,e))})),n._log(c+++": converts classes to svgs, if any."),A.default.each(A.default.keys(n.elementMap),(function(t){l.find("."+t).get().forEach(n._processNodeClass.bind(n,e,n.elementMap[t]))})),n._log(c+++": process svgs by changing them to canvas"),l.find("svg").get().forEach(n._processNodeSVG.bind(n,e)),n._log(c+++": done processing nodes, waiting for "+e.waits.length+" promises to complete."),Promise.all(e.waits).then((function(){n._log("let html2canvas continue is processing."),i(r)}))}catch(e){o(e)}}))}},{key:"_html2canvas_onIgnoreElements",value:function(e,t){return this._isHiddenElement(e,t)||this._isExcludedElement(e,t)}},{key:"_isHiddenElement",value:function(e,t){return t.style&&("none"===t.style.display||"hidden"===t.style.visibility||"0"===t.style.opacity)&&!("svgIcons"===t.id||"infographicDef"===t.className||this._hasOnlySvgs(t))}},{key:"_isExcludedElement",value:function(e,t){return this._isExcludedLinkElement(e,t)||this._isExcludedIframeElement(e,t)}},{key:"_isExcludedLinkElement",value:function(e,t){return!0===e.excludeLinks&&t.tagName&&"LINK"===t.tagName.toUpperCase()}},{key:"_isExcludedIframeElement",value:function(e,t){try{return!0===e.excludeEmptyIframes&&t.tagName&&"IFRAME"===t.tagName.toUpperCase()&&t.contentWindow&&t.contentWindow.location&&"about:blank"===t.contentWindow.location.href}catch(e){return this._log(e),!1}}},{key:"_html2canvas_onRendered",value:function(e,t){try{if(this._log("_html2canvas_onRendered() called."),!t||"canvas"!==t.localName||"http://www.w3.org/1999/xhtml"!==t.namespaceURI)return void e.reject(t);var n=void 0,i=t.width,o=t.height;if(e.maxWidth&&e.maxWidth<i||e.maxHeight&&e.maxHeight<o){var r=1e3,a=1e3,A=document.createElement("canvas");e.maxWidth&&(r=e.maxWidth/i),e.maxHeight&&(a=e.maxHeight/o);var s=Math.min(r,a);A.width=t.width*s,A.height=t.height*s,A.getContext("2d").drawImage(t,0,0,i,o,0,0,A.width,A.height),n=e.binary?A:A.toDataURL()}else n=e.binary?t:t.toDataURL();e.resolve(n)}catch(t){e.reject(t)}}},{key:"_log",value:function(){var e;if(this.glassLogger)(e=this.glassLogger).info.apply(e,arguments);else if(this.logging){var t;(t=console).log.apply(t,arguments)}}}]),e}();t.default=f},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t,n){"use strict";(function(e){var n,i,o,r,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*!
 * ba-html2canvas 16.0.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */r=function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=27)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=/^#([a-f0-9]{3})$/i,a=function(e){var t=e.match(r);return!!t&&[parseInt(t[1][0]+t[1][0],16),parseInt(t[1][1]+t[1][1],16),parseInt(t[1][2]+t[1][2],16),null]},A=/^#([a-f0-9]{6})$/i,s=function(e){var t=e.match(A);return!!t&&[parseInt(t[1].substring(0,2),16),parseInt(t[1].substring(2,4),16),parseInt(t[1].substring(4,6),16),null]},l=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,c=function(e){var t=e.match(l);return!!t&&[Number(t[1]),Number(t[2]),Number(t[3]),null]},d=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/,u=function(e){var t=e.match(d);return!!(t&&t.length>4)&&[Number(t[1]),Number(t[2]),Number(t[3]),Number(t[4])]},h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=Array.isArray(t)?function(e){return[Math.min(e[0],255),Math.min(e[1],255),Math.min(e[2],255),e.length>3?e[3]:null]}(t):a(t)||c(t)||u(t)||function(e){return g[e.toLowerCase()]||!1}(t)||s(t)||[0,0,0,null],o=i(n,4),r=o[0],A=o[1],l=o[2],d=o[3];this.r=r,this.g=A,this.b=l,this.a=d}return o(e,[{key:"isTransparent",value:function(){return 0===this.a}},{key:"toString",value:function(){return null!==this.a&&1!==this.a?"rgba("+this.r+","+this.g+","+this.b+","+this.a+")":"rgb("+this.r+","+this.g+","+this.b+")"}}]),e}();t.default=h;var g={transparent:[0,0,0,0],aliceblue:[240,248,255,null],antiquewhite:[250,235,215,null],aqua:[0,255,255,null],aquamarine:[127,255,212,null],azure:[240,255,255,null],beige:[245,245,220,null],bisque:[255,228,196,null],black:[0,0,0,null],blanchedalmond:[255,235,205,null],blue:[0,0,255,null],blueviolet:[138,43,226,null],brown:[165,42,42,null],burlywood:[222,184,135,null],cadetblue:[95,158,160,null],chartreuse:[127,255,0,null],chocolate:[210,105,30,null],coral:[255,127,80,null],cornflowerblue:[100,149,237,null],cornsilk:[255,248,220,null],crimson:[220,20,60,null],cyan:[0,255,255,null],darkblue:[0,0,139,null],darkcyan:[0,139,139,null],darkgoldenrod:[184,134,11,null],darkgray:[169,169,169,null],darkgreen:[0,100,0,null],darkgrey:[169,169,169,null],darkkhaki:[189,183,107,null],darkmagenta:[139,0,139,null],darkolivegreen:[85,107,47,null],darkorange:[255,140,0,null],darkorchid:[153,50,204,null],darkred:[139,0,0,null],darksalmon:[233,150,122,null],darkseagreen:[143,188,143,null],darkslateblue:[72,61,139,null],darkslategray:[47,79,79,null],darkslategrey:[47,79,79,null],darkturquoise:[0,206,209,null],darkviolet:[148,0,211,null],deeppink:[255,20,147,null],deepskyblue:[0,191,255,null],dimgray:[105,105,105,null],dimgrey:[105,105,105,null],dodgerblue:[30,144,255,null],firebrick:[178,34,34,null],floralwhite:[255,250,240,null],forestgreen:[34,139,34,null],fuchsia:[255,0,255,null],gainsboro:[220,220,220,null],ghostwhite:[248,248,255,null],gold:[255,215,0,null],goldenrod:[218,165,32,null],gray:[128,128,128,null],green:[0,128,0,null],greenyellow:[173,255,47,null],grey:[128,128,128,null],honeydew:[240,255,240,null],hotpink:[255,105,180,null],indianred:[205,92,92,null],indigo:[75,0,130,null],ivory:[255,255,240,null],khaki:[240,230,140,null],lavender:[230,230,250,null],lavenderblush:[255,240,245,null],lawngreen:[124,252,0,null],lemonchiffon:[255,250,205,null],lightblue:[173,216,230,null],lightcoral:[240,128,128,null],lightcyan:[224,255,255,null],lightgoldenrodyellow:[250,250,210,null],lightgray:[211,211,211,null],lightgreen:[144,238,144,null],lightgrey:[211,211,211,null],lightpink:[255,182,193,null],lightsalmon:[255,160,122,null],lightseagreen:[32,178,170,null],lightskyblue:[135,206,250,null],lightslategray:[119,136,153,null],lightslategrey:[119,136,153,null],lightsteelblue:[176,196,222,null],lightyellow:[255,255,224,null],lime:[0,255,0,null],limegreen:[50,205,50,null],linen:[250,240,230,null],magenta:[255,0,255,null],maroon:[128,0,0,null],mediumaquamarine:[102,205,170,null],mediumblue:[0,0,205,null],mediumorchid:[186,85,211,null],mediumpurple:[147,112,219,null],mediumseagreen:[60,179,113,null],mediumslateblue:[123,104,238,null],mediumspringgreen:[0,250,154,null],mediumturquoise:[72,209,204,null],mediumvioletred:[199,21,133,null],midnightblue:[25,25,112,null],mintcream:[245,255,250,null],mistyrose:[255,228,225,null],moccasin:[255,228,181,null],navajowhite:[255,222,173,null],navy:[0,0,128,null],oldlace:[253,245,230,null],olive:[128,128,0,null],olivedrab:[107,142,35,null],orange:[255,165,0,null],orangered:[255,69,0,null],orchid:[218,112,214,null],palegoldenrod:[238,232,170,null],palegreen:[152,251,152,null],paleturquoise:[175,238,238,null],palevioletred:[219,112,147,null],papayawhip:[255,239,213,null],peachpuff:[255,218,185,null],peru:[205,133,63,null],pink:[255,192,203,null],plum:[221,160,221,null],powderblue:[176,224,230,null],purple:[128,0,128,null],rebeccapurple:[102,51,153,null],red:[255,0,0,null],rosybrown:[188,143,143,null],royalblue:[65,105,225,null],saddlebrown:[139,69,19,null],salmon:[250,128,114,null],sandybrown:[244,164,96,null],seagreen:[46,139,87,null],seashell:[255,245,238,null],sienna:[160,82,45,null],silver:[192,192,192,null],skyblue:[135,206,235,null],slateblue:[106,90,205,null],slategray:[112,128,144,null],slategrey:[112,128,144,null],snow:[255,250,250,null],springgreen:[0,255,127,null],steelblue:[70,130,180,null],tan:[210,180,140,null],teal:[0,128,128,null],thistle:[216,191,216,null],tomato:[255,99,71,null],turquoise:[64,224,208,null],violet:[238,130,238,null],wheat:[245,222,179,null],white:[255,255,255,null],whitesmoke:[245,245,245,null],yellow:[255,255,0,null],yellowgreen:[154,205,50,null]};t.TRANSPARENT=new h([0,0,0,0])},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=t.LENGTH_TYPE={PX:0,PERCENTAGE:1},r=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.type="%"===t.substr(t.length-1)?o.PERCENTAGE:o.PX;var n=parseFloat(t);isNaN(n)&&console.error('Invalid value given for Length: "'+t+'"'),this.value=isNaN(n)?0:n}return i(e,[{key:"isPercentage",value:function(){return this.type===o.PERCENTAGE}},{key:"getAbsoluteValue",value:function(e){return this.isPercentage()?e*(this.value/100):this.value}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=r,t.calculateLengthFromValueWithUnit=function(e,t,n){switch(n){case"px":case"%":return new r(t+n);case"em":case"rem":var i=new r(t);return i.value*="em"===n?parseFloat(e.style.font.fontSize):function e(t){var n=t.parent;return n?e(n):parseFloat(t.style.font.fontSize)}(e),i;default:return new r("0")}}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.parseBoundCurves=t.calculatePaddingBoxPath=t.calculateBorderBoxPath=t.parsePathForBorder=t.parseDocumentSize=t.calculateContentBox=t.calculatePaddingBox=t.parseBounds=t.Bounds=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=i(n(7)),a=i(n(32)),A=t.Bounds=function(){function e(t,n,i,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.left=t,this.top=n,this.width=i,this.height=o}return o(e,null,[{key:"fromClientRect",value:function(t,n,i){return new e(t.left+n,t.top+i,t.width,t.height)}}]),e}(),s=(t.parseBounds=function(e,t,n){return A.fromClientRect(e.getBoundingClientRect(),t,n)},t.calculatePaddingBox=function(e,t){return new A(e.left+t[3].borderWidth,e.top+t[0].borderWidth,e.width-(t[1].borderWidth+t[3].borderWidth),e.height-(t[0].borderWidth+t[2].borderWidth))},t.calculateContentBox=function(e,t,n){var i=t[0].value,o=t[1].value,r=t[2].value,a=t[3].value;return new A(e.left+a+n[3].borderWidth,e.top+i+n[0].borderWidth,e.width-(n[1].borderWidth+n[3].borderWidth+a+o),e.height-(n[0].borderWidth+n[2].borderWidth+i+r))},t.parseDocumentSize=function(e){var t=e.body,n=e.documentElement;if(!t||!n)throw new Error("Unable to get document size");var i=Math.max(Math.max(t.scrollWidth,n.scrollWidth),Math.max(t.offsetWidth,n.offsetWidth),Math.max(t.clientWidth,n.clientWidth)),o=Math.max(Math.max(t.scrollHeight,n.scrollHeight),Math.max(t.offsetHeight,n.offsetHeight),Math.max(t.clientHeight,n.clientHeight));return new A(0,0,i,o)},t.parsePathForBorder=function(e,t){switch(t){case 0:return s(e.topLeftOuter,e.topLeftInner,e.topRightOuter,e.topRightInner);case 1:return s(e.topRightOuter,e.topRightInner,e.bottomRightOuter,e.bottomRightInner);case 2:return s(e.bottomRightOuter,e.bottomRightInner,e.bottomLeftOuter,e.bottomLeftInner);case 3:default:return s(e.bottomLeftOuter,e.bottomLeftInner,e.topLeftOuter,e.topLeftInner)}},function(e,t,n,i){var o=[];return e instanceof a.default?o.push(e.subdivide(.5,!1)):o.push(e),n instanceof a.default?o.push(n.subdivide(.5,!0)):o.push(n),i instanceof a.default?o.push(i.subdivide(.5,!0).reverse()):o.push(i),t instanceof a.default?o.push(t.subdivide(.5,!1).reverse()):o.push(t),o}),l=(t.calculateBorderBoxPath=function(e){return[e.topLeftOuter,e.topRightOuter,e.bottomRightOuter,e.bottomLeftOuter]},t.calculatePaddingBoxPath=function(e){return[e.topLeftInner,e.topRightInner,e.bottomRightInner,e.bottomLeftInner]},t.parseBoundCurves=function(e,t,n){var i=n[l.TOP_LEFT][0].getAbsoluteValue(e.width),o=n[l.TOP_LEFT][1].getAbsoluteValue(e.height),a=n[l.TOP_RIGHT][0].getAbsoluteValue(e.width),A=n[l.TOP_RIGHT][1].getAbsoluteValue(e.height),s=n[l.BOTTOM_RIGHT][0].getAbsoluteValue(e.width),d=n[l.BOTTOM_RIGHT][1].getAbsoluteValue(e.height),u=n[l.BOTTOM_LEFT][0].getAbsoluteValue(e.width),h=n[l.BOTTOM_LEFT][1].getAbsoluteValue(e.height),g=[];g.push((i+a)/e.width),g.push((u+s)/e.width),g.push((o+h)/e.height),g.push((A+d)/e.height);var f=Math.max.apply(Math,g);f>1&&(i/=f,o/=f,a/=f,A/=f,s/=f,d/=f,u/=f,h/=f);var p=e.width-a,m=e.height-d,C=e.width-s,B=e.height-h;return{topLeftOuter:i>0||o>0?c(e.left,e.top,i,o,l.TOP_LEFT):new r.default(e.left,e.top),topLeftInner:i>0||o>0?c(e.left+t[3].borderWidth,e.top+t[0].borderWidth,Math.max(0,i-t[3].borderWidth),Math.max(0,o-t[0].borderWidth),l.TOP_LEFT):new r.default(e.left+t[3].borderWidth,e.top+t[0].borderWidth),topRightOuter:a>0||A>0?c(e.left+p,e.top,a,A,l.TOP_RIGHT):new r.default(e.left+e.width,e.top),topRightInner:a>0||A>0?c(e.left+Math.min(p,e.width+t[3].borderWidth),e.top+t[0].borderWidth,p>e.width+t[3].borderWidth?0:a-t[3].borderWidth,A-t[0].borderWidth,l.TOP_RIGHT):new r.default(e.left+e.width-t[1].borderWidth,e.top+t[0].borderWidth),bottomRightOuter:s>0||d>0?c(e.left+C,e.top+m,s,d,l.BOTTOM_RIGHT):new r.default(e.left+e.width,e.top+e.height),bottomRightInner:s>0||d>0?c(e.left+Math.min(C,e.width-t[3].borderWidth),e.top+Math.min(m,e.height+t[0].borderWidth),Math.max(0,s-t[1].borderWidth),d-t[2].borderWidth,l.BOTTOM_RIGHT):new r.default(e.left+e.width-t[1].borderWidth,e.top+e.height-t[2].borderWidth),bottomLeftOuter:u>0||h>0?c(e.left,e.top+B,u,h,l.BOTTOM_LEFT):new r.default(e.left,e.top+e.height),bottomLeftInner:u>0||h>0?c(e.left+t[3].borderWidth,e.top+B,Math.max(0,u-t[3].borderWidth),h-t[2].borderWidth,l.BOTTOM_LEFT):new r.default(e.left+t[3].borderWidth,e.top+e.height-t[2].borderWidth)}},{TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_RIGHT:2,BOTTOM_LEFT:3}),c=function(e,t,n,i,o){var A=(Math.sqrt(2)-1)/3*4,s=n*A,c=i*A,d=e+n,u=t+i;switch(o){case l.TOP_LEFT:return new a.default(new r.default(e,u),new r.default(e,u-c),new r.default(d-s,t),new r.default(d,t));case l.TOP_RIGHT:return new a.default(new r.default(e,t),new r.default(e+s,t),new r.default(d,u-c),new r.default(d,u));case l.BOTTOM_RIGHT:return new a.default(new r.default(d,t),new r.default(d,t+c),new r.default(e+s,u),new r.default(e,u));case l.BOTTOM_LEFT:default:return new a.default(new r.default(d,u),new r.default(d-s,u),new r.default(e,t+c),new r.default(e,t))}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.contains=function(e,t){return 0!=(e&t)},t.distance=function(e,t){return Math.sqrt(e*e+t*t)},t.copyCSSStyles=function(e,t){for(var n=e.length-1;n>=0;n--){var i=e.item(n);"content"!==i&&t.style.setProperty(i,e.getPropertyValue(i))}return t},t.SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.parseBackgroundImage=t.parseBackground=t.calculateBackgroundRepeatPath=t.calculateBackgroundPosition=t.calculateBackgroungPositioningArea=t.calculateBackgroungPaintingArea=t.calculateGradientBackgroundSize=t.calculateBackgroundSize=t.BACKGROUND_ORIGIN=t.BACKGROUND_CLIP=t.BACKGROUND_SIZE=t.BACKGROUND_REPEAT=void 0;var o=i(n(0)),r=i(n(1)),a=i(n(31)),A=i(n(7)),s=n(2),l=n(17),c=t.BACKGROUND_REPEAT={REPEAT:0,NO_REPEAT:1,REPEAT_X:2,REPEAT_Y:3},d=t.BACKGROUND_SIZE={AUTO:0,CONTAIN:1,COVER:2,LENGTH:3},u=t.BACKGROUND_CLIP={BORDER_BOX:0,PADDING_BOX:1,CONTENT_BOX:2},h=t.BACKGROUND_ORIGIN=u,g=function e(t){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t){case"contain":this.size=d.CONTAIN;break;case"cover":this.size=d.COVER;break;case"auto":this.size=d.AUTO;break;default:this.value=new r.default(t)}},f=(t.calculateBackgroundSize=function(e,t,n){var i=0,o=0,r=e.size;if(r[0].size===d.CONTAIN||r[0].size===d.COVER){var A=n.width/n.height,s=t.width/t.height;return A<s!=(r[0].size===d.COVER)?new a.default(n.width,n.width/s):new a.default(n.height*s,n.height)}return r[0].value&&(i=r[0].value.getAbsoluteValue(n.width)),r[0].size===d.AUTO&&r[1].size===d.AUTO?o=t.height:r[1].size===d.AUTO?o=i/t.width*t.height:r[1].value&&(o=r[1].value.getAbsoluteValue(n.height)),r[0].size===d.AUTO&&(i=o/t.height*t.width),new a.default(i,o)},t.calculateGradientBackgroundSize=function(e,t){var n=e.size,i=n[0].value?n[0].value.getAbsoluteValue(t.width):t.width,o=n[1].value?n[1].value.getAbsoluteValue(t.height):n[0].value?i:t.height;return new a.default(i,o)},new g("auto")),p=(t.calculateBackgroungPaintingArea=function(e,t){switch(t){case u.BORDER_BOX:return(0,s.calculateBorderBoxPath)(e);case u.PADDING_BOX:default:return(0,s.calculatePaddingBoxPath)(e)}},t.calculateBackgroungPositioningArea=function(e,t,n,i){var o=(0,s.calculatePaddingBox)(t,i);switch(e){case h.BORDER_BOX:return t;case h.CONTENT_BOX:var r=n[l.PADDING_SIDES.LEFT].getAbsoluteValue(t.width),a=n[l.PADDING_SIDES.RIGHT].getAbsoluteValue(t.width),A=n[l.PADDING_SIDES.TOP].getAbsoluteValue(t.width),c=n[l.PADDING_SIDES.BOTTOM].getAbsoluteValue(t.width);return new s.Bounds(o.left+r,o.top+A,o.width-r-a,o.height-A-c);case h.PADDING_BOX:default:return o}},t.calculateBackgroundPosition=function(e,t,n){return new A.default(e[0].getAbsoluteValue(n.width-t.width),e[1].getAbsoluteValue(n.height-t.height))},t.calculateBackgroundRepeatPath=function(e,t,n,i,o){switch(e.repeat){case c.REPEAT_X:return[new A.default(Math.round(o.left),Math.round(i.top+t.y)),new A.default(Math.round(o.left+o.width),Math.round(i.top+t.y)),new A.default(Math.round(o.left+o.width),Math.round(n.height+i.top+t.y)),new A.default(Math.round(o.left),Math.round(n.height+i.top+t.y))];case c.REPEAT_Y:return[new A.default(Math.round(i.left+t.x),Math.round(o.top)),new A.default(Math.round(i.left+t.x+n.width),Math.round(o.top)),new A.default(Math.round(i.left+t.x+n.width),Math.round(o.height+o.top)),new A.default(Math.round(i.left+t.x),Math.round(o.height+o.top))];case c.NO_REPEAT:return[new A.default(Math.round(i.left+t.x),Math.round(i.top+t.y)),new A.default(Math.round(i.left+t.x+n.width),Math.round(i.top+t.y)),new A.default(Math.round(i.left+t.x+n.width),Math.round(i.top+t.y+n.height)),new A.default(Math.round(i.left+t.x),Math.round(i.top+t.y+n.height))];default:return[new A.default(Math.round(o.left),Math.round(o.top)),new A.default(Math.round(o.left+o.width),Math.round(o.top)),new A.default(Math.round(o.left+o.width),Math.round(o.height+o.top)),new A.default(Math.round(o.left),Math.round(o.height+o.top))]}},t.parseBackground=function(e,t){return{backgroundColor:new o.default(e.backgroundColor),backgroundImage:B(e,t),backgroundClip:p(e.backgroundClip),backgroundOrigin:m(e.backgroundOrigin)}},function(e){switch(e){case"padding-box":return u.PADDING_BOX;case"content-box":return u.CONTENT_BOX}return u.BORDER_BOX}),m=function(e){switch(e){case"padding-box":return h.PADDING_BOX;case"content-box":return h.CONTENT_BOX}return h.BORDER_BOX},C=function(e){switch(e.trim()){case"no-repeat":return c.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return c.REPEAT_X;case"repeat-y":case"no-repeat repeat":return c.REPEAT_Y;case"repeat":return c.REPEAT}return console.error('Invalid background-repeat value "'+e+'"'),c.REPEAT},B=function(e,t){var n=b(e.backgroundImage).map((function(e){if("url"===e.method){var n=t.loadImage(e.args[0]);e.args=n?[n]:[]}return e})),i=e.backgroundPosition.split(","),o=e.backgroundRepeat.split(","),r=e.backgroundSize.split(",");return n.map((function(e,t){var n=(r[t]||"auto").trim().split(" ").map(v),a=(i[t]||"auto").trim().split(" ").map(w);return{source:e,repeat:C("string"==typeof o[t]?o[t]:o[0]),size:n.length<2?[n[0],f]:[n[0],n[1]],position:a.length<2?[a[0],a[0]]:[a[0],a[1]]}}))},v=function(e){return"auto"===e?f:new g(e)},w=function(e){switch(e){case"bottom":case"right":return new r.default("100%");case"left":case"top":return new r.default("0%");case"auto":return new r.default("0")}return new r.default(e)},b=t.parseBackgroundImage=function(e){var t=/^\s$/,n=[],i=[],o="",r=null,a="",A=0,s=0,l=function(){var e="";if(o){'"'===a.substr(0,1)&&(a=a.substr(1,a.length-2)),a&&i.push(a.trim());var t=o.indexOf("-",1)+1;"-"===o.substr(0,1)&&t>0&&(e=o.substr(0,t).toLowerCase(),o=o.substr(t)),"none"!==(o=o.toLowerCase())&&n.push({prefix:e,method:o,args:i})}i=[],o=a=""};return e.split("").forEach((function(e){if(0!==A||!t.test(e)){switch(e){case'"':r?r===e&&(r=null):r=e;break;case"(":if(r)break;if(0===A)return void(A=1);s++;break;case")":if(r)break;if(1===A){if(0===s)return A=0,void l();s--}break;case",":if(r)break;if(0===A)return void l();if(1===A&&0===s&&!o.match(/^url$/i))return i.push(a.trim()),void(a="")}0===A?o+=e:a+=e}})),l(),n}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.PATH={VECTOR:0,BEZIER_CURVE:1,CIRCLE:2}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),r=n(3),a=n(4),A=n(12),s=n(33),l=n(34),c=n(35),d=n(36),u=n(37),h=n(38),g=n(8),f=n(39),p=n(40),m=n(18),C=n(17),B=n(19),v=n(11),w=n(41),b=n(20),y=n(42),F=n(43),E=n(44),_=n(45),Q=n(2),U=n(21),T=n(14),S=["INPUT","TEXTAREA","SELECT"],I=function(){function e(t,n,i,r){var I=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.parent=n,this.tagName=t.tagName,this.index=r,this.childNodes=[],this.listItems=[],"number"==typeof t.start&&(this.listStart=t.start);var P=t.ownerDocument.defaultView,x=P.pageXOffset,N=P.pageYOffset,L=P.getComputedStyle(t,null),M=(0,l.parseDisplay)(L.display),R="radio"===t.type||"checkbox"===t.type,k=(0,B.parsePosition)(L.position);if(this.style={background:R?U.INPUT_BACKGROUND:(0,a.parseBackground)(L,i),border:R?U.INPUT_BORDERS:(0,A.parseBorder)(L),borderRadius:(t instanceof P.HTMLInputElement||t instanceof HTMLInputElement)&&R?(0,U.getInputBorderRadius)(t):(0,s.parseBorderRadius)(L),color:R?U.INPUT_COLOR:new o.default(L.color),display:M,float:(0,c.parseCSSFloat)(L.float),font:(0,d.parseFont)(L),letterSpacing:(0,u.parseLetterSpacing)(L.letterSpacing),listStyle:M===l.DISPLAY.LIST_ITEM?(0,g.parseListStyle)(L):null,lineBreak:(0,h.parseLineBreak)(L.lineBreak),margin:(0,f.parseMargin)(L),opacity:parseFloat(L.opacity),overflow:-1===S.indexOf(t.tagName)?(0,p.parseOverflow)(L.overflow):p.OVERFLOW.HIDDEN,overflowWrap:(0,m.parseOverflowWrap)(L.overflowWrap?L.overflowWrap:L.wordWrap),padding:(0,C.parsePadding)(L),position:k,textDecoration:(0,v.parseTextDecoration)(L),textShadow:(0,w.parseTextShadow)(L.textShadow),textTransform:(0,b.parseTextTransform)(L.textTransform),transform:(0,y.parseTransform)(L),visibility:(0,F.parseVisibility)(L.visibility),wordBreak:(0,E.parseWordBreak)(L.wordBreak),zIndex:(0,_.parseZIndex)(k!==B.POSITION.STATIC?L.zIndex:"auto")},this.isTransformed()&&(t.style.transform="matrix(1,0,0,1,0,0)"),M===l.DISPLAY.LIST_ITEM){var D=(0,T.getListOwner)(this);if(D){var O=D.listItems.length;D.listItems.push(this),this.listIndex=t.hasAttribute("value")&&"number"==typeof t.value?t.value:0===O?"number"==typeof D.listStart?D.listStart:1:D.listItems[O-1].listIndex+1}}"IMG"===t.tagName&&t.addEventListener("load",(function(){I.bounds=(0,Q.parseBounds)(t,x,N),I.curvedBounds=(0,Q.parseBoundCurves)(I.bounds,I.style.border,I.style.borderRadius)})),this.image=H(t,i),this.bounds=R?(0,U.reformatInputBounds)((0,Q.parseBounds)(t,x,N)):(0,Q.parseBounds)(t,x,N),this.curvedBounds=(0,Q.parseBoundCurves)(this.bounds,this.style.border,this.style.borderRadius),this.name=t.tagName.toLowerCase()+(t.id?"#"+t.id:"")+t.className.toString().split(" ").map((function(e){return e.length?"."+e:""})).join("")}return i(e,[{key:"getClipPaths",value:function(){var e=this.parent?this.parent.getClipPaths():[];return this.style.overflow!==p.OVERFLOW.VISIBLE?e.concat([(0,Q.calculatePaddingBoxPath)(this.curvedBounds)]):e}},{key:"isInFlow",value:function(){return this.isRootElement()&&!this.isFloating()&&!this.isAbsolutelyPositioned()}},{key:"isVisible",value:function(){return!(0,r.contains)(this.style.display,l.DISPLAY.NONE)&&this.style.opacity>0&&this.style.visibility===F.VISIBILITY.VISIBLE}},{key:"isAbsolutelyPositioned",value:function(){return this.style.position!==B.POSITION.STATIC&&this.style.position!==B.POSITION.RELATIVE}},{key:"isPositioned",value:function(){return this.style.position!==B.POSITION.STATIC}},{key:"isFloating",value:function(){return this.style.float!==c.FLOAT.NONE}},{key:"isRootElement",value:function(){return null===this.parent}},{key:"isTransformed",value:function(){return null!==this.style.transform}},{key:"isPositionedWithZIndex",value:function(){return this.isPositioned()&&!this.style.zIndex.auto}},{key:"isInlineLevel",value:function(){return(0,r.contains)(this.style.display,l.DISPLAY.INLINE)||(0,r.contains)(this.style.display,l.DISPLAY.INLINE_BLOCK)||(0,r.contains)(this.style.display,l.DISPLAY.INLINE_FLEX)||(0,r.contains)(this.style.display,l.DISPLAY.INLINE_GRID)||(0,r.contains)(this.style.display,l.DISPLAY.INLINE_LIST_ITEM)||(0,r.contains)(this.style.display,l.DISPLAY.INLINE_TABLE)}},{key:"isInlineBlockOrInlineTable",value:function(){return(0,r.contains)(this.style.display,l.DISPLAY.INLINE_BLOCK)||(0,r.contains)(this.style.display,l.DISPLAY.INLINE_TABLE)}}]),e}();t.default=I;var H=function(e,t){if(e instanceof e.ownerDocument.defaultView.SVGSVGElement||e instanceof SVGSVGElement){var n=new XMLSerializer;return t.loadImage("data:image/svg+xml,"+encodeURIComponent(n.serializeToString(e)))}switch(e.tagName){case"IMG":var i=e;return t.loadImage(i.currentSrc||i.src);case"CANVAS":var o=e;return t.loadCanvas(o);case"IFRAME":var r=e.getAttribute("data-html2canvas-internal-iframe-key");if(r)return r}return null}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);t.default=function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.type=i.PATH.VECTOR,this.x=t,this.y=n,isNaN(t)&&console.error("Invalid x value given for Vector"),isNaN(n)&&console.error("Invalid y value given for Vector")}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseListStyle=t.parseListStyleType=t.LIST_STYLE_TYPE=t.LIST_STYLE_POSITION=void 0;var i=n(4),o=t.LIST_STYLE_POSITION={INSIDE:0,OUTSIDE:1},r=t.LIST_STYLE_TYPE={NONE:-1,DISC:0,CIRCLE:1,SQUARE:2,DECIMAL:3,CJK_DECIMAL:4,DECIMAL_LEADING_ZERO:5,LOWER_ROMAN:6,UPPER_ROMAN:7,LOWER_GREEK:8,LOWER_ALPHA:9,UPPER_ALPHA:10,ARABIC_INDIC:11,ARMENIAN:12,BENGALI:13,CAMBODIAN:14,CJK_EARTHLY_BRANCH:15,CJK_HEAVENLY_STEM:16,CJK_IDEOGRAPHIC:17,DEVANAGARI:18,ETHIOPIC_NUMERIC:19,GEORGIAN:20,GUJARATI:21,GURMUKHI:22,HEBREW:22,HIRAGANA:23,HIRAGANA_IROHA:24,JAPANESE_FORMAL:25,JAPANESE_INFORMAL:26,KANNADA:27,KATAKANA:28,KATAKANA_IROHA:29,KHMER:30,KOREAN_HANGUL_FORMAL:31,KOREAN_HANJA_FORMAL:32,KOREAN_HANJA_INFORMAL:33,LAO:34,LOWER_ARMENIAN:35,MALAYALAM:36,MONGOLIAN:37,MYANMAR:38,ORIYA:39,PERSIAN:40,SIMP_CHINESE_FORMAL:41,SIMP_CHINESE_INFORMAL:42,TAMIL:43,TELUGU:44,THAI:45,TIBETAN:46,TRAD_CHINESE_FORMAL:47,TRAD_CHINESE_INFORMAL:48,UPPER_ARMENIAN:49,DISCLOSURE_OPEN:50,DISCLOSURE_CLOSED:51},a=t.parseListStyleType=function(e){switch(e){case"disc":return r.DISC;case"circle":return r.CIRCLE;case"square":return r.SQUARE;case"decimal":return r.DECIMAL;case"cjk-decimal":return r.CJK_DECIMAL;case"decimal-leading-zero":return r.DECIMAL_LEADING_ZERO;case"lower-roman":return r.LOWER_ROMAN;case"upper-roman":return r.UPPER_ROMAN;case"lower-greek":return r.LOWER_GREEK;case"lower-alpha":return r.LOWER_ALPHA;case"upper-alpha":return r.UPPER_ALPHA;case"arabic-indic":return r.ARABIC_INDIC;case"armenian":return r.ARMENIAN;case"bengali":return r.BENGALI;case"cambodian":return r.CAMBODIAN;case"cjk-earthly-branch":return r.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return r.CJK_HEAVENLY_STEM;case"cjk-ideographic":return r.CJK_IDEOGRAPHIC;case"devanagari":return r.DEVANAGARI;case"ethiopic-numeric":return r.ETHIOPIC_NUMERIC;case"georgian":return r.GEORGIAN;case"gujarati":return r.GUJARATI;case"gurmukhi":return r.GURMUKHI;case"hebrew":return r.HEBREW;case"hiragana":return r.HIRAGANA;case"hiragana-iroha":return r.HIRAGANA_IROHA;case"japanese-formal":return r.JAPANESE_FORMAL;case"japanese-informal":return r.JAPANESE_INFORMAL;case"kannada":return r.KANNADA;case"katakana":return r.KATAKANA;case"katakana-iroha":return r.KATAKANA_IROHA;case"khmer":return r.KHMER;case"korean-hangul-formal":return r.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return r.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return r.KOREAN_HANJA_INFORMAL;case"lao":return r.LAO;case"lower-armenian":return r.LOWER_ARMENIAN;case"malayalam":return r.MALAYALAM;case"mongolian":return r.MONGOLIAN;case"myanmar":return r.MYANMAR;case"oriya":return r.ORIYA;case"persian":return r.PERSIAN;case"simp-chinese-formal":return r.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return r.SIMP_CHINESE_INFORMAL;case"tamil":return r.TAMIL;case"telugu":return r.TELUGU;case"thai":return r.THAI;case"tibetan":return r.TIBETAN;case"trad-chinese-formal":return r.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return r.TRAD_CHINESE_INFORMAL;case"upper-armenian":return r.UPPER_ARMENIAN;case"disclosure-open":return r.DISCLOSURE_OPEN;case"disclosure-closed":return r.DISCLOSURE_CLOSED;case"none":default:return r.NONE}},A=(t.parseListStyle=function(e){var t=(0,i.parseBackgroundImage)(e.getPropertyValue("list-style-image"));return{listStyleType:a(e.getPropertyValue("list-style-type")),listStyleImage:t.length?t[0]:null,listStylePosition:A(e.getPropertyValue("list-style-position"))}},function(e){switch(e){case"inside":return o.INSIDE;case"outside":default:return o.OUTSIDE}})},function(e,t,n){function i(e,t,n){return e.length>0?t+n.toUpperCase():e}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(20),a=n(22),A=function(){function e(t,n,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.text=t,this.parent=n,this.bounds=i}return o(e,null,[{key:"fromTextNode",value:function(t,n){var i=l(t.data,n.style.textTransform);return new e(i,n,(0,a.parseTextBounds)(i,n,t))}}]),e}();t.default=A;var s=/(^|\s|:|-|\(|\))([a-z])/g,l=function(e,t){switch(t){case r.TEXT_TRANSFORM.LOWERCASE:return e.toLowerCase();case r.TEXT_TRANSFORM.CAPITALIZE:return e.replace(s,i);case r.TEXT_TRANSFORM.UPPERCASE:return e.toUpperCase();default:return e}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(23),o=function(e){return 0===e[0]&&255===e[1]&&0===e[2]&&255===e[3]},r={get SUPPORT_RANGE_BOUNDS(){var e=function(e){if(e.createRange){var t=e.createRange();if(t.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n);var i=t.getBoundingClientRect(),o=Math.round(i.height);if(e.body.removeChild(n),123===o)return!0}}return!1}(document);return Object.defineProperty(r,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=function(e){var t=new Image,n=e.createElement("canvas"),i=n.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{i.drawImage(t,0,0),n.toDataURL()}catch(e){return!1}return!0}(document);return Object.defineProperty(r,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_BASE64_DRAWING(){return function(e){var t=function(e,t){var n=new Image,i=e.createElement("canvas"),o=i.getContext("2d");return new Promise((function(e){n.src=t;var r=function(){try{o.drawImage(n,0,0),i.toDataURL()}catch(t){return e(!1)}return e(!0)};n.onload=r,n.onerror=function(){return e(!1)},!0===n.complete&&setTimeout((function(){r()}),500)}))}(document,e);return Object.defineProperty(r,"SUPPORT_BASE64_DRAWING",{value:function(){return t}}),t}},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e="function"==typeof Array.from&&"function"==typeof window.fetch?function(e){var t=e.createElement("canvas");t.width=100,t.height=100;var n=t.getContext("2d");n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,100,100);var r=new Image,a=t.toDataURL();r.src=a;var A=(0,i.createForeignObjectSVG)(100,100,0,0,r);return n.fillStyle="red",n.fillRect(0,0,100,100),(0,i.loadSerializedSVG)(A).then((function(t){n.drawImage(t,0,0);var r=n.getImageData(0,0,100,100).data;n.fillStyle="red",n.fillRect(0,0,100,100);var A=e.createElement("div");return A.style.backgroundImage="url("+a+")",A.style.height="100px",o(r)?(0,i.loadSerializedSVG)((0,i.createForeignObjectSVG)(100,100,0,0,A)):Promise.reject(!1)})).then((function(e){return n.drawImage(e,0,0),o(n.getImageData(0,0,100,100).data)})).catch((function(e){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(r,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=void 0!==(new Image).crossOrigin;return Object.defineProperty(r,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(r,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(r,"SUPPORT_CORS_XHR",{value:e}),e}};t.default=r},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextDecoration=t.TEXT_DECORATION_LINE=t.TEXT_DECORATION=t.TEXT_DECORATION_STYLE=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=t.TEXT_DECORATION_STYLE={SOLID:0,DOUBLE:1,DOTTED:2,DASHED:3,WAVY:4},r=t.TEXT_DECORATION={NONE:null},a=t.TEXT_DECORATION_LINE={UNDERLINE:1,OVERLINE:2,LINE_THROUGH:3,BLINK:4},A=function(e){switch(e){case"underline":return a.UNDERLINE;case"overline":return a.OVERLINE;case"line-through":return a.LINE_THROUGH}return a.BLINK},s=function(e){switch(e){case"double":return o.DOUBLE;case"dotted":return o.DOTTED;case"dashed":return o.DASHED;case"wavy":return o.WAVY}return o.SOLID};t.parseTextDecoration=function(e){var t=function(e){return"none"===e?null:e.split(" ").map(A)}(e.textDecorationLine?e.textDecorationLine:e.textDecoration);return null===t?r.NONE:{textDecorationLine:t,textDecorationColor:e.textDecorationColor?new i.default(e.textDecorationColor):null,textDecorationStyle:s(e.textDecorationStyle)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseBorder=t.BORDER_SIDES=t.BORDER_STYLE=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=t.BORDER_STYLE={NONE:0,SOLID:1},r=t.BORDER_SIDES={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},a=Object.keys(r).map((function(e){return e.toLowerCase()})),A=function(e){switch(e){case"none":return o.NONE}return o.SOLID};t.parseBorder=function(e){return a.map((function(t){var n=new i.default(e.getPropertyValue("border-"+t+"-color")),o=A(e.getPropertyValue("border-"+t+"-style")),r=parseFloat(e.getPropertyValue("border-"+t+"-width"));return{borderColor:n,borderStyle:o,borderWidth:isNaN(r)?0:r}}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});for(var i=(t.toCodePoints=function(e){for(var t=[],n=0,i=e.length;n<i;){var o=e.charCodeAt(n++);if(o>=55296&&o<=56319&&n<i){var r=e.charCodeAt(n++);56320==(64512&r)?t.push(((1023&o)<<10)+(1023&r)+65536):(t.push(o),n--)}else t.push(o)}return t},t.fromCodePoint=function(){if(String.fromCodePoint)return String.fromCodePoint.apply(String,arguments);var e=arguments.length;if(!e)return"";for(var t=[],n=-1,i="";++n<e;){var o=arguments.length<=n?void 0:arguments[n];o<=65535?t.push(o):(o-=65536,t.push(55296+(o>>10),o%1024+56320)),(n+1===e||t.length>16384)&&(i+=String.fromCharCode.apply(String,t),t.length=0)}return i},"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o="undefined"==typeof Uint8Array?[]:new Uint8Array(256),r=0;r<i.length;r++)o[i.charCodeAt(r)]=r;t.decode=function(e){var t=.75*e.length,n=e.length,i=void 0,r=0,a=void 0,A=void 0,s=void 0,l=void 0;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(t):new Array(t),d=Array.isArray(c)?c:new Uint8Array(c);for(i=0;i<n;i+=4)a=o[e.charCodeAt(i)],A=o[e.charCodeAt(i+1)],s=o[e.charCodeAt(i+2)],l=o[e.charCodeAt(i+3)],d[r++]=a<<2|A>>4,d[r++]=(15&A)<<4|s>>2,d[r++]=(3&s)<<6|63&l;return c},t.polyUint16Array=function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n.push(e[i+1]<<8|e[i]);return n},t.polyUint32Array=function(e){for(var t=e.length,n=[],i=0;i<t;i+=4)n.push(e[i+3]<<24|e[i+2]<<16|e[i+1]<<8|e[i]);return n}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.createCounterText=t.inlineListItemElement=t.getListOwner=void 0;var o=n(3),r=i(n(6)),a=i(n(9)),A=n(8),s=n(24),l=["OL","UL","MENU"],c=(t.getListOwner=function(e){var t=e.parent;if(!t)return null;do{if(-1!==l.indexOf(t.tagName))return t;t=t.parent}while(t);return e.parent},t.inlineListItemElement=function(e,t,n){var i=t.style.listStyle;if(i){var s=e.ownerDocument.defaultView.getComputedStyle(e,null),l=e.ownerDocument.createElement("html2canvaswrapper");switch((0,o.copyCSSStyles)(s,l),l.style.position="absolute",l.style.bottom="auto",l.style.display="block",l.style.letterSpacing="normal",i.listStylePosition){case A.LIST_STYLE_POSITION.OUTSIDE:l.style.left="auto",l.style.right=e.ownerDocument.defaultView.innerWidth-t.bounds.left-t.style.margin[1].getAbsoluteValue(t.bounds.width)+7+"px",l.style.textAlign="right";break;case A.LIST_STYLE_POSITION.INSIDE:l.style.left=t.bounds.left-t.style.margin[3].getAbsoluteValue(t.bounds.width)+"px",l.style.right="auto",l.style.textAlign="left"}var c=void 0,d=t.style.margin[0].getAbsoluteValue(t.bounds.width),u=i.listStyleImage;if(u)if("url"===u.method){var h=e.ownerDocument.createElement("img");h.src=u.args[0],l.style.top=t.bounds.top-d+"px",l.style.width="auto",l.style.height="auto",l.appendChild(h)}else{var g=.5*parseFloat(t.style.font.fontSize);l.style.top=t.bounds.top-d+t.bounds.height-1.5*g+"px",l.style.width=g+"px",l.style.height=g+"px",l.style.backgroundImage=s.listStyleImage}else"number"==typeof t.listIndex&&(c=e.ownerDocument.createTextNode(B(t.listIndex,i.listStyleType,!0)),l.appendChild(c),l.style.top=t.bounds.top-d+"px");var f=e.ownerDocument.body;f.appendChild(l),c?(t.childNodes.push(a.default.fromTextNode(c,t)),f.removeChild(l)):t.childNodes.push(new r.default(l,t,n,0))}},{integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]}),d={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},u={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},h={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},g=function(e,t,n,i,o,r){return e<t||e>n?B(e,o,r.length>0):i.integers.reduce((function(t,n,o){for(;e>=n;)e-=n,t+=i.values[o];return t}),"")+r},f=function(e,t,n,i){var o="";do{n||e--,o=i(e)+o,e/=t}while(e*t>=t);return o},p=function(e,t,n,i,o){var r=n-t+1;return(e<0?"-":"")+(f(Math.abs(e),r,i,(function(e){return(0,s.fromCodePoint)(Math.floor(e%r)+t)}))+o)},m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:". ",i=t.length;return f(Math.abs(e),i,!1,(function(e){return t[Math.floor(e%i)]}))+n},C=function(e,t,n,i,r,a){if(e<-9999||e>9999)return B(e,A.LIST_STYLE_TYPE.CJK_DECIMAL,r.length>0);var s=Math.abs(e),l=r;if(0===s)return t[0]+l;for(var c=0;s>0&&c<=4;c++){var d=s%10;0===d&&(0,o.contains)(a,1)&&""!==l?l=t[d]+l:d>1||1===d&&0===c||1===d&&1===c&&(0,o.contains)(a,2)||1===d&&1===c&&(0,o.contains)(a,4)&&e>100||1===d&&c>1&&(0,o.contains)(a,8)?l=t[d]+(c>0?n[c-1]:"")+l:1===d&&c>0&&(l=n[c-1]+l),s=Math.floor(s/10)}return(e<0?i:"")+l},B=t.createCounterText=function(e,t,n){var i=n?". ":"",o=n?"、":"",r=n?", ":"";switch(t){case A.LIST_STYLE_TYPE.DISC:return"•";case A.LIST_STYLE_TYPE.CIRCLE:return"◦";case A.LIST_STYLE_TYPE.SQUARE:return"◾";case A.LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:var a=p(e,48,57,!0,i);return a.length<4?"0"+a:a;case A.LIST_STYLE_TYPE.CJK_DECIMAL:return m(e,"〇一二三四五六七八九",o);case A.LIST_STYLE_TYPE.LOWER_ROMAN:return g(e,1,3999,c,A.LIST_STYLE_TYPE.DECIMAL,i).toLowerCase();case A.LIST_STYLE_TYPE.UPPER_ROMAN:return g(e,1,3999,c,A.LIST_STYLE_TYPE.DECIMAL,i);case A.LIST_STYLE_TYPE.LOWER_GREEK:return p(e,945,969,!1,i);case A.LIST_STYLE_TYPE.LOWER_ALPHA:return p(e,97,122,!1,i);case A.LIST_STYLE_TYPE.UPPER_ALPHA:return p(e,65,90,!1,i);case A.LIST_STYLE_TYPE.ARABIC_INDIC:return p(e,1632,1641,!0,i);case A.LIST_STYLE_TYPE.ARMENIAN:case A.LIST_STYLE_TYPE.UPPER_ARMENIAN:return g(e,1,9999,d,A.LIST_STYLE_TYPE.DECIMAL,i);case A.LIST_STYLE_TYPE.LOWER_ARMENIAN:return g(e,1,9999,d,A.LIST_STYLE_TYPE.DECIMAL,i).toLowerCase();case A.LIST_STYLE_TYPE.BENGALI:return p(e,2534,2543,!0,i);case A.LIST_STYLE_TYPE.CAMBODIAN:case A.LIST_STYLE_TYPE.KHMER:return p(e,6112,6121,!0,i);case A.LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:return m(e,"子丑寅卯辰巳午未申酉戌亥",o);case A.LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:return m(e,"甲乙丙丁戊己庚辛壬癸",o);case A.LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:case A.LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:return C(e,"零一二三四五六七八九","十百千萬","負",o,14);case A.LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:return C(e,"零壹貳參肆伍陸柒捌玖","拾佰仟萬","負",o,15);case A.LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:return C(e,"零一二三四五六七八九","十百千萬","负",o,14);case A.LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:return C(e,"零壹贰叁肆伍陆柒捌玖","拾佰仟萬","负",o,15);case A.LIST_STYLE_TYPE.JAPANESE_INFORMAL:return C(e,"〇一二三四五六七八九","十百千万","マイナス",o,0);case A.LIST_STYLE_TYPE.JAPANESE_FORMAL:return C(e,"零壱弐参四伍六七八九","拾百千万","マイナス",o,7);case A.LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:return C(e,"영일이삼사오육칠팔구","십백천만","마이너스",r,7);case A.LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:return C(e,"零一二三四五六七八九","十百千萬","마이너스",r,0);case A.LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:return C(e,"零壹貳參四五六七八九","拾百千","마이너스",r,7);case A.LIST_STYLE_TYPE.DEVANAGARI:return p(e,2406,2415,!0,i);case A.LIST_STYLE_TYPE.GEORGIAN:return g(e,1,19999,h,A.LIST_STYLE_TYPE.DECIMAL,i);case A.LIST_STYLE_TYPE.GUJARATI:return p(e,2790,2799,!0,i);case A.LIST_STYLE_TYPE.GURMUKHI:return p(e,2662,2671,!0,i);case A.LIST_STYLE_TYPE.HEBREW:return g(e,1,10999,u,A.LIST_STYLE_TYPE.DECIMAL,i);case A.LIST_STYLE_TYPE.HIRAGANA:return m(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case A.LIST_STYLE_TYPE.HIRAGANA_IROHA:return m(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case A.LIST_STYLE_TYPE.KANNADA:return p(e,3302,3311,!0,i);case A.LIST_STYLE_TYPE.KATAKANA:return m(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",o);case A.LIST_STYLE_TYPE.KATAKANA_IROHA:return m(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",o);case A.LIST_STYLE_TYPE.LAO:return p(e,3792,3801,!0,i);case A.LIST_STYLE_TYPE.MONGOLIAN:return p(e,6160,6169,!0,i);case A.LIST_STYLE_TYPE.MYANMAR:return p(e,4160,4169,!0,i);case A.LIST_STYLE_TYPE.ORIYA:return p(e,2918,2927,!0,i);case A.LIST_STYLE_TYPE.PERSIAN:return p(e,1776,1785,!0,i);case A.LIST_STYLE_TYPE.TAMIL:return p(e,3046,3055,!0,i);case A.LIST_STYLE_TYPE.TELUGU:return p(e,3174,3183,!0,i);case A.LIST_STYLE_TYPE.THAI:return p(e,3664,3673,!0,i);case A.LIST_STYLE_TYPE.TIBETAN:return p(e,3872,3881,!0,i);case A.LIST_STYLE_TYPE.DECIMAL:default:return p(e,48,57,!0,i)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(5),r=n(11),a=function(e,t){var n=Math.max.apply(null,e.colorStops.map((function(e){return e.stop}))),i=1/Math.max(1,n);e.colorStops.forEach((function(e){t.addColorStop(i*e.stop,e.color.toString())}))},A=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.canvas=t||document.createElement("canvas")}return i(e,[{key:"render",value:function(e){this.ctx=this.canvas.getContext("2d"),this.options=e,this.canvas.width=Math.floor(e.width*e.scale),this.canvas.height=Math.floor(e.height*e.scale),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.ctx.scale(this.options.scale,this.options.scale),this.ctx.translate(-e.x,-e.y),this.ctx.textBaseline="bottom",e.logger.log("Canvas renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+this.options.scale)}},{key:"clip",value:function(e,t){var n=this;e.length&&(this.ctx.save(),e.forEach((function(e){n.path(e),n.ctx.clip()}))),t(),e.length&&this.ctx.restore()}},{key:"drawImage",value:function(e,t,n){this.ctx.drawImage(e,t.left,t.top,t.width,t.height,n.left,n.top,n.width,n.height)}},{key:"drawShape",value:function(e,t){this.path(e),this.ctx.fillStyle=t.toString(),this.ctx.fill()}},{key:"fill",value:function(e){this.ctx.fillStyle=e.toString(),this.ctx.fill()}},{key:"getTarget",value:function(){return this.canvas.getContext("2d").setTransform(1,0,0,1,0,0),Promise.resolve(this.canvas)}},{key:"path",value:function(e){var t=this;this.ctx.beginPath(),Array.isArray(e)?e.forEach((function(e,n){var i=e.type===o.PATH.VECTOR?e:e.start;0===n?t.ctx.moveTo(i.x,i.y):t.ctx.lineTo(i.x,i.y),e.type===o.PATH.BEZIER_CURVE&&t.ctx.bezierCurveTo(e.startControl.x,e.startControl.y,e.endControl.x,e.endControl.y,e.end.x,e.end.y)})):this.ctx.arc(e.x+e.radius,e.y+e.radius,e.radius,0,2*Math.PI,!0),this.ctx.closePath()}},{key:"rectangle",value:function(e,t,n,i,o){this.ctx.fillStyle=o.toString(),this.ctx.fillRect(e,t,n,i)}},{key:"renderLinearGradient",value:function(e,t){var n=this.ctx.createLinearGradient(e.left+t.direction.x1,e.top+t.direction.y1,e.left+t.direction.x0,e.top+t.direction.y0);a(t,n),this.ctx.fillStyle=n,this.ctx.fillRect(e.left,e.top,e.width,e.height)}},{key:"renderRadialGradient",value:function(e,t){var n=this,i=e.left+t.center.x,o=e.top+t.center.y,r=this.ctx.createRadialGradient(i,o,0,i,o,t.radius.x);if(r)if(a(t,r),this.ctx.fillStyle=r,t.radius.x!==t.radius.y){var A=e.left+.5*e.width,s=e.top+.5*e.height,l=t.radius.y/t.radius.x,c=1/l;this.transform(A,s,[1,0,0,l,0,0],(function(){return n.ctx.fillRect(e.left,c*(e.top-s)+s,e.width,e.height*c)}))}else this.ctx.fillRect(e.left,e.top,e.width,e.height)}},{key:"renderRepeat",value:function(e,t,n,i,o){this.path(e),this.ctx.fillStyle=this.ctx.createPattern(this.resizeImage(t,n),"repeat"),this.ctx.translate(i,o),this.ctx.fill(),this.ctx.translate(-i,-o)}},{key:"renderTextNode",value:function(e,t,n,i,o){var a=this;this.ctx.font=[n.fontStyle,n.fontVariant,n.fontWeight,n.fontSize,n.fontFamily].join(" "),e.forEach((function(e){if(a.ctx.fillStyle=t.toString(),o&&e.text.trim().length?o.slice(0).reverse().forEach((function(t){a.ctx.shadowColor=t.color.toString(),a.ctx.shadowOffsetX=t.offsetX*a.options.scale,a.ctx.shadowOffsetY=t.offsetY*a.options.scale,a.ctx.shadowBlur=t.blur,a.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height)})):a.ctx.fillText(e.text,e.bounds.left,e.bounds.top+e.bounds.height),null!==i){var A=i.textDecorationColor||t;i.textDecorationLine.forEach((function(t){switch(t){case r.TEXT_DECORATION_LINE.UNDERLINE:var i=a.options.fontMetrics.getMetrics(n).baseline;a.rectangle(e.bounds.left,Math.round(e.bounds.top+i),e.bounds.width,1,A);break;case r.TEXT_DECORATION_LINE.OVERLINE:a.rectangle(e.bounds.left,Math.round(e.bounds.top),e.bounds.width,1,A);break;case r.TEXT_DECORATION_LINE.LINE_THROUGH:var o=a.options.fontMetrics.getMetrics(n).middle;a.rectangle(e.bounds.left,Math.ceil(e.bounds.top+o),e.bounds.width,1,A)}}))}}))}},{key:"resizeImage",value:function(e,t){if(e.width===t.width&&e.height===t.height)return e;var n=this.canvas.ownerDocument.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),n}},{key:"setOpacity",value:function(e){this.ctx.globalAlpha=e}},{key:"transform",value:function(e,t,n,i){this.ctx.save(),this.ctx.translate(e,t),this.ctx.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.ctx.translate(-e,-t),i(),this.ctx.restore()}}]),e}();t.default=A},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,n,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.enabled="undefined"!=typeof window&&t,this.start=i||Date.now(),this.id=n}return i(e,[{key:"child",value:function(t){return new e(this.enabled,t,this.start)}},{key:"log",value:function(){if(this.enabled&&window.console&&window.console.log){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-this.start+"ms",this.id?"html2canvas ("+this.id+"):":"html2canvas:"].concat([].slice.call(t,0)))}}},{key:"error",value:function(){if(this.enabled&&window.console&&window.console.error){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Function.prototype.bind.call(window.console.error,window.console).apply(window.console,[Date.now()-this.start+"ms",this.id?"html2canvas ("+this.id+"):":"html2canvas:"].concat([].slice.call(t,0)))}}}]),e}();t.default=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePadding=t.PADDING_SIDES=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),o=(t.PADDING_SIDES={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},["top","right","bottom","left"]);t.parsePadding=function(e){return o.map((function(t){return new i.default(e.getPropertyValue("padding-"+t))}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.OVERFLOW_WRAP={NORMAL:0,BREAK_WORD:1};t.parseOverflowWrap=function(e){switch(e){case"break-word":return i.BREAK_WORD;case"normal":default:return i.NORMAL}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.POSITION={STATIC:0,RELATIVE:1,ABSOLUTE:2,FIXED:3,STICKY:4};t.parsePosition=function(e){switch(e){case"relative":return i.RELATIVE;case"absolute":return i.ABSOLUTE;case"fixed":return i.FIXED;case"sticky":return i.STICKY}return i.STATIC}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.TEXT_TRANSFORM={NONE:0,LOWERCASE:1,UPPERCASE:2,CAPITALIZE:3};t.parseTextTransform=function(e){switch(e){case"uppercase":return i.UPPERCASE;case"lowercase":return i.LOWERCASE;case"capitalize":return i.CAPITALIZE}return i.NONE}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.reformatInputBounds=t.inlineSelectElement=t.inlineTextAreaElement=t.inlineInputElement=t.getInputBorderRadius=t.INPUT_BACKGROUND=t.INPUT_BORDERS=t.INPUT_COLOR=void 0;var o=i(n(9)),r=n(4),a=n(12),A=i(n(50)),s=i(n(7)),l=i(n(0)),c=i(n(1)),d=(n(2),n(22),n(3)),u=(t.INPUT_COLOR=new l.default([42,42,42]),new l.default([165,165,165])),h=new l.default([222,222,222]),g={borderWidth:1,borderColor:u,borderStyle:a.BORDER_STYLE.SOLID},f=(t.INPUT_BORDERS=[g,g,g,g],t.INPUT_BACKGROUND={backgroundColor:h,backgroundImage:[],backgroundClip:r.BACKGROUND_CLIP.PADDING_BOX,backgroundOrigin:r.BACKGROUND_ORIGIN.PADDING_BOX},new c.default("50%")),p=[f,f],m=[p,p,p,p],C=new c.default("3px"),B=[C,C],v=[B,B,B,B],w=(t.getInputBorderRadius=function(e){return"radio"===e.type?m:v},t.inlineInputElement=function(e,t){if("radio"===e.type||"checkbox"===e.type){if(e.checked){var n=Math.min(t.bounds.width,t.bounds.height);t.childNodes.push("checkbox"===e.type?[new s.default(t.bounds.left+.39363*n,t.bounds.top+.79*n),new s.default(t.bounds.left+.16*n,t.bounds.top+.5549*n),new s.default(t.bounds.left+.27347*n,t.bounds.top+.44071*n),new s.default(t.bounds.left+.39694*n,t.bounds.top+.5649*n),new s.default(t.bounds.left+.72983*n,t.bounds.top+.23*n),new s.default(t.bounds.left+.84*n,t.bounds.top+.34085*n),new s.default(t.bounds.left+.39363*n,t.bounds.top+.79*n)]:new A.default(t.bounds.left+n/4,t.bounds.top+n/4,n/4))}}else w(b(e),e,t,!1)},t.inlineTextAreaElement=function(e,t){w(e.value,e,t,!0)},t.inlineSelectElement=function(e,t){var n=e.options[e.selectedIndex||0];w(n&&n.text||"",e,t,!1)},t.reformatInputBounds=function(e){return e.width>e.height?(e.left+=(e.width-e.height)/2,e.width=e.height):e.width<e.height&&(e.top+=(e.height-e.width)/2,e.height=e.width),e},function(e,t,n,i){var r=t.ownerDocument.body;if(e.length>0&&r){var a=t.ownerDocument.createElement("html2canvaswrapper");(0,d.copyCSSStyles)(t.ownerDocument.defaultView.getComputedStyle(t,null),a),a.style.position="absolute",a.style.left=n.bounds.left+"px",a.style.top=n.bounds.top+"px",i||(a.style.whiteSpace="nowrap");var A=t.ownerDocument.createTextNode(e);a.appendChild(A),r.appendChild(a),n.childNodes.push(o.default.fromTextNode(A,n)),r.removeChild(a)}}),b=function(e){var t="password"===e.type?new Array(e.value.length+1).join("•"):e.value;return 0===t.length?e.placeholder||"":t}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextBounds=t.TextBounds=void 0;var i=n(2),o=n(11),r=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),a=n(24),A=t.TextBounds=function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.text=t,this.bounds=n},s=(t.parseTextBounds=function(e,t,n){for(var i=0!==t.style.letterSpacing?(0,a.toCodePoints)(e).map((function(e){return(0,a.fromCodePoint)(e)})):(0,a.breakWords)(e,t),c=i.length,d=n.parentNode?n.parentNode.ownerDocument.defaultView:null,u=d?d.pageXOffset:0,h=d?d.pageYOffset:0,g=[],f=0,p=0;p<c;p++){var m=i[p];if(t.style.textDecoration!==o.TEXT_DECORATION.NONE||m.trim().length>0)if(r.default.SUPPORT_RANGE_BOUNDS)g.push(new A(m,l(n,f,m.length,u,h)));else{var C=n.splitText(m.length);g.push(new A(m,s(n,u,h))),n=C}else r.default.SUPPORT_RANGE_BOUNDS||(n=n.splitText(m.length));f+=m.length}return g},function(e,t,n){var o=e.ownerDocument.createElement("html2canvaswrapper");o.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(o,e);var a=(0,i.parseBounds)(o,t,n);return o.firstChild&&r.replaceChild(o.firstChild,o),a}return new i.Bounds(0,0,0,0)}),l=function(e,t,n,o,r){var a=e.ownerDocument.createRange();return a.setStart(e,t),a.setEnd(e,t+n),i.Bounds.fromClientRect(a.getBoundingClientRect(),o,r)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.element=t}return i(e,[{key:"render",value:function(e){var t=this;this.options=e,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=Math.floor(e.width)*e.scale,this.canvas.height=Math.floor(e.height)*e.scale,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",e.logger.log("ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale);var n=r(Math.max(e.windowWidth,e.width)*e.scale,Math.max(e.windowHeight,e.height)*e.scale,e.scrollX*e.scale,e.scrollY*e.scale,this.element);return a(n).then((function(n){return e.backgroundColor&&(t.ctx.fillStyle=e.backgroundColor.toString(),t.ctx.fillRect(0,0,e.width*e.scale,e.height*e.scale)),t.ctx.drawImage(n,-e.x*e.scale,-e.y*e.scale),t.canvas}))}}]),e}();t.default=o;var r=t.createForeignObjectSVG=function(e,t,n,i,o){var r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),A=document.createElementNS(r,"foreignObject");return a.setAttributeNS(null,"width",e),a.setAttributeNS(null,"height",t),A.setAttributeNS(null,"width","100%"),A.setAttributeNS(null,"height","100%"),A.setAttributeNS(null,"x",n),A.setAttributeNS(null,"y",i),A.setAttributeNS(null,"externalResourcesRequired","true"),a.appendChild(A),A.appendChild(o),a},a=t.loadSerializedSVG=function(e){return new Promise((function(t,n){var i=new Image;i.onload=function(){return t(i)},i.onerror=n,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(e))}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.breakWords=t.fromCodePoint=t.toCodePoints=void 0;var i=n(46);Object.defineProperty(t,"toCodePoints",{enumerable:!0,get:function(){return i.toCodePoints}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return i.fromCodePoint}});var o=n(18);t.breakWords=function(e,t){for(var n=(0,i.LineBreaker)(e,{lineBreak:t.style.lineBreak,wordBreak:t.style.overflowWrap===o.OVERFLOW_WRAP.BREAK_WORD?"break-word":t.style.wordBreak}),r=[],a=void 0;!(a=n.next()).done;)r.push(a.value.slice());return r}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.FontMetrics=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(3);t.FontMetrics=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._data={},this._document=t}return i(e,[{key:"_parseMetrics",value:function(e){var t=this._document.createElement("div"),n=this._document.createElement("img"),i=this._document.createElement("span"),r=this._document.body;if(!r)throw new Error("No document found for font metrics");t.style.visibility="hidden",t.style.fontFamily=e.fontFamily,t.style.fontSize=e.fontSize,t.style.margin="0",t.style.padding="0",r.appendChild(t),n.src=o.SMALL_IMAGE,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",i.style.fontFamily=e.fontFamily,i.style.fontSize=e.fontSize,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode("Hidden Text")),t.appendChild(i),t.appendChild(n);var a=n.offsetTop-i.offsetTop+2;t.removeChild(i),t.appendChild(this._document.createTextNode("Hidden Text")),t.style.lineHeight="normal",n.style.verticalAlign="super";var A=n.offsetTop-t.offsetTop+2;return r.removeChild(t),{baseline:a,middle:A}}},{key:"getMetrics",value:function(e){var t=e.fontFamily+" "+e.fontSize;return void 0===this._data[t]&&(this._data[t]=this._parseMetrics(e)),this._data[t]}}]),e}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Proxy=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(10));t.Proxy=function(e,t){if(!t.proxy)return Promise.reject("No proxy defined");var n=t.proxy;return new Promise((function(o,r){var a=i.default.SUPPORT_CORS_XHR&&i.default.SUPPORT_RESPONSE_TYPE?"blob":"text",A=i.default.SUPPORT_CORS_XHR?new XMLHttpRequest:new XDomainRequest;if(A.onload=function(){if(A instanceof XMLHttpRequest)if(200===A.status)if("text"===a)o(A.response);else{var t=new FileReader;t.addEventListener("load",(function(){return o(t.result)}),!1),t.addEventListener("error",(function(e){return r(e)}),!1),t.readAsDataURL(A.response)}else r("Failed to proxy resource "+e.substring(0,256)+" with status code "+A.status);else o(A.responseText)},A.onerror=r,A.open("GET",n+"?url="+encodeURIComponent(e)+"&responseType="+a),"text"!==a&&A instanceof XMLHttpRequest&&(A.responseType=a),t.imageTimeout){var s=t.imageTimeout;A.timeout=s,A.ontimeout=function(){return r("Timed out ("+s+"ms) proxying "+e.substring(0,256))}}A.send()}))}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=i(n(15)),a=i(n(16)),A=n(28),s=function(e,t){var n=t||{},i=new a.default("boolean"!=typeof n.logging||n.logging);i.log("html2canvas 16.0.1"),"function"==typeof n.onrendered&&i.error("onrendered option is deprecated, html2canvas returns a Promise with the canvas as the value");var s=e.ownerDocument;if(!s)return Promise.reject("Provided element is not within a Document");var l=s.defaultView,c={async:!0,allowTaint:!1,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,scale:l.devicePixelRatio||1,target:new r.default(n.canvas),useCORS:!1,windowWidth:l.innerWidth,windowHeight:l.innerHeight,scrollX:l.pageXOffset,scrollY:l.pageYOffset};return(0,A.renderElement)(e,o({},c,n),i).catch((function(e){throw i.error(e),e}))};s.CanvasRenderer=r.default,e.exports=s},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.renderElement=void 0;var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=(i(n(16)),n(29)),a=i(n(51)),A=i(n(23)),s=i(n(10)),l=n(2),c=n(54),d=n(25),u=n(0),h=i(u);t.renderElement=function e(t,n,i){var g=t.ownerDocument,f=new l.Bounds(n.scrollX,n.scrollY,n.windowWidth,n.windowHeight),p=g.documentElement?new h.default(getComputedStyle(g.documentElement).backgroundColor):u.TRANSPARENT,m=g.body?new h.default(getComputedStyle(g.body).backgroundColor):u.TRANSPARENT,C=t===g.documentElement?p.isTransparent()?m.isTransparent()?n.backgroundColor?new h.default(n.backgroundColor):null:m:p:n.backgroundColor?new h.default(n.backgroundColor):null;return(n.foreignObjectRendering?s.default.SUPPORT_FOREIGNOBJECT_DRAWING:Promise.resolve(!1)).then((function(s){return s?function(e){return i.log("Document cloned, using foreignObject rendering"),e.inlineFonts(g).then((function(){return e.resourceLoader.ready()})).then((function(){var o=new A.default(e.documentElement),r=g.defaultView,a=r.pageXOffset,s=r.pageYOffset,c="HTML"===t.tagName||"BODY"===t.tagName?(0,l.parseDocumentSize)(g):(0,l.parseBounds)(t,a,s),d=c.width,u=c.height,h=c.left,f=c.top;return o.render({backgroundColor:C,logger:i,scale:n.scale,x:"number"==typeof n.x?n.x:h,y:"number"==typeof n.y?n.y:f,width:"number"==typeof n.width?n.width:Math.ceil(d),height:"number"==typeof n.height?n.height:Math.ceil(u),windowWidth:n.windowWidth,windowHeight:n.windowHeight,scrollX:n.scrollX,scrollY:n.scrollY})}))}(new c.DocumentCloner(t,n,i,!0,e)):(0,c.cloneWindow)(g,f,t,n,i,e).then((function(e){var t=o(e,3),A=t[0],s=t[1],c=t[2];i.log("Document cloned, using computed rendering");var h=(0,r.NodeParser)(s,c,i),f=s.ownerDocument;return C===h.container.style.background.backgroundColor&&(h.container.style.background.backgroundColor=u.TRANSPARENT),c.ready().then((function(e){var t=new d.FontMetrics(f);i.log("Starting renderer");var o=f.defaultView,r=o.pageXOffset,c=o.pageYOffset,u="HTML"===s.tagName||"BODY"===s.tagName?(0,l.parseDocumentSize)(g):(0,l.parseBounds)(s,r,c),p=u.width,m=u.height,B=u.left,v=u.top,w={backgroundColor:C,fontMetrics:t,imageStore:e,logger:i,scale:n.scale,x:"number"==typeof n.x?n.x:B,y:"number"==typeof n.y?n.y:v,width:"number"==typeof n.width?n.width:Math.ceil(p),height:"number"==typeof n.height?n.height:Math.ceil(m)};if(Array.isArray(n.target))return Promise.all(n.target.map((function(e){return new a.default(e,w).render(h)})));var b=new a.default(n.target,w).render(h);return!0===n.removeContainer&&(A.parentNode?A.parentNode.removeChild(A):i.log("Cannot detach cloned iframe as it is not in the DOM anymore")),b}))}))}))}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NodeParser=void 0;var o=i(n(30)),r=i(n(6)),a=i(n(9)),A=n(21),s=n(14),l=n(8),c=(t.NodeParser=function(e,t,n){n.log("Starting node parsing");var i=0,a=new r.default(e,null,t,i++),A=new o.default(a,null,!0);return d(e,a,A,t,1),n.log("Finished parsing node tree"),A},["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"]),d=function e(t,n,i,d,g){if(g>5e4)throw new Error("Recursion error while parsing node tree");for(var f,p=t.firstChild;p;p=f){f=p.nextSibling;var m=p.ownerDocument.defaultView;if(p instanceof m.Text||p instanceof Text||m.parent&&p instanceof m.parent.Text)p.data.trim().length>0&&n.childNodes.push(a.default.fromTextNode(p,n));else if(p instanceof m.HTMLElement||p instanceof HTMLElement||m.parent&&p instanceof m.parent.HTMLElement){if(-1===c.indexOf(p.nodeName)){var C=new r.default(p,n,d,g++);if(C.isVisible()){"INPUT"===p.tagName?(0,A.inlineInputElement)(p,C):"TEXTAREA"===p.tagName?(0,A.inlineTextAreaElement)(p,C):"SELECT"===p.tagName?(0,A.inlineSelectElement)(p,C):C.style.listStyle&&C.style.listStyle.listStyleType!==l.LIST_STYLE_TYPE.NONE&&(0,s.inlineListItemElement)(p,C,d);var B="TEXTAREA"!==p.tagName,v=u(C,p);if(v||h(C)){var w=v||C.isPositioned()?i.getRealParentStackingContext():i,b=new o.default(C,w,v);w.contexts.push(b),B&&e(p,C,b,d,g)}else i.children.push(C),B&&e(p,C,i,d,g)}}}else if(p instanceof m.SVGSVGElement||p instanceof SVGSVGElement||m.parent&&p instanceof m.parent.SVGSVGElement){var y=new r.default(p,n,d,g++),F=u(y,p);if(F||h(y)){var E=F||y.isPositioned()?i.getRealParentStackingContext():i,_=new o.default(y,E,F);E.contexts.push(_)}else i.children.push(y)}}},u=function(e,t){return e.isRootElement()||e.isPositionedWithZIndex()||e.style.opacity<1||e.isTransformed()||g(e,t)},h=function(e){return e.isPositioned()||e.isFloating()},g=function(e,t){return"BODY"===t.nodeName&&e.parent instanceof r.default&&e.parent.style.background.backgroundColor.isTransparent()}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=(function(e){e&&e.__esModule}(n(6)),n(19),function(){function e(t,n,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.container=t,this.parent=n,this.contexts=[],this.children=[],this.treatAsRealStackingContext=i}return i(e,[{key:"getOpacity",value:function(){return this.parent?this.container.style.opacity*this.parent.getOpacity():this.container.style.opacity}},{key:"getRealParentStackingContext",value:function(){return!this.parent||this.treatAsRealStackingContext?this:this.parent.getRealParentStackingContext()}}]),e}());t.default=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.width=t,this.height=n}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(5),r=function(e){return e&&e.__esModule?e:{default:e}}(n(7)),a=function(e,t,n){return new r.default(e.x+(t.x-e.x)*n,e.y+(t.y-e.y)*n)},A=function(){function e(t,n,i,r){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.type=o.PATH.BEZIER_CURVE,this.start=t,this.startControl=n,this.endControl=i,this.end=r}return i(e,[{key:"subdivide",value:function(t,n){var i=a(this.start,this.startControl,t),o=a(this.startControl,this.endControl,t),r=a(this.endControl,this.end,t),A=a(i,o,t),s=a(o,r,t),l=a(A,s,t);return n?new e(this.start,i,A,l):new e(l,s,r,this.end)}},{key:"reverse",value:function(){return new e(this.end,this.endControl,this.startControl,this.start)}}]),e}();t.default=A},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseBorderRadius=void 0;var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),r=["top-left","top-right","bottom-right","bottom-left"];t.parseBorderRadius=function(e){return r.map((function(t){var n=e.getPropertyValue("border-"+t+"-radius").split(" ").map(o.default.create),r=i(n,2),a=r[0],A=r[1];return void 0===A?[a,a]:[a,A]}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.DISPLAY={NONE:1,BLOCK:2,INLINE:4,RUN_IN:8,FLOW:16,FLOW_ROOT:32,TABLE:64,FLEX:128,GRID:256,RUBY:512,SUBGRID:1024,LIST_ITEM:2048,TABLE_ROW_GROUP:4096,TABLE_HEADER_GROUP:8192,TABLE_FOOTER_GROUP:16384,TABLE_ROW:32768,TABLE_CELL:65536,TABLE_COLUMN_GROUP:1<<17,TABLE_COLUMN:1<<18,TABLE_CAPTION:1<<19,RUBY_BASE:1<<20,RUBY_TEXT:1<<21,RUBY_BASE_CONTAINER:1<<22,RUBY_TEXT_CONTAINER:1<<23,CONTENTS:1<<24,INLINE_BLOCK:1<<25,INLINE_LIST_ITEM:1<<26,INLINE_TABLE:1<<27,INLINE_FLEX:1<<28,INLINE_GRID:1<<29},o=function(e,t){return e|function(e){switch(e){case"block":return i.BLOCK;case"inline":return i.INLINE;case"run-in":return i.RUN_IN;case"flow":return i.FLOW;case"flow-root":return i.FLOW_ROOT;case"table":return i.TABLE;case"flex":return i.FLEX;case"grid":return i.GRID;case"ruby":return i.RUBY;case"subgrid":return i.SUBGRID;case"list-item":return i.LIST_ITEM;case"table-row-group":return i.TABLE_ROW_GROUP;case"table-header-group":return i.TABLE_HEADER_GROUP;case"table-footer-group":return i.TABLE_FOOTER_GROUP;case"table-row":return i.TABLE_ROW;case"table-cell":return i.TABLE_CELL;case"table-column-group":return i.TABLE_COLUMN_GROUP;case"table-column":return i.TABLE_COLUMN;case"table-caption":return i.TABLE_CAPTION;case"ruby-base":return i.RUBY_BASE;case"ruby-text":return i.RUBY_TEXT;case"ruby-base-container":return i.RUBY_BASE_CONTAINER;case"ruby-text-container":return i.RUBY_TEXT_CONTAINER;case"contents":return i.CONTENTS;case"inline-block":return i.INLINE_BLOCK;case"inline-list-item":return i.INLINE_LIST_ITEM;case"inline-table":return i.INLINE_TABLE;case"inline-flex":return i.INLINE_FLEX;case"inline-grid":return i.INLINE_GRID}return i.NONE}(t)};t.parseDisplay=function(e){return e.split(" ").reduce(o,0)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.FLOAT={NONE:0,LEFT:1,RIGHT:2,INLINE_START:3,INLINE_END:4};t.parseCSSFloat=function(e){switch(e){case"left":return i.LEFT;case"right":return i.RIGHT;case"inline-start":return i.INLINE_START;case"inline-end":return i.INLINE_END}return i.NONE}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){switch(e){case"normal":return 400;case"bold":return 700}var t=parseInt(e,10);return isNaN(t)?400:t};t.parseFont=function(e){return{fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontVariant:e.fontVariant,fontWeight:i(e.fontWeight)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseLetterSpacing=function(e){if("normal"===e)return 0;var t=parseFloat(e);return isNaN(t)?0:t}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.LINE_BREAK={NORMAL:"normal",STRICT:"strict"};t.parseLineBreak=function(e){switch(e){case"strict":return i.STRICT;case"normal":default:return i.NORMAL}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseMargin=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),o=["top","right","bottom","left"];t.parseMargin=function(e){return o.map((function(t){return new i.default(e.getPropertyValue("margin-"+t))}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.OVERFLOW={VISIBLE:0,HIDDEN:1,SCROLL:2,AUTO:3};t.parseOverflow=function(e){switch(e){case"hidden":return i.HIDDEN;case"scroll":return i.SCROLL;case"auto":return i.AUTO;case"visible":default:return i.VISIBLE}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseTextShadow=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=/^([+-]|\d|\.)$/i;t.parseTextShadow=function(e){if("none"===e||"string"!=typeof e)return null;for(var t="",n=!1,r=[],a=[],A=0,s=null,l=function(){t.length&&(n?r.push(parseFloat(t)):s=new i.default(t)),n=!1,t=""},c=function(){r.length&&null!==s&&a.push({color:s,offsetX:r[0]||0,offsetY:r[1]||0,blur:r[2]||0}),r.splice(0,r.length),s=null},d=0;d<e.length;d++){var u=e[d];switch(u){case"(":t+=u,A++;break;case")":t+=u,A--;break;case",":0===A?(l(),c()):t+=u;break;case" ":0===A?l():t+=u;break;default:0===t.length&&o.test(u)&&(n=!0),t+=u}}return l(),c(),0===a.length?null:a}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseTransform=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),o=function(e){return parseFloat(e.trim())},r=/(matrix|matrix3d)\((.+)\)/,a=(t.parseTransform=function(e){var t=A(e.transform||e.webkitTransform||e.mozTransform||e.msTransform||e.oTransform);return null===t?null:{transform:t,transformOrigin:a(e.transformOrigin||e.webkitTransformOrigin||e.mozTransformOrigin||e.msTransformOrigin||e.oTransformOrigin)}},function(e){if("string"!=typeof e){var t=new i.default("0");return[t,t]}var n=e.split(" ").map(i.default.create);return[n[0],n[1]]}),A=function(e){if("none"===e||"string"!=typeof e)return null;var t=e.match(r);if(t){if("matrix"===t[1]){var n=t[2].split(",").map(o);return[n[0],n[1],n[2],n[3],n[4],n[5]]}var i=t[2].split(",").map(o);return[i[0],i[1],i[4],i[5],i[12],i[13]]}return null}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.VISIBILITY={VISIBLE:0,HIDDEN:1,COLLAPSE:2};t.parseVisibility=function(e){switch(e){case"hidden":return i.HIDDEN;case"collapse":return i.COLLAPSE;case"visible":default:return i.VISIBLE}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=t.WORD_BREAK={NORMAL:"normal",BREAK_ALL:"break-all",KEEP_ALL:"keep-all"};t.parseWordBreak=function(e){switch(e){case"break-all":return i.BREAK_ALL;case"keep-all":return i.KEEP_ALL;case"normal":default:return i.NORMAL}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseZIndex=function(e){var t="auto"===e;return{auto:t,order:t?0:parseInt(e,10)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(13);Object.defineProperty(t,"toCodePoints",{enumerable:!0,get:function(){return i.toCodePoints}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return i.fromCodePoint}});var o=n(47);Object.defineProperty(t,"LineBreaker",{enumerable:!0,get:function(){return o.LineBreaker}})},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.LineBreaker=t.inlineBreakOpportunities=t.lineBreakAtIndex=t.codePointsToCharacterClasses=t.UnicodeTrie=t.BREAK_ALLOWED=t.BREAK_NOT_ALLOWED=t.BREAK_MANDATORY=t.classes=t.LETTER_NUMBER_MODIFIER=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=n(48),a=function(e){return e&&e.__esModule?e:{default:e}}(n(49)),A=n(13),s=t.LETTER_NUMBER_MODIFIER=50,l=(t.classes={BK:1,CR:2,LF:3,CM:4,NL:5,SG:6,WJ:7,ZW:8,GL:9,SP:10,ZWJ:11,B2:12,BA:13,BB:14,HY:15,CB:16,CL:17,CP:18,EX:19,IN:20,NS:21,OP:22,QU:23,IS:24,NU:25,PO:26,PR:27,SY:28,AI:29,AL:30,CJ:31,EB:32,EM:33,H2:34,H3:35,HL:36,ID:37,JL:38,JV:39,JT:40,RI:41,SA:42,XX:43},t.BREAK_MANDATORY="!"),c=t.BREAK_NOT_ALLOWED="×",d=t.BREAK_ALLOWED="÷",u=t.UnicodeTrie=(0,r.createTrieFromBase64)(a.default),h=[30,36],g=[1,2,3,5],f=[10,8],p=[27,26],m=g.concat(f),C=[38,39,40,34,35],B=[15,13],v=t.codePointsToCharacterClasses=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"strict",n=[],i=[],o=[];return e.forEach((function(e,r){var a=u.get(e);if(a>s?(o.push(!0),a-=s):o.push(!1),-1!==["normal","auto","loose"].indexOf(t)&&-1!==[8208,8211,12316,12448].indexOf(e))return i.push(r),n.push(16);if(4===a||11===a){if(0===r)return i.push(r),n.push(30);var A=n[r-1];return-1===m.indexOf(A)?(i.push(i[r-1]),n.push(A)):(i.push(r),n.push(30))}return i.push(r),31===a?n.push("strict"===t?21:37):42===a||29===a?n.push(30):43===a?e>=131072&&e<=196605||e>=196608&&e<=262141?n.push(37):n.push(30):void n.push(a)})),[i,n,o]},w=function(e,t,n,i){var o=i[n];if(Array.isArray(e)?-1!==e.indexOf(o):e===o)for(var r=n;r<=i.length;){var a=i[++r];if(a===t)return!0;if(10!==a)break}if(10===o)for(var A=n;A>0;){var s=i[--A];if(Array.isArray(e)?-1!==e.indexOf(s):e===s)for(var l=n;l<=i.length;){var c=i[++l];if(c===t)return!0;if(10!==c)break}if(10!==s)break}return!1},b=function(e,t){for(var n=e;n>=0;){var i=t[n];if(10!==i)return i;n--}return 0},y=function(e,t,n,i,o){if(0===n[i])return c;var r=i-1;if(Array.isArray(o)&&!0===o[r])return c;var a=r-1,A=r+1,s=t[r],m=a>=0?t[a]:0,v=t[A];if(2===s&&3===v)return c;if(-1!==g.indexOf(s))return l;if(-1!==g.indexOf(v))return c;if(-1!==f.indexOf(v))return c;if(8===b(r,t))return d;if(11===u.get(e[r])&&(37===v||32===v||33===v))return c;if(7===s||7===v)return c;if(9===s)return c;if(-1===[10,13,15].indexOf(s)&&9===v)return c;if(-1!==[17,18,19,24,28].indexOf(v))return c;if(22===b(r,t))return c;if(w(23,22,r,t))return c;if(w([17,18],21,r,t))return c;if(w(12,12,r,t))return c;if(10===s)return d;if(23===s||23===v)return c;if(16===v||16===s)return d;if(-1!==[13,15,21].indexOf(v)||14===s)return c;if(36===m&&-1!==B.indexOf(s))return c;if(28===s&&36===v)return c;if(20===v&&-1!==h.concat(20,19,25,37,32,33).indexOf(s))return c;if(-1!==h.indexOf(v)&&25===s||-1!==h.indexOf(s)&&25===v)return c;if(27===s&&-1!==[37,32,33].indexOf(v)||-1!==[37,32,33].indexOf(s)&&26===v)return c;if(-1!==h.indexOf(s)&&-1!==p.indexOf(v)||-1!==p.indexOf(s)&&-1!==h.indexOf(v))return c;if(-1!==[27,26].indexOf(s)&&(25===v||-1!==[22,15].indexOf(v)&&25===t[A+1])||-1!==[22,15].indexOf(s)&&25===v||25===s&&-1!==[25,28,24].indexOf(v))return c;if(-1!==[25,28,24,17,18].indexOf(v))for(var y=r;y>=0;){var F=t[y];if(25===F)return c;if(-1===[28,24].indexOf(F))break;y--}if(-1!==[27,26].indexOf(v))for(var E=-1!==[17,18].indexOf(s)?a:r;E>=0;){var _=t[E];if(25===_)return c;if(-1===[28,24].indexOf(_))break;E--}if(38===s&&-1!==[38,39,34,35].indexOf(v)||-1!==[39,34].indexOf(s)&&-1!==[39,40].indexOf(v)||-1!==[40,35].indexOf(s)&&40===v)return c;if(-1!==C.indexOf(s)&&-1!==[20,26].indexOf(v)||-1!==C.indexOf(v)&&27===s)return c;if(-1!==h.indexOf(s)&&-1!==h.indexOf(v))return c;if(24===s&&-1!==h.indexOf(v))return c;if(-1!==h.concat(25).indexOf(s)&&22===v||-1!==h.concat(25).indexOf(v)&&18===s)return c;if(41===s&&41===v){for(var Q=n[r],U=1;Q>0&&41===t[--Q];)U++;if(U%2!=0)return c}return 32===s&&33===v?c:d},F=(t.lineBreakAtIndex=function(e,t){if(0===t)return c;if(t>=e.length)return l;var n=v(e),i=o(n,2),r=i[0],a=i[1];return y(e,a,r,t)},function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var n=v(e,t.lineBreak),i=o(n,3),r=i[0],a=i[1],A=i[2];return"break-all"!==t.wordBreak&&"break-word"!==t.wordBreak||(a=a.map((function(e){return-1!==[25,30,42].indexOf(e)?37:e}))),[r,a,"keep-all"===t.wordBreak?A.map((function(t,n){return t&&e[n]>=19968&&e[n]<=40959})):null]}),E=(t.inlineBreakOpportunities=function(e,t){var n=(0,A.toCodePoints)(e),i=c,r=F(n,t),a=o(r,3),s=a[0],d=a[1],u=a[2];return n.forEach((function(e,t){i+=(0,A.fromCodePoint)(e)+(t>=n.length-1?l:y(n,d,s,t+1,u))})),i},function(){function e(t,n,i,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._codePoints=t,this.required=n===l,this.start=i,this.end=o}return i(e,[{key:"slice",value:function(){return A.fromCodePoint.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this._codePoints.slice(this.start,this.end)))}}]),e}());t.LineBreaker=function(e,t){var n=(0,A.toCodePoints)(e),i=F(n,t),r=o(i,3),a=r[0],s=r[1],l=r[2],d=n.length,u=0,h=0;return{next:function(){if(h>=d)return{done:!0};for(var e=c;h<d&&(e=y(n,s,a,++h,l))===c;);if(e!==c||h===d){var t=new E(n,e,u,h);return u=h,{value:t,done:!1}}return{done:!0}}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Trie=t.createTrieFromBase64=t.UTRIE2_INDEX_2_MASK=t.UTRIE2_INDEX_2_BLOCK_LENGTH=t.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=t.UTRIE2_INDEX_1_OFFSET=t.UTRIE2_UTF8_2B_INDEX_2_LENGTH=t.UTRIE2_UTF8_2B_INDEX_2_OFFSET=t.UTRIE2_INDEX_2_BMP_LENGTH=t.UTRIE2_LSCP_INDEX_2_LENGTH=t.UTRIE2_DATA_MASK=t.UTRIE2_DATA_BLOCK_LENGTH=t.UTRIE2_LSCP_INDEX_2_OFFSET=t.UTRIE2_SHIFT_1_2=t.UTRIE2_INDEX_SHIFT=t.UTRIE2_SHIFT_1=t.UTRIE2_SHIFT_2=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(13),r=t.UTRIE2_SHIFT_2=5,a=t.UTRIE2_SHIFT_1=11,A=t.UTRIE2_INDEX_SHIFT=2,s=t.UTRIE2_SHIFT_1_2=a-r,l=t.UTRIE2_LSCP_INDEX_2_OFFSET=65536>>r,c=t.UTRIE2_DATA_BLOCK_LENGTH=1<<r,d=t.UTRIE2_DATA_MASK=c-1,u=t.UTRIE2_LSCP_INDEX_2_LENGTH=1024>>r,h=t.UTRIE2_INDEX_2_BMP_LENGTH=l+u,g=t.UTRIE2_UTF8_2B_INDEX_2_OFFSET=h,f=t.UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,p=t.UTRIE2_INDEX_1_OFFSET=g+f,m=t.UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>a,C=t.UTRIE2_INDEX_2_BLOCK_LENGTH=1<<s,B=t.UTRIE2_INDEX_2_MASK=C-1,v=(t.createTrieFromBase64=function(e){var t=(0,o.decode)(e),n=Array.isArray(t)?(0,o.polyUint32Array)(t):new Uint32Array(t),i=Array.isArray(t)?(0,o.polyUint16Array)(t):new Uint16Array(t),r=i.slice(12,n[4]/2),a=2===n[5]?i.slice((24+n[4])/2):n.slice(Math.ceil((24+n[4])/4));return new v(n[0],n[1],n[2],n[3],r,a)},t.Trie=function(){function e(t,n,i,o,r,a){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.initialValue=t,this.errorValue=n,this.highStart=i,this.highValueIndex=o,this.index=r,this.data=a}return i(e,[{key:"get",value:function(e){var t=void 0;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=((t=this.index[e>>r])<<A)+(e&d),this.data[t];if(e<=65535)return t=((t=this.index[l+(e-55296>>r)])<<A)+(e&d),this.data[t];if(e<this.highStart)return t=p-m+(e>>a),t=this.index[t],t+=e>>r&B,t=((t=this.index[t])<<A)+(e&d),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue}}]),e}())},function(e,t,n){e.exports="KwAAAAAAAAAACA4AIDoAAPAfAAACAAAAAAAIABAAGABAAEgAUABYAF4AZgBeAGYAYABoAHAAeABeAGYAfACEAIAAiACQAJgAoACoAK0AtQC9AMUAXgBmAF4AZgBeAGYAzQDVAF4AZgDRANkA3gDmAOwA9AD8AAQBDAEUARoBIgGAAIgAJwEvATcBPwFFAU0BTAFUAVwBZAFsAXMBewGDATAAiwGTAZsBogGkAawBtAG8AcIBygHSAdoB4AHoAfAB+AH+AQYCDgIWAv4BHgImAi4CNgI+AkUCTQJTAlsCYwJrAnECeQKBAk0CiQKRApkCoQKoArACuALAAsQCzAIwANQC3ALkAjAA7AL0AvwCAQMJAxADGAMwACADJgMuAzYDPgOAAEYDSgNSA1IDUgNaA1oDYANiA2IDgACAAGoDgAByA3YDfgOAAIQDgACKA5IDmgOAAIAAogOqA4AAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAK8DtwOAAIAAvwPHA88D1wPfAyAD5wPsA/QD/AOAAIAABAQMBBIEgAAWBB4EJgQuBDMEIAM7BEEEXgBJBCADUQRZBGEEaQQwADAAcQQ+AXkEgQSJBJEEgACYBIAAoASoBK8EtwQwAL8ExQSAAIAAgACAAIAAgACgAM0EXgBeAF4AXgBeAF4AXgBeANUEXgDZBOEEXgDpBPEE+QQBBQkFEQUZBSEFKQUxBTUFPQVFBUwFVAVcBV4AYwVeAGsFcwV7BYMFiwWSBV4AmgWgBacFXgBeAF4AXgBeAKsFXgCyBbEFugW7BcIFwgXIBcIFwgXQBdQF3AXkBesF8wX7BQMGCwYTBhsGIwYrBjMGOwZeAD8GRwZNBl4AVAZbBl4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAGMGXgBqBnEGXgBeAF4AXgBeAF4AXgBeAF4AXgB5BoAG4wSGBo4GkwaAAIADHgR5AF4AXgBeAJsGgABGA4AAowarBrMGswagALsGwwbLBjAA0wbaBtoG3QbaBtoG2gbaBtoG2gblBusG8wb7BgMHCwcTBxsHCwcjBysHMAc1BzUHOgdCB9oGSgdSB1oHYAfaBloHaAfaBlIH2gbaBtoG2gbaBtoG2gbaBjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHbQdeAF4ANQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQd1B30HNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B4MH2gaKB68EgACAAIAAgACAAIAAgACAAI8HlwdeAJ8HpweAAIAArwe3B14AXgC/B8UHygcwANAH2AfgB4AA6AfwBz4B+AcACFwBCAgPCBcIogEYAR8IJwiAAC8INwg/CCADRwhPCFcIXwhnCEoDGgSAAIAAgABvCHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIfQh3CHgIeQh6CHsIfAh9CHcIeAh5CHoIewh8CH0Idwh4CHkIegh7CHwIhAiLCI4IMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAANQc1BzUHNQc1BzUHNQc1BzUHNQc1B54INQc1B6II2gaqCLIIugiAAIAAvgjGCIAAgACAAIAAgACAAIAAgACAAIAAywiHAYAA0wiAANkI3QjlCO0I9Aj8CIAAgACAAAIJCgkSCRoJIgknCTYHLwk3CZYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiWCJYIlgiAAIAAAAFAAXgBeAGAAcABeAHwAQACQAKAArQC9AJ4AXgBeAE0A3gBRAN4A7AD8AMwBGgEAAKcBNwEFAUwBXAF4QkhCmEKnArcCgAHHAsABz4LAAcABwAHAAd+C6ABoAG+C/4LAAcABwAHAAc+DF4MAAcAB54M3gweDV4Nng3eDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEeDqABVg6WDqABoQ6gAaABoAHXDvcONw/3DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DvcO9w73DncPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB7cPPwlGCU4JMACAAIAAgABWCV4JYQmAAGkJcAl4CXwJgAkwADAAMAAwAIgJgACLCZMJgACZCZ8JowmrCYAAswkwAF4AXgB8AIAAuwkABMMJyQmAAM4JgADVCTAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAqwYWBNkIMAAwADAAMADdCeAJ6AnuCR4E9gkwAP4JBQoNCjAAMACAABUK0wiAAB0KJAosCjQKgAAwADwKQwqAAEsKvQmdCVMKWwowADAAgACAALcEMACAAGMKgABrCjAAMAAwADAAMAAwADAAMAAwADAAMAAeBDAAMAAwADAAMAAwADAAMAAwADAAMAAwAIkEPQFzCnoKiQSCCooKkAqJBJgKoAqkCokEGAGsCrQKvArBCjAAMADJCtEKFQHZCuEK/gHpCvEKMAAwADAAMACAAIwE+QowAIAAPwEBCzAAMAAwADAAMACAAAkLEQswAIAAPwEZCyELgAAOCCkLMAAxCzkLMAAwADAAMAAwADAAXgBeAEELMAAwADAAMAAwADAAMAAwAEkLTQtVC4AAXAtkC4AAiQkwADAAMAAwADAAMAAwADAAbAtxC3kLgAuFC4sLMAAwAJMLlwufCzAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAApwswADAAMACAAIAAgACvC4AAgACAAIAAgACAALcLMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAvwuAAMcLgACAAIAAgACAAIAAyguAAIAAgACAAIAA0QswADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAANkLgACAAIAA4AswADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACJCR4E6AswADAAhwHwC4AA+AsADAgMEAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMACAAIAAGAwdDCUMMAAwAC0MNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQw1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHPQwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADUHNQc1BzUHNQc1BzUHNQc2BzAAMAA5DDUHNQc1BzUHNQc1BzUHNQc1BzUHNQdFDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAgACAAIAATQxSDFoMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAF4AXgBeAF4AXgBeAF4AYgxeAGoMXgBxDHkMfwxeAIUMXgBeAI0MMAAwADAAMAAwAF4AXgCVDJ0MMAAwADAAMABeAF4ApQxeAKsMswy7DF4Awgy9DMoMXgBeAF4AXgBeAF4AXgBeAF4AXgDRDNkMeQBqCeAM3Ax8AOYM7Az0DPgMXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgBeAF4AXgCgAAANoAAHDQ4NFg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAeDSYNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIAAgACAAIAAgACAAC4NMABeAF4ANg0wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAD4NRg1ODVYNXg1mDTAAbQ0wADAAMAAwADAAMAAwADAA2gbaBtoG2gbaBtoG2gbaBnUNeg3CBYANwgWFDdoGjA3aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gaUDZwNpA2oDdoG2gawDbcNvw3HDdoG2gbPDdYN3A3fDeYN2gbsDfMN2gbaBvoN/g3aBgYODg7aBl4AXgBeABYOXgBeACUG2gYeDl4AJA5eACwO2w3aBtoGMQ45DtoG2gbaBtoGQQ7aBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDjUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B1EO2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQdZDjUHNQc1BzUHNQc1B2EONQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHaA41BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B3AO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gY1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1BzUHNQc1B2EO2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gZJDtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBtoG2gbaBkkOeA6gAKAAoAAwADAAMAAwAKAAoACgAKAAoACgAKAAgA4wADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAD//wQABAAEAAQABAAEAAQABAAEAA0AAwABAAEAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAKABMAFwAeABsAGgAeABcAFgASAB4AGwAYAA8AGAAcAEsASwBLAEsASwBLAEsASwBLAEsAGAAYAB4AHgAeABMAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAFgAbABIAHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYADQARAB4ABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkAFgAaABsAGwAbAB4AHQAdAB4ATwAXAB4ADQAeAB4AGgAbAE8ATwAOAFAAHQAdAB0ATwBPABcATwBPAE8AFgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwArAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAAQABAANAA0ASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAUAArACsAKwArACsAKwArACsABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAGgAaAFAAUABQAFAAUABMAB4AGwBQAB4AKwArACsABAAEAAQAKwBQAFAAUABQAFAAUAArACsAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUAArAFAAUAArACsABAArAAQABAAEAAQABAArACsAKwArAAQABAArACsABAAEAAQAKwArACsABAArACsAKwArACsAKwArAFAAUABQAFAAKwBQACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwAEAAQAUABQAFAABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUAArACsABABQAAQABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQAKwArAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeABsAKwArACsAKwArACsAKwBQAAQABAAEAAQABAAEACsABAAEAAQAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArAAQABAArACsABAAEAAQAKwArACsAKwArACsAKwArAAQABAArACsAKwArAFAAUAArAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwAeAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwAEAFAAKwBQAFAAUABQAFAAUAArACsAKwBQAFAAUAArAFAAUABQAFAAKwArACsAUABQACsAUAArAFAAUAArACsAKwBQAFAAKwArACsAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQAKwArACsABAAEAAQAKwAEAAQABAAEACsAKwBQACsAKwArACsAKwArAAQAKwArACsAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAB4AHgAeAB4AHgAeABsAHgArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArAFAAUABQACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAB4AUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABAArACsAKwArACsAKwArAAQABAArACsAKwArACsAKwArAFAAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwArAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAKwBcAFwAKwBcACsAKwBcACsAKwArACsAKwArAFwAXABcAFwAKwBcAFwAXABcAFwAXABcACsAXABcAFwAKwBcACsAXAArACsAXABcACsAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgArACoAKgBcACsAKwBcAFwAXABcAFwAKwBcACsAKgAqACoAKgAqACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAFwAXABcAFwAUAAOAA4ADgAOAB4ADgAOAAkADgAOAA0ACQATABMAEwATABMACQAeABMAHgAeAB4ABAAEAB4AHgAeAB4AHgAeAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUAANAAQAHgAEAB4ABAAWABEAFgARAAQABABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAAQABAAEAAQABAANAAQABABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsADQANAB4AHgAeAB4AHgAeAAQAHgAeAB4AHgAeAB4AKwAeAB4ADgAOAA0ADgAeAB4AHgAeAB4ACQAJACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgAeAB4AHgBcAFwAXABcAFwAXAAqACoAKgAqAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAKgAqACoAKgAqACoAKgBcAFwAXAAqACoAKgAqAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAXAAqAEsASwBLAEsASwBLAEsASwBLAEsAKgAqACoAKgAqACoAUABQAFAAUABQAFAAKwBQACsAKwArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQACsAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwAEAAQABAAeAA0AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAEQArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAADQANAA0AUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAA0ADQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQACsABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoADQANABUAXAANAB4ADQAbAFwAKgArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAB4AHgATABMADQANAA4AHgATABMAHgAEAAQABAAJACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAUABQAFAAUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwAeACsAKwArABMAEwBLAEsASwBLAEsASwBLAEsASwBLAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwBcAFwAXABcAFwAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcACsAKwArACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwAeAB4AXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsABABLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKgAqACoAKgAqACoAKgBcACoAKgAqACoAKgAqACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAUABQAFAAUABQAFAAUAArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4ADQANAA0ADQAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAHgAeAB4AHgBQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwANAA0ADQANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwBQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsABAAEAAQAHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAABABQAFAAUABQAAQABAAEAFAAUAAEAAQABAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAKwBQACsAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAKwArAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAKwAeAB4AHgAeAB4AHgAeAA4AHgArAA0ADQANAA0ADQANAA0ACQANAA0ADQAIAAQACwAEAAQADQAJAA0ADQAMAB0AHQAeABcAFwAWABcAFwAXABYAFwAdAB0AHgAeABQAFAAUAA0AAQABAAQABAAEAAQABAAJABoAGgAaABoAGgAaABoAGgAeABcAFwAdABUAFQAeAB4AHgAeAB4AHgAYABYAEQAVABUAFQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgANAB4ADQANAA0ADQAeAA0ADQANAAcAHgAeAB4AHgArAAQABAAEAAQABAAEAAQABAAEAAQAUABQACsAKwBPAFAAUABQAFAAUAAeAB4AHgAWABEATwBQAE8ATwBPAE8AUABQAFAAUABQAB4AHgAeABYAEQArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAaABsAGwAbABsAGgAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgBQABoAHgAdAB4AUAAeABoAHgAeAB4AHgAeAB4AHgAeAB4ATwAeAFAAGwAeAB4AUABQAFAAUABQAB4AHgAeAB0AHQAeAFAAHgBQAB4AUAAeAFAATwBQAFAAHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AUABQAFAAUABPAE8AUABQAFAAUABQAE8AUABQAE8AUABPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAE8ATwBPAE8ATwBPAE8ATwBPAE8AUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAATwAeAB4AKwArACsAKwAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB0AHQAeAB4AHgAdAB0AHgAeAB0AHgAeAB4AHQAeAB0AGwAbAB4AHQAeAB4AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB0AHgAdAB4AHQAdAB0AHQAdAB0AHgAdAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAdAB0AHQAdAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAlACUAHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBQAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAeAB4AHgAeAB0AHQAeAB4AHgAeAB0AHQAdAB4AHgAdAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB0AHQAeAB4AHQAeAB4AHgAeAB0AHQAeAB4AHgAeACUAJQAdAB0AJQAeACUAJQAlACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAHgAeAB4AHgAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHQAdAB0AHgAdACUAHQAdAB4AHQAdAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHQAdAB0AHQAlAB4AJQAlACUAHQAlACUAHQAdAB0AJQAlAB0AHQAlAB0AHQAlACUAJQAeAB0AHgAeAB4AHgAdAB0AJQAdAB0AHQAdAB0AHQAlACUAJQAlACUAHQAlACUAIAAlAB0AHQAlACUAJQAlACUAJQAlACUAHgAeAB4AJQAlACAAIAAgACAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeABcAFwAXABcAFwAXAB4AEwATACUAHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACUAJQBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwArACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAE8ATwBPAE8ATwBPAE8ATwAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeACsAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUAArACsAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQBQAFAAUABQACsAKwArACsAUABQAFAAUABQAFAAUABQAA0AUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAABAAEAAQAKwAEAAQAKwArACsAKwArAAQABAAEAAQAUABQAFAAUAArAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsABAAEAAQAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsADQANAA0ADQANAA0ADQANAB4AKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAUABQAFAAUABQAA0ADQANAA0ADQANABQAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwANAA0ADQANAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAeAAQABAAEAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLACsADQArAB4AKwArAAQABAAEAAQAUABQAB4AUAArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwAEAAQABAAEAAQABAAEAAQABAAOAA0ADQATABMAHgAeAB4ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0AUABQAFAAUAAEAAQAKwArAAQADQANAB4AUAArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXABcAA0ADQANACoASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUAArACsAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANACsADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEcARwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQACsAKwAeAAQABAANAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAEAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUAArACsAUAArACsAUABQACsAKwBQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AKwArAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAeAB4ADQANAA0ADQAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAArAAQABAArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAEAAQABAAEAAQABAAEACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAFgAWAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAKwBQACsAKwArACsAKwArAFAAKwArACsAKwBQACsAUAArAFAAKwBQAFAAUAArAFAAUAArAFAAKwArAFAAKwBQACsAUAArAFAAKwBQACsAUABQACsAUAArACsAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAUABQAFAAUAArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUAArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAlACUAJQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeACUAJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeACUAJQAlACUAJQAeACUAJQAlACUAJQAgACAAIAAlACUAIAAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIQAhACEAIQAhACUAJQAgACAAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAIAAlACUAJQAlACAAJQAgACAAIAAgACAAIAAgACAAIAAlACUAJQAgACUAJQAlACUAIAAgACAAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeACUAHgAlAB4AJQAlACUAJQAlACAAJQAlACUAJQAeACUAHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAIAAgACAAIAAgAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFwAXABcAFQAVABUAHgAeAB4AHgAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAIAAgACAAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAlACAAIAAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsA"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(5);t.default=function e(t,n,o){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.type=i.PATH.CIRCLE,this.x=t,this.y=n,this.radius=o,isNaN(t)&&console.error("Invalid x value given for Circle"),isNaN(n)&&console.error("Invalid y value given for Circle"),isNaN(o)&&console.error("Invalid radius value given for Circle")}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(2),a=(n(25),n(52)),A=function(e){return e&&e.__esModule?e:{default:e}}(n(9)),s=n(4),l=n(12),c=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.target=t,this.options=n,t.render(n)}return o(e,[{key:"renderNode",value:function(e){e.isVisible()&&(this.renderNodeBackgroundAndBorders(e),this.renderNodeContent(e))}},{key:"renderNodeContent",value:function(e){var t=this,n=function(){if(e.childNodes.length&&e.childNodes.forEach((function(n){if(n instanceof A.default){var i=n.parent.style;t.target.renderTextNode(n.bounds,i.color,i.font,i.textDecoration,i.textShadow)}else t.target.drawShape(n,e.style.color)})),e.image){var n=t.options.imageStore.get(e.image);if(n){var i=(0,r.calculateContentBox)(e.bounds,e.style.padding,e.style.border),o="number"==typeof n.width&&n.width>0?n.width:i.width,a="number"==typeof n.height&&n.height>0?n.height:i.height;o>0&&a>0&&t.target.clip([(0,r.calculatePaddingBoxPath)(e.curvedBounds)],(function(){t.target.drawImage(n,new r.Bounds(0,0,o,a),i)}))}}},i=e.getClipPaths();i.length?this.target.clip(i,n):n()}},{key:"renderNodeBackgroundAndBorders",value:function(e){var t=this,n=!e.style.background.backgroundColor.isTransparent()||e.style.background.backgroundImage.length,i=e.style.border.some((function(e){return e.borderStyle!==l.BORDER_STYLE.NONE&&!e.borderColor.isTransparent()})),o=function(){var i=(0,s.calculateBackgroungPaintingArea)(e.curvedBounds,e.style.background.backgroundClip);n&&t.target.clip([i],(function(){e.style.background.backgroundColor.isTransparent()||t.target.fill(e.style.background.backgroundColor),t.renderBackgroundImage(e)})),e.style.border.forEach((function(n,i){n.borderStyle===l.BORDER_STYLE.NONE||n.borderColor.isTransparent()||t.renderBorder(n,i,e.curvedBounds)}))};if(n||i){var r=e.parent?e.parent.getClipPaths():[];r.length?this.target.clip(r,o):o()}}},{key:"renderBackgroundImage",value:function(e){var t=this;e.style.background.backgroundImage.slice(0).reverse().forEach((function(n){"url"===n.source.method&&n.source.args.length?t.renderBackgroundRepeat(e,n):/gradient/i.test(n.source.method)&&t.renderBackgroundGradient(e,n)}))}},{key:"renderBackgroundRepeat",value:function(e,t){var n=this.options.imageStore.get(t.source.args[0]);if(n){var i=(0,s.calculateBackgroungPositioningArea)(e.style.background.backgroundOrigin,e.bounds,e.style.padding,e.style.border),o=(0,s.calculateBackgroundSize)(t,n,i),r=(0,s.calculateBackgroundPosition)(t.position,o,i),a=(0,s.calculateBackgroundRepeatPath)(t,r,o,i,e.bounds),A=Math.round(i.left+r.x),l=Math.round(i.top+r.y);this.target.renderRepeat(a,n,o,A,l)}}},{key:"renderBackgroundGradient",value:function(e,t){var n=(0,s.calculateBackgroungPositioningArea)(e.style.background.backgroundOrigin,e.bounds,e.style.padding,e.style.border),i=(0,s.calculateGradientBackgroundSize)(t,n),o=(0,s.calculateBackgroundPosition)(t.position,i,n),A=new r.Bounds(Math.round(n.left+o.x),Math.round(n.top+o.y),i.width,i.height),l=(0,a.parseGradient)(e,t.source,A);if(l)switch(l.type){case a.GRADIENT_TYPE.LINEAR_GRADIENT:this.target.renderLinearGradient(A,l);break;case a.GRADIENT_TYPE.RADIAL_GRADIENT:this.target.renderRadialGradient(A,l)}}},{key:"renderBorder",value:function(e,t,n){this.target.drawShape((0,r.parsePathForBorder)(n,t),e.borderColor)}},{key:"renderStack",value:function(e){var t=this;if(e.container.isVisible()){var n=e.getOpacity();n!==this._opacity&&(this.target.setOpacity(e.getOpacity()),this._opacity=n);var i=e.container.style.transform;null!==i?this.target.transform(e.container.bounds.left+i.transformOrigin[0].value,e.container.bounds.top+i.transformOrigin[1].value,i.transform,(function(){return t.renderStackContent(e)})):this.renderStackContent(e)}}},{key:"renderStackContent",value:function(e){var t=u(e),n=i(t,5),o=n[0],r=n[1],a=n[2],A=n[3],s=n[4],l=d(e),c=i(l,2),g=c[0],f=c[1];this.renderNodeBackgroundAndBorders(e.container),o.sort(h).forEach(this.renderStack,this),this.renderNodeContent(e.container),f.forEach(this.renderNode,this),A.forEach(this.renderStack,this),s.forEach(this.renderStack,this),g.forEach(this.renderNode,this),r.forEach(this.renderStack,this),a.sort(h).forEach(this.renderStack,this)}},{key:"render",value:function(e){var t=this;return this.options.backgroundColor&&this.target.rectangle(this.options.x,this.options.y,this.options.width,this.options.height,this.options.backgroundColor),this.renderStack(e),this.target.getTarget().then((function(e){return t.options.logger.log("Render completed"),e}))}}]),e}();t.default=c;var d=function(e){for(var t=[],n=[],i=e.children.length,o=0;o<i;o++){var r=e.children[o];r.isInlineLevel()?t.push(r):n.push(r)}return[t,n]},u=function(e){for(var t=[],n=[],i=[],o=[],r=[],a=e.contexts.length,A=0;A<a;A++){var s=e.contexts[A];s.container.isPositioned()||s.container.style.opacity<1||s.container.isTransformed()?s.container.style.zIndex.order<0?t.push(s):s.container.style.zIndex.order>0?i.push(s):n.push(s):s.container.isFloating()?o.push(s):r.push(s)}return[t,n,i,o,r]},h=function(e,t){return e.container.style.zIndex.order>t.container.style.zIndex.order?1:e.container.style.zIndex.order<t.container.style.zIndex.order?-1:e.container.index>t.container.index?1:-1}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.transformWebkitRadialGradientArgs=t.parseGradient=t.RadialGradient=t.LinearGradient=t.RADIAL_GRADIENT_SHAPE=t.GRADIENT_TYPE=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=(i(n(6)),n(53)),A=i(n(0)),s=n(1),l=i(s),c=n(3),d=/^(to )?(left|top|right|bottom)( (left|top|right|bottom))?$/i,u=/^([+-]?\d*\.?\d+)% ([+-]?\d*\.?\d+)%$/i,h=/(px)|%|( 0)$/i,g=/^(from|to|color-stop)\((?:([\d.]+)(%)?,\s*)?(.+?)\)$/i,f=/^\s*(circle|ellipse)?\s*((?:([\d.]+)(px|r?em|%)\s*(?:([\d.]+)(px|r?em|%))?)|closest-side|closest-corner|farthest-side|farthest-corner)?\s*(?:at\s*(?:(left|center|right)|([\d.]+)(px|r?em|%))\s+(?:(top|center|bottom)|([\d.]+)(px|r?em|%)))?(?:\s|$)/i,p=t.GRADIENT_TYPE={LINEAR_GRADIENT:0,RADIAL_GRADIENT:1},m=t.RADIAL_GRADIENT_SHAPE={CIRCLE:0,ELLIPSE:1},C={left:new l.default("0%"),top:new l.default("0%"),center:new l.default("50%"),right:new l.default("100%"),bottom:new l.default("100%")},B=t.LinearGradient=function e(t,n){o(this,e),this.type=p.LINEAR_GRADIENT,this.colorStops=t,this.direction=n},v=t.RadialGradient=function e(t,n,i,r){o(this,e),this.type=p.RADIAL_GRADIENT,this.colorStops=t,this.shape=n,this.center=i,this.radius=r},w=(t.parseGradient=function(e,t,n){var i=t.args,o=t.method,r=t.prefix;return"linear-gradient"===o?b(i,n,!!r):"gradient"===o&&"linear"===i[0]?b(["to bottom"].concat(I(i.slice(3))),n,!!r):"radial-gradient"===o?y(e,"-webkit-"===r?S(i):i,n):"gradient"===o&&"radial"===i[0]?y(e,I(S(i.slice(1))),n):void 0},function(e,t,n){for(var i=[],o=t;o<e.length;o++){var r=e[o],a=h.test(r),s=r.lastIndexOf(" "),c=new A.default(a?r.substring(0,s):r),d=a?new l.default(r.substring(s+1)):o===t?new l.default("0%"):o===e.length-1?new l.default("100%"):null;i.push({color:c,stop:d})}for(var u=i.map((function(e){var t=e.color,i=e.stop;return{color:t,stop:0===n?0:i?i.getAbsoluteValue(n)/n:null}})),g=u[0].stop,f=0;f<u.length;f++)if(null!==g){var p=u[f].stop;if(null===p){for(var m=f;null===u[m].stop;)m++;for(var C=m-f+1,B=(u[m].stop-g)/C;f<m;f++)g=u[f].stop=g+B}else g=p}return u}),b=function(e,t,n){var i=(0,a.parseAngle)(e[0]),o=d.test(e[0]),r=o||null!==i||u.test(e[0]),A=r?null!==i?F(n?i-.5*Math.PI:i,t):o?_(e[0],t):Q(e[0],t):F(Math.PI,t),s=r?1:0,l=Math.min((0,c.distance)(Math.abs(A.x0)+Math.abs(A.x1),Math.abs(A.y0)+Math.abs(A.y1)),2*t.width,2*t.height);return new B(w(e,s,l),A)},y=function(e,t,n){var i=t[0].match(f),o=i&&("circle"===i[1]||void 0!==i[3]&&void 0===i[5])?m.CIRCLE:m.ELLIPSE,r={},a={};i&&(void 0!==i[3]&&(r.x=(0,s.calculateLengthFromValueWithUnit)(e,i[3],i[4]).getAbsoluteValue(n.width)),void 0!==i[5]&&(r.y=(0,s.calculateLengthFromValueWithUnit)(e,i[5],i[6]).getAbsoluteValue(n.height)),i[7]?a.x=C[i[7].toLowerCase()]:void 0!==i[8]&&(a.x=(0,s.calculateLengthFromValueWithUnit)(e,i[8],i[9])),i[10]?a.y=C[i[10].toLowerCase()]:void 0!==i[11]&&(a.y=(0,s.calculateLengthFromValueWithUnit)(e,i[11],i[12])));var A={x:void 0===a.x?n.width/2:a.x.getAbsoluteValue(n.width),y:void 0===a.y?n.height/2:a.y.getAbsoluteValue(n.height)},l=T(i&&i[2]||"farthest-corner",o,A,r,n);return new v(w(t,i?1:0,Math.min(l.x,l.y)),o,A,l)},F=function(e,t){var n=t.width,i=t.height,o=.5*n,r=.5*i,a=(Math.abs(n*Math.sin(e))+Math.abs(i*Math.cos(e)))/2,A=o+Math.sin(e)*a,s=r-Math.cos(e)*a;return{x0:A,x1:n-A,y0:s,y1:i-s}},E=function(e){return Math.acos(e.width/2/((0,c.distance)(e.width,e.height)/2))},_=function(e,t){switch(e){case"bottom":case"to top":return F(0,t);case"left":case"to right":return F(Math.PI/2,t);case"right":case"to left":return F(3*Math.PI/2,t);case"top right":case"right top":case"to bottom left":case"to left bottom":return F(Math.PI+E(t),t);case"top left":case"left top":case"to bottom right":case"to right bottom":return F(Math.PI-E(t),t);case"bottom left":case"left bottom":case"to top right":case"to right top":return F(E(t),t);case"bottom right":case"right bottom":case"to top left":case"to left top":return F(2*Math.PI-E(t),t);case"top":case"to bottom":default:return F(Math.PI,t)}},Q=function(e,t){var n=e.split(" ").map(parseFloat),i=r(n,2),o=i[0],a=i[1],A=o/100*t.width/(a/100*t.height);return F(Math.atan(isNaN(A)?1:A)+Math.PI/2,t)},U=function(e,t,n,i){return[{x:0,y:0},{x:0,y:e.height},{x:e.width,y:0},{x:e.width,y:e.height}].reduce((function(e,o){var r=(0,c.distance)(t-o.x,n-o.y);return(i?r<e.optimumDistance:r>e.optimumDistance)?{optimumCorner:o,optimumDistance:r}:e}),{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},T=function(e,t,n,i,o){var r=n.x,a=n.y,A=0,s=0;switch(e){case"closest-side":t===m.CIRCLE?A=s=Math.min(Math.abs(r),Math.abs(r-o.width),Math.abs(a),Math.abs(a-o.height)):t===m.ELLIPSE&&(A=Math.min(Math.abs(r),Math.abs(r-o.width)),s=Math.min(Math.abs(a),Math.abs(a-o.height)));break;case"closest-corner":if(t===m.CIRCLE)A=s=Math.min((0,c.distance)(r,a),(0,c.distance)(r,a-o.height),(0,c.distance)(r-o.width,a),(0,c.distance)(r-o.width,a-o.height));else if(t===m.ELLIPSE){var l=Math.min(Math.abs(a),Math.abs(a-o.height))/Math.min(Math.abs(r),Math.abs(r-o.width)),d=U(o,r,a,!0);s=l*(A=(0,c.distance)(d.x-r,(d.y-a)/l))}break;case"farthest-side":t===m.CIRCLE?A=s=Math.max(Math.abs(r),Math.abs(r-o.width),Math.abs(a),Math.abs(a-o.height)):t===m.ELLIPSE&&(A=Math.max(Math.abs(r),Math.abs(r-o.width)),s=Math.max(Math.abs(a),Math.abs(a-o.height)));break;case"farthest-corner":if(t===m.CIRCLE)A=s=Math.max((0,c.distance)(r,a),(0,c.distance)(r,a-o.height),(0,c.distance)(r-o.width,a),(0,c.distance)(r-o.width,a-o.height));else if(t===m.ELLIPSE){var u=Math.max(Math.abs(a),Math.abs(a-o.height))/Math.max(Math.abs(r),Math.abs(r-o.width)),h=U(o,r,a,!1);s=u*(A=(0,c.distance)(h.x-r,(h.y-a)/u))}break;default:A=i.x||0,s=void 0!==i.y?i.y:A}return{x:A,y:s}},S=t.transformWebkitRadialGradientArgs=function(e){var t="",n="",i="",o="",r=0,a=/^(left|center|right|\d+(?:px|r?em|%)?)(?:\s+(top|center|bottom|\d+(?:px|r?em|%)?))?$/i,A=/^\d+(px|r?em|%)?(?:\s+\d+(px|r?em|%)?)?$/i,s=e[r].match(a);s&&r++;var l=e[r].match(/^(circle|ellipse)?\s*(closest-side|closest-corner|farthest-side|farthest-corner|contain|cover)?$/i);l&&(t=l[1]||"","contain"===(i=l[2]||"")?i="closest-side":"cover"===i&&(i="farthest-corner"),r++);var c=e[r].match(A);c&&r++;var d=e[r].match(a);d&&r++;var u=e[r].match(A);u&&r++;var h=d||s;h&&h[1]&&(o=h[1]+(/^\d+$/.test(h[1])?"px":""),h[2]&&(o+=" "+h[2]+(/^\d+$/.test(h[2])?"px":"")));var g=u||c;return g&&(n=g[0],g[1]||(n+="px")),!o||t||n||i||(n=o,o=""),o&&(o="at "+o),[[t,i,n,o].filter((function(e){return!!e})).join(" ")].concat(e.slice(r))},I=function(e){return e.map((function(e){return e.match(g)})).map((function(t,n){if(!t)return e[n];switch(t[1]){case"from":return t[4]+" 0%";case"to":return t[4]+" 100%";case"color-stop":return"%"===t[3]?t[4]+" "+t[2]:t[4]+" "+100*parseFloat(t[2])+"%"}}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=/([+-]?\d*\.?\d+)(deg|grad|rad|turn)/i;t.parseAngle=function(e){var t=e.match(i);if(t){var n=parseFloat(t[1]);switch(t[2].toLowerCase()){case"deg":return Math.PI*n/180;case"grad":return Math.PI/200*n;case"rad":return n;case"turn":return 2*Math.PI*n}}return null}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.cloneWindow=t.DocumentCloner=void 0;var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2),A=n(26),s=i(n(55)),l=n(3),c=n(4),d=i(n(15)),u=n(56),h=t.DocumentCloner=function(){function e(t,n,i,o,r){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.referenceElement=t,this.scrolledElements=[],this.copyStyles=o,this.inlineImages=o,this.logger=i,this.options=n,this.renderer=r,this.resourceLoader=new s.default(n,i,window),this.pseudoContentData={counters:{},quoteDepth:0},this.documentElement=this.cloneNode(t.ownerDocument.documentElement)}return r(e,[{key:"inlineAllImages",value:function(e){var t=this;if(this.inlineImages&&e){var n=e.style;Promise.all((0,c.parseBackgroundImage)(n.backgroundImage).map((function(e){return"url"===e.method?t.resourceLoader.inlineImage(e.args[0]).then((function(e){return e&&"string"==typeof e.src?'url("'+e.src+'")':"none"})).catch((function(e){t.logger.log("Unable to load image",e)})):Promise.resolve(""+e.prefix+e.method+"("+e.args.join(",")+")")}))).then((function(e){e.length>1&&(n.backgroundColor=""),n.backgroundImage=e.join(",")})),e instanceof HTMLImageElement&&this.resourceLoader.inlineImage(e.src).then((function(t){if(t&&e instanceof HTMLImageElement&&e.parentNode){var n=e.parentNode,i=(0,l.copyCSSStyles)(e.style,t.cloneNode(!1));n.replaceChild(i,e)}})).catch((function(e){t.logger.log("Unable to load image",e)}))}}},{key:"inlineFonts",value:function(e){var t=this;return Promise.all(Array.from(e.styleSheets).map((function(n){return n.href?fetch(n.href).then((function(e){return e.text()})).then((function(e){return f(e,n.href)})).catch((function(e){return t.logger.log("Unable to load stylesheet",e),[]})):g(n,e)}))).then((function(e){return e.reduce((function(e,t){return e.concat(t)}),[])})).then((function(e){return Promise.all(e.map((function(e){return fetch(e.formats[0].src).then((function(e){return e.blob()})).then((function(e){return new Promise((function(t,n){var i=new FileReader;i.onerror=n,i.onload=function(){var e=i.result;t(e)},i.readAsDataURL(e)}))})).then((function(t){return e.fontFace.setProperty("src",'url("'+t+'")'),"@font-face {"+e.fontFace.cssText+" "}))})))})).then((function(n){var i=e.createElement("style");i.textContent=n.join("\n"),t.documentElement.appendChild(i)}))}},{key:"createElementClone",value:function(e){var t=this;if(this.copyStyles&&e instanceof HTMLCanvasElement){var n=e.ownerDocument.createElement("img");try{return n.src=e.toDataURL(),n}catch(e){this.logger.log("Unable to clone canvas contents, canvas is tainted")}}if(e instanceof HTMLIFrameElement){var i=e.cloneNode(!1),o=E();i.setAttribute("data-html2canvas-internal-iframe-key",o);var r=(0,a.parseBounds)(e,0,0),A=r.width,s=r.height;return this.resourceLoader.cache[o]=Q(e,this.options).then((function(e){return t.renderer(e,{async:t.options.async,allowTaint:t.options.allowTaint,backgroundColor:"#ffffff",canvas:null,imageTimeout:t.options.imageTimeout,logging:t.options.logging,proxy:t.options.proxy,removeContainer:t.options.removeContainer,scale:t.options.scale,foreignObjectRendering:t.options.foreignObjectRendering,useCORS:t.options.useCORS,target:new d.default,width:A,height:s,x:0,y:0,windowWidth:e.ownerDocument.defaultView.innerWidth,windowHeight:e.ownerDocument.defaultView.innerHeight,scrollX:e.ownerDocument.defaultView.pageXOffset,scrollY:e.ownerDocument.defaultView.pageYOffset},t.logger.child(o))})).then((function(t){return new Promise((function(n,o){var r=document.createElement("img");r.onload=function(){return n(t)},r.onerror=o,r.src=t.toDataURL(),i.parentNode&&i.parentNode.replaceChild((0,l.copyCSSStyles)(e.ownerDocument.defaultView.getComputedStyle(e),r),i)}))})),i}try{if(e instanceof HTMLStyleElement&&e.sheet&&e.sheet.cssRules){var c=[].slice.call(e.sheet.cssRules,0).reduce((function(e,t){return t&&"string"==typeof t.cssText?e+t.cssText:e}),""),u=e.cloneNode(!1);return u.textContent=c,u}}catch(e){if(this.logger.log("Unable to access cssRules property"),"SecurityError"!==e.name)throw this.logger.log(e),e}return e.cloneNode(!1)}},{key:"cloneNode",value:function(e){var t=e.nodeType===Node.TEXT_NODE?document.createTextNode(e.nodeValue):this.createElementClone(e),n=e.ownerDocument.defaultView,i=e instanceof n.HTMLElement?n.getComputedStyle(e):null,o=e instanceof n.HTMLElement?n.getComputedStyle(e,":before"):null,r=e instanceof n.HTMLElement?n.getComputedStyle(e,":after"):null;this.referenceElement===e&&t instanceof n.HTMLElement&&(this.clonedReferenceElement=t),t instanceof n.HTMLBodyElement&&b(t);for(var a=(0,u.parseCounterReset)(i,this.pseudoContentData),A=(0,u.resolvePseudoContent)(e,o,this.pseudoContentData),s=e.firstChild;s;s=s.nextSibling)s.nodeType===Node.ELEMENT_NODE&&("SCRIPT"===s.nodeName||s.hasAttribute("data-html2canvas-ignore")||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(s))||this.copyStyles&&"STYLE"===s.nodeName||t.appendChild(this.cloneNode(s));var c=(0,u.resolvePseudoContent)(e,r,this.pseudoContentData);if((0,u.popCounters)(a,this.pseudoContentData),e instanceof n.HTMLElement&&t instanceof n.HTMLElement)switch(o&&this.inlineAllImages(m(e,t,o,A,C)),r&&this.inlineAllImages(m(e,t,r,c,B)),!i||!this.copyStyles||e instanceof HTMLIFrameElement||(0,l.copyCSSStyles)(i,t),this.inlineAllImages(t),0===e.scrollTop&&0===e.scrollLeft||this.scrolledElements.push([t,e.scrollLeft,e.scrollTop]),e.nodeName){case"CANVAS":this.copyStyles||p(e,t);break;case"TEXTAREA":case"SELECT":t.value=e.value}return t}}]),e}(),g=function(e,t){return(e.cssRules?Array.from(e.cssRules):[]).filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).map((function(e){for(var n=(0,c.parseBackgroundImage)(e.style.getPropertyValue("src")),i=[],o=0;o<n.length;o++)if("url"===n[o].method&&n[o+1]&&"format"===n[o+1].method){var r=t.createElement("a");r.href=n[o].args[0],t.body&&t.body.appendChild(r);var a={src:r.href,format:n[o+1].args[0]};i.push(a)}return{formats:i.filter((function(e){return/^woff/i.test(e.format)})),fontFace:e.style}})).filter((function(e){return e.formats.length}))},f=function(e,t){var n=document.implementation.createHTMLDocument(""),i=document.createElement("base");i.href=t;var o=document.createElement("style");return o.textContent=e,n.head&&n.head.appendChild(i),n.body&&n.body.appendChild(o),o.sheet?g(o.sheet,n):[]},p=function(e,t){try{if(t){t.width=e.width,t.height=e.height;var n=e.getContext("2d"),i=t.getContext("2d");n?i.putImageData(n.getImageData(0,0,e.width,e.height),0,0):i.drawImage(e,0,0)}}catch(e){}},m=function(e,t,n,i,o){if(n&&n.content&&"none"!==n.content&&"-moz-alt-content"!==n.content&&"none"!==n.display){var r=t.ownerDocument.createElement("html2canvaspseudoelement");if((0,l.copyCSSStyles)(n,r),i)for(var a=i.length,A=0;A<a;A++){var s=i[A];switch(s.type){case u.PSEUDO_CONTENT_ITEM_TYPE.IMAGE:var d=t.ownerDocument.createElement("img");d.src=(0,c.parseBackgroundImage)("url("+s.value+")")[0].args[0],d.style.opacity="1",r.appendChild(d);break;case u.PSEUDO_CONTENT_ITEM_TYPE.TEXT:r.appendChild(t.ownerDocument.createTextNode(s.value))}}return r.className=v+" "+w,t.className+=o===C?" "+v:" "+w,o===C?t.insertBefore(r,t.firstChild):t.appendChild(r),r}},C=":before",B=":after",v="___html2canvas___pseudoelement_before",w="___html2canvas___pseudoelement_after",b=function(e){y(e,"."+v+C+'{\n    content: "" !important;\n    display: none !important;\n}\n         .'+w+B+'{\n    content: "" !important;\n    display: none !important;\n}')},y=function(e,t){var n=e.ownerDocument.createElement("style");n.innerHTML=t,e.appendChild(n)},F=function(e){var t=o(e,3),n=t[0],i=t[1],r=t[2];n.scrollLeft=i,n.scrollTop=r},E=function(){return Math.ceil(Date.now()+1e7*Math.random()).toString(16)},_=/^data:text\/(.+);(base64)?,(.*)$/i,Q=function(e,t){try{return Promise.resolve(e.contentWindow.document.documentElement)}catch(n){return t.proxy?(0,A.Proxy)(e.src,t).then((function(e){var t=e.match(_);return t?"base64"===t[2]?window.atob(decodeURIComponent(t[3])):decodeURIComponent(t[3]):Promise.reject()})).then((function(t){return U(e.ownerDocument,(0,a.parseBounds)(e,0,0)).then((function(e){var n=e.contentWindow.document;n.open(),n.write(t);var i=T(e).then((function(){return n.documentElement}));return n.close(),i}))})):Promise.reject()}},U=function(e,t){var n=e.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=t.width.toString(),n.height=t.height.toString(),n.scrolling="no",n.setAttribute("data-html2canvas-ignore","true"),e.body?(e.body.appendChild(n),Promise.resolve(n)):Promise.reject("Body element not found in Document that is getting rendered")},T=function(e){var t=e.contentWindow,n=t.document;return new Promise((function(i,o){t.onload=e.onload=n.onreadystatechange=function(){var t=setInterval((function(){n.body.childNodes.length>0&&"complete"===n.readyState&&(clearInterval(t),i(e))}),50)}}))},S=(t.cloneWindow=function(e,t,n,i,o,r){var a=new h(n,i,o,!1,r),A=e.defaultView.pageXOffset,s=e.defaultView.pageYOffset;return U(e,t).then((function(o){var r=o.contentWindow,l=r.document,c=T(o).then((function(){a.scrolledElements.forEach(F),r.scrollTo(t.left,t.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||r.scrollY===t.top&&r.scrollX===t.left||(l.documentElement.style.top=-t.top+"px",l.documentElement.style.left=-t.left+"px",l.documentElement.style.position="absolute");var A=Promise.resolve([o,a.clonedReferenceElement,a.resourceLoader]),s=i.onclone;return a.clonedReferenceElement instanceof r.HTMLElement||a.clonedReferenceElement instanceof e.defaultView.HTMLElement||a.clonedReferenceElement instanceof HTMLElement?"function"==typeof s?Promise.resolve().then((function(){return s(l)})).then((function(){return A})):A:Promise.reject("Error finding the "+n.nodeName+" in the cloned document")}));return l.open(),l.write(S(document.doctype)+"<html></html>"),function(e,t,n){!e.defaultView||t===e.defaultView.pageXOffset&&n===e.defaultView.pageYOffset||e.defaultView.scrollTo(t,n)}(n.ownerDocument,A,s),l.replaceChild(l.adoptNode(a.documentElement),l.documentElement),l.close(),c}))},function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t})},function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceStore=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(10)),a=n(26),A=function(){function e(t,n,o){i(this,e),this.options=t,this._window=o,this.origin=this.getOrigin(o.location.href),this.cache={},this.logger=n,this._index=0}return o(e,[{key:"loadImage",value:function(e){var t=this;if(this.hasResourceInCache(e))return e;if(g(e))return this.cache[e]=p(e,this.options.imageTimeout||0),e;if(!f(e)||r.default.SUPPORT_SVG_DRAWING){if(!0===this.options.allowTaint||u(e)||this.isSameOrigin(e))return this.addImage(e,e,!1);if(!this.isSameOrigin(e)){if("string"==typeof this.options.proxy)return this.cache[e]=(0,a.Proxy)(e,this.options).then((function(e){return p(e,t.options.imageTimeout||0)})),e;if(!0===this.options.useCORS&&r.default.SUPPORT_CORS_IMAGES)return this.addImage(e,e,!0)}}}},{key:"inlineImage",value:function(e){var t=this;return u(e)?p(e,this.options.imageTimeout||0):this.hasResourceInCache(e)?this.cache[e]:this.isSameOrigin(e)||"string"!=typeof this.options.proxy?this.xhrImage(e):this.cache[e]=(0,a.Proxy)(e,this.options).then((function(e){return p(e,t.options.imageTimeout||0)}))}},{key:"xhrImage",value:function(e){var t=this;return this.cache[e]=new Promise((function(n,i){var o=new XMLHttpRequest;if(o.onreadystatechange=function(){if(4===o.readyState)if(200!==o.status)i("Failed to fetch image "+e.substring(0,256)+" with status code "+o.status);else{var t=new FileReader;t.addEventListener("load",(function(){var e=t.result;n(e)}),!1),t.addEventListener("error",(function(e){return i(e)}),!1),t.readAsDataURL(o.response)}},o.responseType="blob",t.options.imageTimeout){var r=t.options.imageTimeout;o.timeout=r,o.ontimeout=function(){return i("Timed out ("+r+"ms) fetching "+e.substring(0,256))}}o.open("GET",e,!0),o.send()})).then((function(e){return p(e,t.options.imageTimeout||0)})),this.cache[e]}},{key:"loadCanvas",value:function(e){var t=String(this._index++);return this.cache[t]=Promise.resolve(e),t}},{key:"hasResourceInCache",value:function(e){return void 0!==this.cache[e]}},{key:"addImage",value:function(e,t,n){var i=this;this.logger.log("Added image "+e.substring(0,256));var o=function(e){return new Promise((function(o,r){var a=new Image;if(a.onload=function(){return o(a)},e&&!n||(a.crossOrigin="anonymous"),a.onerror=r,a.src=t,!0===a.complete&&setTimeout((function(){o(a)}),500),i.options.imageTimeout){var A=i.options.imageTimeout;setTimeout((function(){return r("Timed out ("+A+"ms) fetching "+t.substring(0,256))}),A)}}))};return this.cache[e]=h(t)&&!f(t)?r.default.SUPPORT_BASE64_DRAWING(t).then(o):o(!0),e}},{key:"isSameOrigin",value:function(e){return this.getOrigin(e)===this.origin}},{key:"getOrigin",value:function(e){var t=this._link||(this._link=this._window.document.createElement("a"));return t.href=e,t.href=t.href,t.protocol+t.hostname+t.port}},{key:"ready",value:function(){var e=this,t=Object.keys(this.cache),n=t.map((function(t){return e.cache[t].catch((function(t){return e.logger.log("Unable to load image",t),null}))}));return Promise.all(n).then((function(n){return e.logger.log("Finished loading "+n.length+" images",n),new s(t,n)}))}}]),e}();t.default=A;var s=t.ResourceStore=function(){function e(t,n){i(this,e),this._keys=t,this._resources=n}return o(e,[{key:"get",value:function(e){var t=this._keys.indexOf(e);return-1===t?null:this._resources[t]}}]),e}(),l=/^data:image\/svg\+xml/i,c=/^data:image\/.*;base64,/i,d=/^data:image\/.*/i,u=function(e){return d.test(e)},h=function(e){return c.test(e)},g=function(e){return"blob"===e.substr(0,4)},f=function(e){return"svg"===e.substr(-3).toLowerCase()||l.test(e)},p=function(e,t){return new Promise((function(n,i){var o=new Image;o.onload=function(){return n(o)},o.onerror=i,o.src=e,!0===o.complete&&setTimeout((function(){n(o)}),500),t&&setTimeout((function(){return i("Timed out ("+t+"ms) loading image")}),t)}))}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parseContent=t.resolvePseudoContent=t.popCounters=t.parseCounterReset=t.TOKEN_TYPE=t.PSEUDO_CONTENT_ITEM_TYPE=void 0;var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,A=e[Symbol.iterator]();!(i=(a=A.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&A.return&&A.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=n(14),r=n(8),a=t.PSEUDO_CONTENT_ITEM_TYPE={TEXT:0,IMAGE:1},A=t.TOKEN_TYPE={STRING:0,ATTRIBUTE:1,URL:2,COUNTER:3,COUNTERS:4,OPENQUOTE:5,CLOSEQUOTE:6},s=(t.parseCounterReset=function(e,t){if(!e||!e.counterReset||"none"===e.counterReset)return[];for(var n=[],o=e.counterReset.split(/\s*,\s*/),r=o.length,a=0;a<r;a++){var A=o[a].split(/\s+/),s=i(A,2),l=s[0],c=s[1];n.push(l);var d=t.counters[l];d||(d=t.counters[l]=[]),d.push(parseInt(c||0,10))}return n},t.popCounters=function(e,t){for(var n=e.length,i=0;i<n;i++)t.counters[e[i]].pop()},t.resolvePseudoContent=function(e,t,n){if(!t||!t.content||"none"===t.content||"-moz-alt-content"===t.content||"none"===t.display)return null;var o=s(t.content),r=o.length,l=[],u="",h=t.counterIncrement;if(h&&"none"!==h){var g=h.split(/\s+/),f=i(g,2),p=f[0],m=f[1],C=n.counters[p];C&&(C[C.length-1]+=void 0===m?1:parseInt(m,10))}for(var B=0;B<r;B++){var v=o[B];switch(v.type){case A.STRING:u+=v.value||"";break;case A.ATTRIBUTE:e instanceof HTMLElement&&v.value&&(u+=e.getAttribute(v.value)||"");break;case A.COUNTER:var w=n.counters[v.name||""];w&&(u+=d([w[w.length-1]],"",v.format));break;case A.COUNTERS:var b=n.counters[v.name||""];b&&(u+=d(b,v.glue,v.format));break;case A.OPENQUOTE:u+=c(t,!0,n.quoteDepth),n.quoteDepth++;break;case A.CLOSEQUOTE:n.quoteDepth--,u+=c(t,!1,n.quoteDepth);break;case A.URL:u&&(l.push({type:a.TEXT,value:u}),u=""),l.push({type:a.IMAGE,value:v.value||""})}}return u&&l.push({type:a.TEXT,value:u}),l},t.parseContent=function(e,t){if(t&&t[e])return t[e];for(var n=[],i=e.length,o=!1,r=!1,a=!1,s="",c="",d=[],u=0;u<i;u++){var h=e.charAt(u);switch(h){case"'":case'"':r?s+=h:(o=!o,a||o||(n.push({type:A.STRING,value:s}),s=""));break;case"\\":r?(s+=h,r=!1):r=!0;break;case"(":o?s+=h:(a=!0,c=s,s="",d=[]);break;case")":if(o)s+=h;else if(a){switch(s&&d.push(s),c){case"attr":d.length>0&&n.push({type:A.ATTRIBUTE,value:d[0]});break;case"counter":if(d.length>0){var g={type:A.COUNTER,name:d[0]};d.length>1&&(g.format=d[1]),n.push(g)}break;case"counters":if(d.length>0){var f={type:A.COUNTERS,name:d[0]};d.length>1&&(f.glue=d[1]),d.length>2&&(f.format=d[2]),n.push(f)}break;case"url":d.length>0&&n.push({type:A.URL,value:d[0]})}a=!1,s=""}break;case",":o?s+=h:a&&(d.push(s),s="");break;case" ":case"\t":o?s+=h:s&&(l(n,s),s="");break;default:s+=h}"\\"!==h&&(r=!1)}return s&&l(n,s),t&&(t[e]=n),n}),l=function(e,t){switch(t){case"open-quote":e.push({type:A.OPENQUOTE});break;case"close-quote":e.push({type:A.CLOSEQUOTE})}},c=function(e,t,n){var i=e.quotes?e.quotes.split(/\s+/):["'\"'","'\"'"],o=2*n;return o>=i.length&&(o=i.length-2),t||++o,i[o].replace(/^["']|["']$/g,"")},d=function(e,t,n){for(var i=e.length,a="",A=0;A<i;A++)A>0&&(a+=t||""),a+=(0,o.createCounterText)(e[A],(0,r.parseListStyleType)(n||"decimal"),!1);return a}}])},"object"===a(t)&&"object"===a(e)?e.exports=r():(i=[],void 0!==(o="function"==typeof(n=r)?n.apply(t,i):n)&&(e.exports=o))}).call(t,n(5)(e))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=i}])})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define("dashboard-core/js/lib/@waca/echo-cache/dist/js/bundles/echo-cache.min",[],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/bundles",n(n.s=0)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.EchoCacheService=void 0;var i,o=n(1),r=(i=o)&&i.__esModule?i:{default:i};t.EchoCacheService=r.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t){var n=t.logger,i=t.ajaxSvc;if(_classCallCheck(this,e),this.logger=n,!i)throw new Error("Invalid ajax service provided");this.ajaxSvc=i}return _createClass(e,[{key:"stash",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.cacheId,i=t.ttl,o=t.contentType,r=void 0===o?"text/plain":o,a="v1/echo",A=void 0;return n?(a=a+"/"+n,A="PUT"):A="POST",i&&(a=a+"?ttl="+i),this.ajaxSvc.ajax({type:A,url:a,contentType:r,data:e}).then((function(e){var t=e.jqXHR.getResponseHeader("location"),n=e.jqXHR.getResponseHeader("X-CA-Affinity");return{id:t.match(/\/bi\/v1\/echo\/(.*)/)[1],location:t,affinity:n}}))}},{key:"retrieve",value:function(e,t){if(!e)throw new Error("Invalid cacheId argument provided");var n={type:"GET",url:"v1/echo/"+e,contentType:"text/plain",headers:{}};return t&&(n.headers["X-CA-Affinity"]=t),this.ajaxSvc.ajax(n).then((function(e){return{text:e.jqXHR.responseText}}))}}]),e}();t.default=i}])})),define("dashboard-core/js/dashboard/services/thumbnail/ThumbnailService",["../../../lib/@waca/core-client/js/core-client/ui/core/Class","../../../app/nls/StringResources","./ThumbnailStore","../../../lib/@waca/core-client/js/core-client/utils/UniqueId","../../../lib/@waca/image-capture/dist/js/bundles/image-capture.min","../../../lib/@waca/echo-cache/dist/js/bundles/echo-cache.min","../../../lib/@waca/core-client/js/core-client/utils/ClassFactory","underscore","jquery"],(function(e,t,n,i,o,r,a,A,s){var l=["id","clip-path"],c=o.default,d=r.EchoCacheService,u=e.extend({_store:null,echoCacheService:null,init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u.inherited("init",this,arguments),this._pendingRequests={fetch:{}},this.logger=e.dashboardApi.getFeature("Logger"),this.ajax=e.dashboardApi.getFeature("Ajax"),this.readyPromise=this.initialize(e)},_isValidPendingRequestType:function(e){return!!this._pendingRequests[e]},setPendingRequest:function(e,t){if(!e)throw new Error("Invalid options argument provided");var n=e.type,i=e.cacheId;if(!i)throw new Error("Invalid cacheId option provided");if(!this._isValidPendingRequestType(n))throw new Error("Invalid type: "+n);this._pendingRequests[n][i]=t},getPendingRequest:function(e){if(!e)throw new Error("Invalid options argument provided");var t=e.type,n=e.cacheId;if(!n)throw new Error("Invalid cacheId option provided");if(!this._isValidPendingRequestType(t))throw new Error("Invalid type: "+t);return this._pendingRequests[t][n]},initialize:function(e){var t=e.store,i=void 0===t?{}:t,o=e.elementMap,r=e.excludeClassList,a=e.html2canvasProxy,A=e.echoCacheSvc;return this._store=new n(i),this.echoCacheService=A||new d({logger:this.logger,ajaxSvc:this.ajax}),this._thumbnailGenerator=null,this._elements={map:{},paths:o,excludeClassList:r,html2canvasProxy:a},this.initializeThumbnailGenerator()},initializeThumbnailGenerator:function(){var e=this,t=void 0;if(this._elements.paths){var n=Object.keys(this._elements.paths);t=Promise.all(n.map((function(t){return"text!"+e._elements.paths[t]})).map((function(e){return a.loadModule(e)}))).then((function(t){t.forEach((function(t,i){var o=n[i];o&&(e._elements.map[o]=t)}))})).catch((function(t){e.logger.error("ThumbnailService.readyPromise:error",t)}))}else t=Promise.resolve();return t.then((function(){e._thumbnailGenerator=new c({UniqueId:i,elementMap:e._elements.map,excludeClassList:e._elements.excludeClassList,proxy:e._elements.html2canvasProxy})}))},destroy:function(){this._thumbnailGenerator&&this._thumbnailGenerator.destroy(),this._elements=null,this._store=null,this.logger=null,this.ajax=null},sync:function(e,t){var n=this,i=void 0;if(t){var o=function(t,i){return n.update(t,i).then((function(e){var t=e.cacheId,i=e.affinity;return n.fetch(t,i)})).then((function(t){var i=t.data,o=t.cacheId;n._setCacheIdInWidgetAndStore(e,o,i)}),(function(){n._setCacheIdInWidgetAndStore(e,null,null)}))};i=this.fetch(e.thumbnailId,void 0,{silent:!0}).then((function(i){var r=i.data;if(n._needsUpdate(r,t))return o(e.thumbnailId,t);var a=n._store.getLocal(e.id);return n._needsUpdate(a,t)&&n._setCacheIdInWidgetAndStore(e,e.thumbnailId,t),{data:t}})).catch((function(){return o(e.thumbnailId,t)}))}else this._setCacheIdInWidgetAndStore(e,null);return i||Promise.resolve()},_setCacheIdInWidgetAndStore:function(e,t,n){var i=e.id;e.set({thumbnailId:t},{payloadData:{runtimeOnly:!0}}),t?this._store.set(i,{data:n,cacheId:t}):this._store.delete(i)},setError:function(e,t){this._store.setError(e,t)},setWarning:function(e,t){this._store.setWarning(e,t)},_needsUpdate:function(e,t){return this._stripUniqueAttributes(e)!==this._stripUniqueAttributes(t)||this._getImgSrc(e)!==this._getImgSrc(t)},_getImgSrc:function(e){var t=s(e).find("img");return t?t.attr("src"):null},_stripUniqueAttributes:function(e){var t=s(e);return l.forEach((function(e){t.find("["+e+"]").attr(e,"")})),t.html()},getStoreAPI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{defaultFn:function(){}},t=e.defaultFn;return A.extend({},this._store,{getVisTypeDefault:t})},get:function(e,t,n){var i=this;n||(n=this._store);var o=e.id,r=void 0;if(n.exists(o))r=Promise.resolve(n.getLocal(o));else{var a=e.thumbnailId;r=a?this.fetch(a,void 0,{silent:!0}).then((function(e){var t=e.data,r=e.cacheId;return i._store.set(o,{data:t,cacheId:r}),n.getLocal(o)})).catch((function(){})):Promise.resolve()}return r.then((function(){return n.get(o,t)}))},fetch:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return Promise.reject(new Error("Invalid cacheId argument provided: "+e));var o=this.getPendingRequest({type:"fetch",cacheId:e});if(o){var r=!!o.then;return r?o:Promise.reject(o)}var a=this.echoCacheService.retrieve(e,t).then((function(t){n.setPendingRequest({type:"fetch",cacheId:e},void 0);var i=t.text;return n.logger.debug("ThumbnailService.fetch:response",t),{cacheId:e,data:i}})).catch((function(t){var o=n._ajaxErrorHandler(t,"ThumbnailService.fetch:error",i);return n.setPendingRequest({type:"fetch",cacheId:e},o),Promise.reject(o)}));return this.setPendingRequest({type:"fetch",cacheId:e},a),a},update:function(e,t,n){var i=this;return this.echoCacheService.stash(t,{cacheId:e}).then((function(e){var t=e.id,n=e.location,o=e.affinity;return i.setPendingRequest({type:"fetch",cacheId:t},void 0),{cacheId:t,location:n,affinity:o}})).catch((function(e){return Promise.reject(i._ajaxErrorHandler(e,"ThumbnailService.update:error",n))}))},_ajaxErrorHandler:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ThumbnailService:error",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{silent:!1},o=i.silent,r=this._parseError(e,t.get("thumbnails_error_fetching")),a=new Error(r);return o||this.logger.error(n,a),a},_parseError:function(e,t){var n=t;try{if(e.responseText)n=JSON.parse(e.responseText).error}catch(e){}return n},_prepareThumbnail:function(e){return JSON.stringify({data:e})},generateImage:function(e,t,n){return t=A.extend(t||{},{onClone:function(e,t){var n=s(t).find(".staticContent");n.length&&n.css({"background-color":"transparent"})},excludeEmptyIframes:!0,transparentBackground:!1}),this._thumbnailGenerator.generateImage(e,t,n)},generateMarkup:function(e,t,n){return this.generateImage(e,t,n).then((function(e){return'<div class="visThumbnail"><div class="visThumbnailImgContainer"><img src="'+e+'" /></div></div>'}))},delete:function(e){return this._store.delete(e)}});return u})),define("text!dashboard-core/js/common/templates/TranslationOverlayTemplate.html",[],(function(){return'<div class="translate-overlay">\n\t<span class="translate-text">\n\t\t{{= it.text}}\n\t</span>\n\t<button type="button" class="translate-button">{{= it.buttonText}}</button>\n</div>\n'})),define("dashboard-core/js/dashboard/services/TranslationService",["jquery","underscore","../../app/nls/StringResources","doT","text!../../common/templates/TranslationOverlayTemplate.html","../../lib/@waca/dashboard-common/dist/ui/dialogs/ConfirmationDialog","../util/ButtonHideHelper","../../lib/@waca/core-client/js/core-client/utils/Utils"],(function(e,t,n,i,o,r,a,A){"use strict";return function(){function s(e){_classCallCheck(this,s),t.extend(this,e),this._excludedCSVAttributes=["titleHtml","content"],this._notVisibleLocalizedProps={text:"name"},this.localizedItems={},this.dashboardApi.getFeature("Properties").registerProvider(this),this._glass=this.dashboardApi.getFeature("Glass"),this.registeredHandlers=[];var n=this.dashboardApi.getGlassCoreSvc(".FeatureChecker");this.isPropertiesV2Enabled=n&&n.checkValue&&n.checkValue("dashboard","PropertiesV2","enabled")}return s.prototype.registerView=function(e){this.localizedItems[e.model.id]=e,this.isInTranslationMode()&&this._startModelTranslationMode(e.model,e.view,this.getTranslationModeLocale())},s.prototype.deregisterView=function(e){this.isInTranslationMode()&&this._endModelTranslationMode(this.localizedItems[e].model,this.localizedItems[e].view,!0),delete this.localizedItems[e]},s.prototype.initialize=function(e){var t=this;return this.$el=e.view,this.boardModel=e.boardModel,this.defaultLocale=e.boardModel.properties.defaultLocale,e.boardModel.properties.on("change:translationModeLocale",this._onChangeTranslationMode,this),e.boardModel.properties.on("change:defaultLocale",this._onChangeDefaultLocale,this),e.boardModel.properties.on("change:switchLanguageInfo",this._onChangeToLocale,this),this._contentLocalesPromise=this.dashboardApi.getFeature("UserProfile").getAvailableContentLocales().then((function(e){t._contentLocales=e})),this._contentLocalesPromise},s.prototype.getLanguageRadioItems=function(){var e=[],n=this.getSelectedLanguages();return"Default"===this.getDefaultLanguage()&&(n=[]),t.each(this._contentLocales,(function(t,i){-1===n.indexOf(i)&&e.push({value:i,label:t})})),e},s.prototype.getContentLocales=function(){return this._contentLocales},s.prototype.getLanguageName=function(e){return this._contentLocales[e]},s.prototype._onChangeTranslationMode=function(){var e=this.getTranslationModeLocale();e?this._startTranslationMode(e):this._endTranslationMode()},s.prototype.getTranslationModeLocale=function(){return this.boardModel.properties.get("translationModeLocale")},s.prototype.isInTranslationMode=function(){return this.translationModeOn},s.prototype.startTranslationMode=function(e){this.boardModel.setTranslationLocale(e)},s.prototype.endTranslationMode=function(){this.boardModel.setTranslationLocale(null)},s.prototype.getMultilingualProperty=function(e,t){if(e){var n=this.localizedItems[e],i=n&&n.model&&n.model.getMultilingualAttribute&&n.model.getMultilingualAttribute(t);if(i)return i.multilingualProperty}return null},s.prototype._startTranslationMode=function(e){var t=i.template(o)({text:n.get("multilingualDashboardTranslationMode",{currentLanguage:this.getLanguageName(e)}),buttonText:n.get("multilingualDashboardTranslationDone")});for(var r in this.$el.append(t),this.$el.find(".translate-button").click(this.endTranslationMode.bind(this)),this.translationModeOn=!0,this.translationModeLanguage=e,this.eventRouter.trigger("properties:refreshPane"),a.changeMode(this.glassContext,"translation"),this.numTranslationsLeft=0,this.showingMissingTranslationCount=!1,this.localizedItems){var A=this.localizedItems[r],s=A.model,l=A.view;this._startModelTranslationMode(s,l,e)}},s.prototype._startModelTranslationMode=function(e,t,n){var i=this,o=e.getMultilingualAttributes(),r=[],a=this.localizedItems[e.id];a.enterTranslationMode&&a.enterTranslationMode(),o.forEach((function(t){var o=t.propertyName,a=t.propertyParentModel,A=t.multilingualProperty;if(A.startTranslation(n),i.dashboardApi&&a.multilingual){i.dashboardApi.getCanvas().getContent(e.id).on("change:property:"+t.propertyParentModel.name,i._onPropertyChange.bind(i,e.id,e,t.propertyParentModel.name))}else{var s=a.on("change:"+o,i._onPropertyChange.bind(i,e.id,a,o));i.registeredHandlers.push(s)}if(0!==Object.keys(A.translationTable).length){var l=a.type;l&&i._notVisibleLocalizedProps[l]===o||(A.needsTranslation()?r.push(t):i._updateView(a,o,i.localizedItems[e.id]))}})),r.length>0&&this._appendTranslationIcon(t,r)},s.prototype._onPropertyChange=function(e,t,n){var i=t.getMultilingualAttribute(n);if(i){var o=t.type;if(!o||this._notVisibleLocalizedProps[o]!==n){var r=i.multilingualProperty,a=this.localizedItems[e].view;r.needsTranslation()?this._appendTranslationIcon(a,[i]):this._removeTranslationIcon(a,[i])}}},s.prototype._endTranslationMode=function(){for(var e in this.$el.find("div.translate-overlay").remove(),this.translationModeOn=!1,this.showingMissingTranslationCount=!1,this.localizedItems){var t=this.localizedItems[e];this._endModelTranslationMode(t.model,t.view,!1)}this.eventRouter.trigger("properties:refreshPane",{focusSelector:".clickablelanguage_"+this.translationModeLanguage}),a.changeMode(this.glassContext,"authoring")},s.prototype._endModelTranslationMode=function(e,t,n){var i=this,o=this.localizedItems[e.id];o.leaveTranslationMode&&o.leaveTranslationMode(),this.registeredHandlers.forEach((function(e){e.remove()})),this.registeredHandlers=[];var r=e.getMultilingualAttributes();r.forEach((function(t){var o=t.propertyName,r=t.propertyParentModel;(t.multilingualProperty.stopTranslation(),n||i._updateView(r,o,i.localizedItems[e.id]),i.dashboardApi&&r.multilingual)&&i.dashboardApi.getCanvas().getContent(e.id).off("change:property:"+t.propertyParentModel.name,i._onPropertyChange.bind(i,e.id,e,t.propertyParentModel.name))})),this._removeTranslationIcon(t,r)},s.prototype._updateView=function(e,t,n){n.reRender?n.reRender():this._triggerTextUpdate(e,t)},s.prototype._triggerTextUpdate=function(e,t){var n={};n[t]=e.get(t),e.set(n,{payloadData:{forceEvent:!0,skipUndoRedo:!0},sender:"TranslationService"})},s.prototype._appendTranslationIcon=function(e,t){this.isInTranslationMode()&&(e.addTranslationIcon?this.numTranslationsLeft+=e.addTranslationIcon(t):(this.appendTranslationIcon(e.$el),this.numTranslationsLeft++),this._displayRemainingMessage())},s.prototype.appendTranslationIcon=function(t){var i=t instanceof e?t:e(t);if(this.isInTranslationMode()&&0===i.find(".translateIcon").length){var o=this.dashboardApi.getFeature("Icons"),r=e('<div class="translateIcon"></div>');A.setIcon(r,o.getIcon("warning").id,n.get("multilingualDashboardIconTranslatableArea")),i.append(r)}},s.prototype.updateRemainingCount=function(e){0!==e&&(this.showingMissingTranslationCount=!0),this.numTranslationsLeft+=e,this._displayRemainingMessage()},s.prototype._removeTranslationIcon=function(e,t){var n=e.$el;if(e.removeTranslationIcon){var i=e.removeTranslationIcon(t);i&&this.updateRemainingCount(-i)}else this.hasTranslationIcon(n)&&(this.updateRemainingCount(-1),this.removeTranslationIcon(n))},s.prototype.hasTranslationIcon=function(e){return e.find(".translateIcon").length>0},s.prototype.removeTranslationIcon=function(t){(t instanceof e?t:e(t)).find(".translateIcon").remove()},s.prototype._displayRemainingMessage=function(){var e;this.numTranslationsLeft>=0&&this.showingMissingTranslationCount&&(e=1===this.numTranslationsLeft?n.get("multilingualDashboardRemainingString"):n.get("multilingualDashboardRemainingStrings",{numTranslationsLeft:this.numTranslationsLeft}),this.$el.find(".translate-text").text(e))},s.prototype.downloadTranslations=function(e){var t=this._getLocalizedStrings(e),n="OriginalStrings_"+e;this.dashboardApi.getFeature("CsvExport").export(n,[t])},s.prototype.removeTranslations=function(e){var i=this,o=this.getContentLocales()[e];new r({title:n.get("multilingualDeleteTitle"),message:n.get("multilingualDeleteLanguageWarning",{language:o}),confirmCallback:function(){var n=t.uniqueId("removeTranslations");for(var o in i.localizedItems){i.localizedItems[o].model.getMultilingualAttributes().forEach((function(t){var i=t.propertyName,o=t.propertyParentModel,r={};r[i]={value:null,locale:e},o.set(r,{sender:"TranslationService",payloadData:{undoRedoTransactionId:n}})})),i._onMultilingualPropertyChange(o)}i.eventRouter.trigger("properties:refreshPane",{focusSelector:".r_addLanguage-1"})}}).render()},s.prototype.changeDefaultLanguage=function(e){this.boardModel.properties.set({defaultLocale:e})},s.prototype.processMultilingualProperty=function(e,t){if(t){e.editor.uiControl.appendTranslationIcon=function(e){t.needsTranslation()&&this.appendTranslationIcon(e)}.bind(this)}return e},s.prototype._onMultilingualPropertyChange=function(e){var t=this.localizedItems[e];t&&t.onMultilingualPropertyChange&&t.onMultilingualPropertyChange()},s.prototype._onChangeDefaultLocale=function(){var e=this,t=this.getDefaultLanguage();this.boardModel.setDefaultLocale(t);var n=function(n){e.localizedItems[n].model.getMultilingualAttributes().forEach((function(i){var o=i.propertyName,r=i.propertyParentModel;i.multilingualProperty.setDefaultLocale(t),e._updateView(r,o,e.localizedItems[n])})),e._onMultilingualPropertyChange(n)};for(var i in this.localizedItems)n(i);this.eventRouter.trigger("properties:refreshPane",{focusSelector:".clickablelanguage_"+t})},s.prototype._onChangeToLocale=function(){var e=this,t=this.boardModel.properties.get("switchLanguageInfo"),n=function(n){e.localizedItems[n].model.getMultilingualAttributes().forEach((function(i){var o=i.propertyName,r=i.propertyParentModel;i.multilingualProperty.switchLocale(t),e._updateView(r,o,e.localizedItems[n])})),e._onMultilingualPropertyChange(n)};for(var i in this.localizedItems)n(i);this.eventRouter.trigger("properties:refreshPane",{focusSelector:".clickablelanguage_"+t.to})},s.prototype.switchLanguage=function(e){e.from===this.getDefaultLanguage()?this.changeDefaultLanguage(e.to):(this.boardModel.properties.set({switchLanguageInfo:{from:e.to,to:e.from}},{silent:!0,payloadData:{skipUndoRedo:!0}}),this.boardModel.properties.set({switchLanguageInfo:e}))},s.prototype.getDefaultLanguage=function(){return this.boardModel.get("properties").get("defaultLocale")},s.prototype._getLocalizedStrings=function(e){var t=this,n=[];for(var i in this.localizedItems){this.localizedItems[i].model.getMultilingualAttributes().forEach((function(i){var o=i.propertyName,r=i.multilingualProperty;if(-1===t._excludedCSVAttributes.indexOf(o)){var a=r.getValue(e);a&&(a=a.trim(),n.push(a))}}))}return n},s.prototype._addTo=function(e,n){return t.union(e,Object.keys(n))},s.prototype.getSelectedLanguages=function(){var e=[];for(var n in this.localizedItems){this.localizedItems[n].model.getMultilingualAttributes().forEach((function(t){var n=t.multilingualProperty;e=e.concat(n.getLanguages())}))}return t.uniq(e)},s.prototype.destroy=function(){this.dashboardApi&&this.dashboardApi.getFeature("Properties").deregisterProvider(this),this.localizedItems=null,this._contentLocales=null},s.prototype.getPropertyLayoutList=function(){return[{id:"advanced",type:"Section",label:n.get("sectionName_advanced"),position:99},{id:"languages",type:"Section",label:n.get("multilingualDashboardsLabel"),collapsible:!1,style:"light",position:99}]},s.prototype.getPropertyList=function(){var e=this.dashboardApi.getFeature("propertiesManager");return e?"Default"===this.getDefaultLanguage()?this.getContentLocales()?this._getLanguageSpecWhenNoLocaleSet(e):[]:this._getMultilingualProperties(e):[]},s.prototype._getLanguageSpecWhenNoLocaleSet=function(e){var t=this,i=this.getDefaultLanguage(),o=void 0;return o=this.isPropertiesV2Enabled?"advanced":"general.advanced",[{id:"language_"+i,editor:{sectionId:o,position:3,uiControl:{type:"SingleLineLinks",items:[{align:"left",items:[{type:"text",id:"text"+i,value:n.get("multilingualDashboardsLabel")}]},{align:"right",items:[{type:this.isPropertiesV2Enabled?"textLink":"text",value:n.get("multilingualDashboardsSetDefault"),clickCallback:function(){t.launchLanguageSelectSlideout(i,!1,e)}}]}]}}}]},s.prototype._getMultilingualProperties=function(e){var t=this,i=this.getDefaultLanguage(),o=void 0;o=this.isPropertiesV2Enabled?"advanced.languages":"general.advanced.languages";var r=[].concat(this._createLanguageRow(i,o,!0));return this.getSelectedLanguages().sort((function(e,n){return t.getLanguageName(e)>t.getLanguageName(n)?1:-1})).forEach((function(e){e!==i&&"Default"!==e&&r.push(t._createLanguageRow(e,o,!1))})),r.push({id:"addLanguage",editor:{sectionId:o,uiControl:{type:"SingleLineLinks",isDisabled:this.translationModeOn,items:[{align:"right",items:[{type:this.isPropertiesV2Enabled?"textLink":"text",value:n.get("multilingualDashboardsAddLinkText"),clickCallback:function(){t.launchLanguageSelectSlideout(null,!0,e)}}]}]}}}),r},s.prototype._createLanguageRow=function(e,t,i){var o=this,r=this.getLanguageName(e);return{id:"language_"+e,editor:{sectionId:t,uiControl:{type:"SingleLineLinks",indent:2,disabled:this.translationModeOn,items:[{align:"left",items:[]},{align:"right",items:[{type:"text",id:"text"+e,value:i?n.get("multilingualDashboardsDefault",{defaultLanguage:r}):r},{type:"icon",svgIcon:"common-menuoverflow",iconTooltip:n.get("multilingualDashboardIconMore",{currentLanguage:r}),clickCallback:function(t){o.launchLanguageMenu(t,e)}}]}]}}}},s.prototype.launchLanguageSelectSlideout=function(e,t,i){var o=this;i=i||this.dashboardApi.getFeature("propertiesManager");var r=null;r=this.isPropertiesV2Enabled?{propertyLayoutList:this._buildPropertyLayoutList(e,t,i)}:{module:"dashboard-core/js/dashboard/contentpane/PropertyUIControlView",items:[{value:n.get("multilingualSelectLanguage"),centerLabel:!0,type:"Banner",backButton:!0,ariaLabel:n.get("multilingualSelectLanguage")},{type:"RadioButtonGroup",name:"language",separator:!0,ariaLabel:n.get("multilingualSelectLanguage"),value:e,selectOnNavigation:!1,items:this.getLanguageRadioItems(),onChange:function(n,r){i.closeChild(),"Default"===e?o.changeDefaultLanguage(r):t?o.startTranslationMode(r):o.switchLanguage({from:e,to:r})}}]},i.addChild({overlay:!0,label:n.get("multilingualSelectLanguage"),content:r})},s.prototype._buildPropertyLayoutList=function(e,t,i){var o=this,r=n.get("multilingualSelectLanguage");return[{id:"languagesList",type:"Banner",value:r,style:"light"},{id:"selectLanControl",editor:{uiControl:{type:"ComboBox",placeholder:r,items:this.getLanguageRadioItems(),onChange:function(n){var r=n&&n.selectedItem&&n.selectedItem.value;r&&("Default"===e?o.changeDefaultLanguage(r):t?o.startTranslationMode(r):o.switchLanguage({from:e,to:r})),i.closeChild()}}}}]},s.prototype.launchLanguageMenu=function(t,n){var i={};void 0===t.pageX||t.gesture&&(void 0===t.gesture.center||void 0===t.gesture.center.pageX)?i=e(t.target).offset():(i.left=t.pageX||t.gesture.center.pageX,i.top=t.pageY||t.gesture.center.pageY),this._glass.showContextMenu({position:{pageX:i.left,pageY:i.top},menuId:"com.ibm.bi.dashboard.languageMenu",activeObject:{selectedLocale:n,translationService:this,layoutBaseView:this}})},s}()})),define("text!dashboard-core/js/dashboard/util/templates/DashboardColorSet.html",[],(function(){return"{{~ it.colors : color }}\n\t.fill-{{=color.name}} {\n\t\tbackground-color: {{=color.hexValue}} !important;\n\t}\n\t.border-{{=color.name}} {\n\t\tborder-color: {{=color.hexValue}} !important;\n\t}\n\n\t.fill-{{=color.name}} .widgetContent .fillColorBackground {\n\t\tbackground-color: {{=color.hexValue}} !important;\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .userPrimaryFGPaletteColor *,\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .userPrimaryGridFGPaletteColor *:not(.edge):not(.summary):not(.implied_selection):not(.selected),\n\t.fill-{{=color.name}}.widget .widgetContent .userPrimaryFGPaletteColor *,\n\t.fill-{{=color.name}}.widget .widgetContent .userPrimaryGridFGPaletteColor *:not(.edge):not(.summary):not(.implied_selection):not(.selected) {\n\t\tcolor: {{=it.foregroundColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .kpi-widget-value .labeled-value-label, .fill-{{=color.name}}.widget .widgetContent .kpi-widget-value .labeled-value-label {\n\t\tcolor: {{=it.kpiLabelColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .kpi-widget-value .labeled-value-value, .fill-{{=color.name}}.widget .widgetContent .kpi-widget-value .labeled-value-value {\n\t\tcolor: {{=it.kpiValueColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .kpi-widget .kpi-widget-sparkline.defaultColors svg .line .line-element, .fill-{{=color.name}}.widget .widgetContent .kpi-widget .kpi-widget-sparkline.defaultColors svg .line .line-element {\n\t\tstroke: {{=it.kpiValueColors[color.name]}} !important;\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .infographic-widget .infographic-content.colorFill svg, .fill-{{=color.name}}.widget .widgetContent .infographic-widget .infographic-content.colorFill svg {\n\t\tfill: {{=it.kpiValueColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetContent .infographic-widget .infographic-content.colorStroke svg, .fill-{{=color.name}}.widget .widgetContent .infographic-widget .infographic-content.colorStroke svg {\n\t\tstroke: {{=it.kpiValueColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}}.widget .widgetContent .dataplayer-view.userPrimaryFGPaletteColor .sliderTickForHorizontal .tick{\n\t\tbackground-color: {{=it.dataPlayerColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}}.widget .widgetContent  .dataplayer-view.userPrimaryFGPaletteColor .sliderLabel{\n\t\tcolor: {{=it.dataPlayerColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}}.widget .widgetContent  .dataplayer-view.userPrimaryFGPaletteColor .sliderNode{\n\t\tfill: {{=it.dataPlayerColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}}.widget .widgetContent .dataplayer-view.userPrimaryFGPaletteColor .sliderBarHorizontal{\n\t\tbackground-color: {{=it.dataPlayerColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}}.widget .widgetContent .dataplayer-view.userPrimaryFGPaletteColor .playOrPause *{\n\t\tfill: {{=it.dataPlayerColors[color.name]}};\n\t}\n\n\t.ba-theme-default.fill-{{=color.name}} .relativeLayoutGrid,\n\t.fill-{{=color.name}} .relativeLayoutGrid{\n\t\tstroke: {{=it.gridColors[color.name]}} !important;\n\t}\n\n\t.ba-theme-default.fill-{{=color.name}} .absoluteLayoutGrid,\n\t.fill-{{=color.name}} .absoluteLayoutGrid{\n\t\tbackground-image: repeating-linear-gradient(0deg, {{=it.gridColors[color.name]}}, {{=it.gridColors[color.name]}} 1px, transparent 1px, transparent 100%),repeating-linear-gradient(-90deg, {{=it.gridColors[color.name]}}, {{=it.gridColors[color.name]}} 1px, transparent 1px, transparent 100%) !important;\n\t}\n{{~}}\n"})),define("dashboard-core/js/dashboard/util/DashboardColorSet",["underscore","doT","text!./templates/DashboardColorSet.html","./ColorUtils"],(function(e,t,n,i){var o=function(){function t(){_classCallCheck(this,t)}return t.getColorStyles=function(n,o){return n.getForegroundCSSColors("ForegroundUserPaletteColor",o).then((function(r){var a=n.getColorSet(o),A=[],s=[],l=e.clone(r,!0),c=e.clone(r,!0);return l.color1="rgba(52, 51, 52, 1)",c.color1="rgba(89, 88, 89, 1)","#FFFFFF"===n.getValueForPropertyOfUIElement("board","backgroundColor")&&(l.transparent="rgba(52, 51, 52, 1)",c.transparent="rgba(89, 88, 89, 1)"),a.forEach((function(e){var t=e.hexValue;"transparent"===e.name&&(t=n.getValueForPropertyOfUIElement("board","backgroundColor")),A[e.name]=i.invertColor(t,120,100,!0),s[e.name]=i.invertColor(t,120,100,!1)})),t.dotTemplate({colors:a,foregroundColors:r,kpiValueColors:l,kpiLabelColors:c,gridColors:A,dataPlayerColors:s})}))},t}();return o.dotTemplate=t.template(n),o})),define("text!dashboard-core/js/dashboard/widgets/staticwidget/colorSets/templates/TextWidgetColorSet.html",[],(function(){return"{{~ it.colors : color }}\n\t.fill-{{=color.name}}.widget .infographicLegendText,\n\t.fill-{{=color.name}} .widget:not([class*=\"fill-color\"]) .infographicLegendText {\n\t\tcolor: {{=it.foregroundColors[color.name]}} !important;\n\t}\n\n\t.fill-{{=color.name}}.widget .infographicLegendShape,\n\t.fill-{{=color.name}} .widget:not([class*=\"fill-color\"]) .infographicLegendShape {\n\t\tfill: {{=it.foregroundColors[color.name]}};\n\t}\n\n\t.fill-{{=color.name}}.widget .infographicLegendLine,\n\t.fill-{{=color.name}} .widget:not([class*=\"fill-color\"]) .infographicLegendLine {\n\t\tstroke: {{=it.foregroundColors[color.name]}};\n\t}\n\n\t.note-editable .{{=color.name}} {\n\t\tcolor: {{=color.hexValue}} !important;\n\t}\n\n\t.fill-{{=color.name}}.widget .widgetTitle .responsiveColor,\n\t.fill-{{=color.name}} .widget.fill-transparent .widgetTitle .responsiveColor {\n\t\tcolor: {{=it.foregroundTextWidgetColor1[color.name]}} !important;\n\t}\n\n\n\t{{~ ['titleColor', 'titleSmallColor', 'responsiveColor', 'titleText', 'titleSmallText', 'responsiveText'] : className }}\n\t\t.fill-{{=color.name}}.staticContent .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor1[color.name]}} {{? color.name !== 'transparent'}}!important{{?}};\n\t\t}\n\t\t.fill-{{=color.name}} .staticContent:not([class*=\"fill-color\"]) .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor1[color.name]}};\n\t\t}\n\t{{~}}\n\n\t{{~ ['subtitleColor', 'bodyColor', 'bodySmallColor'] : className }}\n\t\t.fill-{{=color.name}}.staticContent .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor2[color.name]}} !important;\t\t\t\n\t\t}\n\t\t.fill-{{=color.name}} .staticContent:not([class*=\"fill-color\"]) .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor2[color.name]}};\n\t\t}\n\t{{~}}\n\t\n\t{{~ ['captionColor', 'captionText'] : className }}\n\t\t.fill-{{=color.name}}.staticContent .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor3[color.name]}} !important;\t\t\t\n\t\t}\n\t\t.fill-{{=color.name}} .staticContent:not([class*=\"fill-color\"]) .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor3[color.name]}};\n\t\t}\n\t{{~}}\n\n\t{{~ ['quoteColor', 'quoteSmallColor', 'quoteText','quoteSmallText'] : className }}\n\t\t.fill-{{=color.name}}.staticContent .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor4[color.name]}} !important;\t\t\t\n\t\t}\n\t\t.fill-{{=color.name}} .staticContent:not([class*=\"fill-color\"]) .{{=className}} {\n\t\t\tcolor: {{=it.foregroundTextWidgetColor4[color.name]}};\n\t\t}\n\t{{~}}\n{{~}}"})),define("dashboard-core/js/dashboard/widgets/staticwidget/colorSets/TextWidgetColorSet",["doT","text!./templates/TextWidgetColorSet.html"],(function(e,t){var n=function(){function e(){_classCallCheck(this,e)}return e.getColorStyles=function(t,n){return Promise.all([t.getForegroundCSSColors("ForegroundUserPaletteColor",n),t.getForegroundCSSColors("TextWidgetColor1UserPaletteColor",n),t.getForegroundCSSColors("TextWidgetColor2UserPaletteColor",n),t.getForegroundCSSColors("TextWidgetColor3UserPaletteColor",n),t.getForegroundCSSColors("TextWidgetColor4UserPaletteColor",n)]).then((function(i){var o=i[0],r=i[1],a=i[2],A=i[3],s=i[4];return e.dotTemplate({colors:t.getColorSet(n),foregroundColors:o,foregroundTextWidgetColor1:r,foregroundTextWidgetColor2:a,foregroundTextWidgetColor3:A,foregroundTextWidgetColor4:s})}))},e}();return n.dotTemplate=e.template(t),n})),define("text!dashboard-core/js/dashboard/widgets/staticwidget/colorSets/templates/ShapeWidgetColorSet.html",[],(function(){return"{{~ it.colors : color }}\n\t.shapeWidget .fill-{{=color.name}} {\n\t\tfill: {{=color.hexValue}} !important;\n\t\tbackground-color: transparent !important;\n\t}\n\t.shapeWidget .border-{{=color.name}} {\n\t\tstroke: {{=color.hexValue}} !important;\n\t\tcolor: {{=color.hexValue}} !important;\n\t}\n{{~}}"})),define("dashboard-core/js/dashboard/widgets/staticwidget/colorSets/ShapeWidgetColorSet",["doT","text!./templates/ShapeWidgetColorSet.html"],(function(e,t){var n=function(){function e(){_classCallCheck(this,e)}return e.getColorStyles=function(t,n){return Promise.resolve(e.dotTemplate({colors:t.getColorSet(n)}))},e}();return n.dotTemplate=e.template(t),n})),define("text!dashboard-core/js/dashboard/layout/views/templates/TabColorSet.html",[],(function(){return"{{~ it.colors : color }}\n\n\t.pagetab .tabCntr > .fill-{{=color.name}} .ba-common-tabList .addNewIcon,\n\t.pagetab .tabCntr > .fill-{{=color.name}} .ba-common-tabList .chevron-icon {\n\t\tfill: {{=it.actionButtonColors[color.name]}};\n\t}\n\n\t.pagetab .tabCntr > .fill-{{=color.name}} .ba-common-tabList .addNewIcon:hover {\n\t\tfill: {{=it.plusHoverColors[color.name]}};\n\t}\n\n\t.pagetab .tabCntr > .fill-{{=color.name}} .ba-common-tabList {\n\t\tborder-color: {{=it.tabDividerColor[color.name]}};\n\t}\n\n\t{{? color.name === 'transparent'}}\n\t\t.pagetab .tabCntr .ba-common-tabList .addNewIcon,\n\t\t.pagetab .tabCntr .ba-common-tabList .chevron-icon {\n\t\t\tfill: {{=it.actionButtonColors[color.name]}};\n\t\t}\n\n\t\t.pagetab .tabCntr .ba-common-tabList .addNewIcon:hover {\n\t\t\tfill: {{=it.plusHoverColors[color.name]}};\n\t\t}\n\n\t\t.pagetab .tabCntr .ba-common-tabList {\n\t\t\tborder-color: {{=it.tabDividerColor[color.name]}};\n\t\t}\n\t{{?}}\n{{~}}\n"})),define("dashboard-core/js/dashboard/layout/views/TabColorSet",["doT","text!./templates/TabColorSet.html","../../util/ColorUtils"],(function(e,t,n){var i=function(){function e(){_classCallCheck(this,e)}return e.getColorStyles=function(t,i){return Promise.all([t.getForegroundCSSColors("TabActionButtonColor",i),t.getForegroundCSSColors("TabDividerColor",i),t.getForegroundCSSColors("TabPlusHoverColor",i)]).then((function(o){var r=o[0],a=o[1],A=o[2],s=t.getColorSet(i),l="userPaletteColor"===t.getColorSetId();return s.forEach((function(e){var i=e.hexValue;"transparent"===e.name&&(i=t.getValueForPropertyOfUIElement("board","backgroundColor")),l&&!t.isCustomColor(e.name)||(A[e.name]=n.invertColor(i,90,100,!0),a[e.name]=n.invertColor(i,40,100,!0))})),e.dotTemplate({colors:s,actionButtonColors:r,plusHoverColors:A,tabDividerColor:a})}))},e}();return i.dotTemplate=e.template(t),i})),define("dashboard-core/js/dashboard/data/ThemeDefinition",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../../app/nls/StringResources","underscore"],(function(e,t,n){var i=["UserPaletteColor","ForegroundUserPaletteColor","SecondaryForegroundUserPaletteColor","TabTextColor","TabSelectedLineColor"];return e.extend({init:function(e){this.jsonDefinition=e,this.variableMapping={},this._cssColors={},this._mapVariables(),this._fillColor=null},getId:function(){return this.jsonDefinition.id},getProperty:function(e){return this.jsonDefinition&&this.jsonDefinition[e]},_mapVariables:function(){if(this.jsonDefinition&&this.jsonDefinition.variables){var e=this.jsonDefinition.variables;for(var t in e)e.hasOwnProperty(t)&&(this.variableMapping[t]=this._getMapOfVariables(e[t]))}},_getMapOfVariables:function(e){var t={};return n.each(e,function(e){t[e.id]=e}.bind(this)),t},getValueForVariable:function(e,t){if(this.variableMapping[e]){if(!t)return this.variableMapping[e];if(this.variableMapping[e][t])return this.variableMapping[e][t].value}},_getValueForProperty:function(e){if(e&&void 0!==e.value&&null!==e.value)return isNaN(e.value)&&"$"===e.value.substr(0,1)?this.getValueForVariable(e.type,e.value.substr(1)):e.value},getDefaultPaletteName:function(e){var t=n.keys(this.variableMapping[e]);if(t&&t.length>0)return t[0]},getColorValue:function(e){return e.pattern?e.pattern:e.fill?e.fill:e.backgroundColor?e.backgroundColor:e},getCSSColors:function(e){var t=this;if(!this._cssColors[e]){var n=this._getVariable(e);if(!n)return{};this._cssColors[e]={},n.forEach((function(n){t._cssColors[e][n.id]=t._convertToCssColor(n.value)}))}return this._cssColors[e]},_convertToCssColor:function(e){var t=null;if(this._isColorValue(e)){var n=e.r+","+e.g+","+e.b;t=void 0!==e.a?"rgba("+n+","+e.a+")":"rgb("+n+")"}return t||e},_isColorValue:function(e){return e&&void 0!==e.r&&void 0!==e.g&&void 0!==e.b},_getVariable:function(e){if(!this.jsonDefinition)return null;var t=this.jsonDefinition,n=t.legacy,i=t.variables;return!0===n?i[e].sort(this._sortCarbonFirst):i[e]},_sortCarbonFirst:function(e,t){return e.deprecated&&!t.deprecated?1:!e.deprecated&&t.deprecated?-1:0},getPalette:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("userPaletteColor"===e){var i=this._getUserPaletteColor();return this._createCMPaletteResponse(i,n)}var o=this._getVariable("UserPaletteColor"===t?"ColorPalette":t);if(!o)return{};for(var r=0,a=0;a<o.length;a++){var A=o[a];if(A.deprecated||r++,A.id===e||A.aliases&&-1!==A.aliases.indexOf(e)){var s=a-r;return this._createCMPaletteResponse(A,n,s)}}return this._createCMPaletteResponse(o[0],n,0)},_getUserPaletteColor:function(){var e=this._getVariable("UserPaletteColor"),n={id:"userPaletteColor",fillType:"simple",label:t.get("userPaletteColor_"+this.jsonDefinition.id),labelTranslated:!0,ids:[],labels:[],fills:[]};return e.forEach((function(e){var t=e.value,i=e.id,o=e.label;n.fills.push(t),i&&n.ids.push(i),o&&n.labels.push(o)})),n},getPalettes:function(e,t){var i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getVariable(e);if(!r)return[];var a=0,A=r.filter((function(e){return o||n.find(e.fills,(function(e){return!e.pattern}))})).map((function(e,n){e.deprecated||a++;var o=n-a;return i._createCMPaletteResponse(e,t,o)}));return A},_createCMPaletteResponse:function(e,i,o){if(!e)return{};var r=n.find(e.fills,(function(e){return e.pattern})),a=e.labelTranslated?e.label:t.get(e.label,{number:o+1}),A=n.extend(e,{label:a,labelTranslated:!0,fillType:r?"ImgPath":e.fillType});return r&&(A.path="dashboard-core/images/patterns/",A.fileType=".svg"),i?(A.deprecated||(A.renderMode="step"),{system:!0,id:e.id,content:A}):A},getValueForPropertyOfUIElement:function(e,t){var n=this.getPropertyForUIElement(e,t);return this._getValueForProperty(n)},getPropertyForUIElement:function(e,t){if(this.jsonDefinition&&this.jsonDefinition.uiElements[e]){var i=this.jsonDefinition.uiElements[e];return n.find(i,function(e){return e.id===t}.bind(this))}},getUIElement:function(e){return this.jsonDefinition.uiElements[e]},getForegroundPropertiesForUIElement:function(e){var t=this.jsonDefinition.uiElements[e];return t?t.filter((function(e){return-1!==i.indexOf(e.type)})):[]},getForegroundColorPropertiesForUIElement:function(e,t){var n=this,i=[];return this.getForegroundPropertiesForUIElement(t).forEach((function(t){var o=n._getValueForProperty({type:t.type,value:"$"+e});o=t.alpha?n._convertToRGBA(o,t.alpha):o,i.push({id:t.id,value:o})})),i},_convertToRGBA:function(e,t){if(e){if("string"!=typeof e)return n.extend({a:t},n.omit(e,"a"));if("#"===e.charAt(0)&&7===e.length)return{a:t,r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5),16)}}return e}})})),define("text!dashboard-core/js/app/util/resources/bg_default_image.svg",[],(function(){return'<svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><style>.foregroundFill{fill:#a7a9ac;fill-opacity:.33}</style><path class="foregroundFill" d="M0 0v32h32V0H0zm30.9 27.1H1.1V1.2h29.7v25.9z"/><path class="foregroundFill" d="M20.2 18.7l-9.6-9.6L2.7 16v9.1h27.4v-6.8L25.5 15z"/><circle fill="none" stroke-miterlimit="10" cx="25.5" cy="8" r="2.3" stroke="#a7a9ac" stroke-opacity=".33"/></svg>\n'})),define("text!dashboard-core/js/app/util/resources/bg_default_media.svg",[],(function(){return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="none" stroke-miterlimit="10" d="M.5.5h31v31H.5z" stroke="#a7a9ac" stroke-opacity=".33"/><path d="M10.6 9.6L21.8 16l-11.2 6.4zM2.4 2.4h5v3.7h-5zm7.4 0h5v3.7h-5zm7.4 0h5v3.7h-5zm7.5 0h5v3.7h-5zM2.4 25.9h5v3.7h-5zm7.4 0h5v3.7h-5zm7.4 0h5v3.7h-5zm7.5 0h5v3.7h-5z" fill="#a7a9ac" fill-opacity=".33"/></svg>\n'})),define("text!dashboard-core/js/app/util/resources/bg_default_webpage.svg",[],(function(){return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="none" stroke-miterlimit="10" stroke="#a7a9ac" stroke-opacity=".33" d="M.5.5h31v31H.5z"/><path d="M16 5.6c-5.8 0-10.5 4.7-10.5 10.5S10.2 26.6 16 26.6s10.5-4.7 10.5-10.5S21.8 5.6 16 5.6zm-2.7 2c-1.1 1.2-1.5 2.1-1.6 2.4-.8 0-1.6-.4-1.7-.5.7-.8 2.5-1.8 3.3-1.9zm-4 2.6c.3.2 1.1.5 1.9.6-1.2 2.3-1.1 4.9-1.1 4.9H7c0-2.4 1.2-4.3 2.3-5.5zM7 16.6h3s0 2.7 1.2 5.1c-.7.2-1.5.5-1.7.7C8.4 21.2 7 19.1 7 16.6zm3.2 6.4c.3-.2.7-.4 1.4-.5.3.8 1.2 2 1.2 2-.4-.1-1.9-.8-2.6-1.5zm5.3 2.1c-.2 0-.5 0-1-.1-.4-.4-1.3-1.5-1.9-2.6.6-.2 2-.4 2.9-.4v3.1zm0-4c-.9 0-2 0-3.3.4-1-2-1.1-3.8-1.1-4.9h4.4v4.5zm0-5.4h-4.4c0-1.1 0-2.7 1-4.7 1.4.3 2.5.3 3.4.3v4.4zm0-5.2c-.5 0-1.8 0-3-.3.5-1 2-2.9 2.6-2.9h.4v3.2zm9.3 5.3h-3s.1-2.5-1.1-4.9c.7-.1 1.6-.5 1.9-.6 1.1 1.1 2.2 3 2.2 5.5zm-2.9-6.3c-.1.1-.9.5-1.7.5-.2-.3-.6-1.2-1.6-2.4.7.2 2.6 1.1 3.3 1.9zm-5.5-2.3h.4c.6.1 2.2 1.9 2.6 2.9-1.2.3-2.5.3-3 .3V7.2zm0 4.2c.9 0 2.1 0 3.4-.3 1 2 1 3.6 1 4.7h-4.4v-4.4zm0 5.2h4.4c0 1.1-.2 2.9-1.1 4.9-1.4-.3-2.4-.4-3.3-.4v-4.5zm.9 8.3l-1 .1v-3c.9 0 2.3.2 2.9.4-.5 1-1.5 2.2-1.9 2.5zm1.7-.4s.9-1.2 1.2-2c.7.1 1.1.3 1.4.5-.6.7-2.1 1.4-2.6 1.5zm3.4-2.2c-.3-.2-1-.5-1.7-.7 1.2-2.3 1.2-5.1 1.2-5.1h3c-.1 2.6-1.4 4.7-2.5 5.8z" fill="#a7a9ac" fill-opacity=".33"/></svg>\n'})),define("text!dashboard-core/js/app/util/resources/bg_default_vizualization.svg",[],(function(){return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M0 14.8h8.6V32H0zm23.4 14.7H32V32h-8.6zm0-4.9H32v2.5h-8.6zm0-4.9H32v2.5h-8.6zm0-4.9H32v2.5h-8.6zm0-5H32v2.5h-8.6zm0-4.9H32v2.5h-8.6zm0-4.9H32v2.5h-8.6zM11 7.4V32h9.8V7.4H11zm7.4 22.1h-4.9V9.8h4.9v19.7z" fill="#a7a9ac" fill-opacity=".33"/></svg>\n'})),define("dashboard-core/js/features/dashboard/segment/api/SegmentAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.track=function(){},e.prototype.getInfo=function(){},e.prototype.registerInfoCallback=function(){},e.prototype.unregisterInfoCallback=function(){},e}()})),define("dashboard-core/js/features/dashboard/segment/SegmentFeature",["./api/SegmentAPI","./api/impl/Segment","../../../lib/@waca/dashboard-common/dist/core/APIFactory"],(function(e,t,n){return function(){function i(o){_classCallCheck(this,i);var r=o.dashboardApi,a=r.getGlassCoreSvc(".Instrumentation");if(a.enabled){var A=r.getGlassCoreSvc(".Logger"),s=r.getFeature("DashboardSettings");this._api=n.createAPI(new t(_extends({},o,{instrumentationSvc:a,logger:A,mapping:s.get("instrumentationMapping")})),[e])}else this._api=new e}return i.prototype.getAPI=function(){return this._api},i}()})),define("dashboard-core/js/features/dashboard/coachMark/api/CoachMarkAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.addCoachMark=function(){},e}()})),define("dashboard-core/js/features/dashboard/coachMark/api/impl/CoachMark",["jquery","../../../../../lib/@waca/dashboard-common/dist/core/APIFactory","../CoachMarkAPI","../../../../../lib/@waca/baglass/js/baglass/utils/Utils"],(function(e,t,n,i){return function(){function o(){_classCallCheck(this,o)}return o.prototype.getAPI=function(){return t.createAPI(this,[n])},o.prototype.addCoachMark=function(t){var n=_extends({$el:e(t.domElement)},t);return i.addCoachmark(n)},o}()})),define("dashboard-core/js/features/dashboard/theme/DashboardThemeAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.getThemeDefinition=function(){},e}()})),define("dashboard-core/js/dashboard/data/ThemeDefinitionAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.getCSSColors=function(){},e.prototype.getDefaultPaletteName=function(){},e.prototype.getId=function(){},e.prototype.getUIElement=function(){},e.prototype.getPalette=function(){},e.prototype.getPalettes=function(){},e.prototype.getPropertyForUIElement=function(){},e.prototype.getValueForPropertyOfUIElement=function(){},e.prototype.getValueForVariable=function(){},e.prototype.getForegroundColorPropertiesForUIElement=function(){},e.prototype.getForegroundPropertiesForUIElement=function(){},e.prototype.getProperty=function(){},e}()})),define("dashboard-core/js/features/dashboard/theme/ThemeProviderAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.loadThemeDefinition=function(){},e}()})),define("dashboard-core/js/features/dashboard/theme/DashboardTheme",["../../../lib/@waca/dashboard-common/dist/core/APIFactory","./DashboardThemeAPI","../../../lib/@waca/core-client/js/core-client/utils/ClassFactory","../../../dashboard/data/ThemeDefinition","../../../dashboard/data/ThemeDefinitionAPI","./ThemeProviderAPI"],(function(e,t,n,i,o,r){return function(){function a(){_classCallCheck(this,a),this._themes={},this._getThemeDefinition=null,this._themeProvider=this,this._api=e.createAPI(this,[t])}return a.prototype.getAPI=function(){return this._api},a.prototype.initialize=function(t){var i=this;try{return this._logger=t.getCoreSvc(".Logger"),t.appController.findCollection("com.ibm.bi.dashboard.dashboardTheme.system").then((function(t){if(Array.isArray(t)&&t.length>0){var o=t[0].class;return n.loadModule(o).then((function(t){i._themeProvider=e.createAPI(new t,[r])})).catch((function(e){return i._logger.error(e)}))}}))}catch(e){console.log(e)}return Promise.resolve()},a.prototype.loadThemeDefinition=function(e){return n.loadModule("text!dashboard-core/js/lib/@waca/dashboard-common/dist/themes/"+e+".json").then(JSON.parse.bind(JSON))},a.prototype.getThemeDefinition=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"carbonGrey10";return this._themes[t]?(this._themeDefinition=this._themes[t],Promise.resolve(this._themes[t])):this._themeProvider.loadThemeDefinition(t).catch(this._handleLoadingError.bind(this,t)).then(this._processThemeDefinition.bind(this,t)).then((function(n){return e._setThemeDefinition(t,n),e._themeDefinition}))},a.prototype._processThemeDefinition=function(e,t){return this._themeProvider!==this?this.loadThemeDefinition(e).then(this._mergeDeep.bind(this,t)):t},a.prototype._handleLoadingError=function(e,t){if(this._logger.error(t),this===this._themeProvider)throw t;return this.loadThemeDefinition(e)},a.prototype._isObject=function(e){return e&&"object"===(void 0===e?"undefined":_typeof(e))&&!Array.isArray(e)},a.prototype._mergeDeep=function(e,t){var n=this,i=Object.assign({},t);return this._isObject(t)&&this._isObject(e)&&Object.keys(e).forEach((function(o){var r,a;e[o]?t[o]?_typeof(e[o])!==_typeof(t[o])?n._logger.warn("Contributed theme attribute: "+o+" is not of the right type"):n._isObject(e[o])?i[o]=n._mergeDeep(e[o],t[o]):Object.assign(i,((r={})[o]=e[o],r)):Object.assign(i,((a={})[o]=e[o],a)):n._logger.info("No value corresponding to the key: "+o)})),i},a.prototype._setThemeDefinition=function(t,n){this._themes[t]=e.createAPI(new i(n),[o]),this._themeDefinition=this._themes[t]},a}()})),define("dashboard-core/js/consumeDashboardBundle",(function(){}));