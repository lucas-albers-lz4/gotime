/**
 * IBM Confidential OCO Source Materials IBM Business Platform: Dashboard
 * (C) Copyright IBM Corp. 2016, 2021
 *
 * The source code for this program is not published or otherwise divested of
 * its trade secrets, irrespective of what has been deposited with the U.S.
 * Copyright Office
 */

function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t};define("dashboard-core/js/dashboard/layouts/CustomLayout",[],(function(){return{layout:{type:"genericPage",layoutPositioning:"relative",pageSize:{width:512,height:1024},showGrid:!0,snapGrid:!0,snapObjects:!0}}})),define("dashboard-core/js/dashboard/layouts/InfographicsLayout",[],(function(){return{layout:{type:"genericPage",layoutPositioning:"relative",pageSize:{width:512,height:1024},showGrid:!1,snapGrid:!1,snapObjects:!1}}})),function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"));else if("function"==typeof define&&define.amd)define("js/gemini/lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/icons-js/overflow-menu--vertical_32",["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"],e);else{var a=e("object"==typeof exports?require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"):t["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"]);for(var n in a)("object"==typeof exports?exports:t)[n]=a[n]}}("undefined"!=typeof self?self:this,(function(t){return webpackJsonPBaGraphics([464],{"05e92c9505a6025ba118":function(t,e,a){"use strict";var n=a("9689a9c94ae38b47fa2c"),o=a.n(n),s=a("9ce58a7deea14f49ef01"),r=a.n(s),i=new o.a({id:"overflow-menu--vertical_32_v7",use:"overflow-menu--vertical_32_v7-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="overflow-menu--vertical_32_v7"><circle cx="16" cy="8" r="2" /><circle cx="16" cy="16" r="2" /><circle cx="16" cy="24" r="2" /></symbol>'});r.a.add(i),e.a=i},"226a34d55d3eac820fae":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("6873601dfe1d9459c1a9"),o=(a.n(n),a("05e92c9505a6025ba118"));e.default=o.a},"6873601dfe1d9459c1a9":function(e,a){e.exports=t}},["226a34d55d3eac820fae"])})),define("dashboard-core/js/dashboard/views/TemplateLayout",["react","prop-types","@ba/ba-ui-carbon-toolkit","@ba/ba-graphics/dist/icons-js/overflow-menu--vertical_32"],(function(t,e,a,n){var o=t.Component,s=a.Container,r=a.SVGIcon,i=a.FlexLayout,l=a.FlexItem,p=a.TruncatedText,c=function(e){function a(t){return _classCallCheck(this,a),_possibleConstructorReturn(this,e.call(this,t))}return _inherits(a,e),a.prototype.render=function(){var e=this;return t.createElement(s,{onDoubleClick:function(){return e.props.action()}},this._getContent(this.props.layoutSpec))},a.prototype._getContent=function(t){return t.layout.navigationTemplates&&-1!==t.layout.navigationTemplates.indexOf("custom")?this._getTemplateThumbnail(t):this._getPreview(t.layout)},a.prototype._getPreview=function(e){var a=this,n={};if(e.style)for(var o in e.style)e.style.hasOwnProperty(o)&&(n[o]=e.style[o]);var s=e.css||"";s+=" "+e.type;var r=[];return e.items&&(r=e.items.map((function(t){return a._getPreview(t)}))),t.createElement("div",{className:s,style:n},r)},a.prototype._getTemplateThumbnail=function(e){var a=this,o=e.layout,s=e.thumbnail,c=e.contextMenuEnabled,u=e.template,d=o.name,h=o.label,m=o.location;if(d&&s)return t.createElement(i,{fullHeight:!0,direction:"column",className:"layoutThumbnailContainer"},t.createElement(l,{alignSelf:"center",className:"layoutThumbnail"},t.createElement("img",{src:"data:image/png;base64,"+s})),t.createElement(l,null,t.createElement(i,{direction:"row",justifyContent:"space-between",alignItems:"center"},t.createElement(p,{className:"layoutThumbnailLabel",value:h}),c?t.createElement(l,{alignSelf:"right",className:"layoutContextMenuButton",onClick:function(t){return a._onContextMenuButtonClick(u,t)}},t.createElement(r,{iconId:n.default.id})):null)),t.createElement(l,null,t.createElement(p,{className:"layoutLocation",value:m})))},a.prototype._onContextMenuButtonClick=function(t,e){t&&this.props.showContextMenu(t,e.pageX,e.pageY)},a}(o);return c.propTypes={action:e.func.isRequired,layoutSpec:e.object.isRequired,showContextMenu:e.func},c})),define("dashboard-core/js/dashboard/views/LayoutPicker",["react","prop-types","@ba/ba-ui-carbon","@ba/ba-ui-carbon-toolkit","./TemplateLayout","../../lib/@waca/core-client/js/core-client/ui/KeyCodes"],(function(t,e,a,n,o,s){var r=t.Component,i=a.TileGroup,l=a.RadioTile,p=n.Container,c=n.SVGIcon,u=function(e){function a(t){return _classCallCheck(this,a),_possibleConstructorReturn(this,e.call(this,t))}return _inherits(a,e),a.prototype.render=function(){var e=this;if(this.props.templates&&this.props.templates.length){var a=this.props.templates.map((function(t,a){return e._getTemplateTile(t,a)}));return t.createElement(i,{className:"layoutPickerContainer",valueSelected:this.props.defaultTemplateSelected,onChange:function(){var t;return(t=e.props).onSelectedTemplateId.apply(t,arguments)},ref:function(t){return e.tileGroupRef=t}},a)}return null},a.prototype._getTemplateTile=function(e,a){var n=this,s=e.layoutSpec,r=e.templateId,i=e.ariaLabel,u=e.icon,d="layoutTemplateItem";return d=this.props.selectedNavModel?d+" "+this.props.selectedNavModel:d,t.createElement(l,{className:d,id:r,value:r,onKeyDown:function(t){return n._onKeyDown(t)},tabIndex:0,"aria-label":i,"aria-posinset":a+1,"aria-setsize":this.props.templates.length,"data-id":r,light:this.props.light},u?t.createElement(p,{onDoubleClick:function(){return n.props.action()}},t.createElement(c,{size:"xxlarge",iconId:u})):t.createElement(o,{layoutSpec:s,action:this.props.action,showContextMenu:this.props.showContextMenu}))},a.prototype._onKeyDown=function(t){switch(t.keyCode){case s.ENTER:case s.SPACE:t.stopPropagation(),this.props.action()}},a}(r);return u.propTypes={action:e.func.isRequired,onSelectedTemplateId:e.func.isRequired,templates:e.array.isRequired,defaultTemplateSelected:e.string,showContextMenu:e.func,selectedNavModel:e.string,light:e.bool},u})),define("dashboard-core/js/dashboard/views/NavigationPickerTabs",["react","prop-types","@ba/ba-ui-carbon","@ba/ba-ui-carbon-toolkit","./LayoutPicker","../../app/nls/StringResources"],(function(t,e,a,n,o,s){var r=t.Component,i=a.Tabs,l=a.Tab,p=a.Button,c=n.FlexLayout,u=n.FlexItem,d=function(e){function a(n){_classCallCheck(this,a);var o=_possibleConstructorReturn(this,e.call(this,n));o.primaryButtonRef=t.createRef();var s=o.props.navModels.findIndex((function(t){return t.dataId===o.props.defaultNavigation}));return s=s<0?0:s,o.state={navModels:o.props.navModels,selectedTabIndex:s,selectedLayout:null},o}return _inherits(a,e),a.prototype.shouldComponentUpdate=function(t,e){var a=e.navModels.find((function(t){return"custom"===t.dataId})),n=this.state.navModels.find((function(t){return"custom"===t.dataId}));return!!(a&&!n||!a&&n)||!(!a||!n||a.templates.length===n.templates.length)},a.prototype.componentDidMount=function(){this.props.glassContext.getCoreSvc(".Events").on("deleteAction:done",this._onDeleteActionDone,this),this.primaryButtonRef.current&&this.primaryButtonRef.current.focus()},a.prototype.componentWillUnmount=function(){this.props.glassContext.getCoreSvc(".Events").off("deleteAction:done",this._onDeleteActionDone,this)},a.prototype.render=function(){return t.createElement(c,{className:"createBoardContainer",direction:"column"},t.createElement(c,{direction:"row",className:"createBoardTitleBar",justifyContent:"space-between"},this._renderTitle(),this._renderButtons()),this._renderTabSection())},a.prototype._renderTitle=function(){var e=this.props.title||s.get("createBoardTitle"),a=this.props.subTitle||s.get("createBoardSubtitle");return t.createElement(c,{direction:"column",className:"createBoardTitle"},t.createElement(u,{className:"title-text"},e),t.createElement(u,{className:"subtitle-text"},a))},a.prototype._renderButtons=function(){var e=this;return t.createElement(c,{className:"createBoardBtns"},t.createElement(p,{kind:"secondary",onClick:function(){return e.props.onCancel()}},s.get("cancelButton")),t.createElement(p,{kind:"primary",onClick:function(){return e._onSelectTemplate()},ref:this.primaryButtonRef},s.get("createButton")))},a.prototype._renderTabSection=function(){var e=this,a=this.state.navModels.map((function(t){return e._renderTab(t)}));return t.createElement(i,{className:"navigationTabs",selected:this.state.selectedTabIndex,onSelectionChange:function(t){return e.setState({selectedTabIndex:t})}},a)},a.prototype._renderTab=function(e){var a=this,n=e.dataId,s=e.label,r=e.templates;return t.createElement(l,{id:n,label:s,dataId:n,renderContent:function(t){var e=t.selected,n=t.children;return e?(a.setState({selectedLayout:r[0].templateId}),n):null}},t.createElement(o,{action:this._onSelectTemplate.bind(this),showContextMenu:this.props.showContextMenu.bind(this),onSelectedTemplateId:function(t){return a.setState({selectedLayout:t})},templates:r,selectedNavModel:n,defaultTemplateSelected:r[0].templateId}))},a.prototype._onSelectTemplate=function(){var t=this,e=this.state.navModels[this.state.selectedTabIndex].dataId;return this.props.templateLayoutGenerator.getSelectedLayoutSpec(this.state.selectedLayout).then((function(a){var n=a.layout;t.props.action(n,e)})).catch((function(e){t.props.displayError(e)}))},a.prototype._onDeleteActionDone=function(t){var e=t&&t.length&&t[0];if(e&&e.tags&&-1!==e.tags.indexOf("dashboard_template")){this.props.templateLayoutGenerator.customTemplateDelete(e.id);var a=this.state.navModels.map((function(t){return _extends({},t)})),n=a.find((function(t){return"custom"===t.dataId}));n.templates=this.props.templateLayoutGenerator.getTemplates("custom"),n.templates.length?this.setState({navModels:a}):(a=a.filter((function(t){return"custom"!==t.dataId})),this.setState({navModels:a,selectedTabIndex:0}))}},a}(r);return d.propTypes={action:e.func.isRequired,onCancel:e.func.isRequired,navModels:e.array.isRequired,templateLayoutGenerator:e.shape({initialize:e.func.isRequired,getTemplates:e.func.isRequired,customTemplateDelete:e.func.isRequired,getSelectedLayoutSpec:e.func.isRequired}),glassContext:e.shape({getCoreSvc:e.func.isRequired}),displayError:e.func,defaultNavigation:e.string,title:e.string,subTitle:e.string,showContextMenu:e.func},d})),define("dashboard-core/js/features/dashboard/dashboardTemplates/api/DashboardTemplatesAPI",[],(function(){return function(){function t(){_classCallCheck(this,t)}return t.prototype.destroy=function(){},t.prototype.listTemplates=function(){},t.prototype.getTemplate=function(){},t.prototype.getThumbnail=function(){},t}()})),define("dashboard-core/js/features/dashboard/dashboardTemplates/api/impl/DashboardTemplatesImpl",["../DashboardTemplatesAPI","../../../../../lib/@waca/dashboard-common/dist/core/APIFactory"],(function(t,e){return function(){function a(t){_classCallCheck(this,a),this._logger=t.logger,this._getContentSvc=t.getContentSvc,this._featureChecker=t.featureChecker,this._isEnabled=!this._featureChecker.checkValue("dashboard","dashboardTemplates","disabled")}return a.prototype.destroy=function(){},a.prototype.getAPI=function(){return e.createAPI(this,[t])},a.prototype.listTemplates=function(){var t=this;return this._isEnabled?this._getContentSvc.then((function(e){return e.get("v1/search/cm?filter=type%7Cexploration&filter=tags%7Cdashboard_template",{type:"GET",data:{fields:"defaultName,data,id,ancestors,modificationTime"}}).then((function(t){var a=t&&t.results;return a?(a.sort((function(t,e){return Date.parse(e.modificationTime)-Date.parse(t.modificationTime)})).forEach((function(t){t.location=e.getLocation(t)})),a):[]})).catch((function(e){return t._logger.error(e,t),[]}))})):Promise.resolve([])},a.prototype.getTemplate=function(t,e){return this._isEnabled?this._getContentSvc.then((function(a){var n=a.getBaseObjectsURL()+"/"+t,o={dataType:"json",type:"GET"};return e&&(o.data={fields:"specification"}),a.get(n,o).then((function(t){var e=t&&t.data&&t.data.length&&t.data[0];if(e.specification)try{e.specification=JSON.parse(e.specification)}catch(t){return Promise.reject(t)}return e}))})):Promise.resolve({})},a.prototype.getThumbnail=function(t){return this._isEnabled?this._getContentSvc.then((function(e){var a=e.getBaseObjectsURL()+"/"+t+"/items?types=graphic";return e.get(a,{type:"GET",data:{fields:"data"}}).then((function(t){return t&&t.data&&t.data.length&&t.data[0].data}))})):Promise.resolve({})},a}()})),define("text!dashboard-core/js/dashboard/layout/templates/listing.json",[],(function(){return'{"templates":[\n\t{\n\t\t"name":"NoTemplate",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"label":"freeformTemplate",\n\t\t"navigationTemplates": "singlePage tab",\n\t\t"description": "freeformTemplateDesc"\n\t},\n\t{\n\t\t"name":"Template1",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template23",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template2",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template3",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template4",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template5",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template6",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template7",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template8",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template9",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template10",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template11",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template12",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template13",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template22",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template14",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template15",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template16",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template17",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template18",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template19",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template20",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Template21",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "singlePage tab"\n\t},\n\t{\n\t\t"name":"Infographics1",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics2",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics3",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics4",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics5",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics6",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics7",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics8",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics9",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t},\n\t{\n\t\t"name":"Infographics10",\n\t\t"path": "dashboard-core/js/dashboard/layout/templates",\n\t\t"navigationTemplates": "infographics"\n\t}\n]}\n'})),define("dashboard-core/js/dashboard/TemplateLayoutGenerator",["text!./layout/templates/listing.json","../app/nls/StringResources"],(function(t,e){return function(){function a(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,a),this._templates=[],this.stringResources=n.stringResources||e,this._dashboardTemplatesApi=n.dashboardTemplatesApi,this._processTemplates(t,n.excludeTemplates),this._addCustomTemplates(n.customTemplates)}return a.prototype.initialize=function(){var t=this;return this._generateTemplates().then((function(e){return t._loadedTemplates=e}))},a.prototype.getTemplates=function(t){return this._loadedTemplates.filter((function(e){return-1!==e.navTemplates.indexOf(t)}))},a.prototype.customTemplateDelete=function(t){this._loadedTemplates=this._loadedTemplates.filter((function(e){return e.templateId!==t}))},a.prototype.getSelectedLayoutSpec=function(t){var e=this._loadedTemplates.find((function(e){return e.templateId===t}));return e&&e.layoutSpec?Promise.resolve(e.layoutSpec):Promise.reject(new Error(this.stringResources.get("errorLoadingLayoutFile")))},a.prototype._addCustomTemplates=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){t._templates.push({label:e.defaultName,ariaLabel:e.defaultName,navigationTemplates:"custom",location:e.location,name:e.id})}))},a.prototype._processTemplates=function(t,e){var a=("string"==typeof t?JSON.parse(t):t).templates;e&&(a=a.filter((function(t){return!(-1!==e.indexOf(t.name))})));for(var n=0;n<a.length;n++){var o=a[n];o.label&&(o.label=this.stringResources.get(o.label)),o.name&&(o.ariaLabel=this.stringResources.get(o.name)),o.description&&(o.description=this.stringResources.get(o.description)),this._templates.push(o)}},a.prototype._generateTemplates=function(){for(var t=[],e=0;e<this._templates.length;e++)-1!==this._templates[e].navigationTemplates.indexOf("custom")?t.push(this._generateCustomTemplate(this._templates[e])):t.push(this._generateRegularTemplate(this._templates[e]));return Promise.all(t)},a.prototype._generateCustomTemplate=function(t){var e=this,a=["write","execute"];return this._dashboardTemplatesApi.getThumbnail(t.name).then((function(n){return e._dashboardTemplatesApi.getTemplate(t.name).then((function(e){var o=(e.permissions||[]).filter((function(t){return-1!==a.indexOf(t)})).length;return{templateId:t.name,ariaLabel:t.ariaLabel,navTemplates:t.navigationTemplates,layoutSpec:{thumbnail:n,layout:t,contextMenuEnabled:o,template:e}}}))}))},a.prototype._generateRegularTemplate=function(t){return this._getLayoutSpec(t).then((function(e){var a=e.layout;return{templateId:t.name,ariaLabel:t.ariaLabel,navTemplates:t.navigationTemplates,layoutSpec:{layout:a}}}))},a.prototype._getLayoutSpec=function(t){return-1!==t.navigationTemplates.indexOf("custom")?Promise.resolve({layout:t}):new Promise((function(e,a){try{var n="text!"+t.path+"/"+t.name+".json";require([n],(function(t){var a="string"==typeof t?JSON.parse(t):t;e({layout:a})}))}catch(t){a(t)}}))},a}()})),define("dashboard-core/js/dashboard/glass/CreateAuthoredView",["./BaseView","react","react-dom","../../app/nls/StringResources","underscore","../layouts/TabLayout","../layouts/CustomLayout","../layouts/InfographicsLayout","../layouts/SinglePageLayout","../views/NavigationPickerTabs","../../lib/@waca/core-client/js/core-client/utils/UniqueId","./util/InstrumentationUtil","../../features/dashboard/dashboardTemplates/api/impl/DashboardTemplatesImpl","../TemplateLayoutGenerator","../../lib/@waca/dashboard-common/dist/ui/dialogs/MessageDialog","../../app/util/DeepClone"],(function(t,e,a,n,o,s,r,i,l,p,c,u,d,h,m){var g=t.extend({boardName:"",events:{"input .editNameInput":"onBoardNameChange"},$navPicker:null,_navigationLayouts:{tab:s,infographics:i,singlePage:l,custom:r},init:function(t,e){this.sources=t.sources,this.ui_appbar=!1!==t.ui_appbar,this.containerAppOptions=t.containerAppOptions,this._appView=e,this._templateTitle=t.templateTitle,this._templateSubTitle=t.templateSubTitle,g.inherited("init",this,arguments);var a=new d({getContentSvc:this.glassContext.getSvc(".Content"),logger:this.glassContext.getSvc(".Logger"),featureChecker:this.glassContext.getCoreSvc(".FeatureChecker")});this.dashboardTemplates=a.getAPI(),this.boardName=n.get("defaultName")},_updateOptions:function(){this._appView&&this._appView.content&&(this.sources=this._appView.content.sources,this.ui_appbar=!1!==this._appView.content.ui_appbar,this.containerAppOptions=this._appView.content.containerAppOptions)},render:function(){var t=this;return this.dashboardTemplates.listTemplates().then((function(e){return t._customTemplates=e,t._render()}))},_getNavPickerOptions:function(){var t=this,e=[],a=this.glassContext.getCoreSvc(".Logger"),o={dataId:"tab",label:n.get("createAvTabLabel")},s={dataId:"infographics",label:n.get("createAvInfographicsLabel")},r={dataId:"singlePage",label:n.get("createAvSinglepageLabel")},i={tab:o,infographic:s,singlePage:r},l=[];return this.glassContext.appController.findCollection("com.ibm.bi.dashboard.templates").then((function(p){return Array.isArray(p)&&p.length>0?p.forEach((function(t){i[t.dataId]?(l.push(i[t.dataId]),Array.isArray(t.excludedTemplates)&&(e=e.concat(t.excludedTemplates))):a.error("Unknown template provided in collections")})):l.push(o,s,r),t._customTemplates&&t._customTemplates.length&&l.push({dataId:"custom",label:n.get("createAvCustomLabel")}),{navModels:l,excludeTemplates:e}}))},_render:function(){var t=this;return this.$el.empty(),this.createBoardView=document.createElement("div"),this.createBoardView.className="createBoardView",this.$el.append(this.createBoardView),this._handleAppAndNavBarVisiblity(),this._getNavPickerOptions().then((function(e){return t._templateLayoutGenerator=new h({dashboardTemplatesApi:t.dashboardTemplates,customTemplates:t._customTemplates,excludeTemplates:e.excludeTemplates}),t._templateLayoutGenerator.initialize().then((function(){return t._navModels=e.navModels.map((function(e){return _extends({},e,{templates:t._templateLayoutGenerator.getTemplates(e.dataId)})})),t._renderTabs()}))}))},_renderTabs:function(){var t=this;return new Promise((function(n){a.render(e.createElement(p,{navModels:t._navModels,templateLayoutGenerator:t._templateLayoutGenerator,action:function(e,a){return t._createAuthoredView(e,a)},showContextMenu:function(e,a,n){return t._showContextMenu(e,a,n)},defaultNavigation:"tab",onCancel:function(){return t.onCancelClick()},glassContext:t.glassContext,displayError:function(e){return t._displayErrorMessage(e)},title:t._templateTitle,subTitle:t._templateSubTitle}),t.createBoardView,n)}))},_showContextMenu:function(t,e,a){this.glassContext.appController.showContextMenu({position:{pageX:e,pageY:a},menuId:"com.ibm.bi.dashboard.templateMenu",activeObject:{oListControl:{contentView:{isEnabledAction:function(){return!0}},getSelectedRows:function(){return[t]},removeSelectedRows:function(){}},aSelectedContext:[t]},options:[{id:t.name}]})},_handleAppAndNavBarVisiblity:function(){this.containerAppOptions&&(this.glassContext.appController.currentAppView.$(".navbar").css("display","none"),this.glassContext.appController.currentAppView.$(".appbar").css("display","none"))},remove:function(){this.createBoardView&&a.unmountComponentAtNode(this.createBoardView),g.inherited("remove",this,arguments)},getUrl:function(){return null},getIcon:function(){return"common-dashboard_24"},getIconColor:function(){return"purple"},getTitle:function(){return n.get("createDashboardTitle")},onBoardNameChange:function(){this.setBoardName(this.$(".editNameInput").val())},getBoardName:function(){return this.boardName},setBoardName:function(t){this.boardName=t,this.boardName?this.$(".okButton").prop("disabled",!1):this.$(".okButton").prop("disabled",!0)},changeBoardName:function(){},onCancelClick:function(){this._updateOptions(),this.containerAppOptions&&this.containerAppOptions.callbacks&&this.containerAppOptions.callbacks.reject("CREATE_CANCELLED"),this.close()},_createAuthoredView:function(t,e){var a=this;if(u.track(this.glassContext,"created",{objectType:"dashboard",sources:this.sources,type:"Created Object"}),this._selectedNavTemplate=this._navigationLayouts[e],"custom"===e)return this.dashboardTemplates.getTemplate(t.name,!0).then((function(t){return a._createBoard(Object.assign(t.specification,{name:a.boardName}))}));var n=this._createNavTemplate(t),o=this._createBoardSpec(n);return this._createBoard(o)},_createNavTemplate:function(t){var e=o.deepClone(this._selectedNavTemplate);if(e.layout.items){var a=e.layout,n=[];o.each(a.items,(function(e){var a=o.deepClone(t);a.title=e.title,a.data=e.data,n.push(a)})),a.items=n}else{var s=e.layout.pageSize,r=e.layout.layoutPositioning,i=e.layout.showGrid,l=e.layout.snapGrid,p=e.layout.snapObjects;e.layout=o.deepClone(t),s&&(e.layout.pageSize=o.deepClone(s)),r&&(e.layout.layoutPositioning=o.deepClone(r)),e.layout.showGrid=!0===i,e.layout.snapGrid=!0===l,e.layout.snapObjects=!0===p}return e},_createBoardSpec:function(t){return{name:this.boardName,layout:t.layout,theme:"carbonGrey10"}},_createBoard:function(t){return t._meta={bundleID:null},this._openBoard(t)},_openBoard:function(t){var e=this,a=t._meta.bundleID;return this._updateOptions(),this.glassContext.appController.openAppView(this._getDashboardPerspectiveName(),{content:{id:c.get("dashboard_"),boardId:a,boardSpec:t,isAuthoringMode:!0,ui_appbar:this.ui_appbar,containerAppOptions:this.containerAppOptions,sources:this.sources}}).then((function(t){return t.onViewRendered()})).then((function(t){t.currentContentView.openDatasetpane(),e.glassContext.appController.closeAppView("createBoard")}))},_getDashboardPerspectiveName:function(){return"dashboard"},close:function(){this.glassContext.appController.closeAppView("createBoard")},_displayErrorMessage:function(t){new m({title:n.get("errorMessageTitle"),message:t.toString()}).render()},setFocus:function(){}});return g})),define("dashboard-core/js/features/dashboard/dashboardTemplates/DashboardTemplates",["./api/impl/DashboardTemplatesImpl"],(function(t){return function(){function e(a){var n=a.features;_classCallCheck(this,e),this._dashboardApi=n.API,this._api=new t({feature:this,logger:this._dashboardApi.getGlassSvc(".Logger"),getContentSvc:this._dashboardApi.getGlassSvc(".Content"),featureChecker:this._dashboardApi.getGlassCoreSvc(".FeatureChecker")})}return e.prototype.getAPI=function(){return this._api.getAPI()},e.prototype.destroy=function(){this._api=null},e}()})),define("dashboard-core/js/createBoardBundle",(function(){}));