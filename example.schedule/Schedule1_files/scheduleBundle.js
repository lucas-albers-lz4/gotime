/**
 * IBM Confidential OCO Source Materials IBM Business Platform: CA Share
 * (C) Copyright IBM Corp. 2017, 2018
 *
 * The source code for this program is not published or otherwise divested of
 * its trade secrets, irrespective of what has been deposited with the U.S.
 * Copyright Office
 */

define("bi/schedule/app/appControler",["bi/sharecommon/utils/translator"],function(e){var t={};return t.SUBSCRIPTION_SLIDEOUT_PANE_WIDTH="400px",t.createUserCredential=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.createUserCredential(e,t).then(function(){i()},function(e){s(e)})})})},t.getUserCredential=function(e){return new Promise(function(t,i){require(["bi/schedule/service/service"],function(s){s.getUserCredential(e).then(function(){t()},function(){i()})})})},t.createSchedule=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.createOrUpdateSchedule(e,t).then(i).fail(s)})})},t.updateSchedule=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.createOrUpdateSchedule(e,t).then(i).fail(function(e){s()})})})},t.deleteSchedule=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.deleteSchedule(e,t).then(function(e){i()}).fail(function(e){s()})})})},t.getSchedule=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.getSchedule(e,t).then(i).fail(s)})})},t.getRawSchedule=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.readRawSchedule(e,t).then(function(e){return i(e)}).fail(function(e){return s(e)})})})},t.updateSaveToCloudOptions=function(e,i,s){return e&&i?new Promise(function(n,a){require(["bi/schedule/service/service"],function(l){t.getRawSchedule(e,s).then(function(e){return l.updateScheduleCloudOptions(e.data[0],i,s)}).then(function(e){return n(e)}).fail(function(e){return a(e)})})}):Promise.resolve()},t.getSingleSchedule=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(s){s.getSingleSchedule(e,t).then(i).fail(function(e){})})})},t.showSubscriptionPane=function(i,s,n,a){return new Promise(function(l,r){var o={module:"bi/schedule/views/SubscriptionView",glassContext:i,descriptor:s};void 0!==a&&(o.callback=a),i.appController.showSlideOut({position:"right",content:o,width:t.SUBSCRIPTION_SLIDEOUT_PANE_WIDTH,enableTabLooping:!0,label:e.translate("subscription_header_region"),launchPoint:n})})},t.showSubscriptionManagementPane=function(e){return new Promise(function(t,i){var s={id:"subscribe_mgmt",content:{}};e.appController.openAppView("subscribe_mgmt",s),t()})},t.createSubscription=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.createSubscription(e,t).then(function(e){i()}).fail(function(e){s()})})})},t.updateSubscription=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.updateSubscription(e,t).then(i).fail(function(e){s()})})})},t.getSubscriptions=function(e){return new Promise(function(t,i){require(["bi/schedule/service/service"],function(s){s.getSubscriptions(e).then(t).fail(i)})})},t.deleteSubscription=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.deleteSubscription(e,t).then(i).fail(s)})})},t.getSubscriptionDetails=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.getSubscriptionDetails(e,t).then(i).fail(s)})})},t.getSubscriptionRunHistory=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.getObjectProperties(e,t).then(i).fail(s)})})},t.showVersionsPane=function(t,i,s){var n={module:"bi/content_apps/VersionsView",glassContext:t,objectInformation:i.data[0]};t.appController.showSlideOut({position:"right",content:n,width:"350px",enableTabLooping:!0,label:e.translate("schedule_subscription_version_aria_label"),launchPoint:s})},t.getPrinters=function(e){return new Promise(function(t,i){require(["bi/schedule/service/service"],function(s){s.getPrinters(e).then(t).fail(i)})})},t.getArchiveLocations=function(e){return new Promise(function(t,i){require(["bi/schedule/service/service"],function(s){s.getArchiveLocations(e).then(t).fail(i)})})},t.getS3ConnectionDetails=function(e){return new Promise(function(t,i){require(["bi/schedule/service/service"],function(s){s.getS3ConnectionDetails(e).then(t).fail(i)})})},t.getS3LocationsDetails=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.getS3LocationsDetails(e,t).then(i).fail(s)})})},t.getS3LocationParentConnectionID=function(e,t){return new Promise(function(i,s){require(["bi/schedule/service/service"],function(n){n.getS3LocationParentConnectionID(e,t).then(i).fail(s)})})},t}),define("bi/sharecommon/utils/simpledoT",["doT"],function(e){var t=e;return t.NOT_REPLACED="__NOT_REPLACED__",t.options={verbose:!1},t.simpleTemplate=function(i){var s=i;return t.options.verbose&&(s=i.replace(/\{\{(=[\s\S]+?(\}?)+)\}\}/g,"{{$1 || '"+t.NOT_REPLACED+"($1)'}}")),e.template(s)},t}),define("text!bi/schedule/templates/ScheduleView.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n *\n * IBM Cognos Products: SHARE\n *\n * (C) Copyright IBM Corp. 2015, 2017\n *\n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n<div>\n    <div class="schedule_section schedule_type_section">\n        <div class="schedule_input_section schedule_type_input_selector" id="schedule_type_selector_container_{{=it.uniqueid}}"></div>\n    </div>\n\n\n    <div class="schedule_section schedule_period_section">\n        <div class="schedule_datetime_range_picker"></div>\n        <div class="invalid_input_warning_message"></div>\n        <div class="schedule_cadence_picker"></div>\n    </div>\n\n\n	<div class="schedule_section schedule_options_section">\n\n		{{? it.showOptions}}\n\n        <!-- Output Format -->\n	    <div class="schedule_input_section options_picker schedule_input_section_first_option schedule_output_format_picker">\n	        <div class="schedule_form_label format_label">\n	            <label id=\'schedule_output_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_output_label}}</label>\n	        </div>\n	        <div class="schedule_form_input schedule_format_icon_list">\n	            <div class="output_format_list clearfix"></div>\n	            <button class="btn btn-link rightArrow output_format_toggler" aria-label="{{=it.schedule_output_label}}"\n                 aria-haspopup="true"></button>\n	        </div>\n	    </div>\n\n        <!-- Delivery Options -->\n	   	<div class="schedule_input_section options_picker schedule_delivery_picker">\n	   		<div class="delivery_picker">\n				<div class="schedule_form_label delivery_label">\n					<label id=\'schedule_delivery_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_label}}</label>\n				</div>\n				<div class="schedule_form_input">\n					<div class="delivery_list clearfix"></div>\n                    <button class="btn btn-link rightArrow delivery_toggler" aria-label="{{=it.schedule_delivery_label}}"\n                    aria-haspopup="true"></button>\n				</div>\n			</div>\n	   	</div>\n\n		{{? it.canShowPrompt}}\n	        <!-- Report Prompts -->\n	        <div class="schedule_input_section">\n	            <div class="schedule_form_label">\n	                <label id=\'prompt_label{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_prompts_label}}</label>\n	            </div>\n	            <div class="schedule_form_input clickable prompt_picker_target">\n	                <div id="prompt_value{{=it.uniqueid}}" class="schedule_form_value currentPromptValues"></div>\n	                <button class="btn btn-link rightArrow output_prompt_toggler" aria-label="{{=it.schedule_prompts_label}}"\n	                 aria-haspopup="true"></button>\n	            </div>\n	        </div>\n	     {{?}}\n\n        <!-- Language Selection -->\n	    <div class="schedule_input_section options_picker schedule_language_picker">\n	    	<div class="schedule_form_label">\n				<label class="schedule_label">{{=it.schedule_languages_label}}</label>\n			</div>\n\n			<div class="schedule_form_input schedule_format_icon_list">\n	            <div class="output_language_list clearfix"></div>\n                <button class="btn btn-link rightArrow schedule_language_option_toggler" aria-label="{{=it.schedule_languages_label}}"\n                 aria-haspopup="true"></button>\n	        </div>\n	    </div>\n\n        <!-- PDF Options -->\n        {{? it.showPDFOption}}\n        <div class="schedule_input_section options_picker schedule_pdf_options_picker" role="button" aria-label="{{=it.schedule_select_text}}"\n                 aria-haspopup="true">\n            <div class="schedule_form_label">\n                <label class="schedule_label">{{=it.schedule_pdf_options_label}}</label>\n            </div>\n            <div class="schedule_form_input">\n                <div class="schedule_select_toggler_label">{{=it.schedule_select_text}}</div>\n            </div>\n        </div>\n        {{?}}\n\n        {{? it.canBurst}}\n        <div class="schedule_input_section">\n            <div class="schedule_burst_option_container"></div>\n        </div>\n        {{?}}\n\n		{{?}}\n\n        {{? it.canShowClassic}}\n          <div style="padding-bottom: 10px;">\n            <a class="classicViewLink">{{=it.schedule_classic_view_label}}</a>\n          </div>\n        {{?}}\n        <div class="new_schedule_panel_footer clearfix">\n            <div class="pull-right" role="region" aria-label="{{=it.schedule_controls_description}}">\n                <button class="new_schedule_panel_button schedule_primary_button">{{=it.schedule_create_btn}}</button>\n                <button class="new_schedule_panel_button schedule_secondary_button">{{=it.schedule_cancel_btn}}</button>\n            </div>\n        </div>\n    </div>\n    <div class="progress-overlay"></div>\n</div>\n'}),define("bi/schedule/views/CadencePickerView",["bi/commons/ui/View","jquery"],function(e,t){"use strict";var i=e.extend({everyNperiods:1,init:function(i){t.extend(this,i),e.inherited("init",this,[i])},render:function(){var e=t.Deferred();return e.resolve(this),e.promise()},toDescriptor:function(e){return e},validate:function(e){return e}});return i}),define("text!bi/schedule/templates/DateTimeRangeCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n    <div class="schedule_input_section schedule_input_section_first_option">\n        <div class="schedule_date_section_start">\n	        <div class="schedule_date_time_range_form_label">\n	            <label class="schedule_date schedule_label">{{=it.schedule_datepicker_start}}</label>\n	        </div>\n	        <!-- Date start -->\n	        <div class="schedule_date_range_input">\n	            <div class="schedule_start_container schedule_period_start"></div>\n	        </div>\n	        <!-- Time start -->\n            <div class="schedule_time_range_input">\n                <div class="schedule_start_container schedule_time_start"></div>\n            </div>\n        </div>\n        <div class="schedule_date_section_end">\n            <div class="schedule_date_time_range_form_label">\n                <label class="schedule_date schedule_label">{{=it.schedule_datepicker_end}}</label>\n            </div>\n            <!-- Date end -->\n            <div class="schedule_date_range_input">\n                <div class="schedule_end_container schedule_period_end"></div>\n            </div>\n            <!-- Time end -->\n            <div class="schedule_time_range_input">\n                <div class="schedule_end_container schedule_time_end"></div>\n            </div>\n        </div>\n        <div class="no_endDate_checkbox"></div>\n    </div>\n'}),define("text!bi/schedule/templates/TimePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n *\n * IBM Cognos Products: SHARE\n *\n * (C) Copyright IBM Corp. 2015, 2016\n *\n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n{{? it.labelText}}\n<div class="bi_timepicker_label">\n    <label class=\'bi_timepicker_label\'>{{=it.labelText}}</label>\n</div>\n{{?}}\n<div class=\'bi_timepicker_div bootstrap-timepicker timepicker\'>\n    <span class=\'timepicker_icon svg_icon\' data-icon="clock-time"></span>\n    <input id=\'bi_timepicker_{{=it.tpId}}\' class="bi_timepicker" aria-label="{{=it.ariaLabel}}" aria-describedby="input_instructions_{{=it.tpId}}"/>\n    <span id="input_instructions_{{=it.tpId}}" class="sr-only">{{=it.inputInstructions}}</span>\n</div>\n'}),function(e,t,i){"use strict";var s=function(t,i){this.widget="",this.$element=e(t),this.defaultTime=i.defaultTime,this.disableFocus=i.disableFocus,this.disableMousewheel=i.disableMousewheel,this.isOpen=i.isOpen,this.minuteStep=i.minuteStep,this.modalBackdrop=i.modalBackdrop,this.orientation=i.orientation,this.secondStep=i.secondStep,this.snapToStep=i.snapToStep,this.showInputs=i.showInputs,this.showMeridian=i.showMeridian,this.showSeconds=i.showSeconds,this.template=i.template,this.appendWidgetTo=i.appendWidgetTo,this.showWidgetOnAddonClick=i.showWidgetOnAddonClick,this.maxHours=i.maxHours,this.explicitMode=i.explicitMode,this.handleDocumentClick=function(e){var t=e.data.scope;t.$element.parent().find(e.target).length||t.$widget.is(e.target)||t.$widget.find(e.target).length||t.hideWidget()},this._init()};s.prototype={constructor:s,_init:function(){var t=this;this.showWidgetOnAddonClick&&this.$element.parent().hasClass("input-group")&&this.$element.parent().hasClass("bootstrap-timepicker")?(this.$element.parent(".input-group.bootstrap-timepicker").find(".input-group-addon").on({"click.timepicker":e.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":e.proxy(this.highlightUnit,this),"click.timepicker":e.proxy(this.highlightUnit,this),"keydown.timepicker":e.proxy(this.elementKeydown,this),"blur.timepicker":e.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":e.proxy(this.mousewheel,this)})):this.template?this.$element.on({"focus.timepicker":e.proxy(this.showWidget,this),"click.timepicker":e.proxy(this.showWidget,this),"blur.timepicker":e.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":e.proxy(this.mousewheel,this)}):this.$element.on({"focus.timepicker":e.proxy(this.highlightUnit,this),"click.timepicker":e.proxy(this.highlightUnit,this),"keydown.timepicker":e.proxy(this.elementKeydown,this),"blur.timepicker":e.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":e.proxy(this.mousewheel,this)}),this.template!==!1?this.$widget=e(this.getTemplate()).on("click",e.proxy(this.widgetClick,this)):this.$widget=!1,this.showInputs&&this.$widget!==!1&&this.$widget.find("input").each(function(){e(this).on({"click.timepicker":function(){e(this).select()},"keydown.timepicker":e.proxy(t.widgetKeydown,t),"keyup.timepicker":e.proxy(t.widgetKeyup,t)})}),this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null,this.updateFromElementVal()},clear:function(){this.hour="",this.minute="",this.second="",this.meridian="",this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else this.hour<=0?this.hour=this.maxHours-1:this.hour--},decrementMinute:function(e){var t;t=e?this.minute-e:this.minute-this.minuteStep,0>t?(this.decrementHour(),this.minute=t+60):this.minute=t},decrementSecond:function(){var e=this.second-this.secondStep;0>e?(this.decrementMinute(!0),this.second=e+60):this.second=e},elementKeydown:function(e){switch(e.which){case 9:if(e.shiftKey){if("hour"===this.highlightedUnit)break;this.highlightPrevUnit()}else{if(this.showMeridian&&"meridian"===this.highlightedUnit||this.showSeconds&&"second"===this.highlightedUnit||!this.showMeridian&&!this.showSeconds&&"minute"===this.highlightedUnit)break;this.highlightNextUnit()}e.preventDefault(),this.updateFromElementVal();break;case 27:this.updateFromElementVal();break;case 37:e.preventDefault(),this.highlightPrevUnit(),this.updateFromElementVal();break;case 38:switch(e.preventDefault(),this.highlightedUnit){case"hour":this.incrementHour(),this.highlightHour();break;case"minute":this.incrementMinute(),this.highlightMinute();break;case"second":this.incrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:e.preventDefault(),this.highlightNextUnit(),this.updateFromElementVal();break;case 40:switch(e.preventDefault(),this.highlightedUnit){case"hour":this.decrementHour(),this.highlightHour();break;case"minute":this.decrementMinute(),this.highlightMinute();break;case"second":this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update()}},getCursorPosition:function(){var e=this.$element.get(0);if("selectionStart"in e)return e.selectionStart;if(i.selection){e.focus();var t=i.selection.createRange(),s=i.selection.createRange().text.length;return t.moveStart("character",-e.value.length),t.text.length-s}},getTemplate:function(){var e,t,i,s,n,a;switch(this.showInputs?(t='<input type="text" class="bootstrap-timepicker-hour" maxlength="2"/>',i='<input type="text" class="bootstrap-timepicker-minute" maxlength="2"/>',s='<input type="text" class="bootstrap-timepicker-second" maxlength="2"/>',n='<input type="text" class="bootstrap-timepicker-meridian" maxlength="2"/>'):(t='<span class="bootstrap-timepicker-hour"></span>',i='<span class="bootstrap-timepicker-minute"></span>',s='<span class="bootstrap-timepicker-second"></span>',n='<span class="bootstrap-timepicker-meridian"></span>'),a='<table><tr><td><a href="#" data-action="incrementHour"><span class="glyphicon glyphicon-chevron-up"></span></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><span class="glyphicon glyphicon-chevron-up"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><span class="glyphicon glyphicon-chevron-up"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><span class="glyphicon glyphicon-chevron-up"></span></a></td>':"")+"</tr><tr><td>"+t+'</td> <td class="separator">:</td><td>'+i+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+s+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+n+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><span class="glyphicon glyphicon-chevron-down"></span></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><span class="glyphicon glyphicon-chevron-down"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><span class="glyphicon glyphicon-chevron-down"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><span class="glyphicon glyphicon-chevron-down"></span></a></td>':"")+"</tr></table>",this.template){case"modal":e='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×</a><h3>Pick a Time</h3></div><div class="modal-content">'+a+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":e='<div class="bootstrap-timepicker-widget dropdown-menu">'+a+"</div>"}return e},getTime:function(){return""===this.hour?"":this.hour+":"+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){this.isOpen!==!1&&(this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("open"),e(i).off("mousedown.timepicker, touchend.timepicker",this.handleDocumentClick),this.isOpen=!1,this.$widget.detach())},highlightUnit:function(){this.position=this.getCursorPosition(),this.position>=0&&this.position<=2?this.highlightHour():this.position>=3&&this.position<=5?this.highlightMinute():this.position>=6&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():this.position>=9&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="hour",e.setSelectionRange&&setTimeout(function(){t.hour<10?e.setSelectionRange(0,1):e.setSelectionRange(0,2)},0)},highlightMinute:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="minute",e.setSelectionRange&&setTimeout(function(){t.hour<10?e.setSelectionRange(2,4):e.setSelectionRange(3,5)},0)},highlightSecond:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="second",e.setSelectionRange&&setTimeout(function(){t.hour<10?e.setSelectionRange(5,7):e.setSelectionRange(6,8)},0)},highlightMeridian:function(){var e=this.$element.get(0),t=this;this.highlightedUnit="meridian",e.setSelectionRange&&(this.showSeconds?setTimeout(function(){t.hour<10?e.setSelectionRange(8,10):e.setSelectionRange(9,11)},0):setTimeout(function(){t.hour<10?e.setSelectionRange(5,7):e.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}return this.hour===this.maxHours-1?void(this.hour=0):void this.hour++},incrementMinute:function(e){var t;t=e?this.minute+e:this.minute+this.minuteStep-this.minute%this.minuteStep,t>59?(this.incrementHour(),this.minute=t-60):this.minute=t},incrementSecond:function(){var e=this.second+this.secondStep-this.second%this.secondStep;e>59?(this.incrementMinute(!0),this.second=e-60):this.second=e},mousewheel:function(t){if(!this.disableMousewheel){t.preventDefault(),t.stopPropagation();var i=t.originalEvent.wheelDelta||-t.originalEvent.detail,s=null;switch("mousewheel"===t.type?s=-1*t.originalEvent.wheelDelta:"DOMMouseScroll"===t.type&&(s=40*t.originalEvent.detail),s&&(t.preventDefault(),e(this).scrollTop(s+e(this).scrollTop())),this.highlightedUnit){case"minute":i>0?this.incrementMinute():this.decrementMinute(),this.highlightMinute();break;case"second":i>0?this.incrementSecond():this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian();break;default:i>0?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},changeToNearestStep:function(e,t){return e%t===0?e:Math.round(e%t/t)?(e+(t-e%t))%60:e-e%t},place:function(){if(!this.isInline){var i=this.$widget.outerWidth(),s=this.$widget.outerHeight(),n=10,a=e(t).width(),l=e(t).height(),r=e(t).scrollTop(),o=parseInt(this.$element.parents().filter(function(){return"auto"!==e(this).css("z-index")}).first().css("z-index"),10)+10,d=this.component?this.component.parent().offset():this.$element.offset(),c=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),h=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1),u=d.left,_=d.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left"),"auto"!==this.orientation.x?(this.picker.addClass("datepicker-orient-"+this.orientation.x),"right"===this.orientation.x&&(u-=i-h)):(this.$widget.addClass("timepicker-orient-left"),d.left<0?u-=d.left-n:d.left+i>a&&(u=a-i-n));var p,m,v=this.orientation.y;"auto"===v&&(p=-r+d.top-s,m=r+l-(d.top+c+s),v=Math.max(p,m)===m?"top":"bottom"),this.$widget.addClass("timepicker-orient-"+v),"top"===v?_+=c:_-=s+parseInt(this.$widget.css("padding-top"),10),this.$widget.css({top:_,left:u,zIndex:o})}},remove:function(){e("document").off(".timepicker"),this.$widget&&this.$widget.remove(),delete this.$element.data().timepicker},setDefaultTime:function(e){if(this.$element.val())this.updateFromElementVal();else if("current"===e){var t=new Date,i=t.getHours(),s=t.getMinutes(),n=t.getSeconds(),a="AM";0!==n&&(n=Math.ceil(t.getSeconds()/this.secondStep)*this.secondStep,60===n&&(s+=1,n=0)),0!==s&&(s=Math.ceil(t.getMinutes()/this.minuteStep)*this.minuteStep,60===s&&(i+=1,s=0)),this.showMeridian&&(0===i?i=12:i>=12?(i>12&&(i-=12),a="PM"):a="AM"),this.hour=i,this.minute=s,this.second=n,this.meridian=a,this.update()}else e===!1?(this.hour=0,this.minute=0,this.second=0,this.meridian="AM"):this.setTime(e)},setTime:function(e,t){if(!e)return void this.clear();var i,s,n,a,l,r;if("object"==typeof e&&e.getMonth)n=e.getHours(),a=e.getMinutes(),l=e.getSeconds(),this.showMeridian&&(r="AM",n>12&&(r="PM",n%=12),12===n&&(r="PM"));else{if(i=(/a/i.test(e)?1:0)+(/p/i.test(e)?2:0),i>2)return void this.clear();if(s=e.replace(/[^0-9\:]/g,"").split(":"),n=s[0]?s[0].toString():s.toString(),this.explicitMode&&n.length>2&&n.length%2!==0)return void this.clear();a=s[1]?s[1].toString():"",l=s[2]?s[2].toString():"",n.length>4&&(l=n.slice(-2),n=n.slice(0,-2)),n.length>2&&(a=n.slice(-2),n=n.slice(0,-2)),a.length>2&&(l=a.slice(-2),a=a.slice(0,-2)),n=parseInt(n,10),a=parseInt(a,10),l=parseInt(l,10),isNaN(n)&&(n=0),isNaN(a)&&(a=0),isNaN(l)&&(l=0),l>59&&(l=59),a>59&&(a=59),n>=this.maxHours&&(n=this.maxHours-1),this.showMeridian?(n>12&&(i=2,n-=12),i||(i=1),0===n&&(n=12),r=1===i?"AM":"PM"):12>n&&2===i?n+=12:n>=this.maxHours?n=this.maxHours-1:0>n&&(n=0)}this.hour=n,this.snapToStep?(this.minute=this.changeToNearestStep(a,this.minuteStep),this.second=this.changeToNearestStep(l,this.secondStep)):(this.minute=a,this.second=l),this.meridian=r,this.update(t)},showWidget:function(){this.isOpen||this.$element.is(":disabled")||(this.$widget.appendTo(this.appendWidgetTo),e(i).on("mousedown.timepicker, touchend.timepicker",{scope:this},this.handleDocumentClick),this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.place(),this.disableFocus&&this.$element.blur(),""===this.hour&&(this.defaultTime?this.setDefaultTime(this.defaultTime):this.setTime("0:0:0")),"modal"===this.template&&this.$widget.modal?this.$widget.modal("show").on("hidden",e.proxy(this.hideWidget,this)):this.isOpen===!1&&this.$widget.addClass("open"),this.isOpen=!0)},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM"},update:function(e){this.updateElement(),e||this.updateWidget(),this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(this.$widget!==!1){var e=this.hour,t=1===this.minute.toString().length?"0"+this.minute:this.minute,i=1===this.second.toString().length?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(e),this.$widget.find("input.bootstrap-timepicker-minute").val(t),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(i),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(e),this.$widget.find("span.bootstrap-timepicker-minute").text(t),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(i),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(this.$widget!==!1){var e=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(e,!0)}},widgetClick:function(t){t.stopPropagation(),t.preventDefault();var i=e(t.target),s=i.closest("a").data("action");s&&this[s](),this.update(),i.is("input")&&i.get(0).setSelectionRange(0,2)},widgetKeydown:function(t){var i=e(t.target),s=i.attr("class").replace("bootstrap-timepicker-","");switch(t.which){case 9:if(t.shiftKey){if("hour"===s)return this.hideWidget()}else if(this.showMeridian&&"meridian"===s||this.showSeconds&&"second"===s||!this.showMeridian&&!this.showSeconds&&"minute"===s)return this.hideWidget();break;case 27:this.hideWidget();break;case 38:switch(t.preventDefault(),s){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),i.get(0).setSelectionRange(0,2);break;case 40:switch(t.preventDefault(),s){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),i.get(0).setSelectionRange(0,2)}},widgetKeyup:function(e){(65===e.which||77===e.which||80===e.which||46===e.which||8===e.which||e.which>=48&&e.which<=57||e.which>=96&&e.which<=105)&&this.updateFromWidgetInputs()}},e.fn.timepicker=function(t){var i=Array.apply(null,arguments);return i.shift(),this.each(function(){var n=e(this),a=n.data("timepicker"),l="object"==typeof t&&t;a||n.data("timepicker",a=new s(this,e.extend({},e.fn.timepicker.defaults,l,e(this).data()))),"string"==typeof t&&a[t].apply(a,i)})},e.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",y:"auto"},secondStep:15,snapToStep:!1,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:!0,maxHours:24,explicitMode:!1},e.fn.timepicker.Constructor=s,e(i).on("focus.timepicker.data-api click.timepicker.data-api",'[data-provide="timepicker"]',function(t){var i=e(this);i.data("timepicker")||(t.preventDefault(),i.timepicker())})}(jQuery,window,document),define("datetimepicker",function(){}),define("bi/schedule/views/TimePicker",["jquery","lodash","bi/commons/ui/View","bi/commons/nls/StringResources","doT","bi/commons/utils/Utils","text!../templates/TimePicker.html","moment-timezone","datetimepicker"],function(e,t,i,s,n,a,l,r){"use strict";var o="H:mm",d="h:mm a",c=i.extend({init:function(i){c.inherited("init",this,arguments),this.labelText="",this.$timePicker=null,this.attributes={minuteStep:1,showMeridian:!0,defaultTime:"current"},e.extend(this,i),this.timezone||(console.error("Timepicker must be initialized with a timezone. Defaulting to America/New York"),this.timezone="America/New_York"),
this.format?this.format!==d&&this.format!==o&&console.warn("TimePicker created with non-standard time format (not 12hr 'h:mm a' or 24hr 'H:mm')"):this.format=this.attributes.showMeridian===!1?o:d,this.ariaLabel&&"string"==typeof this.ariaLabel||(this.ariaLabel=s.get("bs_timepicker_input_description")),this.tpId=t.uniqueId(),this.isiPad=null!==navigator.userAgent.match(/iPad/i)},render:function(){var e=n.template(l);this.$el.html(e({tpId:this.tpId,labelText:this.labelText,ariaLabel:this.ariaLabel,inputInstructions:s.get("bs_timepicker_input_describedby")})),this.$timePicker=this.$el.find("#bi_timepicker_"+this.tpId),this._showTimePicker(),this._setSvg(),this._makeAccessible(),this._place()},setTabIndex:function(e){this.$timePicker.attr("tabindex",e)},setTime:function(e){this.$timePicker.timepicker("setTime",e)},setTime24H:function(e){var t=r(e,"HH:mm:ss.SSSZ"),i=t.tz(this.timezone).format(this.format);this.$timePicker.timepicker("setTime",i)},getTime:function(){return this.$timePicker.val()},isValidTime:function(){return r.tz(this.getTime(),this.format,!0,this.timezone).isValid()},getDateTimeUTC:function(e){if(e){var t=r.tz(e,this.timezone).format("YYYY-MM-DD"),i=r.tz(this.getTime(),this.format,this.timezone).format("HH:mm:ss"),s=r.tz(t+"T"+i,"YYYY-MM-DDTHH:mm:ss",this.timezone).format();return s}return r.tz(this.getTime(),this.format,this.timezone).format()},setDateTimeUTC:function(e){var t=r.utc(e);t.tz(this.timezone);var i=t.format(this.format);this.$timePicker.timepicker("setTime",i)},getTime24H:function(){var e=r.tz(this.getTime(),this.format,this.timezone).format("HH:mm:ss.SSSZ");return e},getTime24HShort:function(){var e=r.tz(this.getTime(),this.format,this.timezone).format("HH:mm:ss");return e},_showTimePicker:function(){var t="current";t="current"!==this.attributes.defaultTime?r.tz(this.attributes.defaultTime,this.timezone).format(this.format):r().tz(this.timezone).format(this.format),this.setDiv?this.$timePicker.timepicker({minuteStep:this.attributes.minuteStep,secondStep:this.attributes.secondStep,showMeridian:this.attributes.showMeridian,showSeconds:this.attributes.showSeconds,defaultTime:t,appendWidgetTo:e(this.setDiv)}):this.$timePicker.timepicker({minuteStep:this.attributes.minuteStep,secondStep:this.attributes.secondStep,showMeridian:this.attributes.showMeridian,showSeconds:this.attributes.showSeconds,defaultTime:t})},_setSvg:function(){for(var t=this.$el.find(".svg_icon"),i=0;i<t.length;i++){var s=e(t[i]);a.setIcon(s,"common-"+s.data("icon"),s.data("icon"))}},_makeAccessible:function(){var t=function(e,t){return'<label for="'+e+'" class="sr-only">'+s.get(t)+"</label>"},i=function(e){return'<span class="sr-only">'+s.get(e)+"</span>"};this.$timePicker.on("keydown",function(e){var t=e.keyCode||e.charCode||e.which||0;switch(t){case 9:this.$timePicker.timepicker("hideWidget");break;case 17:this.isiPad&&this.$timePicker.timepicker("hideWidget")}}.bind(this)),this.$timePicker.on("focus",function(){this.$timePicker.timepicker("hideWidget")}.bind(this)),this.onChange&&this.$timePicker.timepicker().on("change",this.onChange);var n=!1;this.$timePicker.timepicker().on("show.timepicker",function(){if(!n){n=!0,e(".bootstrap-timepicker-widget").on("clicktap",function(e){e.preventDefault()});var a=e("div.bootstrap-timepicker-widget");a.attr("role","region").attr("aria-label",s.get("bs_timepicker_container")),a.find(".glyphicon-chevron-up").removeClass().addClass("timepicker_arrows arrow_up"),a.find(".glyphicon-chevron-down").removeClass().addClass("timepicker_arrows arrow_down");var l=a.find("table");l.attr("role","presentation");var r={hour:"bs_timepicker_hour_text",minute:"bs_timepicker_minute_text",meridian:"bs_timepicker_meridian_text"};for(var o in r){var d="timepicker_"+o+"_"+this.tpId;l.find(".bootstrap-timepicker-"+o).attr("id",d).before(t(d,r[o]))}l.find('a[data-action="incrementHour"]').append(i("bs_timepicker_increment_hour")),l.find('a[data-action="decrementHour"]').append(i("bs_timepicker_decrement_hour")),l.find('a[data-action="incrementMinute"]').append(i("bs_timepicker_increment_minute")),l.find('a[data-action="decrementMinute"]').append(i("bs_timepicker_decrememt_minute")),l.find('a[data-action="toggleMeridian"]').append(i("bs_timepicker_toggle_meridian"))}})},_place:function(){this.$timePicker.on("click.timepicker",function(){this.$timePicker.timepicker("showWidget");var t=e("div.bootstrap-timepicker-widget"),i=null;if(t.parents().each(function(){return"none"!==e(this).css("transform")?(i=e(this),!1):!0}),i&&i.length>0){var s=10,n=t[0].getBoundingClientRect(),a=this.$timePicker[0].getBoundingClientRect(),l=a.height,r=a.top,o=a.left,d=i.offset(),c=d.left,h=d.top,u=i.scrollLeft(),_=i.scrollTop(),p=o-(c-u);u>p?p=u+s:p>window.innerWidth-(c-u)-n.width&&(p=window.innerWidth-(c-u)-n.width-s);var m=0,v=window.innerHeight-r-l,b=r-h;m=Math.max(b,v)===v?r+l-(h-_):r-n.height-(h-_),t.css({top:m,left:p})}}.bind(this))}});return c}),define("bi/schedule/views/DateTimeRangeCadencePickerView",["bi/schedule/views/CadencePickerView","bi/sharecommon/utils/translator","bi/content_apps/utils/GlassContextHelper","moment-timezone","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/DateTimeRangeCadencePicker.html","lodash","bi/commons/ui/widgets/DatePicker","bi/schedule/views/TimePicker","bi/commons/ui/properties/CheckBox","bi/commons/utils/DateTimeUtils"],function(e,t,i,s,n,a,l,r,o,d,c){"use strict";var h=e.extend({init:function(e){h.inherited("init",this,arguments),l.assign(this,e),this.descriptor=this.objectInformation.descriptor,this.isEditMode="undefined"!=typeof this.descriptor,this.noEndDateCheckbox=null,this.uniqueId=l.uniqueId(),this.timezone=this.glassContext.services.userProfile.preferences.timeZoneID,this.locale=this._determineDateLocale(),this.logger=this.glassContext.getCoreSvc&&this.glassContext.getCoreSvc(".Logger")},_determineDateLocale:function(){var e=i.getUserPreference(this.glassContext,"productLocale"),t=i.getUserPreference(this.glassContext,"contentLocale");return e===t.substring(0,2)?t:e},_renderDateStartEndPeriod:function(e){var t=s.tz(this.timezone).startOf("day"),i=this.isEditMode?s.utc(this.descriptor.scheduleInfo.startDate).toDate():t.toDate();return this.startDate=new r({$el:this.$el.find(".schedule_period_start"),ariaLabelText:e.schedule_datepicker_start,timezone:this.timezone,locale:this.locale,logger:this.logger,attributes:{inputFieldDate:i}}),this.startDate.render().then(function(){var t=new Date(i);return t.setMonth(t.getMonth()+3),this.isEditMode&&"onDate"===this.descriptor.scheduleInfo.endType&&(t=s.utc(this.descriptor.scheduleInfo.endDate).toDate()),this.endDate=new r({$el:this.$el.find(".schedule_period_end"),ariaLabelText:e.schedule_datepicker_end,timezone:this.timezone,locale:this.locale,logger:this.logger,attributes:{defaultDate:"+3m",inputFieldDate:t}}),this.endDate.render()}.bind(this))},_renderNoEndDateCheckBox:function(){var e=!1;this.isEditMode&&this.descriptor.scheduleInfo&&this.descriptor.scheduleInfo.endType&&"onDate"!=this.descriptor.scheduleInfo.endType&&(this.$el.find(".schedule_date_section_end").hide(),e=!0),this.noEndDateCheckbox=new d({id:"schedule_noEndDate_checkbox_"+this.uniqueId,el:this.$el.find(".no_endDate_checkbox"),name:"schedule_DateTimeRange_noEndDate",label:t.translate("schedule_date_noEndDate"),ariaLabel:t.translate("schedule_date_noEndDate"),checked:e,controlOnLeft:!0,onChange:this._hideShowEndDate.bind(this)}),this.noEndDateCheckbox.doRender()},render:function(){var e=n.simpleTemplate(a),i={schedule_datepicker_label:t.translate("schedule_datepicker_label"),schedule_datepicker_start:t.translate("period_start_label"),schedule_datepicker_end:t.translate("period_end_label"),schedule_timepicker_label:t.translate("schedule_timepicker_label"),schedule_timepicker_start:t.translate("period_start_time_label"),schedule_timepicker_end:t.translate("period_end_time_label"),uniqueid:this.uniqueId};return this.$el.append(e(i)),new Promise(function(e,t){this._renderDateStartEndPeriod(i).then(function(){this._renderDateTimeRangeTimePickers(),this._renderNoEndDateCheckBox(),e(this)}.bind(this))}.bind(this))},toDescriptor:function(e){var t=this.startDate.getDateAsISOString(),i=s(t).toDate(),n=this.rangeStartTime.getDateTimeUTC(i),a=this.noEndDateCheckbox.isChecked()?"indefinite":"onDate",l="";if("onDate"===a){var r=this.endDate.getDateAsISOString(),o=s(r).toDate();l=this.rangeEndTime.getDateTimeUTC(o)}return e.startDate=n,e.endDate=l,e.endType=a,e},validate:function(e){var i={},s=this.noEndDateCheckbox.isChecked(),n=this.$el.find(".schedule_period_start"),a=this.$el.find(".schedule_period_end");n.removeAttr("aria-invalid aria-describedby"),a.removeAttr("aria-invalid aria-describedby");var l=this.$el.find(".schedule_time_start"),r=this.$el.find(".schedule_time_end");if(l.removeAttr("aria-invalid aria-describedby"),r.removeAttr("aria-invalid aria-describedby"),this.startDate.isValidDate())if(s||this.endDate.isValidDate())if(this.rangeStartTime.isValidTime())if(s||this.rangeEndTime.isValidTime()){if(this.startDate.isValidDate()&&this.endDate.isValidDate()&&!s){var o=this.startDate.getDateObj(),d=this.endDate.getDateObj();o>d&&(i.param1=t.translate("schedule_period"),i.param2=t.translate("schedule_datepicker_label"),e.push(t.translate("schedule_invalid_date_range",i)),a.attr({"aria-invalid":"true","aria-describedby":e[0]}))}}else i.param1=t.translate("schedule_period"),i.param2=t.translate("period_end_label"),e.push(t.translate("schedule_invalid_time",i)),r.attr({"aria-invalid":"true","aria-describedby":e[0]});else i.param1=t.translate("schedule_period"),i.param2=t.translate("period_start_label"),e.push(t.translate("schedule_invalid_time",i)),l.attr({"aria-invalid":"true","aria-describedby":e[0]});else i.param1=t.translate("schedule_period"),i.param2=t.translate("schedule_datepicker_label"),i.param3=t.translate("period_end_label"),e.push(t.translate("schedule_invalid_date",i)),a.attr({"aria-invalid":"true","aria-describedby":e[0]});else i.param1=t.translate("schedule_period"),i.param2=t.translate("schedule_datepicker_label"),i.param3=t.translate("period_start_label"),e.push(t.translate("schedule_invalid_date",i)),n.attr({"aria-invalid":"true","aria-describedby":e[0]});return e},_renderDateTimeRangeTimePickers:function(){this.rangeStartTime=new o({$el:this.$el.find(".schedule_time_start"),timezone:this.timezone,ariaLabel:t.translate("period_start_time_label"),attributes:{showMeridian:!c.is24HrFormat(this.locale)}}),this.rangeStartTime.render(),this.rangeEndTime=new o({$el:this.$el.find(".schedule_time_end"),timezone:this.timezone,ariaLabel:t.translate("period_end_time_label"),attributes:{showMeridian:!c.is24HrFormat(this.locale)}}),this.rangeEndTime.render(),this.isEditMode&&(this.descriptor.scheduleInfo&&this.descriptor.scheduleInfo.startDate&&this.rangeStartTime.setDateTimeUTC(this.descriptor.scheduleInfo.startDate),this.descriptor.scheduleInfo&&this.descriptor.scheduleInfo.endDate&&this.rangeEndTime.setDateTimeUTC(this.descriptor.scheduleInfo.endDate))},_hideShowEndDate:function(e,t){t?this.$el.find(".schedule_date_section_end").hide():this.$el.find(".schedule_date_section_end").show()}});return h}),define("text!bi/schedule/templates/DailyCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n <div class="schedule_input_section propertyUIControl">\n\n 	<div class="schedule_form_label">\n	 	<label class="schedule_label schedule_daily_label" for="schDaily_every_{{=it.uniqueid}}">{{=it.schedule_every_label}}</label>\n	</div>\n    <div class="schedule_form_input">\n    	<div class="schedule_dailyinterval_controls_container">\n			<input id="schDaily_every_{{=it.uniqueid}}" class="schedule_input_field schedule_every_days_input" type="text" value="{{=it.defaultPeriod}}" maxlength="3"></input>\n	    	<div class="schedule_frequency_daily_container" id="schedule_frequency_container_{{=it.uniqueid}}"></div>\n		</div>\n	</div>\n </div>\n <div class="schedule_daily_interval_container"></div>\n \n'}),define("text!bi/schedule/templates/DailyIntervalCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n	<div class="schedule_input_section schedule_daily_interval_container">\n        <!-- Radio group now becomes a checkbox -->\n		<div id="schedule_daily_interval_cadence_picker_container_{{=it.uniqueid}}" class="schedule_interval_checkbox"></div>\n    </div>\n    <div class="schedule_indent schedule_dailyinterval">\n        <div class="schedule_form_space"> \n	 		<div class="schedule_form_label">\n	 			<label class="schedule_label" for="schWeekly_run_every_{{=it.uniqueid}}">{{=it.schedule_repeat_label}}</label>\n	 		</div>\n	    	<div class="schedule_dailyinterval_controls_container">\n		    	<input id="schWeekly_run_every_{{=it.uniqueid}}" class="schedule_input_field schedule_run_every_input" type="text" value="{{=it.defaultPeriod}}" maxlength="3"></input>\n		    	<div id="schedule_daily_time_interval_selector_container_{{=it.uniqueid}}" class="schedule_daily_time_interval_selector_container"></div>\n        	</div>\n        </div>\n        <div class="schedule_form_space"> \n		    <div class="schedule_form_label"> \n			    <label class="schedule_date schedule_label">{{=it.schedule_timepicker_label}}</label> \n		    </div>\n	    	<div class="schedule_form_input schedule_interval_time_container"> \n	    		<div class="schedule_date_section">\n			        <div class="schedule_form_label">\n			            <label class="schedule_date schedule_label">{{=it.schedule_timepicker_start}}</label>\n			        </div>\n			        <div class="schedule_form_input">\n			            <div class="schedule_start_container schedule_time_interval_start"></div>\n			        </div>\n		        </div>\n		        \n		        <div class="schedule_date_section">\n			        <div class="schedule_form_label">\n			            <label class="schedule_date schedule_label">{{=it.schedule_timepicker_end}}</label>\n			        </div>\n			        <div class="schedule_form_input">\n			            <div class="schedule_end_container schedule_time_interval_end"></div>\n			        </div>\n		        </div>\n			</div> \n	     </div>  \n	</div>\n'}),define("bi/schedule/views/DailyIntervalCadencePickerView",["bi/schedule/views/CadencePickerView","jquery","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/DailyIntervalCadencePicker.html","lodash","bi/schedule/views/TimePicker","bi/commons/ui/properties/CheckBox","bi/commons/ui/properties/DropDown","bi/commons/utils/DateTimeUtils","bi/content_apps/utils/GlassContextHelper"],function(e,t,i,s,n,a,l,r,o,d,c){"use strict";var h=e.extend({init:function(e){h.inherited("init",this,arguments),a.assign(this,e),this.descriptor=this.objectInformation.descriptor,this.isEditMode="undefined"!=typeof this.descriptor,this.dailyIntervalCheckbox=null,this.uniqueId=a.uniqueId(),this.frequencyTypeSelector=null,this.renderDailyIntervalCheckbox=!1,this.timezone=c.getUserPreference(this.glassContext,"timeZoneID"),this.locale=this._determineDateLocale()},render:function(){var e=s.simpleTemplate(n),t=1;if(this.isEditMode&&this.descriptor.intradayRecurrence){var a=this.descriptor.intradayRecurrence.intradayRecurrenceInterval;t=a.substring(2,a.length-1)}var l={daily_time_interval_label:i.translate("daily_time_interval_label"),schedule_repeat_label:i.translate("schedule_repeat_label"),schedule_time_dropdown_hours_t:i.translate("schedule_time_dropdown_hours_t"),schedule_time_dropdown_minutes_t:i.translate("schedule_time_dropdown_minutes_t"),schedule_timepicker_label:i.translate("schedule_timepicker_label"),schedule_timepicker_start:i.translate("period_start_time_label"),schedule_timepicker_end:i.translate("period_end_time_label"),defaultPeriod:t,uniqueid:this.uniqueId};if(this.$el.append(e(l)),(this.glassContext.hasCapability("canUseSchedulingByHour")||this.glassContext.hasCapability("canUseSchedulingByMinute"))&&this.objectInformation.showDailyIntervalCheckbox&&(this.renderDailyIntervalCheckbox=!0),this.renderDailyIntervalCheckbox&&(this._renderDailyIntervalCheckbox(),this._renderDailyIntervalTimePickers(),this._renderSelectors()),this.isEditMode){if(this.descriptor.scheduleInfo&&this.descriptor.scheduleInfo.intradayRecurrence&&this.renderDailyIntervalCheckbox){this.$el.find(".schedule_dailyinterval").slideDown();var r=this.descriptor.scheduleInfo.intradayRecurrence.intradayRecurrenceInterval,o=r.replace(/[^0-9]/g,"");this.$el.find(".schedule_run_every_input").val(o);var d=r.charAt(r.length-1);this.frequencyTypeSelector.getHTMLControl().val(d)}}else this.renderDailyIntervalCheckbox&&(this.glassContext.hasCapability("canUseSchedulingByHour")?this.frequencyTypeSelector.getHTMLControl().val("H"):this.frequencyTypeSelector.getHTMLControl().val("M"));return this._setEvents(),Promise.resolve(this)},_setEvents:function(){t(".schedule_run_every_input").on("input",function(e){this.value=this.value.replace(/[^0-9]/g,"")})},toDescriptor:function(e){if(this.renderDailyIntervalCheckbox&&this.dailyIntervalCheckbox.isChecked()){var t=this.frequencyTypeSelector.getHTMLControl().val(),i=this.$el.find(".schedule_run_every_input").val(),s=this.intervalStartTime.getTime24H(),n=this.intervalEndTime.getTime24H();e.intradayRecurrence={intradayRecurrenceInterval:"PT"+i+t,intradayRecurrenceStart:s,intradayRecurrenceEnd:n}}return e},validate:function(e){if(this.renderDailyIntervalCheckbox&&this.dailyIntervalCheckbox.isChecked()){var t={param1:"",param2:"",param3:""},s=this.$el.find(".schedule_dailyinterval_controls_container"),n=this.$el.find(".schedule_time_interval_start"),a=this.$el.find(".schedule_time_interval_end");s.removeAttr("aria-invalid aria-describedby"),n.removeAttr("aria-invalid aria-describedby"),a.removeAttr("aria-invalid aria-describedby");var l=parseInt(this.$el.find(".schedule_run_every_input").val(),10);if(isNaN(l)||0===l)t.param1=i.translate("daily_time_interval_label"),t.param2=i.translate("schedule_repeat_label"),e.push(i.translate("schedule_invalid_form_input",t)),s.attr({"aria-invalid":"true","aria-describedby":e[0]});else if(this.intervalStartTime.isValidTime())if(this.intervalEndTime.isValidTime()){if(this.intervalStartTime.isValidTime()&&this.intervalEndTime.isValidTime()){var r=new Date(this.intervalStartTime.getDateTimeUTC()),o=new Date(this.intervalEndTime.getDateTimeUTC());r>o&&(t.param1=i.translate("daily_time_interval_label"),t.param2=i.translate("schedule_timepicker_label"),e.push(i.translate("schedule_invalid_time_range",t)),a.attr({"aria-invalid":"true","aria-describedby":e[0]}))}}else t.param1=i.translate("daily_time_interval_label"),t.param2=i.translate("schedule_timepicker_label"),t.param3=i.translate("period_end_label"),e.push(i.translate("schedule_invalid_interval_time",t)),a.attr({"aria-invalid":"true","aria-describedby":e[0]});else t.param1=i.translate("daily_time_interval_label"),t.param2=i.translate("schedule_timepicker_label"),t.param3=i.translate("period_start_label"),e.push(i.translate("schedule_invalid_interval_time",t)),n.attr({"aria-invalid":"true","aria-describedby":e[0]})}return e},_renderDailyIntervalCheckbox:function(){var e=!1;this.descriptor&&this.descriptor.scheduleInfo&&this.descriptor.scheduleInfo.intradayRecurrence&&(e=!0),this.dailyIntervalCheckbox=new r({id:"schedule_daily_interval_cadence_picker",el:this.$el.find("#schedule_daily_interval_cadence_picker_container_"+this.uniqueId),name:"schedule_daily_pick",label:i.translate("daily_time_interval_label"),ariaLabel:i.translate("daily_time_interval_label"),checked:e,controlOnLeft:!0,readOnly:this.readOnly,onChange:this._toggleOption.bind(this)}),this.dailyIntervalCheckbox.doRender()},_renderDailyIntervalTimePickers:function(){if(this.intervalStartTime=new l({$el:this.$el.find(".schedule_time_interval_start"),timezone:this.timezone,ariaLabel:i.translate("period_start_time_label"),attributes:{showMeridian:!d.is24HrFormat(this.locale)}}),this.intervalStartTime.render(),this.intervalEndTime=new l({$el:this.$el.find(".schedule_time_interval_end"),timezone:this.timezone,ariaLabel:i.translate("period_end_time_label"),attributes:{showMeridian:!d.is24HrFormat(this.locale)}}),this.intervalEndTime.render(),this.isEditMode&&this.descriptor.scheduleInfo&&this.descriptor.scheduleInfo.intradayRecurrence){var e=this.descriptor.scheduleInfo.intradayRecurrence.intradayRecurrenceStart;this.intervalStartTime.setTime24H(e);var t=this.descriptor.scheduleInfo.intradayRecurrence.intradayRecurrenceEnd;this.intervalEndTime.setTime24H(t)}},_toggleOption:function(e,t){t===!0?this.$el.find(".schedule_dailyinterval").slideDown():this.$el.find(".schedule_dailyinterval").slideUp()},_renderSelectors:function(){var e=[];this.glassContext.hasCapability("canUseSchedulingByHour")&&e.push({label:i.translate("schedule_time_dropdown_hours_t"),value:"H",selected:!1}),this.glassContext.hasCapability("canUseSchedulingByMinute")&&e.push({label:i.translate("schedule_time_dropdown_minutes_t"),value:"M",selected:!1}),this.frequencyTypeSelector=new o({id:"schedule_cadence_id_"+this.uniqueId,el:this.$el.find("#schedule_daily_time_interval_selector_container_"+this.uniqueId),ariaLabel:i.translate("schedule_repeat_label"),name:"schedule_interval_repeat_type",responsive:!1,onChange:function(){},options:e}),this.frequencyTypeSelector.doRender()},_determineDateLocale:function(){var e=c.getUserPreference(this.glassContext,"productLocale"),t=c.getUserPreference(this.glassContext,"contentLocale");return e===t.substring(0,2)?t:e}});return h}),define("bi/schedule/views/DailyCadencePickerView",["bi/schedule/views/CadencePickerView","jquery","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/DailyCadencePicker.html","lodash","bi/schedule/views/DailyIntervalCadencePickerView","bi/commons/ui/properties/DropDown"],function(e,t,i,s,n,a,l,r){"use strict";var o=e.extend({isEditMode:!1,init:function(e){o.inherited("init",this,arguments),a.assign(this,e),"undefined"!=typeof this.objectInformation.descriptor&&(this.scheduleInfo=this.objectInformation.descriptor.scheduleInfo,this.isEditMode=!0),this.uniqueId=a.uniqueId(),this.dayFrequencySelector=null,this.readOnly=!1},render:function(){var e=s.simpleTemplate(n),t=1;this.isEditMode&&this.scheduleInfo.everyNPeriods>1&&(t=this.scheduleInfo.everyNPeriods),this.readOnly=this.isEditMode&&this.hasPermission&&!this.hasPermission.write&&this.hasPermission.read;var a={schedule_every_label:i.translate("schedule_every_label"),schedule_time_dropdown_days_t:i.translate("schedule_time_dropdown_days_t"),schedule_time_dropdown_hours_t:i.translate("schedule_time_dropdown_hours_t"),schedule_time_dropdown_minutes_t:i.translate("schedule_time_dropdown_minutes_t"),defaultPeriod:t,uniqueid:this.uniqueId};if(this.$el.append(e(a)),this._renderSelectors(),this.isEditMode&&this.scheduleInfo.daily&&this.dayFrequencySelector.getHTMLControl().val(this.scheduleInfo.daily.dailyPeriod||"day"),this.objectInformation.showDailyInterval){var r={descriptor:this.objectInformation.descriptor};this.isEditMode?this.scheduleInfo&&this.scheduleInfo.intradayRecurrence||this.scheduleInfo&&"daily"!=this.scheduleInfo.type||this.scheduleInfo&&this.scheduleInfo.daily&&"day"==this.scheduleInfo.daily.dailyPeriod?r.showDailyIntervalCheckbox=!0:r.showDailyIntervalCheckbox=!1:r.showDailyIntervalCheckbox=!0;var o=this.$el.find(".schedule_daily_interval_container");this.dailyInterval=new l({$el:o,objectInformation:r,glassContext:this.glassContext,readOnly:this.readOnly}),this.dailyInterval.render()}return this._setEvents(),Promise.resolve(this)},_setEvents:function(){t(".schedule_every_days_input").on("input",function(e){this.value=this.value.replace(/[^0-9]/g,"")})},toDescriptor:function(e){return e.daily={dailyPeriod:this.dayFrequencySelector.getHTMLControl().val()},e.type="daily",e.everyNPeriods=parseInt(this.$el.find(".schedule_every_days_input").val(),10),this.dailyInterval&&(e=this.dailyInterval.toDescriptor(e)),e},validate:function(e){if(this.dailyInterval&&(e=this.dailyInterval.validate(e),e.length>0))return e;var t={},s=this.$el.find(".schedule_dailyinterval_controls_container");s.removeAttr("aria-invalid aria-describedby");var n=parseInt(this.$el.find(".schedule_every_days_input").val(),10);return isNaN(n)&&(t.param=i.translate("schedule_every_label"),e.push(i.translate("schedule_invalid_form_input_every_days_input",t)),s.attr({"aria-invalid":"true","aria-describedby":e[0]})),e},_renderSelectors:function(){var e=[];e.push({label:i.translate("schedule_time_dropdown_days_t"),value:"day",selected:!0}),this.glassContext.hasCapability("canUseSchedulingByHour")&&e.push({label:i.translate("schedule_time_dropdown_hours_t"),value:"hour",selected:!1}),this.glassContext.hasCapability("canUseSchedulingByMinute")&&e.push({label:i.translate("schedule_time_dropdown_minutes_t"),value:"minute",selected:!1}),this.dayFrequencySelector=new r({id:"schedule_cadence_id_"+this.uniqueId,el:this.$el.find("#schedule_frequency_container_"+this.uniqueId),label:"",name:"schedule_daily_period",responsive:!1,onChange:function(e,t){this._handleSelectors(e,t)}.bind(this),options:e,readOnly:this.readOnly}),this.dayFrequencySelector.doRender()},_handleSelectors:function(e,t){var i=this.$el.find(".schedule_daily_interval_container"),s={descriptor:this.objectInformation.descriptor};"schedule_daily_period"===e&&("hour"===t||"minute"===t?s.showDailyIntervalCheckbox=!1:"day"===t&&(s.showDailyIntervalCheckbox=!0),i.empty(),this.dailyInterval=new l({$el:i,objectInformation:s,glassContext:this.glassContext}),this.dailyInterval.render())}});return o}),define("text!bi/schedule/templates/WeeklyCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n {{? it.showRunEvery}}\n <div class="schedule_input_section ">\n    <div class="schedule_form_label">\n        <label class="schedule_label" for="schWeekly_run_every_{{=it.run_everyid}}">{{=it.schedule_run_every_label}}</label>\n    </div>\n    <div class="schedule_frequency_input_container">\n		<input id="schWeekly_run_every_{{=it.run_everyid}}" class="schedule_input_field schedule_every_weeks_input" type="text" value="{{=it.schedule_every_weeks_value}}" maxlength="3"></input>\n		<span>{{=it.schedule_run_every_week_label}}</span>\n    </div>\n</div>\n{{?}}\n<div class="schedule_form_space">\n    <div class="weekly_on_days_label schedule_form_label schedule_label">{{=it.schedule_weekly_on_days_label}}</div>\n    <div class="schedule_form_input">\n	    <div class="schedule_button_groups" role="region" aria-label="{{=it.weekly_cadence_buttons_description}}">\n			<button class="weeklyMonday" role="button" aria-label="{{=it.schedule_weekday_Monday}}" aria-pressed="false">{{=it.schedule_weekday_button_Monday}}</button>\n			<button class ="weeklyTuesday" role="button" aria-label="{{=it.schedule_weekday_Tuesday}}" aria-pressed="false">{{=it.schedule_weekday_button_Tuesday}}</button>\n			<button class="weeklyWednesday" role="button" aria-label="{{=it.schedule_weekday_Wednesday}}" aria-pressed="false">{{=it.schedule_weekday_button_Wednesday}}</button>\n			<button class ="weeklyThursday" role="button" aria-label="{{=it.schedule_weekday_Thursday}}" aria-pressed="false">{{=it.schedule_weekday_button_Thursday}}</button>\n			<button class ="weeklyFriday" role="button" aria-label="{{=it.schedule_weekday_Friday}}" aria-pressed="false">{{=it.schedule_weekday_button_Friday}}</button>\n			<button class ="weeklySaturday" role="button" aria-label="{{=it.schedule_weekday_Saturday}}" aria-pressed="false">{{=it.schedule_weekday_button_Saturday}}</button>\n			<button class="weeklySunday" role="button" aria-label="{{=it.schedule_weekday_Sunday}}" aria-pressed="false">{{=it.schedule_weekday_button_Sunday}}</button>\n	    </div>\n    </div>\n</div>'}),define("bi/schedule/views/WeeklyCadencePickerView",["bi/schedule/views/CadencePickerView","jquery","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","bi/commons/utils/ContentFormatter","text!bi/schedule/templates/WeeklyCadencePicker.html","lodash","moment-timezone","bi/schedule/views/DailyIntervalCadencePickerView"],function(e,t,i,s,n,a,l,r,o){"use strict";var d=e.extend({isEditMode:!1,buttonClassName:["weeklySunday","weeklyMonday","weeklyTuesday","weeklyWednesday","weeklyThursday","weeklyFriday","weeklySaturday"],dayNumberMap:{weeklySunday:0,weeklyMonday:1,weeklyTuesday:2,weeklyWednesday:3,weeklyThursday:4,weeklyFriday:5,weeklySaturday:6},init:function(e){d.inherited("init",this,arguments),t.extend(this,e),"undefined"!=typeof this.objectInformation.descriptor&&(this.scheduleInfo=this.objectInformation.descriptor.scheduleInfo,this.isEditMode=!0),this.readOnly=!1,this.timezone=this.glassContext.services.userProfile.preferences.timeZoneID},render:function(){var e=s.simpleTemplate(a),t=1;"undefined"!=typeof this.scheduleInfo&&this.scheduleInfo.everyNPeriods>1&&(t=this.scheduleInfo.everyNPeriods),this.readOnly=this.isEditMode&&this.hasPermission&&!this.hasPermission.write&&this.hasPermission.read;var r={weekly_cadence_buttons_description:i.translate("weekly_cadence_buttons_description"),schedule_run_every_label:i.translate("schedule_run_every_label"),schedule_run_every_week_label:i.translate("schedule_run_every_week_label"),schedule_weekly_on_days_label:i.translate("schedule_weekly_on_days_label"),schedule_every_weeks_value:t,schedule_weekday_Sunday:i.translate("schedule_run_on_the_sun_label"),schedule_weekday_Saturday:i.translate("schedule_run_on_the_sat_label"),schedule_weekday_Friday:i.translate("schedule_run_on_the_fri_label"),schedule_weekday_Thursday:i.translate("schedule_run_on_the_thu_label"),schedule_weekday_Wednesday:i.translate("schedule_run_on_the_wed_label"),schedule_weekday_Tuesday:i.translate("schedule_run_on_the_tue_label"),schedule_weekday_Monday:i.translate("schedule_run_on_the_mon_label"),schedule_weekday_button_Sunday:i.translate("schedule_weekday_button_Sunday_t"),schedule_weekday_button_Saturday:i.translate("schedule_weekday_button_Saturday_t"),schedule_weekday_button_Friday:i.translate("schedule_weekday_button_Friday_t"),schedule_weekday_button_Thursday:i.translate("schedule_weekday_button_Thursday_t"),schedule_weekday_button_Wednesday:i.translate("schedule_weekday_button_Wednesday_t"),schedule_weekday_button_Tuesday:i.translate("schedule_weekday_button_Tuesday_t"),schedule_weekday_button_Monday:i.translate("schedule_weekday_button_Monday_t"),run_everyid:l.uniqueId(),showRunEvery:this.objectInformation.showRunEvery};if(this.$el.append(e(r)),this._setDay(),this.objectInformation.showDailyInterval&&(this.dailyInterval=new o({$el:this.$el,objectInformation:{descriptor:this.objectInformation.descriptor,showDailyIntervalCheckbox:!0},glassContext:this.glassContext,readOnly:this.readOnly}),this.dailyInterval.render()),this.readOnly)for(var d=0;d<this.buttonClassName.length;d++)this.$el.find("."+this.buttonClassName[d]).prop("disabled",!0);return n.middleShortenString(this.$el.find(".weekly_on_days_label")),this._setEvents(),Promise.resolve(this)},toDescriptor:function(e){var t={weeklySunday:!1,weeklyMonday:!1,weeklyTuesday:!1,weeklyWednesday:!1,weeklyThursday:!1,weeklyFriday:!1,weeklySaturday:!1};for(var i in t)this.$el.find("."+i).hasClass("selectedButton")&&(t[i]=!0);e.weekly=t;var s=this.objectInformation.showRunEvery?parseInt(this.$el.find(".schedule_every_weeks_input").val(),10):1;
return e.everyNPeriods=s,e.type="weekly",this.dailyInterval&&(e=this.dailyInterval.toDescriptor(e)),e},validate:function(e){if(this.dailyInterval&&(e=this.dailyInterval.validate(e),e.length>0))return e;var t={},s=this.$el.find(".schedule_frequency_input_container");s.removeAttr("aria-invalid aria-describedby");var n=this.objectInformation.showRunEvery?parseInt(this.$el.find(".schedule_every_weeks_input").val(),10):1;return(isNaN(n)||0===n)&&(t.param1=i.translate("schedule_run_every_label"),t.param2=i.translate("schedule_run_every_week_label"),e.push(i.translate("schedule_invalid_form_input",t)),s.attr({"aria-invalid":"true","aria-describedby":e[0]})),e},_setEvents:function(){for(var e=function(e){for(var t=e.currentTarget.className.split(/\s+/),i=0;i<t.length;i++)0===t[i].indexOf("weekly")&&this._toggleWeekday(t[i])}.bind(this),i=0;i<this.buttonClassName.length;i++)this.$el.find("."+this.buttonClassName[i]).on("clicktap",e);t(".schedule_every_weeks_input").on("input",function(e){this.value=this.value.replace(/[^0-9]/g,"")})},_setDay:function(){var e=!1;if("undefined"!=typeof this.scheduleInfo&&this.scheduleInfo.weekly)for(var t in this.scheduleInfo.weekly)if(this.scheduleInfo.weekly[t]===!0){var i=this._convertTimezone(this.dayNumberMap[t]);this._toggleWeekday(this.buttonClassName[i]),e=!0}if(!e){var s=r().tz(this.timezone).day();this._toggleWeekday(this.buttonClassName[s])}},_convertTimezone:function(e){var t=r(this.scheduleInfo.startDate).tz(this.scheduleInfo.timezone).day(),i=r(this.scheduleInfo.startDate).tz(this.timezone).day(),s=e+(i-t);return 0>s?s+=7:s>6&&(s-=7),s},_toggleWeekday:function(e){var t="."+e,i=this.$el.find(t);i.hasClass("selectedButton")?this.$el.find(".selectedButton").length>1&&(i.removeClass("selectedButton"),i.attr("aria-pressed","false")):(i.addClass("selectedButton"),i.attr("aria-pressed","true"))}});return d}),define("text!bi/schedule/templates/MonthlyCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2017\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n\n<div class="schedule_input_section schedule_input_select_section" id="schedule_day_type_selector_container_{{=it.uniqueid}}">{{=it.schedule_run_on_label}}</div>\n<div class="schedule_input_select_section" id="schedule_day_selector_container_{{=it.uniqueid}}"></div>\n<div class="schedule_form_space">\n    <div class="schedule_form_label"><label class="schedule_label"  for="schMonthly_repeat_interval_{{=it.uniqueid}}">{{=it.schedule_repeat_interval_label}}</label></div>\n    <div class="schedule_frequency_input_container">\n        <input id="schMonthly_repeat_interval_{{=it.uniqueid}}" class="schedule_input_field schedule_every_weeks_input" type="text" value="{{=it.schedule_of_every_n_months_value}}" maxlength="3"></input>\n        <span>{{=it.schedule_repeat_interval_months_label}}</span>\n    </div>\n</div>\n'}),define("bi/schedule/views/MonthlyCadencePickerView",["bi/schedule/views/CadencePickerView","jquery","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/MonthlyCadencePicker.html","lodash","bi/schedule/views/DailyIntervalCadencePickerView","bi/commons/ui/properties/DropDown","bi/commons/ui/properties/RadioButtonGroup"],function(e,t,i,s,n,a,l,r,o){"use strict";var d=e.extend({isEditMode:!1,init:function(e){d.inherited("init",this,arguments),a.assign(this,e),"undefined"!=typeof this.objectInformation.descriptor&&(this.scheduleInfo=this.objectInformation.descriptor.scheduleInfo,this.isEditMode=!0),this.uniqueId=a.uniqueId(),this.dayTypeSelector=null,this.daySelector=null,this.dayOfMonthSelector=null,this.readOnly=!1},render:function(){var e=s.simpleTemplate(n),t=1;this.isEditMode&&this.scheduleInfo.everyNPeriods>1&&(t=this.scheduleInfo.everyNPeriods),this.readOnly=this.isEditMode&&this.hasPermission&&!this.hasPermission.write&&this.hasPermission.read;var a={schedule_run_on_label:i.translate("schedule_run_on_label"),schedule_repeat_interval_label:i.translate("schedule_repeat_interval_label"),schedule_of_every_n_months_value:t,schedule_repeat_interval_months_label:i.translate("schedule_repeat_interval_months_label"),uniqueid:this.uniqueId};if(this.$el.append(e(a)),this._renderSelectors(),this.dayTypeSelector.setValue("relative",!0),this.isEditMode)if(this.scheduleInfo.monthlyRelative){var r=this.scheduleInfo.monthlyRelative.monthlyRelativeDay||"monday",o=this.scheduleInfo.monthlyRelative.monthlyRelativeWeek||"first";this.daySelector.getHTMLControl().val(o+"|"+r)}else this.scheduleInfo.monthlyAbsolute&&(this.dayTypeSelector.setValue("absolute",!0),this.dayOfMonthSelector.getHTMLControl().val(this.scheduleInfo.monthlyAbsolute.monthlyAbsoluteDay||25));return this.objectInformation.showDailyInterval&&(this.dailyInterval=new l({$el:this.$el,objectInformation:{descriptor:this.objectInformation.descriptor,showDailyIntervalCheckbox:!0},glassContext:this.glassContext,readOnly:this.readOnly}),this.dailyInterval.render()),this._setEvents(),Promise.resolve(this)},_setEvents:function(){t(".schedule_every_weeks_input").on("input",function(e){this.value=this.value.replace(/[^0-9]/g,"")})},toDescriptor:function(e){if("absolute"===this.dayTypeSelector.getValue())e.monthlyAbsolute={monthlyAbsoluteDay:parseInt(this.dayOfMonthSelector.getHTMLControl().val(),10)},e.type="monthlyAbsolute";else{var t=this.daySelector.getHTMLControl().val(),i=t.split("|");e.monthlyRelative={monthlyRelativeDay:i[1],monthlyRelativeWeek:i[0]},e.type="monthlyRelative"}return e.everyNPeriods=parseInt(this.$el.find(".schedule_every_weeks_input").val(),10),this.dailyInterval&&(e=this.dailyInterval.toDescriptor(e)),e},validate:function(e){if(this.dailyInterval&&(e=this.dailyInterval.validate(e),e.length>0))return e;var t={},s=this.$el.find(".schedule_frequency_input_container");s.removeAttr("aria-invalid aria-describedby");var n=parseInt(this.$el.find(".schedule_every_weeks_input").val(),10);return isNaN(n)&&(t.param1=i.translate("schedule_repeat_interval_label"),e.push(i.translate("schedule_invalid_form_input_every_month_repeat_input",t)),s.attr({"aria-invalid":"true","aria-describedby":e[0]})),e},_renderSelectors:function(){this.dayTypeSelector=new o({id:"schedule_day_type_selector_"+this.uniqueId,el:this.$el.find("#schedule_day_type_selector_container_"+this.uniqueId),label:i.translate("schedule_run_on_label"),ariaLabel:i.translate("schedule_run_on_select_description"),name:"schedule_day_type_selector",value:"relative",indent:2,separator:!1,onChange:function(e,t){this._handleSelectors(e,t)}.bind(this),controlOnLeft:!0,items:[{label:i.translate("schedule_relative_absolute_radio_absolute"),value:"absolute"},{label:i.translate("schedule_relative_absolute_radio_relative"),value:"relative"}],readOnly:this.readOnly}),this.dayTypeSelector.render(),this.daySelector=new r({id:"schedule_run_on_the_"+this.uniqueId,el:this.$el.find("#schedule_day_selector_container_"+this.uniqueId),label:i.translate("schedule_run_on_day_label"),ariaDescribedby:i.translate("schedule_run_on_select_description"),name:"schedule_relative_day_of_month",responsive:!1,options:[{label:i.translate("schedule_run_on_first_monday_label"),value:"first|monday",selected:!1},{label:i.translate("schedule_run_on_the_second_monday_label"),value:"second|monday",selected:!1},{label:i.translate("schedule_run_on_the_third_monday_label"),value:"third|monday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_monday_label"),value:"fourth|monday",selected:!1},{label:i.translate("schedule_run_on_the_last_monday_label"),value:"last|monday",selected:!1},{label:i.translate("schedule_run_on_first_tuesday_label"),value:"first|tuesday",selected:!1},{label:i.translate("schedule_run_on_the_second_tuesday_label"),value:"second|tuesday",selected:!1},{label:i.translate("schedule_run_on_the_third_tuesday_label"),value:"third|tuesday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_tuesday_label"),value:"fourth|tuesday",selected:!1},{label:i.translate("schedule_run_on_the_last_tuesday_label"),value:"last|tuesday",selected:!1},{label:i.translate("schedule_run_on_first_wednesday_label"),value:"first|wednesday",selected:!1},{label:i.translate("schedule_run_on_the_second_wednesday_label"),value:"second|wednesday",selected:!1},{label:i.translate("schedule_run_on_the_third_wednesday_label"),value:"third|wednesday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_wednesday_label"),value:"fourth|wednesday",selected:!1},{label:i.translate("schedule_run_on_the_last_wednesday_label"),value:"last|wednesday",selected:!1},{label:i.translate("schedule_run_on_first_thursday_label"),value:"first|thursday",selected:!1},{label:i.translate("schedule_run_on_the_second_thursday_label"),value:"second|thursday",selected:!1},{label:i.translate("schedule_run_on_the_third_thursday_label"),value:"third|thursday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_thursday_label"),value:"fourth|thursday",selected:!1},{label:i.translate("schedule_run_on_the_last_thursday_label"),value:"last|thursday",selected:!1},{label:i.translate("schedule_run_on_first_friday_label"),value:"first|friday",selected:!1},{label:i.translate("schedule_run_on_the_second_friday_label"),value:"second|friday",selected:!1},{label:i.translate("schedule_run_on_the_third_friday_label"),value:"third|friday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_friday_label"),value:"fourth|friday",selected:!1},{label:i.translate("schedule_run_on_the_last_friday_label"),value:"last|friday",selected:!1},{label:i.translate("schedule_run_on_first_saturday_label"),value:"first|saturday",selected:!1},{label:i.translate("schedule_run_on_the_second_saturday_label"),value:"second|saturday",selected:!1},{label:i.translate("schedule_run_on_the_third_saturday_label"),value:"third|saturday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_saturday_label"),value:"fourth|saturday",selected:!1},{label:i.translate("schedule_run_on_the_last_saturday_label"),value:"last|saturday",selected:!1},{label:i.translate("schedule_run_on_first_sunday_label"),value:"first|sunday",selected:!1},{label:i.translate("schedule_run_on_the_second_sunday_label"),value:"second|sunday",selected:!1},{label:i.translate("schedule_run_on_the_third_sunday_label"),value:"third|sunday",selected:!1},{label:i.translate("schedule_run_on_the_fourth_sunday_label"),value:"fourth|sunday",selected:!1},{label:i.translate("schedule_run_on_the_last_sunday_label"),value:"last|sunday",selected:!1}],readOnly:this.readOnly}),this.daySelector.doRender(),this.dayOfMonthSelector=new r({id:"schedule_absolute_day_of_month_"+this.uniqueId,el:this.$el.find("#schedule_day_selector_container_"+this.uniqueId),label:i.translate("schedule_run_on_day_label"),ariaDescribedby:i.translate("schedule_run_on_select_description"),name:"schedule_absolute_day_of_month",responsive:!1,readOnly:this.readOnly,options:[{label:"1",value:"1",selected:!1},{label:"2",value:"2",selected:!1},{label:"3",value:"3",selected:!1},{label:"4",value:"4",selected:!1},{label:"5",value:"5",selected:!1},{label:"6",value:"6",selected:!1},{label:"7",value:"7",selected:!1},{label:"8",value:"8",selected:!1},{label:"9",value:"9",selected:!1},{label:"10",value:"10",selected:!1},{label:"11",value:"11",selected:!1},{label:"12",value:"12",selected:!1},{label:"13",value:"13",selected:!1},{label:"14",value:"14",selected:!1},{label:"15",value:"15",selected:!1},{label:"16",value:"16",selected:!1},{label:"17",value:"17",selected:!1},{label:"18",value:"18",selected:!1},{label:"19",value:"19",selected:!1},{label:"20",value:"20",selected:!1},{label:"21",value:"21",selected:!1},{label:"22",value:"22",selected:!1},{label:"23",value:"23",selected:!1},{label:"24",value:"24",selected:!1},{label:"25",value:"25",selected:!1},{label:"26",value:"26",selected:!1},{label:"27",value:"27",selected:!1},{label:"28",value:"28",selected:!1},{label:"29",value:"29",selected:!1},{label:"30",value:"30",selected:!1},{label:"31",value:"31",selected:!1}]}),this.dayOfMonthSelector.doRender()},_handleSelectors:function(e,t){"absolute"===t?(this.daySelector.hide(),this.dayOfMonthSelector.show()):(this.daySelector.show(),this.dayOfMonthSelector.hide())}});return d}),define("text!bi/schedule/templates/YearlyCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2017\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n<div class="schedule_input_section schedule_input_select_section" id="schedule_day_type_selector_container_{{=it.uniqueid}}">{{=it.schedule_run_on_label}}</div>\n<div class="schedule_input_select_section" id="schedule_day_selector_container_{{=it.uniqueid}}"></div>\n\n<div class="schedule_form_space schedule_input_select_section" id="schedule_month_selector_container_{{=it.uniqueid}}"></div>\n'}),define("bi/schedule/views/YearlyCadencePickerView",["bi/schedule/views/CadencePickerView","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/YearlyCadencePicker.html","lodash","bi/schedule/views/DailyIntervalCadencePickerView","bi/commons/ui/properties/DropDown","bi/commons/ui/properties/RadioButtonGroup"],function(e,t,i,s,n,a,l,r){"use strict";var o=e.extend({isEditMode:!1,showAbsolute:!1,init:function(e){o.inherited("init",this,arguments),n.assign(this,e),"undefined"!=typeof this.objectInformation.descriptor&&(this.scheduleInfo=this.objectInformation.descriptor.scheduleInfo,this.isEditMode=!0),this.uniqueId=n.uniqueId(),this.dayTypeSelector=null,this.daySelector=null,this.dayOfMonthSelector=null,this.monthSelector=null,this.readOnly=!1},render:function(){this.readOnly=this.isEditMode&&this.hasPermission&&!this.hasPermission.write&&this.hasPermission.read;var e=i.simpleTemplate(s),n={schedule_run_on_label:t.translate("schedule_run_on_label"),uniqueid:this.uniqueId};if(this.$el.append(e(n)),this._renderSelectors(),this.dayTypeSelector.setValue("relative",!0),this.isEditMode)if(this.scheduleInfo.yearlyRelative){var l=this.scheduleInfo.yearlyRelative.yearlyRelativeDay||"monday",r=this.scheduleInfo.yearlyRelative.yearlyRelativeWeek||"first";this.daySelector.getHTMLControl().val(r+"|"+l),this.monthSelector.getHTMLControl().val(this.scheduleInfo.yearlyRelative.yearlyRelativeMonth||"september")}else this.scheduleInfo.yearlyAbsolute&&(this.dayTypeSelector.setValue("absolute",!0),this.dayOfMonthSelector.getHTMLControl().val(this.scheduleInfo.yearlyAbsolute.yearlyAbsoluteDay||25),this.monthSelector.getHTMLControl().val(this.scheduleInfo.yearlyAbsolute.yearlyAbsoluteMonth||"september"));return this.objectInformation.showDailyInterval&&(this.dailyInterval=new a({$el:this.$el,objectInformation:{descriptor:this.objectInformation.descriptor,showDailyIntervalCheckbox:!0},glassContext:this.glassContext,readOnly:this.readOnly}),this.dailyInterval.render()),Promise.resolve(this)},toDescriptor:function(e){if("absolute"===this.dayTypeSelector.getValue())e.yearlyAbsolute={yearlyAbsoluteDay:parseInt(this.dayOfMonthSelector.getHTMLControl().val(),10),yearlyAbsoluteMonth:this.monthSelector.getHTMLControl().val()},e.type="yearlyAbsolute";else{var t=this.daySelector.getHTMLControl().val(),i=t.split("|");e.yearlyRelative={yearlyRelativeDay:i[1],yearlyRelativeWeek:i[0],yearlyRelativeMonth:this.monthSelector.getHTMLControl().val()},e.type="yearlyRelative"}return e.everyNPeriods=1,this.dailyInterval&&(e=this.dailyInterval.toDescriptor(e)),e},validate:function(e){return this.dailyInterval&&(e=this.dailyInterval.validate(e)),e},_renderSelectors:function(){this.dayTypeSelector=new r({id:"schedule_day_type_selector_"+this.uniqueId,el:this.$el.find("#schedule_day_type_selector_container_"+this.uniqueId),label:t.translate("schedule_run_on_label"),ariaLabel:t.translate("schedule_run_on_select_description"),name:"schedule_day_type_selector",value:"relative",indent:2,separator:!1,onChange:function(e,t){this._handleSelectors(e,t)}.bind(this),controlOnLeft:!0,items:[{label:t.translate("schedule_relative_absolute_radio_absolute"),value:"absolute"},{label:t.translate("schedule_relative_absolute_radio_relative"),value:"relative"}],readOnly:this.readOnly}),this.dayTypeSelector.render(),this.daySelector=new l({id:"schedule_run_on_the_"+this.uniqueId,el:this.$el.find("#schedule_day_selector_container_"+this.uniqueId),label:t.translate("schedule_run_on_day_label"),ariaDescribedby:t.translate("schedule_run_on_select_description"),name:"schedule_relative_day_of_month",responsive:!1,readOnly:this.readOnly,options:[{label:t.translate("schedule_run_on_first_monday_label"),value:"first|monday",selected:!1},{label:t.translate("schedule_run_on_the_second_monday_label"),value:"second|monday",selected:!1},{label:t.translate("schedule_run_on_the_third_monday_label"),value:"third|monday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_monday_label"),value:"fourth|monday",selected:!1},{label:t.translate("schedule_run_on_the_last_monday_label"),value:"last|monday",selected:!1},{label:t.translate("schedule_run_on_first_tuesday_label"),value:"first|tuesday",selected:!1},{label:t.translate("schedule_run_on_the_second_tuesday_label"),value:"second|tuesday",selected:!1},{label:t.translate("schedule_run_on_the_third_tuesday_label"),value:"third|tuesday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_tuesday_label"),value:"fourth|tuesday",selected:!1},{label:t.translate("schedule_run_on_the_last_tuesday_label"),value:"last|tuesday",selected:!1},{label:t.translate("schedule_run_on_first_wednesday_label"),value:"first|wednesday",selected:!1},{label:t.translate("schedule_run_on_the_second_wednesday_label"),value:"second|wednesday",selected:!1},{label:t.translate("schedule_run_on_the_third_wednesday_label"),value:"third|wednesday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_wednesday_label"),value:"fourth|wednesday",selected:!1},{label:t.translate("schedule_run_on_the_last_wednesday_label"),value:"last|wednesday",selected:!1},{label:t.translate("schedule_run_on_first_thursday_label"),value:"first|thursday",selected:!1},{label:t.translate("schedule_run_on_the_second_thursday_label"),value:"second|thursday",selected:!1},{label:t.translate("schedule_run_on_the_third_thursday_label"),value:"third|thursday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_thursday_label"),value:"fourth|thursday",selected:!1},{label:t.translate("schedule_run_on_the_last_thursday_label"),value:"last|thursday",selected:!1},{label:t.translate("schedule_run_on_first_friday_label"),value:"first|friday",selected:!1},{label:t.translate("schedule_run_on_the_second_friday_label"),value:"second|friday",selected:!1},{label:t.translate("schedule_run_on_the_third_friday_label"),value:"third|friday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_friday_label"),value:"fourth|friday",selected:!1},{label:t.translate("schedule_run_on_the_last_friday_label"),value:"last|friday",selected:!1},{label:t.translate("schedule_run_on_first_saturday_label"),value:"first|saturday",selected:!1},{label:t.translate("schedule_run_on_the_second_saturday_label"),value:"second|saturday",selected:!1},{label:t.translate("schedule_run_on_the_third_saturday_label"),value:"third|saturday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_saturday_label"),value:"fourth|saturday",selected:!1},{label:t.translate("schedule_run_on_the_last_saturday_label"),value:"last|saturday",selected:!1},{label:t.translate("schedule_run_on_first_sunday_label"),value:"first|sunday",selected:!1},{label:t.translate("schedule_run_on_the_second_sunday_label"),value:"second|sunday",selected:!1},{label:t.translate("schedule_run_on_the_third_sunday_label"),value:"third|sunday",selected:!1},{label:t.translate("schedule_run_on_the_fourth_sunday_label"),value:"fourth|sunday",selected:!1},{label:t.translate("schedule_run_on_the_last_sunday_label"),value:"last|sunday",selected:!1}]}),this.daySelector.doRender(),this.dayOfMonthSelector=new l({id:"schedule_absolute_day_of_month_"+this.uniqueId,el:this.$el.find("#schedule_day_selector_container_"+this.uniqueId),label:t.translate("schedule_run_on_day_label"),ariaDescribedby:t.translate("schedule_run_on_select_description"),name:"schedule_absolute_day_of_month",responsive:!1,readOnly:this.readOnly,options:[{label:"1",value:"1",selected:!1},{label:"2",value:"2",selected:!1},{label:"3",value:"3",selected:!1},{label:"4",value:"4",selected:!1},{label:"5",value:"5",selected:!1},{label:"6",value:"6",selected:!1},{label:"7",value:"7",selected:!1},{label:"8",value:"8",selected:!1},{label:"9",value:"9",selected:!1},{label:"10",value:"10",selected:!1},{label:"11",value:"11",selected:!1},{label:"12",value:"12",selected:!1},{label:"13",value:"13",selected:!1},{label:"14",value:"14",selected:!1},{label:"15",value:"15",selected:!1},{label:"16",value:"16",selected:!1},{label:"17",value:"17",selected:!1},{label:"18",value:"18",selected:!1},{label:"19",value:"19",selected:!1},{label:"20",value:"20",selected:!1},{label:"21",value:"21",selected:!1},{label:"22",value:"22",selected:!1},{label:"23",value:"23",selected:!1},{label:"24",value:"24",selected:!1},{label:"25",value:"25",selected:!1},{label:"26",value:"26",selected:!1},{label:"27",value:"27",selected:!1},{label:"28",value:"28",selected:!1},{label:"29",value:"29",selected:!1},{label:"30",value:"30",selected:!1},{label:"31",value:"31",selected:!1}]}),this.dayOfMonthSelector.doRender(),this.monthSelector=new l({id:"schedule_run_on_the_month_"+this.uniqueId,el:this.$el.find("#schedule_month_selector_container_"+this.uniqueId),label:t.translate("schedule_repeat_month_label"),name:"schedule_month_of_year",responsive:!1,options:[{label:t.translate("schedule_run_on_the_jan_label"),value:"january",selected:!1},{label:t.translate("schedule_run_on_the_feb_label"),value:"february",selected:!1},{label:t.translate("schedule_run_on_the_mar_label"),value:"march",selected:!1},{label:t.translate("schedule_run_on_the_apr_label"),value:"april",selected:!1},{label:t.translate("schedule_run_on_the_may_label"),value:"may",selected:!1},{label:t.translate("schedule_run_on_the_jun_label"),value:"june",selected:!1},{label:t.translate("schedule_run_on_the_jul_label"),value:"july",selected:!1},{label:t.translate("schedule_run_on_the_aug_label"),value:"august",selected:!1},{label:t.translate("schedule_run_on_the_sep_label"),value:"september",selected:!1},{label:t.translate("schedule_run_on_the_oct_label"),value:"october",selected:!1},{label:t.translate("schedule_run_on_the_nov_label"),value:"november",selected:!1},{label:t.translate("schedule_run_on_the_dec_label"),value:"december",selected:!1}],readOnly:this.readOnly}),this.monthSelector.doRender()},_handleSelectors:function(e,t){"absolute"===t?(this.daySelector.hide(),this.dayOfMonthSelector.show()):(this.daySelector.show(),this.dayOfMonthSelector.hide())}});return o}),define("text!bi/schedule/templates/TriggerCadencePicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n<div class="schedule_input_section ">\n    <div class="schedule_form_label">\n        <label class="schedule_label" for="trigger_name_{{=it.uniqueId}}">{{=it.schedule_trigger_name_label}}</label>\n    </div>\n    <div class="schedule_form_input">\n		<input id="trigger_name_{{=it.uniqueId}}" class="schedule_input_field schedule_trigger_name_input" type="text" value="{{=it.schedule_trigger_name_value}}"></input>\n    </div>\n</div>'}),define("bi/schedule/views/TriggerCadencePickerView",["bi/schedule/views/CadencePickerView","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/TriggerCadencePicker.html","lodash"],function(e,t,i,s,n){"use strict";var a=e.extend({init:function(e){a.inherited("init",this,arguments),this.isEditMode=!1,this.scheduleInfo={},n.assign(this,e),"undefined"!=typeof this.objectInformation.descriptor&&(this.scheduleInfo=this.objectInformation.descriptor.scheduleInfo,this.isEditMode=!0),this.uniqueId=n.uniqueId()},render:function(){var e=i.simpleTemplate(s),n=" ";this.isEditMode&&this.scheduleInfo.trigger&&(n=this.scheduleInfo.trigger.triggerName);var a={schedule_trigger_name_label:t.translate("schedule_trigger_name_label"),schedule_trigger_name_value:n,uniqueId:this.uniqueId};return this.$el.append(e(a)),Promise.resolve(this)},toDescriptor:function(e){return e.trigger={triggerName:n.escape(this.$el.find(".schedule_trigger_name_input").val().trim())},e.everyNPeriods=1,e},validate:function(e){return""===this.$el.find(".schedule_trigger_name_input").val().trim()&&e.push(t.translate("schedule_invalid_trigger_name_empty")),e}});return a}),define("text!bi/schedule/templates/FormatPicker.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n<div>\n	<div class="output_format_container">\n		<div class="propertyUIControl">\n			{{? it.showHTML }}\n			<div class="output_option html_format_option_{{=it.uniqueId}}"></div>\n			{{?}}\n			{{? it.showPDF }}\n			<div class="output_option pdf_format_option_{{=it.uniqueId}}"></div>\n			{{?}}\n			{{? it.showExcel }}\n			<div class="output_option spreadsheet_format_option_{{=it.uniqueId}}"></div>\n			<div class="output_option xlsxdata_format_option_{{=it.uniqueId}}"></div>\n			{{?}}\n			{{? it.showCSV }}\n			<div class="output_option csv_format_option_{{=it.uniqueId}}"></div>\n			{{?}}\n			{{? it.showXML }}\n			<div class="output_option xml_format_option_{{=it.uniqueId}}"></div>\n			{{?}}\n			{{? it.showUnsupported }}\n			<div class="output_option unsupported_format_option_{{=it.uniqueId}}"></div>\n			{{?}}\n			<div class="new_schedule_panel_footer clearfix">\n				<div class="pull-right" role="region"aria-label="{{=it.schedule_controls_description}}">\n					<button class="new_schedule_panel_button schedule_primary_button">{{=it.schedule_done_btn}}</button>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n'}),define("bi/schedule/views/FormatPickerView",["lodash","jquery","bi/sharecommon/utils/simpledoT","bi/commons/ui/View","bi/sharecommon/utils/translator","bi/commons/utils/Utils","bi/commons/utils/ContentFormatter","text!bi/schedule/templates/FormatPicker.html","bi/commons/ui/properties/CheckBox","bi/content_apps/authoring/AuthoringHelper","bootstrap"],function(e,t,i,s,n,a,l,r,o,d){"use strict";var c="350px",h=s.extend({init:function(i){if(h.inherited("init",this,arguments),this._initVariables(),void 0===i.$toggler)throw"Error: $toggler parameter must be provided.";t.extend(this,i),Array.isArray(this.outputFormats)&&0!==this.outputFormats.length||(this.showHTML?this.outputFormats=["HTML"]:this.showPDF&&d.userCanGenerateFormat(i.glassContext,"PDF")?this.outputFormats=["PDF"]:this.showExcel&&d.userCanGenerateFormat(i.glassContext,"spreadsheetML")?this.outputFormats=["spreadsheetML"]:this.showCSV&&d.userCanGenerateFormat(i.glassContext,"CSV")?this.outputFormats=["CSV"]:this.showXML&&d.userCanGenerateFormat(i.glassContext,"XML")?this.outputFormats=["XML"]:this.outputFormats=["HTML"]),e.includes(this.outputFormats,"XLWA")&&(this.showUnsupported=!0)},getOutputFormats:function(){return this.outputFormats},render:function(){var e=i.simpleTemplate(r),s={schedule_done_btn:n.translate("schedule_delivery_done_label"),uniqueId:this.uniqueId,showHTML:this.showHTML,showPDF:this.showPDF,showExcel:this.showExcel,showCSV:this.showCSV,showXML:this.showXML,showUnsupported:this.showUnsupported};return this._popoverContent=e(s),this.$popoverContent=t(this._popoverContent),this._renderCheckBoxes(this.$popoverContent),this._updateFormatList(this.$popoverContent),this.hasPermission&&!this.hasPermission.write&&this.hasPermission.read&&this.$toggler.prop("disabled",!0),this._setEvents(),Promise.resolve(this)},_renderCheckBoxes:function(t){this.htmlCheckbox=new o({id:"output_html_checkbox_"+this.uniqueId,el:t.find(".html_format_option_"+this.uniqueId),name:"HTML",label:n.translate(this.formatLabels.HTML),ariaLabel:n.translate(this.formatLabels.HTML),svgIcon:"html_icon",checked:e.includes(this.outputFormats,"HTML"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.pdfCheckbox=new o({id:"output_pdf_checkbox_"+this.uniqueId,el:t.find(".pdf_format_option_"+this.uniqueId),name:"PDF",label:n.translate(this.formatLabels.PDF),ariaLabel:n.translate(this.formatLabels.PDF),svgIcon:"pdf_icon",checked:e.includes(this.outputFormats,"PDF"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.spreadsheetCheckbox=new o({id:"output_spreadsheet_checkbox_"+this.uniqueId,el:t.find(".spreadsheet_format_option_"+this.uniqueId),name:"spreadsheetML",label:n.translate(this.formatLabels.spreadsheetML),ariaLabel:n.translate(this.formatLabels.spreadsheetML),svgIcon:"excel_icon",checked:e.includes(this.outputFormats,"spreadsheetML"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.xlsxDataCheckbox=new o({id:"output_xlsxdata_checkbox_"+this.uniqueId,el:t.find(".xlsxdata_format_option_"+this.uniqueId),name:"xlsxData",label:n.translate(this.formatLabels.xlsxData),ariaLabel:n.translate(this.formatLabels.xlsxData),svgIcon:"excel_icon",checked:e.includes(this.outputFormats,"xlsxData"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.csvCheckbox=new o({id:"output_csv_checkbox_"+this.uniqueId,el:t.find(".csv_format_option_"+this.uniqueId),name:"CSV",label:n.translate(this.formatLabels.CSV),ariaLabel:n.translate(this.formatLabels.CSV),svgIcon:"csv_icon",checked:e.includes(this.outputFormats,"CSV"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.xmlCheckbox=new o({id:"output_xml_checkbox_"+this.uniqueId,el:t.find(".xml_format_option_"+this.uniqueId),name:"XML",label:n.translate(this.formatLabels.XML),ariaLabel:n.translate(this.formatLabels.XML),svgIcon:"xml_icon",checked:e.includes(this.outputFormats,"XML"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.unsupportedCheckbox=new o({id:"output_unsupported_checkbox_"+this.uniqueId,el:t.find(".unsupported_format_option_"+this.uniqueId),name:"XLWA",label:n.translate(this.formatLabels.XLWA),ariaLabel:n.translate(this.formatLabels.XLWA),svgIcon:"unsupportedformat_icon",checked:e.includes(this.outputFormats,"XLWA"),onChange:function(e,i){this._handleCheckBoxes(e,i,t)}.bind(this)}),this.showHTML&&this.htmlCheckbox.doRender(),this.showPDF&&this.pdfCheckbox.doRender(),this.showExcel&&(this.spreadsheetCheckbox.doRender(),this.xlsxDataCheckbox.doRender()),this.showCSV&&this.csvCheckbox.doRender(),this.showXML&&this.xmlCheckbox.doRender(),this.showUnsupported&&this.unsupportedCheckbox.doRender()},_handleCheckBoxes:function(e,t,i){this._updateOutputFormats(e),0===this.outputFormats.length&&(this.showHTML?this.htmlCheckbox.check():this.showPDF?this.pdfCheckbox.check():this.showExcel?this.spreadsheetCheckbox.check():this.showCSV?this.csvCheckbox.check():this.showXML?this.xmlCheckbox.check():console.error("No checkboxes shown, nothing to select.")),this._updateFormatList(i)},_setEvents:function(){this.$toggler.on("primaryaction",function(i){if(this.isVisible=!this.isVisible,e.includes(this.outputFormats,"XLWA")||(this.showUnsupported=!1),this.isVisible){var s=t(this._popoverContent);this._renderCheckBoxes(s),this.glassContext.appController.showSlideOut({parent:this.slideoutparent,overlay:this.overlay,
width:c,enableTabLooping:!0,label:n.translate("schedule_format_picker_name"),onHide:this._close(),content:{module:"bi/schedule/views/OptionsSlideoutView",content:s,title:n.translate("schedule_output_label")}})}}.bind(this)),this.hideHandler=function(e){var i=t(e.target),s=i.closest(".popover"),n=i.closest(".output_format_toggler");this.isVisible&&0===s.length&&0===n.length&&this._close()}.bind(this),t(document).on("clicktap",this.hideHandler)},_close:function(){this.isVisible=!1},_updateFormatList:function(e){if("object"==typeof e){this.$el.html("");for(var i=0;i<this.outputFormats.length;i++){var s=this.outputFormats[i],a=t("<div/>").addClass("subscription_link").html(n.translate(this.formatLabels[s]));t("<div/>").addClass("format_type_container").append("<span class='subscription_icon' data-icon='"+this.formatIcons[s]+"'></span>").append(a).appendTo(this.$el)}this._setActiveOutputSvg()}},_setActiveOutputSvg:function(){for(var e=this.$el.find(".subscription_icon"),i=this.$el.find(".subscription_link"),s=0;s<e.length;s++){var n=t(e[s]);a.setIcon(n,"common-"+n.data("icon")+"_icon",t(i[s]).html())}for(var r=0;r<i.length;r++)l.middleShortenString(i[r])},_updateOutputFormats:function(t){e.includes(this.outputFormats,t)?this._removeOutputFormats(t):e.includes(this.outputFormats,t)||this.outputFormats.push(t)},_removeOutputFormats:function(e){var t=this.outputFormats.indexOf(e);t>=0&&this.outputFormats.splice(t,1)},_initVariables:function(){this.$el={},this.$toggler={},this.isVisible=!1,this.showHTML=!0,this.showPDF=!0,this.showExcel=!0,this.showCSV=!0,this.showXML=!0,this.showUnsupported=!1,this.placement="left",this.outputFormats=[],this._popoverContent="",this.formatLabels={HTML:"schedule_format_web",PDF:"schedule_format_pdf",spreadsheetML:"schedule_format_xlsx",xlsxData:"schedule_format_xlsx_data",CSV:"schedule_format_csv",XML:"schedule_format_xml",XLWA:"schedule_format_unsupported"},this.formatIcons={HTML:"html",PDF:"pdf",spreadsheetML:"excel",xlsxData:"excel",CSV:"csv",XML:"xml",XLWA:"unsupportedformat"},this.uniqueId=e.uniqueId("id_")}});return h}),define("bi/schedule/utils/TextFormatter",["jquery"],function(e){"use strict";var t="...",i=5,s=15,n={};return n.middleShortenString=function(e,n,a){var l=e,n="number"!=typeof n?i:n,a="number"!=typeof a?s:a;return e.length>n+a&&(l=e.substring(0,n)+t+e.substring(e.length-a,e.length)),l},n.escapeSpecialCharacters=function(e,t){for(var i=t?t:["\\","/"],s="",n=0;n<e.length;n++){for(var a=0;a<i.length;a++)if(e.charAt(n)===i[a]){s+="\\";break}s+=e.charAt(n)}return s},n}),define("text!bi/schedule/templates/DeliveryPickerOptions.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n \n<div class="schedule_delivery_container propertyUIControl">\n	<div class="schedule_delivery_option">\n		<div id="delivery_email_container_{{=it.uniqueid}}"></div>\n		<div class="schedule_nested_delivery_option delivery_email_options">\n	    	<div id="delivery_attachment_container_{{=it.uniqueid}}"></div>\n	    </div>\n	    {{? it.advanced}}\n	    <div class="schedule_email_delivery_body delivery_advanced_content delivery_email_options">\n	      {{? it.allowRecipients}}\n	    	<div class="delivery_email_section delivery_input_section delivery_email_to_section">\n		        <div class="schedule_form_label schedule_delivery_header">\n		            <label for=\'delivery_email_recipients_edit_field_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_recipient_label}}</label>\n		            <button class="btn btn-link arrow rightArrow rightAlignArrow">\n		            	<span class="btn-hidden-label">{{=it.schedule_delivery_recipient_label}}</span>\n		            </button>\n		        </div>\n		        <div class="schedule_form_input schedule_delivery_input">\n		            <div id="delivery_email_recipients_{{=it.uniqueid}}" class="delivery_recipients_field" data-recipienttype="email">\n		            	<div class="delivery_recipients_edit_field">\n		            		<input id="delivery_email_recipients_edit_field_{{=it.uniqueid}}" class="delivery_recipients_edit_box">\n		            	</div>\n		            </div>\n		            <span class="delivery_ellipsis" id="delivery_email_ellipsis_{{=it.uniqueid}}">...</span>\n		        </div>\n	        </div>\n	        \n	        <div class="delivery_email_section delivery_input_section delivery_cc_section">\n		        <div class="schedule_form_label schedule_delivery_header">\n		            <label for=\'delivery_cc_recipients_edit_field_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_cc_label}}</label>\n		            <button class="btn btn-link arrow rightArrow rightAlignArrow">\n		            	<span class="btn-hidden-label">{{=it.schedule_delivery_cc_label}}</span>\n		            </button>\n		        </div>\n		        <div class="schedule_form_input schedule_delivery_input">\n		            <div id="delivery_cc_recipients_{{=it.uniqueid}}" class="delivery_recipients_field" data-recipienttype="cc">\n		            	<div class="delivery_recipients_edit_field">\n		            		<input id="delivery_cc_recipients_edit_field_{{=it.uniqueid}}" class="delivery_recipients_edit_box">\n		            	</div>\n		            </div>\n		            <span class="delivery_ellipsis" id="delivery_cc_ellipsis_{{=it.uniqueid}}">...</span>\n		        </div>\n	        </div>\n	        \n	        <div class="delivery_email_section delivery_input_section delivery_bcc_section">\n		        <div class="schedule_form_label schedule_delivery_header">\n		            <label for=\'delivery_bcc_recipients_edit_field_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_bcc_label}}</label>\n		            <button class="btn btn-link arrow rightArrow rightAlignArrow">\n		            	<span class="btn-hidden-label">{{=it.schedule_delivery_bcc_label}}</span>\n		            </button>\n		        </div>\n		        <div class="schedule_form_input schedule_delivery_input">\n		            <div id="delivery_bcc_recipients_{{=it.uniqueid}}" class="delivery_recipients_field" data-recipienttype="bcc">\n		            	<div class="delivery_recipients_edit_field">\n		            		<input id="delivery_bcc_recipients_edit_field_{{=it.uniqueid}}" class="delivery_recipients_edit_box">\n		            	</div>\n		            </div>\n		            <span class="delivery_ellipsis" id="delivery_bcc_ellipsis_{{=it.uniqueid}}">...</span>\n		        </div>\n	        </div>\n	        {{?}}\n	        \n	        <div class="delivery_email_section delivery_subject_section">\n		        <div class="schedule_form_label schedule_delivery_header">\n		            <label for=\'schedule_email_subject_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_subject_label}}</label>\n		        </div>\n		        <div class="schedule_form_input schedule_delivery_input">\n		            <input id="schedule_email_subject_{{=it.uniqueid}}" class="schedule_input_field delivery_subject_input" type="text" value="" />\n		        </div>\n	        </div>\n	\n		{{? it.allowRecipients}}\n		    <button class="delivery_email_copy_toggler delivery_cc_toggler">{{=it.schedule_delivery_cc_label}}</button>\n		    <button class="delivery_email_copy_toggler delivery_bcc_toggler">{{=it.schedule_delivery_bcc_label}}</button>\n		{{?}}\n	        \n			<form class="delivery_email_message_container">\n	        	<textarea name="delivery_email_message" id="delivery_email_message_{{=it.uniqueid}}"></textarea>\n	        </form>\n	    </div>\n	    {{?}}\n	    <div class="schedule_nested_delivery_option delivery_email_options">\n	    	<div id="delivery_link_container_{{=it.uniqueid}}"></div>\n	    </div>\n	</div>\n	<div class="schedule_delivery_option">\n		<div id="delivery_print_container_{{=it.uniqueid}}"></div>\n	    <div class="schedule_nested_delivery_option delivery_print_options">\n		    <div class="delivery_printer_label">{{=it.schedule_delivery_printer_name_label}}</div>\n	    	<select class="schedule_printer_names"></select>\n		    <div class="delivery_other_printer_section">\n		    	<input id="delivery_print_other_name_{{=it.uniqueid}}" class="schedule_input_field delivery_printer_input_field" type="text" value="" />\n		    </div>\n	    </div>\n	</div>\n        {{? it.showMobile }}\n	<div class="schedule_delivery_option">\n		<div id="delivery_mobile_container_{{=it.uniqueid}}"></div>\n	    {{? it.advanced && it.allowRecipients}}\n		<div class="schedule_form_space delivery_advanced_content delivery_mobile_options">\n			<div class="delivery_input_section delivery_mobile_to_section">\n		        <div class="schedule_form_label schedule_delivery_header">\n		            <label for=\'delivery_mobile_recipients_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_recipient_label}}</label>\n		            <button class="btn btn-link arrow rightArrow rightAlignArrow">\n		            	<span class="btn-hidden-label">{{=it.schedule_delivery_recipient_label}}</span>\n		            </button>\n		        </div>\n		        <div class="schedule_form_input schedule_delivery_input">\n		        	<div id="delivery_mobile_recipients_{{=it.uniqueid}}" class="delivery_recipients_field" data-recipienttype="mobile"></div>\n		        	<span class="delivery_ellipsis" id="delivery_mobile_ellipsis_{{=it.uniqueid}}">...</span>\n		        </div>\n	        </div>\n	    </div>\n		{{?}}\n	</div>\n	{{?}}\n	<div class="schedule_delivery_option">\n		<div id="delivery_saveTOS3_container_{{=it.uniqueid}}"></div>\n		<div class="schedule_nested_delivery_option delivery_print_options delivery_s3_options">\n			<div style=\'display: flex; flex-direction: column\'>\n				<label for=\'delivery_saveToS3_reportName_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_s3ReportName_label}}</label>\n				<input type=\'text\' id="delivery_saveToS3_reportName_{{=it.uniqueid}}"/> \n				\n				<label for=\'delivery_saveToS3_connectionName_{{=it.uniqueid}}\' class="schedule_label">{{=it.schedule_delivery_s3ConnectionName_label}}</label>\n				<select id=\'delivery_saveToS3_connectionName_{{=it.uniqueid}}\' class="schedule_save_to_file_system_connection_selection"></select>\n				\n				<!-- <div class="location-selction-section"> -->\n				<label for=\'delivery_saveToS3_locationName_{{=it.uniqueid}}\'  class="schedule_label location-selction-section-label location-selction-section">{{=it.schedule_delivery_s3LocationName_label}}</label>\n				<select id=\'delivery_saveToS3_locationName_{{=it.uniqueid}}\' class="saveToS3_location_selection location-selction-section-select location-selction-section"></select>\n				<!-- </div> -->\n			</div>	\n		</div>\n	</div>\n	<div class="schedule_delivery_option">\n		<div id="delivery_save_container_{{=it.uniqueid}}"></div>\n	</div>\n	\n    <!-- Delivery to save to file system -->\n    {{? it.showSaveToFileSystem }}\n    <div class="schedule_delivery_option">\n        <div id="delivery_save_to_file_system_checkbox_container_{{=it.uniqueid}}"></div>\n        <div class="schedule_nested_delivery_option delivery_save_to_file_system_options">\n            <div class="delivery_save_to_file_system_file_name_section">\n                <div class="delivery_name_label">{{=it.schedule_name_label}}</div>\n                <div class="delivery_save_to_file_system_file_name_input_section">\n                    <input id="delivery_save_to_file_system_file_name_{{=it.uniqueid}}" class="schedule_input_field delivery_save_to_file_system_input_field" type="text" value="" />\n                </div>\n            </div>\n            <div class="delivery_name_label">{{=it.schedule_delivery_location_label}}</div>\n            <select class="schedule_save_to_file_system_locations"></select>\n            <div id="schedule_delivery_conflict_resolution_section_{{=it.uniqueid}}" class="conflict_resolution_radio_group"></div>\n        </div>\n    </div>\n    {{?}}\n\n	<div class="new_schedule_panel_footer clearfix">\n		<div class="pull-right" role="region"aria-label="{{=it.schedule_controls_description}}">\n			<button class="new_schedule_panel_button schedule_primary_button">{{=it.schedule_done_btn}}</button>\n		</div>\n	</div>\n</div>\n'}),define("text!bi/schedule/templates/RecipientsList.html",[],function(){return'<!-- Licensed Materials - Property of IBM\n \n     IBM Cognos Products: SHARE\n \n     (C) Copyright IBM Corp. 2015, 2019\n \n   US Government Users Restricted Rights - Use, duplication or disclosure restricted by GSA ADP Schedule Contract with IBM Corp.\n-->\n{{~it.recipients :recipient:index}}\n<div class="delivery_recipient " id="{{=recipient.id}}">\n	<div class="delivery_recipient_label" title="{{!recipient.type}}">{{!recipient.defaultName}}</div>\n	<button class="btn btn-link delivery_icon delivery_delete_recipient_icon" data-icon="close-cancel-error" tabindex=0>\n		<span class="btn-hidden-label">{{=it.removeLabel}}</span>\n	</button>\n	<div class="delivery_recipient_underline" aria-label="{{=it.invalidLabel}}"/>\n</div>\n{{~}}\n'}),define("bi/schedule/views/DeliveryPickerView",["jquery","lodash","bi/sharecommon/utils/simpledoT","bi/commons/ui/View","bi/schedule/app/appControler","bi/sharecommon/utils/translator","bi/commons/utils/Utils","bi/commons/ui/properties/PropertyUIControl","bi/commons/utils/ContentFormatter","bi/schedule/utils/TextFormatter","text!bi/schedule/templates/DeliveryPickerOptions.html","text!bi/schedule/templates/RecipientsList.html","bi/commons/ui/properties/CheckBox","bootstrap","ckeditor","ckeditor/jquery"],function(e,t,i,s,n,a,l,r,o,d,c,h,u){"use strict";var _=500,p="<html><body></body></html>",m=s.extend({init:function(i,s){m.inherited("init",this,arguments),this.reportName="",this.isEditMode=!1,this.enableAdvancedSettings=!1,this.deliveryOptions={},this.overlay=!1,this.showMobile=!0,this.s3Connection="",this.showSaveToFileSystem=!0;var n=this._initS3Loc(i);if(this.s3SaveToCloud=n&&""!==n,this.s3SaveToCloud){this.s3Location=n.value;var l=this._initS3ReportName(i);l&&(this.s3ReportName=l.value)}if(this.canSave=!0,this._icons={email:"email",print:"print_icon",mobile:"mobile_icon",save:"save",archive:"saveExternal",saveToCloud:"saveExternal"},this._archiveLocations=[],void 0===i.reportName)throw"Error: report name parameter must be provided.";if(void 0===i.glassContext)throw"Error: glassContext parameter must be provided.";if(void 0===i.$toggler)throw"Error: $toggler parameter must be provided.";e.extend(this,i),this.notifyOnSave=!this.enableAdvancedSettings||!1,i.deliveryOptions&&i.deliveryOptions.save&&(this.notifyOnSave=i.deliveryOptions.save.notify),this.save={notify:this.notifyOnSave},this.print={name:""},this.archive={filenameStub:this.reportName,location:"",conflictResolution:"replace"},void 0===i.hasPermission&&(this.hasPermission={write:!0}),this.canSave=this.hasPermission.write||t.includes(this.hasPermission,"write")?!0:!1,(!i.deliveryOptions||e.isEmptyObject(i.deliveryOptions)&&!this._hasSaveToCloudOption())&&(this.canSave?this.deliveryOptions={save:{notify:this.notifyOnSave}}:this.deliveryOptions={print:{name:""}}),this.enableAdvancedSettings?(this.email={emailAsAttachment:!this.canSave,emailAsURL:this.canSave,subject:"",memoPart:"",to:[],bcc:[],cc:[]},this.mobile={to:[]}):(this.email={emailAsAttachment:!this.canSave,emailAsURL:this.canSave,subject:"",memoPart:""},this.mobile={}),this.isEditMode?this.isEditMode&&!this.enableAdvancedSettings&&(this.email.subject=a.translate("subscription_email_subject",{report_name:this.reportName}),this.email.memoPart=p,this.deliveryOptions.email&&(this.deliveryOptions.email.subject=a.translate("subscription_email_subject",{report_name:this.reportName}),this.deliveryOptions.email.memoPart=p)):(this.email.subject=a.translate("subscription_email_subject",{report_name:this.reportName}),this.enableAdvancedSettings||(this.email.memoPart=p))},_initS3Loc:function(e){if(e.deliveryOptions.saveToCloud){var i={value:e.deliveryOptions.cloudLocation};return i}return t.find(e.rawOptions,function(e){return"runOptionEnum#saveToCloud"===e.name})},_initS3ReportName:function(e){if(e.deliveryOptions.cloudName){var i={value:e.deliveryOptions.cloudName};return i}return t.find(e.rawOptions,function(e){return"runOptionEnum#cloudName"===e.name})},close:function(){e(document).removeData(["setemail","setmobile"])},render:function(){return Promise.resolve()},getDeliveryOptions:function(){if(this.deliveryOptions.email&&(this.emailCheckbox&&this.emailCheckbox.isChecked()&&this.attachmentCheckbox&&this.attachmentCheckbox.isChecked()&&"undefined"!=typeof this.deliveryOptions.email.memoPart&&this.deliveryOptions.email.memoPart===p&&delete this.deliveryOptions.email.memoPart,this.deliveryOptions.email.to&&this.deliveryOptions.email.to.length>0&&(this.deliveryOptions.email.to=this._cleanRecipientsArray(this.deliveryOptions.email.to.slice())),this.deliveryOptions.email.cc&&this.deliveryOptions.email.cc.length>0&&(this.deliveryOptions.email.cc=this._cleanRecipientsArray(this.deliveryOptions.email.cc.slice())),this.deliveryOptions.email.bcc&&this.deliveryOptions.email.bcc.length>0&&(this.deliveryOptions.email.bcc=this._cleanRecipientsArray(this.deliveryOptions.email.bcc.slice()))),this.deliveryOptions.mobile&&this.deliveryOptions.mobile.to&&this.deliveryOptions.mobile.to.length>0&&(this.deliveryOptions.mobile.to=this._cleanRecipientsArray(this.deliveryOptions.mobile.to.slice())),this._isSaveToCloudOptionsSelected()){var e=this.getCloudOptions();e.location&&(this.deliveryOptions.cloudLocation=e.location,e.cloudReportName&&(this.deliveryOptions.cloudName=e.cloudReportName))}else delete this.deliveryOptions.cloudLocation,delete this.deliveryOptions.cloudName;return this.deliveryOptions},getDeliveryContent:function(e){var s=i.simpleTemplate(c);"boolean"!=typeof e&&(e=!0),this.contentUniqueId=t.uniqueId("id_");var n={schedule_delivery_s3ReportName_label:a.translate("schedule_delivery_s3ReportName_label"),schedule_delivery_s3ConnectionName_label:a.translate("schedule_delivery_s3ConnectionName_label"),schedule_delivery_s3LocationName_label:a.translate("schedule_delivery_s3LocationName_label"),schedule_delivery_printer_name_label:a.translate("schedule_delivery_printer_name_label"),schedule_name_label:a.translate("schedule_name_label"),schedule_delivery_location_label:a.translate("schedule_delivery_location_label"),schedule_delivery_conflict_resolution_label:a.translate("schedule_delivery_conflict_resolution_label"),showSaveToFileSystem:this.showSaveToFileSystem,advanced:this.enableAdvancedSettings,schedule_delivery_recipient_label:a.translate("schedule_delivery_recipient_label"),schedule_delivery_subject_label:a.translate("schedule_delivery_subject_label"),schedule_delivery_cc_label:a.translate("schedule_delivery_cc_label"),schedule_delivery_bcc_label:a.translate("schedule_delivery_bcc_label"),schedule_done_btn:a.translate("schedule_delivery_done_label"),uniqueid:this.contentUniqueId,showMobile:this.showMobile,allowRecipients:e};return s(n)},setCloudEvents:function(e){var t=e.find("#delivery_saveToS3_reportName_"+this.contentUniqueId),i=this.getCloudOptions();i.cloudReportName?t.val(i.cloudReportName):i.reportName?t.val(i.reportName):t.val(this.reportName),t.on("change",function(){this.cloudReportName=t.val()}.bind(this))},_renderOptions:function(i,s){i.empty(),i.append(e("<option>",{value:"",text:""})),t.forEach(s,function(t){i.append(e("<option>",{value:t.id,text:t.defaultName}))})},_setS3ConnectionOptionsForUpdate:function(e){var t=this.s3Location;this.cloudLocation&&(t=this.cloudLocation),n.getS3LocationParentConnectionID(this.glassContext,t).then(function(i){if(i.data[0]&&i.data[0].parent[0]&&i.data[0].parent[0].id){var s=i.data[0].parent[0].id;n.getS3ConnectionDetails(this.glassContext).then(function(i){var a=e.find(".schedule_save_to_file_system_connection_selection"),l=e.find(".location-selction-section-select"),r=e.find(".location-selction-section");this._renderOptions(a,i.data),a.val(s),this._handleConnectionChange(a,l,r,e),n.getS3LocationsDetails(this.glassContext,s).then(function(e){this._renderOptions(l,e.data),l.val(t),this._handleLocationChange(l)}.bind(this))}.bind(this))}}.bind(this))},_handleConnectionChange:function(e,t,i,s){e.change(function(){i.hide(),this.cloudConnection=e.val(),t.val(""),t.empty(),n.getS3LocationsDetails(this.glassContext,e.val()).then(function(e){this._renderOptions(t,e.data),i.show(),this._handleLocationChange(t)}.bind(this))}.bind(this))},_handleLocationChange:function(e){e.change(function(){this.cloudLocation=e.val()}.bind(this))},_setS3ConnectionOptions:function(e){return n.getS3ConnectionDetails(this.glassContext).then(function(t){var i=e.find(".schedule_save_to_file_system_connection_selection"),s=e.find(".location-selction-section-select"),n=e.find(".location-selction-section");n.hide(),this._handleConnectionChange(i,s,n,e),this._handleLocationChange(s),this._renderOptions(i,t.data)}.bind(this))},setDeliveryOptions:function(e,t){return n.getArchiveLocations(this.glassContext).then(function(i){i&&i.data&&i.data.length>0?this._archiveLocations=i.data:this.showSaveToFileSystem=!1,this._renderCheckBoxes(e,t),this.setCloudEvents(e),this._isSaveToCloudOptionsSelected()&&e.find(".delivery_s3_options").show(_),this.showSaveToFileSystem&&this._renderRadioButtonGroup(e),t&&this.updateActiveDeliveryList(t)}.bind(this))},getCloudOptions:function(){var e={};return this.cloudLocation&&""!==this.cloudLocation?(e.location=this.cloudLocation,this.cloudReportName&&""!==this.cloudReportName&&(e.reportName=this.cloudReportName,e.cloudReportName=this.cloudReportName)):this.s3Location&&""!==this.s3Location&&(e.location=this.s3Location,this.cloudReportName&&""!==this.cloudReportName?(e.reportName=this.cloudReportName,e.cloudReportName=this.cloudReportName):this.s3ReportName&&""!==this.s3ReportName&&(e.reportName=this.s3ReportName,e.cloudReportName=this.cloudReportName)),e},_isSaveToCloudOptionsSelected:function(){return this.s3SaveToCloud||this.cloudLocation||this.s3Location?!0:!1},_renderCheckBoxes:function(e,i){var s=!1,n=!1,l=!1,r=!1,o=!1,d=!1,c=!1;this.deliveryOptions.save&&(d=!0),(this.s3SaveToCloud||this.cloudLocation)&&this._setS3ConnectionOptionsForUpdate(e),this.deliveryOptions.email?(s=!0,e.find(".delivery_email_options").show(),this.deliveryOptions.email.emailAsAttachment?(this.email.emailAsAttachment=!0,n=!0):this.email.emailAsAttachment=!1,this.deliveryOptions.email.emailAsURL?(this.email.emailAsURL=!0,l=!0,d=!0):this.email.emailAsURL=!1,this.enableAdvancedSettings&&this.setAdvancedEmailStoredContent(e)):e.find(".delivery_email_options").hide(),this.deliveryOptions.mobile?(o=!0,e.find(".delivery_mobile_options").show(),this.enableAdvancedSettings&&this.setAdvancedMobileStoredContent(e)):e.find(".delivery_mobile_options").hide(),this.deliveryOptions.print?(r=!0,this._setPrinters(e),e.find(".delivery_print_options").show()):e.find(".delivery_print_options").hide(),this.deliveryOptions.archive?(c=!0,this.archive.conflictResolution=this.deliveryOptions.archive.conflictResolution,this._setSaveToFileSystemValues(e),e.find(".delivery_save_to_file_system_options").show()):e.find(".delivery_save_to_file_system_options").hide(),this.emailCheckbox=new u({id:"delivery_email_checkbox_"+this.contentUniqueId,el:e.find("#delivery_email_container_"+this.contentUniqueId),name:"delivery_email_option",label:a.translate("schedule_delivery_email_label"),ariaLabel:a.translate("schedule_delivery_email_label"),svgIcon:"email",checked:s,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this.attachmentCheckbox=new u({id:"delivery_attachment_checkbox_"+this.contentUniqueId,el:e.find("#delivery_attachment_container_"+this.contentUniqueId),name:"delivery_attachment_option",label:a.translate("schedule_delivery_attach_label"),ariaLabel:a.translate("schedule_delivery_attach_label"),checked:n,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this.printCheckbox=new u({id:"delivery_print_checkbox_"+this.contentUniqueId,el:e.find("#delivery_print_container_"+this.contentUniqueId),name:"delivery_print_option",label:a.translate("schedule_delivery_print_label"),ariaLabel:a.translate("schedule_delivery_print_label"),svgIcon:"print_icon",checked:r,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this.mobileCheckbox=new u({id:"delivery_mobile_checkbox_"+this.contentUniqueId,el:e.find("#delivery_mobile_container_"+this.contentUniqueId),name:"delivery_mobile_option",label:a.translate("schedule_delivery_mobile_label"),ariaLabel:a.translate("schedule_delivery_mobile_label"),svgIcon:"mobile_icon",checked:o,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this.saveToFSCheckbox=new u({id:"delivery_save_to_file_system_checkbox_container_"+this.contentUniqueId,el:e.find("#delivery_save_to_file_system_checkbox_container_"+this.contentUniqueId),name:"delivery_save_to_file_system_options",label:a.translate("schedule_delivery_save_to_file_system_label"),ariaLabel:a.translate("schedule_delivery_save_to_file_system_label"),svgIcon:"saveExternal",checked:c,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),(this.hasPermission.write||t.includes(this.hasPermission,"write"))&&(this.linkCheckbox=new u({id:"delivery_link_checkbox_"+this.contentUniqueId,el:e.find("#delivery_link_container_"+this.contentUniqueId),name:"delivery_link_option",label:a.translate("schedule_delivery_link_label"),ariaLabel:a.translate("schedule_delivery_link_label"),checked:l,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this.saveTOS3Checkbox=new u({id:"delivery_saveTOS3_checkbox_"+this.contentUniqueId,el:e.find("#delivery_saveTOS3_container_"+this.contentUniqueId),name:"delivery_saveTOS3_option",label:a.translate("saveToCloud"),ariaLabel:a.translate("schedule_delivery_save_label"),svgIcon:"saveExternal",checked:this._isSaveToCloudOptionsSelected(),onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this.saveCheckbox=new u({id:"delivery_save_checkbox_"+this.contentUniqueId,el:e.find("#delivery_save_container_"+this.contentUniqueId),name:"delivery_save_option",label:a.translate("schedule_delivery_save_label"),ariaLabel:a.translate("schedule_delivery_save_label"),svgIcon:"save",checked:d,onChange:function(t,s){this._handleCheckBoxes(t,s,e,i)}.bind(this)}),this._checkCapabilities("canIncludeLinkInEmail")&&this.linkCheckbox.doRender(),this.saveTOS3Checkbox.doRender(),this.saveCheckbox.doRender()),this.showSaveToFileSystem&&this.saveToFSCheckbox.doRender(),this._checkCapabilities("canEmail")&&this.emailCheckbox.doRender(),this._checkCapabilities("canAttach")&&this.attachmentCheckbox.doRender(),this.printCheckbox.doRender(),this.mobileCheckbox.doRender()},_checkCapabilities:function(e){return t.find(this.glassContext.services.userProfile.capabilities,function(t){return t===e})},_handleCheckBoxes:function(i,s,n,l){switch(i){case"delivery_saveTOS3_option":s?(this._setS3ConnectionOptions(n),this.deliveryOptions.saveToCloud=!0,n.find(".delivery_s3_options").show(_)):(n.find(".delivery_s3_options").hide(_),delete this.deliveryOptions.saveToCloud,delete this.deliveryOptions.cloudLocation,this.rawOptions=t.filter(this.rawOptions,function(e){return!("runOptionEnum#saveToCloud"===e.name||"runOptionEnum#cloudName"===e.name)}),delete this.s3SaveToCloud,delete this.s3Location,delete this.cloudConnection,delete this.cloudLocation);break;case"delivery_attachment_option":this.deliveryOptions.email&&(s?(this.email.emailAsAttachment=!0,this.deliveryOptions.email=this.email):(this.email.emailAsAttachment=!1,this.deliveryOptions.email=this.email));break;case"delivery_link_option":this.deliveryOptions.email&&(s?(this.email.emailAsURL=!0,this.deliveryOptions.email=this.email,this.deliveryOptions.save||(this.saveCheckbox.check(),this.glassContext.appController.showToast(a.translate("schedule_delivery_email_save_info_label"),{type:"info",preventDuplicates:!0}))):(this.email.emailAsURL=!1,this.deliveryOptions.email=this.email));break;case"delivery_email_option":s?(this.deliveryOptions.email=this.email,this.deliveryOptions.email.emailAsAttachment?this.attachmentCheckbox.check():this.attachmentCheckbox.uncheck(),this.linkCheckbox&&(this.deliveryOptions.email.emailAsURL?this.linkCheckbox.check():this.linkCheckbox.uncheck()),n.find(".delivery_email_options").show(_),this.enableAdvancedSettings&&this.setAdvancedEmailStoredContent(n)):(delete this.deliveryOptions.email,this.email.to=[],n.find("#delivery_email_recipients_"+this.contentUniqueId+" .delivery_recipient").remove(),n.find(".delivery_email_options").hide(_));break;case"delivery_save_option":s?this.deliveryOptions.save=this.save:this.deliveryOptions.email&&this.deliveryOptions.email.emailAsURL?(this.saveCheckbox.check(),this.glassContext.appController.showToast(a.translate("schedule_delivery_email_save_info_label"),{type:"info",preventDuplicates:!0})):delete this.deliveryOptions.save;break;case"delivery_mobile_option":s?(this.deliveryOptions.mobile=this.mobile,n.find(".delivery_mobile_options").show(_),this.enableAdvancedSettings&&this.setAdvancedMobileStoredContent(n)):(delete this.deliveryOptions.mobile,n.find(".delivery_mobile_options").hide(_));break;case"delivery_print_option":s?(n.find(".delivery_print_options").show(_),this._setPrinters(n,l)):(delete this.deliveryOptions.print,n.find(".delivery_print_options").hide(_));break;case"delivery_save_to_file_system_options":s?(n.find(".delivery_save_to_file_system_options").show(_),this._setSaveToFileSystemValues(n,l)):(delete this.deliveryOptions.archive,n.find(".delivery_save_to_file_system_options").hide(_))}e.isEmptyObject(this.deliveryOptions)&&!this._isSaveToCloudOptionsSelected()&&(this.hasPermission.write||t.includes(this.hasPermission,"write")?this.saveCheckbox.check():this.printCheckbox.check(),this.glassContext.appController.showToast(a.translate("schedule_delivery_min_select_label"),{type:"info",preventDuplicates:!0})),l&&this.updateActiveDeliveryList(l)},_hasSaveToCloudOption:function(){if(this.deliveryOptions.saveToCloud)return!0;var e=t.find(this.rawOptions,function(e){return"runOptionEnum#saveToCloud"===e.name?!0:void 0});return e?!0:!1},_setPrinters:function(e,t){var i=e.find(".schedule_printer_names:not(.clickBound)");i.addClass("clickBound");var s=e.find("#delivery_print_other_name_"+this.contentUniqueId+":not(.clickBound)");s.addClass("clickBound"),i.change(function(){var s=i.val();s===a.translate("schedule_delivery_printer_other_label")?e.find(".delivery_other_printer_section").show(_):(e.find(".delivery_other_printer_section").hide(_),this._updatePrintDeliveryOption(s,t))}.bind(this)),s.on("change",function(e){this._updatePrintDeliveryOption(e.target.value,t)}.bind(this)),i.length?n.getPrinters(this.glassContext).then(function(n){var a=[];n&&n.data&&(a=n.data),this._setPrinterSelectionValues(a,i,s,e,t)}.bind(this)):this.deliveryOptions.print=this.print},_setPrinterSelectionValues:function(t,i,s,n,l){var r="";this.deliveryOptions&&this.deliveryOptions.print&&this.deliveryOptions.print.name&&(r=this.deliveryOptions.print.name);for(var o=0;o<t.length;o++){var c=d.middleShortenString(t[o].defaultName),h=t[o].defaultScreenTip?t[o].defaultScreenTip:t[o].defaultDescription?t[o].defaultDescription:t[o].printerAddress;i.append(e("<option>",{value:t[o].printerAddress,title:h}).text(c))}i.append(e("<option>",{value:a.translate("schedule_delivery_printer_other_label")}).text(a.translate("schedule_delivery_printer_other_label"))),t.length>0&&n.find(".delivery_other_printer_section").hide(),r?this._setDropDownValueToPresetPrinter(r,i,s,n,l):this._setDefaultDeliveryPrintOption(t,s,l)},_setDropDownValueToPresetPrinter:function(e,t,i,s,n){var l=d.escapeSpecialCharacters(e);t.find("option[value='"+l+"']").length>0?(t.val(e),s.find(".delivery_other_printer_section").hide()):(t.val(a.translate("schedule_delivery_printer_other_label")),
s.find(".delivery_other_printer_section").show(_),i.val(e)),this._updatePrintDeliveryOption(e,n)},_setDefaultDeliveryPrintOption:function(e,t,i){var s;s=e&&e.length>0?e[0].printerAddress:t.val(),this._updatePrintDeliveryOption(s,i)},_updatePrintDeliveryOption:function(e,t){this.print.name=e,this.deliveryOptions.print=this.print,t&&this.updateActiveDeliveryList(t)},_setSaveToFileSystemValues:function(i,s){var n=i.find("#delivery_save_to_file_system_file_name_"+this.contentUniqueId+":not(.clickBound)");n.addClass("clickBound"),this.deliveryOptions&&this.deliveryOptions.archive&&this.deliveryOptions.archive.filenameStub?this.archive.filenameStub=this.deliveryOptions.archive.filenameStub:this.archive.filenameStub=this.reportName,n.val(this.archive.filenameStub);var a=i.find(".delivery_save_to_file_system_file_name_input_section");o.middleShortenString(a);var l=i.find(".schedule_save_to_file_system_locations:not(.clickBound)");l.addClass("clickBound"),this._archiveLocations=t.sortBy(this._archiveLocations,"defaultName");for(var r=0;r<this._archiveLocations.length;r++){var c=d.middleShortenString(this._archiveLocations[r].defaultName);l.append(e("<option>",{value:this._archiveLocations[r].defaultName,title:this._archiveLocations[r].defaultName}).text(c))}if(this.deliveryOptions&&this.deliveryOptions.archive&&this.deliveryOptions.archive.location){this.archive.location=this.deliveryOptions.archive.location;var h=this._getDisplayNameFromStoreIDOrSearchPath(this.archive.location);l.val(h)}else this.archive.location=this._archiveLocations[0].searchPath;l.change(function(){var e=l.val(),t=this._getSearchPathForLocation(e);this.archive.location=t,this.deliveryOptions.archive.location=this.archive.location,s&&this.updateActiveDeliveryList(s)}.bind(this)),n.on("change",function(e){this.archive.filenameStub=e.target.value,this.deliveryOptions.archive.filenameStub=this.archive.filenameStub,s&&this.updateActiveDeliveryList(s)}.bind(this)),this._archiveLocations.length>0&&""===this.archive.location&&(this.archive.location=this._archiveLocations[0].searchPath),this.deliveryOptions.archive=this.archive,s&&this.updateActiveDeliveryList(s)},_getSearchPathForLocation:function(e){var i=t.find(this._archiveLocations,function(t){return t.defaultName===e}.bind(this));return i?i.searchPath:""},_getDisplayNameFromStoreIDOrSearchPath:function(e){var i=t.find(this._archiveLocations,function(t){return-1!==e.indexOf(t.id)||e===t.searchPath}.bind(this));return i?i.defaultName:""},_renderRadioButtonGroup:function(e){var t=[this._getConflictResolutionContainer(e)];return this._conflictResolutionOptionsControl=new r({el:e.find("#schedule_delivery_conflict_resolution_section_"+this.contentUniqueId),items:t,glassContext:this.glassContext}),this._conflictResolutionOptionsControl.render().then(function(){this._conflictResolutionOptionsControl=this._conflictResolutionOptionsControl.getProperty("conflictResolutionOptions")}.bind(this))},_getConflictResolutionContainer:function(e){return{type:"CollapsibleSection",name:"conflictResolutionOptions",styleAsSimpleRow:!0,label:a.translate("schedule_delivery_conflict_resolution_label"),items:[this._getConflictResolutionOptions(e)]}},_getConflictResolutionOptions:function(){var e=[];return e.push({name:"fail",label:a.translate("schedule_delivery_keep_existing_label"),id:"delivery_keep_"+this.contentUniqueId,value:"fail"}),e.push({name:"replace",label:a.translate("schedule_delivery_replace_label"),id:"delivery_replace_"+this.contentUniqueId,value:"replace"}),e.push({name:"appendDateTime",label:a.translate("schedule_delivery_timestamp_label"),id:"delivery_timestamp_"+this.contentUniqueId,value:"appendDateTime"}),e.push({name:"appendSequenceNumber",label:a.translate("schedule_delivery_version_number_label"),id:"delivery_version_number_"+this.contentUniqueId,value:"appendSequenceNumber"}),{type:"RadioButtonGroup",name:"delivery_conflict_resolution_pick",ariaLabel:a.translate("schedule_delivery_conflict_resolution_label"),value:this.archive.conflictResolution,separator:!1,onChange:this._updateConflictResolutionValue.bind(this),items:e}},_updateConflictResolutionValue:function(e,t){this.archive.conflictResolution=t},updateActiveDeliveryList:function(t){if(this.deliveryOptions){t.html("");for(var i in this.deliveryOptions)if("cloudLocation"!==i){var s=e("<div/>").addClass("delivery_link").text(a.translate("schedule_delivery_"+i+"_short_label"));e("<div/>").addClass("delivery_type_container").append("<span class='delivery_icon' data-icon='"+this._icons[i]+"'></span>").append(s).appendTo(t)}if(this._hasSaveToCloudOption()&&!this.deliveryOptions.saveToCloud&&0===this.$el.find(".delivery_type_container.saveToCloud").length){var s=e("<div/>").addClass("delivery_link").text(a.translate("schedule_delivery_saveToCloud_short_label"));e("<div/>").addClass("delivery_type_container saveToCloud").append("<span class='delivery_icon' data-icon='"+this._icons.saveToCloud+"'></span>").append(s).appendTo(t)}this.setIcons(t),this.shortenLinks(t)}},setIcons:function(t){for(var i=t.find(".delivery_icon"),s=t.find(".delivery_link"),n=0;n<i.length;n++){var a=e(i[n]),r=e(s[n]);l.setIcon(a,"common-"+a.data("icon"),r.html())}},shortenLinks:function(e){for(var t=e.find(".delivery_link"),i=0;i<t.length;i++)o.middleShortenString(t[i])},setAdvancedMobileStoredContent:function(t){var i=t.find("#delivery_mobile_recipients_"+this.contentUniqueId),s=t.find(".delivery_mobile_to_section:not(.clickBound)");s.addClass("clickBound"),s.on("clicktap",function(){this.glassContext.appController.showSlideOut({position:"right",overlay:!0,parent:this.slideout,width:this.slideout.width,label:a.translate("schedule_delivery_accounts_aria_label"),content:{module:"bi/schedule/views/AccountPickerSlideoutView",glassContext:this.glassContext,addCallback:function(e){var i=Object.keys(e).map(function(t){return e[t]});return this._addMobileRecipients(i,t,!0),Promise.resolve()}.bind(this)}})}.bind(this));var n=t.find("#delivery_mobile_ellipsis_"+this.contentUniqueId+":not(.clickBound)");n.addClass("clickBound"),n.on("clicktap",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),i.addClass("expanded"),n.hide()}.bind(this)),this.deliveryOptions&&this.deliveryOptions.mobile&&this.deliveryOptions.mobile.to&&e.isArray(this.deliveryOptions.mobile.to)&&0!==this.deliveryOptions.mobile.to.length&&this._addMobileRecipients(this.deliveryOptions.mobile.to,t,!1);var l=t.find('label[for="delivery_mobile_recipients_'+this.contentUniqueId+'"]');e(document).data("setmobile")||e(document).data("setmobile",!0).on("clicktap",function(e){s.is(e.target)||0!==s.has(e.target).length||(i.removeClass("expanded"),this._checkForEllipsis(i,l,function(e){e?n.show(_):n.hide(_)}.bind(this)))}.bind(this))},setAdvancedEmailStoredContent:function(i){var s=i.find("#schedule_email_subject_"+this.contentUniqueId);this.deliveryOptions.email.subject?(s.val(this.deliveryOptions.email.subject),this.email.subject=s.val()):this.email.subject&&s.val(this.email.subject),s.on("change",function(e){this.deliveryOptions.email.subject=e.target.value,this.email.subject=e.target.value}.bind(this));var n=i.find("#delivery_email_message_"+this.contentUniqueId),l=n.ckeditor({customConfig:"../../../js/schedule/utils/cke_editor_delivery_config.js"}).editor;l.config&&l.config.language&&(l.config.language=this.glassContext.services.userProfile.preferences.productLocale),this._setEditorDialogHideHandler(),this.deliveryOptions.email.memoPart?(l.setData(this.deliveryOptions.email.memoPart),this.email.memoPart=l.getData()):this.email.memoPart?l.setData(this.email.memoPart):(this.deliveryOptions.email.memoPart=p,this.email.memoPart=p),l.on("change",function(e){this.deliveryOptions.email.memoPart="<html><body>"+e.editor.getData()+"</body></html>",this.email.memoPart="<html><body>"+e.editor.getData()+"</body></html>"}.bind(this));var r=i.find("#delivery_email_recipients_"+this.contentUniqueId),o=i.find("#delivery_cc_recipients_"+this.contentUniqueId),d=i.find("#delivery_bcc_recipients_"+this.contentUniqueId),c=i.find(".delivery_email_to_section"),h=c.find(".schedule_delivery_header:not(.clickBound)");h.addClass("clickBound"),h.on("clicktap",function(){this.glassContext.appController.showSlideOut({position:"right",overlay:!0,parent:this.slideout,width:this.slideout.width,label:a.translate("schedule_delivery_accounts_aria_label"),content:{module:"bi/schedule/views/AccountPickerSlideoutView",glassContext:this.glassContext,addCallback:function(e){var t=Object.keys(e).map(function(t){return e[t]});return this._addEmailRecipients(t,i,!0),Promise.resolve()}.bind(this)}})}.bind(this)),this._handleRecipientEdit(i,r,this._addEmailAddress.bind(this)),this._handleRecipientEdit(i,o,this._addCCEmailAddress.bind(this)),this._handleRecipientEdit(i,d,this._addBCCEmailAddress.bind(this));var u=i.find("#delivery_email_ellipsis_"+this.contentUniqueId+":not(.clickBound)");if(u.addClass("clickBound"),u.on("clicktap",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),r.addClass("expanded"),u.hide()}.bind(this)),this.deliveryOptions&&this.deliveryOptions.email&&this.deliveryOptions.email.to&&e.isArray(this.deliveryOptions.email.to))if(0!==this.deliveryOptions.email.to.length)this._addEmailRecipients(this.deliveryOptions.email.to,i,!1);else if(this.glassContext.profile.account&&this.glassContext.profile.account.defaultName&&this.glassContext.profile.account.email){var m=[{defaultName:this.glassContext.profile.account.defaultName,address:this.glassContext.profile.account.email,type:a.translate("currentUser"),id:t.uniqueId("recipientId_")}];this._addEmailRecipients(m,i)}var v=i.find(".delivery_cc_section"),b=v.find(".schedule_delivery_header:not(.clickBound)");b.addClass("clickBound"),b.on("clicktap",function(){this.glassContext.appController.showSlideOut({position:"right",overlay:!0,parent:this.slideout,width:this.slideout.width,label:a.translate("schedule_delivery_accounts_aria_label"),content:{module:"bi/schedule/views/AccountPickerSlideoutView",glassContext:this.glassContext,addCallback:function(e){var t=Object.keys(e).map(function(t){return e[t]});return this._addCCRecipients(t,i,!0),Promise.resolve()}.bind(this)}})}.bind(this));var y=i.find("#delivery_cc_ellipsis_"+this.contentUniqueId+":not(.clickBound)");y.addClass("clickBound"),y.on("clicktap",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),o.addClass("expanded"),y.hide()}.bind(this));var f=i.find(".delivery_cc_toggler:not(.clickBound)");f.addClass("clickBound"),f.on("clicktap",function(){f.hide(),i.find(".delivery_cc_section").show(_)}.bind(this)),this.deliveryOptions&&this.deliveryOptions.email&&this.deliveryOptions.email.cc&&e.isArray(this.deliveryOptions.email.cc)?0===this.deliveryOptions.email.cc.length?v.hide():(f.hide(),this._addCCRecipients(this.deliveryOptions.email.cc,i,!1)):v.hide();var g=i.find(".delivery_bcc_section"),w=g.find(".schedule_delivery_header:not(.clickBound)");w.addClass("clickBound"),w.on("clicktap",function(){this.glassContext.appController.showSlideOut({position:"right",overlay:!0,parent:this.slideout,width:this.slideout.width,label:a.translate("schedule_delivery_accounts_aria_label"),content:{module:"bi/schedule/views/AccountPickerSlideoutView",glassContext:this.glassContext,addCallback:function(e){var t=Object.keys(e).map(function(t){return e[t]});return this._addBCCRecipients(t,i,!0),Promise.resolve()}.bind(this)}})}.bind(this));var k=i.find("#delivery_bcc_ellipsis_"+this.contentUniqueId+":not(.clickBound)");k.addClass("clickBound"),k.on("clicktap",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),d.addClass("expanded"),k.hide()}.bind(this));var C=i.find(".delivery_bcc_toggler:not(.clickBound)");C.addClass("clickBound"),C.on("clicktap",function(){C.hide(),i.find(".delivery_bcc_section").show(_)}.bind(this)),this.deliveryOptions&&this.deliveryOptions.email&&this.deliveryOptions.email.bcc&&e.isArray(this.deliveryOptions.email.bcc)?0===this.deliveryOptions.email.bcc.length?g.hide():(C.hide(),this._addBCCRecipients(this.deliveryOptions.email.bcc,i,!1)):g.hide();var I=i.find('label[for="delivery_email_recipients_edit_field_'+this.contentUniqueId+'"]'),S=i.find('label[for="delivery_cc_recipients_edit_field_'+this.contentUniqueId+'"]'),x=i.find('label[for="delivery_bcc_recipients_edit_field_'+this.contentUniqueId+'"]');e(document).data("setemail")||e(document).data("setemail",!0).on("clicktap",function(e){c.is(e.target)||0!==c.has(e.target).length||(r.removeClass("expanded"),this._checkForEllipsis(r,I,function(e){e?u.show(_):u.hide(_)}.bind(this))),v.is(e.target)||0!==v.has(e.target).length||(o.removeClass("expanded"),this._checkForEllipsis(o,S,function(e){e?y.show(_):y.hide(_)}.bind(this))),g.is(e.target)||0!==g.has(e.target).length||(d.removeClass("expanded"),this._checkForEllipsis(d,x,function(e){e?k.show(_):k.hide(_)}.bind(this)))}.bind(this))},_validateEmail:function(e){var t=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~])*@[a-zA-Z](-?[a-zA-Z0-9])*(\.[a-zA-Z](-?[a-zA-Z0-9])*)+$/;return e.match(t)},_handleRecipientEdit:function(e,i,s){var n=i.find(".delivery_recipients_edit_box");n.on("keydown",function(t){var a=t.keyCode||t.which;if(t.target.value.length>0)(9==a||13==a||188==a||186==a)&&(s(t.target.value,e,i),n.val(""),t.preventDefault());else if(8==a){var l=i.find(".delivery_recipient:last");0!==l.length&&this._removeRecipient(e,l),t.preventDefault()}}.bind(this)),n.on("paste",function(a){setTimeout(function(){var l=this._checkForMultipleEmails(a.target.value);t.forEach(l,function(t){s(t,e,i)}),n.val("")}.bind(this),0)}.bind(this)),n.on("focusout",function(t){t.target.value.length>0&&(s(t.target.value,e,i),n.val(""))}.bind(this)),n.on("clicktap",function(e){return e.preventDefault(),!1}.bind(this))},_checkForMultipleEmails:function(e){var t=e.split(/,|;/);return t},_addAddress:function(s,n,l){var r=[{defaultName:s,address:s,type:s,id:t.uniqueId("recipientId_")}],o={recipients:r,removeLabel:a.translate("schdeule_delivery_remove_recipient_label"),invalidLabel:a.translate("schedule_delivery_invalid_address")},d=i.simpleTemplate(h),c=e(d(o));if(this._validateEmail(s)?c.find(".delivery_recipient_underline").hide():c.find(".delivery_recipient_underline").show(),l.find(".delivery_recipients_edit_field").before(c),!l.hasClass("expanded")){var u=n.find('label[for="'+l.id+'"]');l.prop("scrollHeight")>1.25*u.height()&&l.addClass("expanded")}return this.setIcons(c),r},_addEmailAddress:function(e,t,i){var s=this._addAddress(e,t,i);this.email.to=this.email.to.slice().concat(s),this._updateEmailRecipients(t),this._setRecipientsListEvents(t)},_addCCEmailAddress:function(e,t,i){var s=this._addAddress(e,t,i);this.email.cc=this.email.cc.slice().concat(s),this._updateCCRecipients(t),this._setRecipientsListEvents(t)},_addBCCEmailAddress:function(e,t,i){var s=this._addAddress(e,t,i);this.email.bcc=this.email.bcc.slice().concat(s),this._updateBCCRecipients(t),this._setRecipientsListEvents(t)},_addEmailRecipients:function(s,n,l){var r,o=[];l?r=this._verifyNewRecipients(s,this.email.to.slice())||[]:(this.email.to=[],r=s||[]);for(var d=0;d<r.length;d++)o.push({defaultName:r[d].defaultName||"",address:r[d].searchPath||r[d].address||"",type:r[d].type?a.translate(r[d].type):r[d].address?r[d].address:"",id:t.uniqueId("recipientId_")});var c={recipients:o,removeLabel:a.translate("schdeule_delivery_remove_recipient_label"),invalidLabel:a.translate("schedule_delivery_invalid_address")},u=i.simpleTemplate(h),_=e(u(c));n.find("#delivery_email_recipients_"+this.contentUniqueId+" .delivery_recipients_edit_field").before(_),this.email.to=this.email.to.slice().concat(o),this._updateEmailRecipients(n),l&&(1===o.length?this.glassContext.appController.showToast(a.translate("schedule_delivery_single_recipient_added")):o.length>1&&this.glassContext.appController.showToast(a.translate("schedule_delivery_multiple_recipient_added",{recipient_count:o.length}))),this.setIcons(_),this._setRecipientsListEvents(n)},_addCCRecipients:function(s,n,l){var r,o=[];l?r=this._verifyNewRecipients(s,this.email.cc.slice())||[]:(this.email.cc=[],r=s||[]);for(var d=0;d<r.length;d++)o.push({defaultName:r[d].defaultName||"",address:r[d].searchPath||r[d].address||"",type:r[d].type?a.translate(r[d].type):r[d].address?r[d].address:"",id:t.uniqueId("recipientId_")});var c={recipients:o,removeLabel:a.translate("schdeule_delivery_remove_recipient_label"),invalidLabel:a.translate("schedule_delivery_invalid_address")},u=i.simpleTemplate(h),_=e(u(c));n.find("#delivery_cc_recipients_"+this.contentUniqueId+" .delivery_recipients_edit_field").before(_),this.email.cc=this.email.cc.slice().concat(o),this._updateCCRecipients(n),l&&(1===o.length?this.glassContext.appController.showToast(a.translate("schedule_delivery_single_recipient_added")):o.length>1&&this.glassContext.appController.showToast(a.translate("schedule_delivery_multiple_recipient_added",{recipient_count:o.length}))),this.setIcons(_),this._setRecipientsListEvents(n)},_addBCCRecipients:function(s,n,l){var r,o=[];l?r=this._verifyNewRecipients(s,this.email.bcc.slice())||[]:(this.email.bcc=[],r=s||[]);for(var d=0;d<r.length;d++)o.push({defaultName:r[d].defaultName||"",address:r[d].searchPath||r[d].address||"",type:r[d].type?a.translate(r[d].type):r[d].address?r[d].address:"",id:t.uniqueId("recipientId_")});var c={recipients:o,removeLabel:a.translate("schdeule_delivery_remove_recipient_label"),invalidLabel:a.translate("schedule_delivery_invalid_address")},u=i.simpleTemplate(h),_=e(u(c));n.find("#delivery_bcc_recipients_"+this.contentUniqueId+" .delivery_recipients_edit_field").before(_),this.email.bcc=this.email.bcc.slice().concat(o),this._updateBCCRecipients(n),l&&(1===o.length?this.glassContext.appController.showToast(a.translate("schedule_delivery_single_recipient_added")):o.length>1&&this.glassContext.appController.showToast(a.translate("schedule_delivery_multiple_recipient_added",{recipient_count:o.length}))),this.setIcons(_),this._setRecipientsListEvents(n)},_addMobileRecipients:function(s,n,l){var r,o=[];l?r=this._verifyNewRecipients(s,this.mobile.to.slice())||[]:(this.mobile.to=[],r=s||[]);for(var d=0;d<r.length;d++)o.push({defaultName:r[d].defaultName||"",address:r[d].searchPath||r[d].address||"",type:r[d].type?a.translate(r[d].type):r[d].address?r[d].address:"",id:t.uniqueId("recipientId_")});var c={recipients:o,removeLabel:a.translate("schdeule_delivery_remove_recipient_label"),invalidLabel:a.translate("schedule_delivery_invalid_address")},u=i.simpleTemplate(h),_=e(u(c));n.find("#delivery_mobile_recipients_"+this.contentUniqueId).append(_),this.mobile.to=this.mobile.to.slice().concat(o),this._updateMobileRecipients(n),l&&(1===o.length?this.glassContext.appController.showToast(a.translate("schedule_delivery_single_recipient_added")):o.length>1&&this.glassContext.appController.showToast(a.translate("schedule_delivery_multiple_recipient_added",{recipient_count:o.length}))),this.setIcons(_),this._setRecipientsListEvents(n)},_verifyNewRecipients:function(e,t){for(var i=[],s=0;s<e.length;s++){for(var n=!0,a=0;a<t.length;a++)if(e[s].searchPath===t[a].address||e[s].address===t[a].address){n=!1;break}n&&i.push(e[s])}return i},_setRecipientsListEvents:function(t){var i=t.find(".delivery_recipient:not(.clickBound)");i.addClass("clickBound"),i.on("clicktap",function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()});var s=t.find(".delivery_delete_recipient_icon:not(.clickBound)");s.addClass("clickBound"),s.on("clicktap",function(i){i.cancelBubble=!0,i.stopPropagation&&i.stopPropagation();var s=e(i.target).closest(".delivery_recipient");this._removeRecipient(t,s)}.bind(this))},_removeRecipient:function(e,t){var i=t.attr("id"),s=t.closest(".delivery_recipients_field").data("recipienttype");switch(t.hide(_),t.remove(),s){case"email":this.email.to=this._removeRecipientFromList(i,this.email.to.slice()),this._updateEmailRecipients(e);break;case"cc":this.email.cc=this._removeRecipientFromList(i,this.email.cc.slice()),this._updateCCRecipients(e);break;case"bcc":this.email.bcc=this._removeRecipientFromList(i,this.email.bcc.slice()),this._updateBCCRecipients(e);break;case"mobile":this.mobile.to=this._removeRecipientFromList(i,this.mobile.to.slice()),this._updateMobileRecipients(e)}},_removeRecipientFromList:function(e,t){for(var i=-1,s=0;s<t.length;s++)if(e===t[s].id){i=s;break}i>=0&&t.splice(i,1);var n=t;return n},_updateEmailRecipients:function(e){var t=e.find("#delivery_email_ellipsis_"+this.contentUniqueId),i=e.find("#delivery_email_recipients_"+this.contentUniqueId),s=e.find('label[for="delivery_email_recipients_edit_field_'+this.contentUniqueId+'"]');this.deliveryOptions.email.to=this.email.to.slice(),this._checkForEllipsis(i,s,function(e){e?i.hasClass("expanded")||t.show(_):(t.hide(_),i.removeClass("expanded"))}.bind(this))},_updateCCRecipients:function(e){var t=e.find("#delivery_cc_ellipsis_"+this.contentUniqueId),i=e.find("#delivery_cc_recipients_"+this.contentUniqueId),s=e.find('label[for="delivery_cc_recipients_edit_field_'+this.contentUniqueId+'"]');this.deliveryOptions.email.cc=this.email.cc.slice(),this._checkForEllipsis(i,s,function(e){e?i.hasClass("expanded")||t.show(_):(t.hide(_),i.removeClass("expanded"))}.bind(this))},_updateBCCRecipients:function(e){var t=e.find("#delivery_bcc_ellipsis_"+this.contentUniqueId),i=e.find("#delivery_bcc_recipients_"+this.contentUniqueId),s=e.find('label[for="delivery_bcc_recipients_edit_field_'+this.contentUniqueId+'"]');this.deliveryOptions.email.bcc=this.email.bcc.slice(),this._checkForEllipsis(i,s,function(e){e?i.hasClass("expanded")||t.show(_):(t.hide(_),i.removeClass("expanded"))}.bind(this))},_updateMobileRecipients:function(e){var t=e.find("#delivery_mobile_ellipsis_"+this.contentUniqueId),i=e.find("#delivery_mobile_recipients_"+this.contentUniqueId),s=e.find('label[for="delivery_mobile_recipients_'+this.contentUniqueId+'"]');this.deliveryOptions.mobile.to=this.mobile.to.slice(),this._checkForEllipsis(i,s,function(e){e?i.hasClass("expanded")||t.show(_):(t.hide(_),i.removeClass("expanded"))}.bind(this))},_checkForEllipsis:function(t,i,s,n){var a=t.offset().left+t.width();if(1!==t.width()){n||(n=0),t.find("#invisibleSpan").remove();var l=!1;if(0!==t.prop("scrollHeight")&&0!==i.height()||n>10)t.prop("scrollHeight")>1.25*i.height()?("function"==typeof s&&s(!0),t.hasClass("expanded")||t.find(".delivery_recipient").each(function(){e(this).offset().left+e(this).width()>a-30&&0===e(this).position().top&&!l&&(e(this).before("<span id='invisibleSpan' style='width:30px; height:30px; visability:hidden'> </span>"),l=!0)})):"function"==typeof s&&s(!1);else{var r=_;setTimeout(function(){this._checkForEllipsis(t,i,s,n+1)}.bind(this),r)}}},_cleanRecipientsArray:function(e){for(var t=[],i=0;i<e.length;i++)t.push({address:e[i].address,defaultName:e[i].defaultName,type:e[i].type?a.translate(e[i].type):e[i].address?e[i].address:""});return t},_setEditorDialogHideHandler:function(){e("body").hasClass("editorHideHandlerSet")||e("body").addClass("editorHideHandlerSet").on("clicktap.ckeditorDialog",function(t){var i=e("body").find(".cke_dialog"),s=e("body").find(".cke_dialog_background_cover");(i.is(t.target)||i.has(t.target).length>0||s.is(t.target)||s.has(t.target).length>0)&&t.stopPropagation()})}});return m}),define("bi/schedule/views/ScheduleDeliveryPickerView",["jquery","bi/schedule/views/DeliveryPickerView","bi/sharecommon/utils/translator","bootstrap"],function(e,t,i){"use strict";var s="350px",n=t.extend({init:function(t){if(e.extend(this,t),n.inherited("init",this,arguments),void 0==t.slideoutparent)throw"Error: slideoutparent parameter must be provided.";this.isVisible=!1,this.slideout=null},render:function(){this.hasPermission&&!this.hasPermission.write&&this.hasPermission.read&&this.$toggler.prop("disabled",!0),this._setEvents(),this.$activeOptionsContainer&&this.updateActiveDeliveryList(this.$activeOptionsContainer)},_setEvents:function(){this.$toggler.on("primaryaction",function(e){this._showDeliveryOptions()}.bind(this))},_setpanelContent:function(){var t="function"==typeof this.allowRecipients?this.allowRecipients():!0,i=this.getDeliveryContent(t);this.$panelContent=e(i)},_showDeliveryOptions:function(){this.isVisible=!0,this._setpanelContent(),this.slideout=this.glassContext.appController.showSlideOut({parent:this.slideoutparent,overlay:this.overlay,width:s,enableTabLooping:!0,label:i.translate("schedule_delivery_picker_name"),content:{module:"bi/schedule/views/OptionsSlideoutView",content:this.$panelContent,title:i.translate("schedule_delivery_label"),closeCallback:function(){this._close()}.bind(this),setUpCallback:function(e){this.setDeliveryOptions(e,this.$activeOptionsContainer)}.bind(this)}})},_close:function(){if(this.isVisible=!1,e("body").hasClass("editorHideHandlerSet")){e("body").removeClass("editorHideHandlerSet"),e("body").off(".ckeditorDialog");var t=e("body").find(".cke_reset_all"),i=e("body").find(".cke_dialog_background_cover");t.remove(),i.remove()}this.close()}});return n}),define("bi/schedule/views/PdfOptionsView",["jquery","bi/sharecommon/utils/translator","bi/commons/ui/View"],function(e,t,i){"use strict";var s=i.extend({init:function(t){s.inherited("init",this,arguments),this._initVariables(),e.extend(this,t)},render:function(){return this._setEvents(),Promise.resolve()},getOptions:function(){return this.pdfOptions},_setEvents:function(){var i=this;this.$toggler.on("clicktap",function(){i._closeOpenSiblings().then(function(){var s={module:"bi/content_apps/PdfOptionsView",glassContext:i.glassContext,closeCallback:i._setPdfOptions.bind(i),pdfOptions:e.map(i.pdfOptions,function(e,t){return[{name:t,value:e}]})};i.slideout=i.glassContext.appController.showSlideOut({parent:i.parentSlideout,position:i.parentSlideout.position,width:"350",label:t.translate("schedule_pdf_options_name"),content:s})})})},_setPdfOptions:function(t){if(t){var i={};t.forEach(function(t){var s=t.value;if(-1!==t.name.indexOf("Password")&&t.value.length){var n=e.parseXML(t.value),a=e(n).find("password");a.text().length&&(s=a.text())}(void 0!==s||null!==s)&&(i[t.name]=s)}.bind(this)),this.pdfOptions=i}},_initVariables:function(){this.glassContext={},this.$toggler={},this.parentSlideout={},this.slideout=null,this.pdfOptions={},this.updatedPdfOptions={}},_closeOpenSiblings:function(){return new Promise(function(e,t){this.slideout&&this.slideout.open?this.slideout.hide().then(e):e()}.bind(this))}});return s}),define("bi/schedule/views/ScheduleView",["bi/glass/app/ContentView","bi/schedule/app/appControler","jquery","bi/commons/utils/Utils","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","text!bi/schedule/templates/ScheduleView.html","lodash","bi/schedule/views/DateTimeRangeCadencePickerView","bi/schedule/views/DailyCadencePickerView","bi/schedule/views/WeeklyCadencePickerView","bi/schedule/views/MonthlyCadencePickerView","bi/schedule/views/YearlyCadencePickerView","bi/schedule/views/TriggerCadencePickerView","bi/schedule/views/FormatPickerView","bi/schedule/views/ScheduleDeliveryPickerView","bi/commons/ui/properties/DropDown","bi/commons/ui/properties/CheckBox","ca_portal/features/profileAndSettings/CredentialDialogs","bi/schedule/views/PdfOptionsView","bi/commons/ui/properties/PropertyUIControl","bi/content_apps/utils/ContentStoreObject","bi/commons/ui/dialogs/ConfirmationDialog","bi/content_apps/utils/C10Utils","caglass/ajax/CAAuthentication","bi/content_apps/authoring/AuthoringHelper"],function(e,t,i,s,n,a,l,r,o,d,c,h,u,_,p,m,v,b,y,f,g,w,k,C,I,S){"use strict";var x="350px",P=e.extend({init:function(e){P.inherited("init",this,arguments),this.showOptions=!0,this.defaultLocale=e.glassContext.services.userProfile.preferences.contentLocale||"en-us",this.options={delivery:{save:{notify:!1}},outputLocale:[this.defaultLocale],pdf:{},burst:!1,outputFormat:[]},this.options.outputFormat.push(this._getDefaultOutputFormat()),r.assign(this,e),this.currentRenderedCadenceType="weekly",this.outputLocale=[this.defaultLocale],this.msgs=[],this.warningMessage=null,this.parameterValues=[],this.reportParameterValues=[],this.scheduleTypeSelector=null,this.uniqueId=r.uniqueId("id_"),this.readOnly=!1,this.deliveryPicker=null,this.outputFormatPicker=null,this.pdfOptionsView=null,this.timezone=this.glassContext.services.userProfile.preferences.timeZoneID,this.canBurst=this.canBurst&&this.glassContext.hasCapability("canUseBursting"),this.showPDFOption=this.glassContext.hasCapability("canGeneratePDFOutput")&&"interactiveReport"!==this.objectInformation.type&&"powerPlay8Report"!==this.objectInformation.type&&"powerPlay8ReportView"!==this.objectInformation.type,this.initScheduleDescriptor={reportId:null,reportType:null,scheduleInfo:{active:null,startDate:null,endDate:null,endType:null,timezone:null,weekly:null,everyNPeriods:null,type:null},options:{outputFormat:null,delivery:null,outputLocale:null,pdf:null,burst:null},parameters:null},this.showOptions=this._supportsOptions()},_supportsOptions:function(){var e=["dataSet2","agentDefinition","agentDefinitionView","jobDefinition","jupyterNotebook"];return-1===e.indexOf(this.objectInformation.type)},_openClassicView:function(){var e=this._prepareScheduleDescriptor();this._confirmChanges(function(){r.isEqual(e,this.initDesc)?(this.setDone(),this.slideout.hide(),this.slideout.parent&&this.slideout.parent.hide(),C.openC10Morphlet("portal/schedule/report.xts",this.objectInfo.type,this.objectInfo.id)):this._createOrUpdateScheduleRoutine(e).then(function(){this.slideout.hide(),this.slideout.parent&&this.slideout.parent.hide(),C.openC10Morphlet("portal/schedule/report.xts",this.objectInfo.type,this.objectInfo.id)}.bind(this))}.bind(this),function(){},n.translate("schedule_update_confirm"),n.translate("schedule_update_save_before_classicview"),e)},setFocus:function(){this.$el.focus()},_confirmChanges:function(e,t,i,s,n){if(n&&r.isEqual(n,this.initDesc))return void e();var a=new k("warning",i,s);a.confirm(e,t)},_hasRestrictedFormats:function(){for(var e=this.outputFormatPicker&&this.outputFormatPicker.getOutputFormats()||[],t=0;t<e.length;t+=1)if(!S.userCanGenerateFormat(this.glassContext,e[t]))return!0;return!1},_resetRestrictedFormats:function(e){var t=r.reject(e.options.outputFormat,function(e){return!S.userCanGenerateFormat(this.glassContext,e)}.bind(this));0===t.length&&t.push("HTML"),e.options.outputFormat=t},_handleUpdate:function(){return this._closeOpenChildren().then(function(){this.setWorking(),this.hideWarningMessage();var e=this._prepareScheduleDescriptor();if(this.initDesc=e,this.validate(e)){if(this.descriptor){var t=this._hasOnlyTimezoneBeenChanged(this.initScheduleDescriptor,e),i=this._hasRestrictedFormats(),s="";return t&&i?s=n.translate("schedule_update_restricted_formats_timezone_confirm_message"):t?s=n.translate("schedule_update_timezone_difference_confirm_message"):i&&(s=n.translate("schedule_update_restricted_formats_confirm_message")),s.length>0?this._confirmChanges(function(){i&&this._resetRestrictedFormats(e),this._createOrUpdateScheduleRoutine(e)}.bind(this),this.setDone.bind(this),n.translate("schedule_update_confirm"),s):this._createOrUpdateScheduleRoutine(e)}return this._createOrUpdateScheduleRoutine(e)}return this.showWarningMessage(),this.setDone(),Promise.resolve()}.bind(this))},_setEvents:function(){this.$el.find(".classicViewLink").on("primaryaction",this._openClassicView.bind(this)),this.$el.find(".schedule_primary_button").on("clicktap",this._handleUpdate.bind(this)),this.$el.find(".schedule_language_picker").on("clicktap",function(){this._closeOpenChildren().then(function(){this.glassContext.appController.showSlideOut({parent:this.slideout,overlay:!1,width:x,label:n.translate("schedule_language_picker_name"),content:{module:"bi/content_apps/common/ui/LanguagePickerView",glassContext:this.glassContext,supportedContentLocales:this.supportedContentLocales,enabledLanguages:this.outputLocale,closeCallback:function(e){this.outputLocale=e;for(var t=n.translate("schedule_no_languages_label"),i=[],s=0;s<this.outputLocale.length;s++)i.push(this.supportedContentLocales[this.outputLocale[s]]);
t=i.join(", "),this.$el.find(".output_language_list").text(t),this.$el.find(".output_language_list").attr("title",t)}.bind(this)}})}.bind(this))}.bind(this));var e=function(){this.close()}.bind(this);this.$el.find(".schedule_secondary_button").on("clicktap",e)},_prepareScheduleDescriptor:function(){var e=this.objectInformation.id,t=this.objectInformation.type,i=this.isEditMode?this.objectInformation.descriptor.scheduleInfo.active:!0,s=this.options.outputFormat;null!==this.outputFormatPicker&&(s=this.outputFormatPicker.getOutputFormats());var n={active:i,timezone:this.timezone};n=this.datetimeRangeCadencePicker.toDescriptor(n),n=this.cadencePicker.toDescriptor(n);var a=this.options.delivery;null!==this.deliveryPicker&&(a=this.deliveryPicker.getDeliveryOptions());var l=this.outputLocale||this.options.outputLocale,o=this.pdfOptionsView?this.pdfOptionsView.getOptions():this.options.pdf,d=this._getBurstValue(),c=r.assign({},{reportId:e,reportType:t,scheduleInfo:n,options:{outputFormat:s,delivery:a,outputLocale:l,pdf:o,burst:d},parameters:this.parameterValues});return("agentDefinition"===this.objectInformation.type||"agentDefinitionView"===this.objectInformation.type)&&delete c.options,c},_hasOnlyTimezoneBeenChanged:function(e,t){var s=!1,n=i.extend(!0,{},e),a=i.extend(!0,{},t),l=n.scheduleInfo.timezone,o=a.scheduleInfo.timezone;return l!==o&&(delete n.scheduleInfo.timezone,delete a.scheduleInfo.timezone,"indefinite"===n.scheduleInfo.endType&&delete n.scheduleInfo.endDate,"indefinite"===a.scheduleInfo.endType&&delete a.scheduleInfo.endDate,s=r.isEqual(n,a)),s},_closeOpenChildren:function(){return new Promise(function(e,t){if(this.slideout&&this.slideout.hasOpenChild()){var i=this.slideout.child;i.hide().then(e)}else e()}.bind(this))},_getOutputFormat:function(e){var t="";try{for(var i=0;i<e.length;i++)if("outputFormat"===e[i].name){t=e[i].value.join(",");break}}catch(s){}return t},_createOrUpdateSchedule:function(e){var i=this;return i.objectInformation&&i.objectInformation.type&&"jobDefinition"===i.objectInformation.type&&e.options&&delete e.options,t.createSchedule(e,i.glassContext).then(function(e){var s=null===this.deliveryPicker?{}:this.deliveryPicker.getCloudOptions();return e||(e={}),t.updateSaveToCloudOptions(e.id,s,this.glassContext).then(function(){i.onCreateOrUpdateCallback&&"function"==typeof i.onCreateOrUpdateCallback&&i.onCreateOrUpdateCallback();var e,t={objectType:this.objectInformation.type,object:this.objectInformation.id,"custom.outputFormat":this._getOutputFormat(this.objectInformation.outputFormat)};i.isEditMode?(t.type="Updated Object",t.action="scheduleEdited",t.milestoneName="scheduleEdited_"+this.objectInformation.type,e=n.translate("sch_update_success_msg")):(t.type="Created Object",t.action="scheduleCreated",t.milestoneName="scheduleCreated_"+this.objectInformation.type,e=n.translate("sch_create_success_msg"));var s=this.glassContext.getCoreSvc(".Instrumentation");return s&&s.track&&s.track(t),i.glassContext.appController.showToast(e,{newestOnTop:!0,preventDuplicates:!1,timeOut:6e3,extendedTimeOut:1e3}),i.setDone(),i.close(),Promise.resolve()}.bind(this))}.bind(this)).fail(function(){i.setDone()})},_getFormatFromObject:function(){if(this.objectInformation&&this.objectInformation.options){var e=r.find(this.objectInformation.options,function(e){return"outputFormat"===e.name});if(e){var t;return t="string"===(typeof e.value).toLocaleLowerCase()?e.value:e.value[0],S.userCanGenerateFormat(this.glassContext,t)||(t="HTML"),t}}else;},_getDefaultOutputFormat:function(){var e=this._getFormatFromObject(),t=this.glassContext.services.userProfile.preferences.format;return e?e:t&&S.userCanGenerateFormat(this.glassContext,t)?t:"HTML"},_createOrUpdateScheduleRoutine:function(e){return t.getUserCredential(this.glassContext).then(function(){return this._createOrUpdateSchedule(e)}.bind(this)).fail(function(){this.glassContext.appController.showToast(n.translate("sub_credentials_expired_msg"),{type:"warning",preventDuplicates:!0,btnLabel:n.translate("sub_renew_credentials_button"),callback:function(){return this._caAuthentication=new I,this._caAuthentication.storeCredentials(this.glassContext).then(function(){this._createOrUpdateSchedule(e)}.bind(this)).fail(function(t){return t&&t.displayObjects?(this._CredentialDialog=new y({glassContext:this.glassContext}),this._CredentialDialog.openCreateCredentialDialog(t.displayObjects).then(function(){this._createOrUpdateSchedule(e)}.bind(this)).fail(function(){this.setDone()}.bind(this))):void 0}.bind(this)).fail(function(){this.setDone()}.bind(this))}.bind(this)})}.bind(this))},render:function(){this.descriptor=this.objectInformation.descriptor,this.isEditMode="undefined"!=typeof this.descriptor,this.readOnly=this.isEditMode&&this.objectInformation.hasPermission&&!this.objectInformation.hasPermission.write&&this.objectInformation.hasPermission.read;var e=a.simpleTemplate(l),t=this.objectInformation||{},s=this.canBurst||!1,o=this.showPDFOption;t.defaultName=this.objectInformation.defaultName||"",this.canShowPrompt=!C.isPowerPlay(this.objectInformation.type),this.canShowPrompt&&(this.reportParameterValues=this.objectInformation.parameters||[]);var d=this.getScheduleType(),c=this.isEditMode?n.translate("schedule_panel_title_update_text"):n.translate("schedule_panel_title_text"),h={canShowClassic:this._supportsOptions(),asset_name:r.escape(t.defaultName),schedule_panel_back:n.translate("schedule_panel_back_text"),schedule_panel_title:c,schedule_type_label:n.translate("schedule_type_label"),schedule_output_label:n.translate("schedule_output_label"),schedule_delivery_label:n.translate("schedule_delivery_label"),schedule_prompts_label:n.translate("schedule_prompts_label"),schedule_select_text:n.translate("schedule_select_text"),schedule_create_btn:this.isEditMode?n.translate("schedule_update_btn_label"):n.translate("schedule_create_btn_label"),schedule_cancel_btn:n.translate("schedule_cancel_btn_label"),schedule_period:n.translate("schedule_period"),uniqueid:this.uniqueId,output_format_select_text:n.translate("output_format_select_text"),showOptions:this.showOptions,showPDFOption:o,canBurst:s,schedule_languages_label:n.translate("schedule_languages_label"),schedule_pdf_options_label:n.translate("schedule_pdf_options_label"),schedule_classic_view_label:n.translate("classicViewLink"),canShowPrompt:this.canShowPrompt};h.schedule_controls_description=n.translate("schedule_controls_description",{action1:h.schedule_create_btn,action2:h.schedule_cancel_btn});var u=[{type:"Banner",centerLabel:!0,backButton:this.slideout.overlay,value:c},{type:"SectionLabel",label:n.translate("schedule_period")}];return this.showOptions&&u.push({type:"SectionLabel",label:n.translate("schedule_options")}),this._propertyUIControl=new g({glassContext:this.glassContext,el:this.$el,closeCallback:this.close.bind(this),items:u}),this._propertyUIControl.render().then(function(){var t=i(e(h));return this.$el=this.$el.find(".propertiesUIControlPageView"),this.$el.prepend(t.find(".schedule_type_section")),t.find(".schedule_period_section").insertAfter(this.$el.find(".sectionLabel:first")),this.$el.append(t.find(".schedule_options_section")),this.$el.append(t.find(".progress-overlay")),this.$el.addClass("new_schedule_slideout"),this.renderDateTimeRangeCadencePicker()}.bind(this)).then(function(){this.renderCadencePicker(d),this.showOptions&&(this.renderOutputFormatPicker(),this.renderPromptRow(),this.renderDeliveryPicker(),o&&this.renderPdfOptionsView(),this.setLanguageLabel(),s&&this.renderBurstCheckBox()),this._renderTypeSelector(d),this.isEditMode&&(this.currentRenderedCadenceType=d,this.scheduleTypeSelector.getHTMLControl().val(this.currentRenderedCadenceType)),this._setIcons(),this.readOnly&&(this.$el.find(".schedule_primary_button").prop("disabled",!0),this.$el.find(".schedule_secondary_button").prop("disabled",!0),this.$el.find(".schedule_language_option_toggler").prop("disabled",!0),this.$el.find(".schedule_pdf_option_toggler").prop("disabled",!0),this.$el.find("input").prop("disabled",!0)),this._saveExistingScheduleInitialState(),this._setEvents(),this.initDesc=this._prepareScheduleDescriptor()}.bind(this))},setLanguageLabel:function(){this.objectInformation.descriptor&&this.objectInformation.descriptor.options.outputLocale&&(this.outputLocale=this.objectInformation.descriptor.options.outputLocale),this.glassContext.services.config.getContentLocales().then(function(e){this.supportedContentLocales=e,this.objectInformation.descriptor&&this.objectInformation.descriptor.options.outputLocale&&(this.outputLocale=this.objectInformation.descriptor.options.outputLocale);var t=n.translate("schedule_no_languages_label");if(this.isEditMode){if(this.objectInformation.descriptor&&this.objectInformation.descriptor.options.outputLocale){for(var i=[],s=0;s<this.outputLocale.length;s++)i.push(e[this.outputLocale[s]]);t=i.length>0?i.join(", "):e[this.defaultLocale]}}else t=e[this.defaultLocale];this.$el.find(".output_language_list").text(t),this.$el.find(".output_language_list").attr("title",t)}.bind(this))},shouldShowMobile:function(){var e=["interactiveReport","report","query","analysis"];return-1!==e.indexOf(this.objectInformation.type)||"reportView"===this.objectInformation.type&&-1!==e.indexOf(this.objectInformation.base[0].type)},renderDeliveryPicker:function(){var e={},t=this.objectInformation.defaultName;this.isEditMode&&this.objectInformation.descriptor.options.delivery&&(e=this.objectInformation.descriptor.options.delivery);try{this.deliveryPicker=new m({$el:this.$el.find(".schedule_delivery_picker"),$toggler:this.$el.find(".schedule_delivery_picker"),$activeOptionsContainer:this.$el.find(".delivery_list"),reportName:t,deliveryOptions:e,rawOptions:this.objectInformation.rawOptions,isEditMode:this.isEditMode,glassContext:this.glassContext,slideoutparent:this.slideout,hasPermission:this.objectInformation.hasPermission,showMobile:this.shouldShowMobile(),enableAdvancedSettings:!0,allowRecipients:function(){return!this._getBurstValue()}.bind(this)}),this.deliveryPicker.render()}catch(i){console.log("There was an error initializing the DeliveryPicker.",i)}},renderPdfOptionsView:function(){var e=this,t={};this.isEditMode&&this.objectInformation.descriptor.options.pdf&&(t=this.objectInformation.descriptor.options.pdf),this.pdfOptionsView=new f({glassContext:e.glassContext,$toggler:e.$el.find(".schedule_pdf_options_picker"),parentSlideout:e.slideout,pdfOptions:t}),this.pdfOptionsView.render()},_saveExistingScheduleInitialState:function(){this.isEditMode&&(this.initScheduleDescriptor=this._prepareScheduleDescriptor(),this.initScheduleDescriptor.scheduleInfo.timezone=this.descriptor.scheduleInfo.timezone)},_renderTypeSelector:function(e){var t=[];this.glassContext.hasCapability("canUseSchedulingByDay")&&t.push({label:n.translate("daily_label"),value:"daily",selected:"daily"==e?!0:!1}),this.glassContext.hasCapability("canUseSchedulingByWeek")&&t.push({label:n.translate("weekly_label"),value:"weekly",selected:"weekly"==e?!0:!1}),this.glassContext.hasCapability("canUseSchedulingByMonth")&&t.push({label:n.translate("monthly_label"),value:"monthly",selected:"monthly"==e?!0:!1}),this.glassContext.hasCapability("canUseSchedulingByYear")&&t.push({label:n.translate("yearly_label"),value:"yearly",selected:"yearly"==e?!0:!1}),this.glassContext.hasCapability("canUseSchedulingByTrigger")&&t.push({label:n.translate("trigger_label"),value:"trigger",selected:"trigger"==e?!0:!1}),0===t.length&&t.push({label:n.translate(e+"_label"),value:e,selected:!0});var i="schedule_type_"+this.uniqueId,s="schedule_type_option";this.scheduleTypeSelector=new v({id:i,el:this.$el.find("#schedule_type_selector_container_"+this.uniqueId),label:n.translate("schedule_type_label"),name:s,responsive:!1,onChange:function(e,t){this._toggleCadenceView(e,t)}.bind(this),options:t,readOnly:this.readOnly,ariaLabel:n.translate("schedule_type_aria_label"),ariaDescribedby:n.translate("schedule_type_description")}),this.scheduleTypeSelector.doRender()},_toggleCadenceView:function(e,t){var i=this.$el.find(".schedule_cadence_picker");t!=this.currentRenderedCadenceType&&(this.currentRenderedCadenceType=t,i.empty(),this.renderCadencePicker(t))},renderDateTimeRangeCadencePicker:function(){return this.datetimeRangeCadencePicker=new o({$el:this.$el.find(".schedule_datetime_range_picker"),objectInformation:{descriptor:this.objectInformation.descriptor},glassContext:this.glassContext}),this.datetimeRangeCadencePicker.render()},renderCadencePicker:function(e){var t=this.$el.find(".schedule_cadence_picker");switch(e){case"daily":this.cadencePicker=new d({$el:t,objectInformation:{descriptor:this.objectInformation.descriptor,showDailyInterval:!0},glassContext:this.glassContext,hasPermission:this.objectInformation.hasPermission});break;case"weekly":this.cadencePicker=new c({$el:t,objectInformation:{descriptor:this.objectInformation.descriptor,showRunEvery:!0,showDailyInterval:!0},glassContext:this.glassContext,hasPermission:this.objectInformation.hasPermission});break;case"monthly":this.cadencePicker=new h({$el:t,objectInformation:{descriptor:this.objectInformation.descriptor,showDailyInterval:!0},glassContext:this.glassContext,hasPermission:this.objectInformation.hasPermission});break;case"yearly":this.cadencePicker=new u({$el:t,objectInformation:{descriptor:this.objectInformation.descriptor,showDailyInterval:!0},glassContext:this.glassContext,hasPermission:this.objectInformation.hasPermission});break;case"trigger":this.cadencePicker=new _({$el:t,objectInformation:{descriptor:this.objectInformation.descriptor},glassContext:this.glassContext});break;default:console.log("Wrong cadence type.")}this.cadencePicker&&this.cadencePicker.render()},renderOutputFormatPicker:function(){var e=this.options.outputFormat;this.isEditMode&&this.objectInformation.descriptor.options.outputFormat&&(e=this.objectInformation.descriptor.options.outputFormat.slice());try{var t="interactiveReport"===this.objectInformation.type||"reportView"===this.objectInformation.type&&this.objectInformation.base&&this.objectInformation.base[0]&&this.objectInformation.base[0].type&&"interactiveReport"===this.objectInformation.base[0].type,i="powerPlay8Report"===this.objectInformation.type||"powerPlay8ReportView"===this.objectInformation.type;this.outputFormatPicker=new p({$el:this.$el.find(".output_format_list"),$toggler:this.$el.find(".schedule_output_format_picker"),outputFormats:i?this._getOutputFormatsForPowerPlayObjects(e):e.slice(),hasPermission:this.objectInformation.hasPermission,showHTML:!i,showPDF:!t&&this.glassContext.hasCapability("canGeneratePDFOutput"),showExcel:!t&&!i&&this.glassContext.hasCapability("canGenerateXLSOutput"),showCSV:!t&&!i&&this.glassContext.hasCapability("canGenerateCSVOutput"),showXML:!t&&!i&&this.glassContext.hasCapability("canGenerateXMLOutput"),glassContext:this.glassContext,slideoutparent:this.slideout,overlay:!1}),this.outputFormatPicker.render()}catch(s){console.log("There was an error initializing the FormatPicker.",s)}},_getOutputFormatsForPowerPlayObjects:function(e){return this.objectInformation.options?e.slice():["PDF"]},_renderPromptRowForReport:function(){var e=this;this.objectInfo=this.objectInformation,this.isEditMode&&this.descriptor.parameters&&(this.parameterValues=this.descriptor.parameters);var t=this.parameterValues.length>0,i=t?this.parameterValues:this.reportParameterValues;this.$el.find(".prompt_picker_target").on("clicktap",function(){e._closeOpenChildren().then(function(){e.glassContext.appController.showSlideOut({position:e.slideout?null:"right",parent:e.slideout,width:"350",enableTabLooping:!0,label:n.translate("schedule_prompt_picker_name"),content:{module:"bi/content_apps/PromptValuesView",parentView:e,glassContext:e.glassContext,promptDisplayValues:w.getPromptsDisplayValues(i),parameters:e.parameterValues,hasPermission:e.objectInformation.hasPermission,clearCallback:e._updatePromptValueLabelCB.bind(e),editCallback:e._updatePromptValueLabelCB.bind(e)}})})}),this._updatePromptValueLabel(i,!t)},renderPromptRow:function(){return this.canShowPrompt?this._renderPromptRowForReport():void 0},_updatePromptValueLabelCB:function(e){this.parameterValues=e?e:[];var t=this.$el.find(".currentPromptValues");t.text(this._getPromptValueLabel(this.parameterValues))},_updatePromptValueLabel:function(e,t){var i=this.$el.find(".currentPromptValues");i.text(this._getPromptValueLabel(e,t))},_getPromptValueLabel:function(e,t){var i=n.translate("schedule_prompt_value_label_default"),s=t?"report":"schedule";return e&&e.length>0&&(i=1==e.length?n.translate(s+"_prompt_value_label_single"):n.translate(s+"_prompt_value_label_multiple",{number:e.length})),i},renderBurstCheckBox:function(){var e=!1;this.objectInformation&&this.objectInformation.descriptor&&this.objectInformation.descriptor.options&&this.objectInformation.descriptor.options.burst&&(e=this.objectInformation.descriptor.options.burst||!1),this.burstCheckbox=new b({id:"schedule_burst_checkbox_"+this.uniqueId,el:this.$el.find(".schedule_burst_option_container"),name:"schedule_burst_report",label:n.translate("schedule_burst_label"),ariaLabel:n.translate("schedule_burst_label"),checked:e,controlOnLeft:!0,onChange:function(){}}),this.burstCheckbox.doRender()},close:function(){this.slideout.hide(),i(".flyoutPane .pane-child").css("z-index","-1")},setWorking:function(){this.$overlay=this.$el.find(".progress-overlay"),this.$overlay.show()},setDone:function(){this.$overlay&&this.$overlay.hide()},_setIcons:function(){for(var e=this.$el.find(".common_schedule_icon"),t=0;t<e.length;t++){var a=i(e[t]);s.setIcon(a,"common-"+a.data("icon"),n.translate("svg_expand_icon"))}},getScheduleType:function(){var e=this.getCapabilityScheduleType();if(!this.isEditMode)return e;switch(this.descriptor.scheduleInfo.type){case"daily":case"dailyWithIntradayRecurrence":return"daily";case"monthlyRelative":case"monthlyAbsolute":case"monthlyRelativeWithIntradayRecurrence":case"monthlyAbsoluteWithIntradayRecurrence":return"monthly";case"yearlyRelative":case"yearlyAbsolute":case"yearlyRelativeWithIntradayRecurrence":case"yearlyAbsoluteWithIntradayRecurrence":return"yearly";case"trigger":return"trigger";default:return"weekly"}},getCapabilityScheduleType:function(){return this.glassContext.hasCapability("canUseSchedulingByWeek")?"weekly":this.glassContext.hasCapability("canUseSchedulingByDay")?"daily":this.glassContext.hasCapability("canUseSchedulingByMonth")?"monthly":this.glassContext.hasCapability("canUseSchedulingByYear")?"yearly":this.glassContext.hasCapability("canUseSchedulingByTrigger")?"trigger":"weekly"},validate:function(){if(this.msgs=[],this.msgs=this.datetimeRangeCadencePicker.validate(this.msgs),this.msgs.length>0)return!1;if(this.msgs=this.cadencePicker.validate(this.msgs),this.msgs.length>0)return!1;var e=this._getBurstValue();if(this.deliveryPicker){var t=this.deliveryPicker.getDeliveryOptions(),s=this.$el.find(".delivery_list");if(s.removeAttr("aria-invalid aria-describedby"),!e){if(t.email){if(t.email.to=t.email.to?t.email.to:[],t.email.cc=t.email.cc?t.email.cc:[],t.email.bcc=t.email.bcc?t.email.bcc:[],0===t.email.to.length&&0===t.email.cc.length&&0===t.email.bcc.length)return this.msgs.push(n.translate("schedule_delivery_no_email_recipients_error")),s.attr({"aria-invalid":"true","aria-describedby":this.msgs[0]}),!1;if(!t.email.emailAsAttachment&&!t.email.emailAsURL)return this.msgs.push(n.translate("schedule_delivery_email_require_include")),s.attr({"aria-invalid":"true","aria-describedby":this.msgs[0]}),!1}if(t.mobile&&("undefined"==typeof t.mobile.to||0===t.mobile.to.length))return this.msgs.push(n.translate("schedule_delivery_no_mobile_recipients_error")),s.attr({"aria-invalid":"true","aria-describedby":this.msgs[0]}),!1}if(t.print&&""===i.trim(t.print.name))return this.msgs.push(n.translate("schedule_delivery_printer_empty_error")),s.attr({"aria-invalid":"true","aria-describedby":this.msgs[0]}),!1;if(t.archive&&""===i.trim(t.archive.filenameStub))return this.msgs.push(n.translate("schedule_delivery_archive_name_empty_error")),s.attr({"aria-invalid":"true","aria-describedby":this.msgs[0]}),!1}return 0===this.msgs.length},showWarningMessage:function(){this.warningMessage=this.$el.find(".invalid_input_warning_message"),this.warningMessage&&(this.warningMessage.text(this.msgs[0]),this.warningMessage.show())},hideWarningMessage:function(){this.warningMessage&&this.warningMessage.hide()},_getBurstValue:function(){var e=!1;return this.canBurst&&"undefined"!=typeof this.burstCheckbox&&(e=this.burstCheckbox.isChecked()),e}});return P}),define("text!bi/schedule/templates/SchedulesView.html",[],function(){return'<!-- /*\n * Licensed Materials - Property of IBM\n * \n * IBM Cognos Products: SHARE\n * \n * (C) Copyright IBM Corp. 2015, 2016\n * \n * US Government Users Restricted Rights - Use, duplication or disclosure\n * restricted by GSA ADP Schedule Contract with IBM Corp.\n */ -->\n<div  class="schedule_view_panel">\n{{? it.show_create}}\n    <div class="schedule_create_new" role="region" aria-label="{{=it.schedule_toolbar_label}}">\n        <button class=\'btn btn-link\' aria-label="{{=it.schedule_new_btn_label}}">\n            <span class="schedule_common_icon schedule_create_new_icon" data-icon="add"></span>\n            {{=it.schedule_new_label}}\n        </button>\n    </div>\n    <div class="schedule_no_schedule_container"></div>\n{{??}}\n    <div class="schedule_toolbar propertyUIControl" role="region" aria-label="{{=it.schedule_toolbar_label}}">\n        <div class="schedules_controls_container">\n            <div class="schedule_toggle_container">\n                <span class="schedule_toggle_button_label">{{=it.schedule_toggle_label}}</span>\n                <div class="schedule_toggle_button_container"></div>\n            </div>\n            <button class=\'btn btn-link schedule_delete_button\'>\n                <span class="schedule_common_icon schedule_delete_schedule_icon" data-icon="remove-trash"></span>\n                {{=it.schedule_delete_label}}\n            </button>\n        </div>\n    </div>\n    <div class="schedule_display">\n		<div class="schedule_short_summary">\n    		<div class="schedule_name"><span class=\'interval\'>{{=it.schedule_type}}</span> - {{=it.schedule_cadence_label}}</div>\n    		{{?it.show_formats}}\n    		<div class="schedule_formats">\n    			{{~it.outputFormat :format:index}}\n    			<div class="schedule_format">\n    				<span class="schedule_common_icon schedule_format_icon" data-icon="{{=format.icon}}"></span>\n    				<span class="schedule_format_label">{{=format.displayName}}</span>\n    			</div>\n    			{{~}}\n    		</div>\n    		{{?}}\n		</div>\n		<div class="schedule_expand_schedule">\n            <button class="btn btn-link schedule_expand" title="{{=it.schedule_update_label}}">\n                <svg class="svgIcon">\n                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#common-chevron_right"></use>\n                </svg>\n            </button>\n		</div>\n	</div>\n{{?}}\n</div>\n\n'}),define("bi/schedule/utils/CadenceLabelGenerator",["jquery","moment-timezone","bi/sharecommon/utils/translator"],function(e,t,i){var s={},n="LT",a=function(e,s){var n=e.timezone;n||(console.error("Schedule was created with no timezone. Defaulting to 'America/New_York'."),n="America/New_York");var a={},l=[],r=[i.translate("schedule_weekday_sunday_t"),i.translate("schedule_weekday_monday_t"),i.translate("schedule_weekday_tuesday_t"),i.translate("schedule_weekday_wednesday_t"),i.translate("schedule_weekday_thursday_t"),i.translate("schedule_weekday_friday_t"),i.translate("schedule_weekday_saturday_t")],o={weeklySunday:0,weeklyMonday:1,weeklyTuesday:2,weeklyWednesday:3,weeklyThursday:4,weeklyFriday:5,weeklySaturday:6},d=e.weekly;for(var c in d)d[c]&&l.push(o[c]);l.sort();for(var h=t(e.startDate).tz(n).day(),u=t(e.startDate).tz(s).day(),_=u-h,p=0;p<l.length;p++){var m=l[p]+_;0>m?m+=7:m>6&&(m-=7),a["param"+(p+1)]=r[m]}return a};return s.getLabelFor=function(e,s,l){if(!e)return"";var r="",o={},d="undefined"!=typeof e.intradayRecurrence?!0:!1;if("daily"===e.type||"dailyWithIntradayRecurrence"===e.type)if("undefined"!=typeof e.daily){var c=parseInt(e.everyNPeriods,10);1==c?d&&"day"==e.daily.dailyPeriod?r="cadence_daily_day_repeat_label":(r="cadence_daily_"+e.daily.dailyPeriod+"_label","day"==e.daily.dailyPeriod&&(o.param=t(e.startDate).locale(l).tz(s).format(n))):d&&"day"==e.daily.dailyPeriod?(r="cadence_daily_every_day_repeat_label",o.param=c):(r="cadence_daily_every_"+e.daily.dailyPeriod+"_label",o.param=c)}else r="cadence_daily_label",o.param=t(e.startDate).locale(l).tz(s).format(n);else if("weekly"===e.type||"weeklyWithIntradayRecurrence"===e.type)if("undefined"!=typeof e.weekly){o=a(e,s);var c=parseInt(e.everyNPeriods,10);1==c?(r=d?"cadence_weekly_"+Object.keys(o).length+"_repeat_label":"cadence_weekly_"+Object.keys(o).length+"_label",o.param=t(e.startDate).locale(l).tz(s).format(n)):d?(r="cadence_week_"+Object.keys(o).length+"_repeat_label",o.param=c):(r="cadence_week_"+Object.keys(o).length+"_label",o.param=c)}else r="cadence_weekly_label",o.param=t(e.startDate).locale(l).tz(s).format(n);else if("monthlyRelative"===e.type||"monthlyRelativeWithIntradayRecurrence"===e.type)if("undefined"!=typeof e.monthlyRelative){o.param1=i.translate("schedule_weekday_"+e.monthlyRelative.monthlyRelativeDay+"_t");var c=parseInt(e.everyNPeriods,10);1==c?r=d?"cadence_monthly_relative_"+e.monthlyRelative.monthlyRelativeWeek+"_repeat":"cadence_monthly_relative_"+e.monthlyRelative.monthlyRelativeWeek:d?(r="cadence_monthly_relative_repeat_"+e.monthlyRelative.monthlyRelativeWeek+"_repeat",o.param=c):(r="cadence_monthly_relative_repeat_"+e.monthlyRelative.monthlyRelativeWeek,o.param=c)}else r="cadence_monthly_label";else if("monthlyAbsolute"===e.type||"monthlyAbsoluteWithIntradayRecurrence"===e.type)if("undefined"!=typeof e.monthlyAbsolute){o.param1=e.monthlyAbsolute.monthlyAbsoluteDay;var c=parseInt(e.everyNPeriods,10);1==c?r=d?"cadence_monthly_absolute_daily_repeat":"cadence_monthly_absolute":d?(r="cadence_monthly_absolute_repeat_daily_repeat",o.param=c):(r="cadence_monthly_absolute_repeat",o.param=c)}else r="cadence_monthly_label";else if("yearlyRelative"===e.type||"yearlyRelativeWithIntradayRecurrence"===e.type)if("undefined"!=typeof e.yearlyRelative){o.weekDay=i.translate("schedule_weekday_"+e.yearlyRelative.yearlyRelativeDay+"_t"),o.month=i.translate("schedule_month_short_"+e.yearlyRelative.yearlyRelativeMonth+"_label");var c=parseInt(e.everyNPeriods,10);1==c?r=d?"cadence_yearly_relative_"+e.yearlyRelative.yearlyRelativeWeek+"_repeat":"cadence_yearly_relative_"+e.yearlyRelative.yearlyRelativeWeek:d?(r="cadence_yearly_relative_repeat_"+e.yearlyRelative.yearlyRelativeWeek+"_repeat",o.param=c):(r="cadence_yearly_relative_repeat_"+e.yearlyRelative.yearlyRelativeWeek,o.param=c)}else r="cadence_yearly_label";else if("yearlyAbsolute"===e.type||"yearlyAbsoluteWithIntradayRecurrence"===e.type)if("undefined"!=typeof e.yearlyAbsolute){o.day=e.yearlyAbsolute.yearlyAbsoluteDay,o.month=i.translate("schedule_month_short_"+e.yearlyAbsolute.yearlyAbsoluteMonth+"_label");var c=parseInt(e.everyNPeriods,10);1==c?r=d?"cadence_yearly_absolute_daily_repeat":"cadence_yearly_absolute":d?(r="cadence_yearly_absolute_repeat_daily_repeat",o.param=c):(r="cadence_yearly_absolute_repeat",o.param=c)}else r="cadence_yearly_label";else"trigger"===e.type&&("undefined"!=typeof e.trigger?(o.triggerName=e.trigger.triggerName,r="cadence_trigger_name_label"):r="");var h="";return""!=r&&(h=i.translate(r,o)),h},s}),define("text!bi/notifications/templates/emptyMessageList.html",[],function(){return'<!-- Licensed Materials - Property of IBM\n \n     IBM Cognos Products: SHARE\n \n     (C) Copyright IBM Corp. 2015\n \n   US Government Users Restricted Rights - Use, duplication or disclosure restricted by GSA ADP Schedule Contract with IBM Corp.\n-->\n<div class="emptyTableContent">\n	<div class = \'empty_notifications_illustration_128\'></div>\n\n    <div class="emptyTableText">{{=it.text}}</div>\n</div>\n'}),define("bi/schedule/views/SchedulesView",["react","react-dom","ba-react-admin/ba-react-admin.min","bi/commons/ui/View","jquery","bi/sharecommon/utils/translator","bi/sharecommon/utils/simpledoT","bi/commons/utils/Utils","text!bi/schedule/templates/SchedulesView.html","bi/schedule/utils/CadenceLabelGenerator","bi/commons/ui/properties/ToggleButton","bi/schedule/app/appControler","text!bi/notifications/templates/emptyMessageList.html","bi/commons/ui/dialogs/ConfirmationDialog"],function(e,t,i,s,n,a,l,r,o,d,c,h,u,_){"use strict";var p=s.extend({schedule:{},init:function(e){p.inherited("init",this,arguments),this.stateToggler=null,this.hasPermission={execute:!0,read:!0,setPolicy:!0,traverse:!0,write:!0},n.extend(this,e),this.timezone=this.glassContext.services.userProfile.preferences.timeZoneID,this.productLocale=this.glassContext.services.userProfile.preferences.productLocale||"en-us","undefined"==typeof this.objectInfo.descriptor&&(this.hasPermission={execute:-1!=n.inArray("execute",this.objectInfo.permissions),read:-1!=n.inArray("read",this.objectInfo.permissions),setPolicy:-1!=n.inArray("setPolicy",this.objectInfo.permissions),traverse:-1!=n.inArray("traverse",this.objectInfo.permissions),write:-1!=n.inArray("write",this.objectInfo.permissions)})},_canHide:function(){return!i.ScheduleUIStore.isDialogOpen},render:function(){return this.slideout.contentView&&(this.slideout.contentView.canHide=this._canHide.bind(this)),h.getSchedule(this.objectInfo.id,this.glassContext).then(function(s){this.$el.append("<div class='newSchedPane'/>");var n=this.$el.find(".newSchedPane"),l=JSON.parse(JSON.stringify(this.objectInfo)),r=e.createElement(i.SchedulesListView,{glassContext:this.glassContext,StringResource:a,runnable:l,shareAppController:h,schedule:s,deleteRequest:h.deleteSchedule});return t.render(r,n[0]),this}.bind(this))},_supportsFormats:function(){var e=["agentDefinition","agentDefinitionView","jobDefinition","jupyterNotebook"];return-1===e.indexOf(this.objectInfo.type)},updateScheduleList:function(){var e=!0,t=null;return h.getSchedule(this.objectInfo.id,this.glassContext).then(function(i){var s=d.getLabelFor(i.scheduleInfo,this.timezone,this.productLocale),n=[],l=this._supportsFormats();if(this.schedule=i,i&&i.scheduleInfo){e=!1,t=a.translate(this._getScheduleType()+"_label");for(var r=i.options&&i.options.outputFormat?i.options.outputFormat.length:0,o=0;r>o;o++){var c={format:i.options.outputFormat[o]};switch(c.format){case"HTML":c.icon="html_icon",c.displayName=a.translate("schedule_format_web");break;case"PDF":c.icon="pdf_icon",c.displayName=a.translate("schedule_format_pdf");break;case"spreadsheetML":c.icon="excel_icon",c.displayName=a.translate("schedule_format_xlsx");break;case"xlsxData":c.icon="excel_icon",c.displayName=a.translate("schedule_format_xlsx_data");break;case"XLWA":c.icon="unsupportedformat_icon",c.displayName=a.translate("schedule_format_unsupported");break;case"CSV":c.icon="csv_icon",c.displayName=a.translate("schedule_format_csv");break;case"XML":c.icon="xml_icon",c.displayName=a.translate("schedule_format_xml");break;case"dataSet":c.icon="dataset",c.displayName=a.translate("schedule_format_dataset");break;default:continue}n.push(c)}0===n.length&&n.push({format:"HTML",icon:"html_icon",displayName:a.translate("schedule_format_web")})}var u={schedule_toolbar_label:a.translate("schedule_toolbar_label"),schedule_new_label:a.translate("schedule_new_label"),schedule_delete_label:a.translate("schedule_delete_label"),schedule_update_label:a.translate("schedule_update_label"),schedule_toggle_label:a.translate("schedule_enable_label"),schedule_new_btn_label:a.translate("schedule_new_btn_label"),report_id:i.reportId,schedule_type:t,schedule_cadence_label:s||"",show_create:e,show_formats:l,outputFormat:n};return this._loadTemplates(u,e),e||this._renderToggleButton(),!this.hasPermission.write&&e&&this.$el.find(".schedule_create_new").remove(),
this.hasPermission.write||e||(this.$el.find(".schedule_toolbar").remove(),this.hasPermission.read||this.$el.find(".schedule_expand").prop("disabled",!0)),this.schedule.id?h.getRawSchedule(this.schedule.id,this.glassContext):Promise.resolve({data:[{options:[]}]})}.bind(this)).then(function(e){this.schedule.id?this.objectInfo.rawOptions=e.data[0].options:this.schedule.reportId&&(this.objectInfo.rawOptions=e.data[0].options),console.log("raw result is",e)}.bind(this))},_getScheduleType:function(){switch(this.schedule.scheduleInfo.type){case"daily":case"dailyWithIntradayRecurrence":return"daily";case"monthlyRelative":case"monthlyAbsolute":case"monthlyRelativeWithIntradayRecurrence":case"monthlyAbsoluteWithIntradayRecurrence":return"monthly";case"yearlyRelative":case"yearlyAbsolute":case"yearlyRelativeWithIntradayRecurrence":case"yearlyAbsoluteWithIntradayRecurrence":return"yearly";case"trigger":return"trigger";default:return"weekly"}},_loadTemplates:function(e,t){var i=l.simpleTemplate(o);if(this.$el.html(i(e)),t){var s=l.template(u)({text:a.translate("no_schedule_label",{type:a.translate(this.objectInfo.type+"_type")})});this.$el.find(".schedule_no_schedule_container").append(s)}this._setIcons(),this._setEvents()},_renderToggleButton:function(){var e=!1;this.schedule&&this.schedule.scheduleInfo&&(e=this.schedule.scheduleInfo.active),this.stateToggler=new c({id:"schedule_toggler_"+this.schedule.reportId,el:this.$el.find(".schedule_toggle_button_container"),name:"schedule_status_toggler",ariaLabel:a.translate("schedule_toggle_label"),checked:e,onChange:this._handleToggler.bind(this)}),this.stateToggler.doRender()},_handleToggler:function(e,t){if("schedule_status_toggler"===e){var i=this.schedule;i.scheduleInfo.active=t,delete i.name,h.updateSchedule(i,this.glassContext).then(function(e){this.schedule=e}.bind(this))}},_openScheduleView:function(e){var t=this;"boolean"!=typeof e&&(e=!1),this.glassContext.getSvc(".Content").then(function(i){var s=i.getBaseObjectsURL()+"/"+t.schedule.reportId+"?fields=canBurst";i.get(s,{}).then(function(i,s,n){e&&(t.objectInfo.descriptor=t.schedule),t.objectInfo.hasPermission=t.hasPermission;var l=t._getScheduleModule();t.glassContext.appController.showSlideOut({parent:t.slideout,overlay:!0,enableTabLooping:!0,label:a.translate("schedule_report_properties_name"),content:{module:l,objectInformation:t.objectInfo,onCreateOrUpdateCallback:t.updateScheduleList.bind(t),canBurst:i.data[0].canBurst,glassContext:t.glassContext,slideoutparent:t.slideout}})})})},remove:function(){var e=this.$el.find(".newSchedPane");e&&1===e.length?t.unmountComponentAtNode(e[0]):this.glassContext.getCoreSvc(".Logger").log("could not remove schedule react element")},_getScheduleModule:function(){return"dataSet2"===this.objectInfo.type?"bi/schedule/views/DatasetScheduleView":"jobDefinition"===this.objectInfo.type?"bi/schedule/views/JobScheduleView":"bi/schedule/views/ScheduleView"},_getOutputFormat:function(e){var t="";try{for(var i=0;i<e.length;i++)if("outputFormat"===e[i].name){t=e[i].value.join(",");break}}catch(s){}return t},_deleteFunction:function(){var e=new _("warning",a.translate("delete_confirm"),a.translate("delete_schedule_confirm_message"));e.confirm(function(){h.deleteSchedule(this.objectInfo.id,this.glassContext).then(function(){var e={type:"Deleted Object",objectType:this.objectInfo.type,object:this.objectInfo.id,action:"scheduleDeleted",milestoneName:"scheduleDeleted_"+this.objectInfo.type,"custom.outputFormat":this._getOutputFormat(this.schedule.options.outputFormat)},t=this.glassContext.getCoreSvc(".Instrumentation");t&&t.track&&t.track(e),this.objectInfo&&this.objectInfo.descriptor&&delete this.objectInfo.descriptor,this.updateScheduleList()}.bind(this))}.bind(this))},_setEvents:function(){this.$el.find(".schedule_create_new button").on("clicktap",function(){return this._openScheduleView(!1),!1}.bind(this)),this.$el.find(".schedule_expand").on("clicktap",function(){return this._openScheduleView(!0),!1}.bind(this)),this.$el.find(".schedule_delete_button").on("clicktap",function(){var e=new _("warning",a.translate("delete_confirm"),a.translate("delete_schedule_confirm_message"));e.confirm(function(){h.deleteSchedule(this.objectInfo.id,this.glassContext).then(function(){var e={type:"Deleted Object",objectType:this.objectInfo.type,object:this.objectInfo.id,action:"scheduleDeleted",milestoneName:"scheduleDeleted_"+this.objectInfo.type,"custom.outputFormat":this._getOutputFormat(this.schedule.options.outputFormat)},t=this.glassContext.getCoreSvc(".Instrumentation");t&&t.track&&t.track(e),this.objectInfo&&this.objectInfo.descriptor&&delete this.objectInfo.descriptor,this.updateScheduleList()}.bind(this))}.bind(this))}.bind(this))},_setIcons:function(){for(var e=this.$el.find(".schedule_common_icon"),t=0;t<e.length;t++){var i=n(e[t]),s=e[t].dataset.displayName;r.setIcon(i,"common-"+e[t].dataset.icon,s?s:e[t].dataset.icon)}}});return p}),define("js/schedule/scheduleBundle",function(){});