/**
 * IBM Confidential OCO Source Materials IBM Business Platform: Dashboard
 * (C) Copyright IBM Corp. 2016, 2021
 *
 * The source code for this program is not published or otherwise divested of
 * its trade secrets, irrespective of what has been deposited with the U.S.
 * Copyright Office
 */

function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}define("dashboard-analytics/dataSources/nls/DataSourcesResources",{root:!0,cs:!0,da:!0,de:!0,es:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,it:!0,ja:!0,kk:!0,ko:!0,no:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-br":!0,ro:!0,ru:!0,sl:!0,sv:!0,th:!0,tr:!0,zh:!0,"zh-cn":!0,"zh-tw":!0}),define("dashboard-analytics/dataSources/nls/root/DataSourcesResources",{pinLabel:"Pin",find_label:"Find",findCancelLabel:"Cancel",dataPaneLabel:"Data",sourcePaneLabel:"Selected sources",sourcePaneContentLabel:"Select a source",emptySourcePaneTitle:"Select a source",emptySourcePaneCaption:"Click select a source to add data to use to build a dashboard.",addDataSource:"Select a source",addDataDashboardCoachMarkContents:"Drag and drop data from the data panel onto your dashboard.",addDataStoryCoachMarkContents:"Drag and drop data from the data panel onto your story.",addDataCoachMarkTitle:"Add data",selectSourcesText:"Select and add a data source to build your %{app}.",selectSourcesLabel:"Select a source",dataPreparationTitle:"Data preparation",dataPreparationCaption:"Data is displayed here when data preparation is complete.",dataPreparationProgress:"%{percentage}% prepared...",dataPreparationSourceError:'The data preparation for "%{sourceName}" was not successfully completed.',dataPreparationStarted:'The data preparation for "%{sourceName}" is in progress. Dashboard features will be available when data preparation is complete.',dataPreparationComplete:'The data preparation for "%{sourceName}" is complete. It is now ready to use with all dashboard features.',preparingData:"Preparing data...",moserUnsupportedSourceType:"This data source type is not supported.",errorSourcesTitle:"Failed to load data tree",errorLoadingDataSources:"An error occurred while loading the list of data sets",errorLoadingDataTree:"An error occurred while loading the tree",dataSetPaneLastUpdated:"Last updated: %{date}",dataSourcePaneDateUnknown:"Unknown",moreTitle:"More",backLabel:"Go back",addDataSourceDialogTitle:"Select a source",addDataSourceDialogButtonLabel:"Add",dlg_use:"Use",dlg_RelinkDataSourceTitle:'Replace data set "%{dataSourceName}" with ...',propertiesDialogTitle:"Properties",missingDataSetData:"The data for this data set is not available. Refresh the data set or contact your administrator for access to the source.",errorMessageTitle:"Error",calculation_navigation_in_use:"Deleting calculations, filters or navigation paths invalidates all visualizations that reference the deleted item. Are you sure you want to delete?",delete_confirm:"Confirm delete",previewUnavailable:"The data tray and global filters are unavailable for this package type.",contextualGridTabName:"Visualization data",DATA_TRAY_no_data_text:"You don't currently have any data",contextualGridMenuLabel:"Visualization data menu",contextualGridExport:"Export",nullValueText:"Null",relationships_title:"Relationships",forecastDetailsTabName:"Forecasting statistical details",forecastDetailsModelLabel:"Model",forecastDetailsQualityMetricLabel:"Accuracy Measures",forecastDetailsSmoothingCoefLabel:"Parameters",forecastDetailsDiagnostics:"Diagnostics",forecastDetailsForecastLabel:"Forecast",forecastDetailsStatusLabel:"Status",forecastDetailsAccuracyPercentLabel:"Accuracy %",forecastDetailsTrendLabel:"Trend",forecastDetailsSeasonLabel:"Seasonality",forecastDetailsSeasonalPeriodLabel:"Seasonal period",forecastDetailsAlphaLabel:"Alpha",forecastDetailsBetaLabel:"Beta",forecastDetailsGammaLabel:"Gamma",forecastDetailsPhiLabel:"Phi",forecastDetailsMissingCount:"Missing count",forecastDetailsSeriesLengthLabel:"Series length",forecastDetailsIgnoredPeriods:"Ignored periods",forecastDetailsTrendStrength:"Trend strength",forecastDetailsSeasonalityStrength:"Seasonality strength",forecastDetailsTimeDeltaUnit:"Date / time interval",forecastDetailsNotes:"Notes",DatasetRefresh_AmbiguousConnection:" Use 'Edit data set' to resolve the following connection issue: %{errorMessage}"}),define("dashboard-analytics/dataSources/nls/StringResources",["i18n!./DataSourcesResources","../../lib/@waca/core-client/js/core-client/utils/Lexicon"],(function(e,t){"use strict";var i=new t({data:e,verbose:!0}),n=function(){};return n.prototype.get=function(e,t){return i.translate(e,t)},new n})),define("dashboard-analytics/dataSources/services/DatasetExecutionService",["../../lib/@waca/core-client/js/core-client/ui/core/Events","../../lib/@waca/core-client/js/core-client/nls/StringResources","../nls/StringResources","../../lib/@waca/core-client/js/core-client/ui/ProgressToast","../../lib/@waca/core-client/js/core-client/utils/Deferred","underscore"],(function(e,t,i,n,r,o){"use strict";var a="application/vnd.ibm.bi.platform.execution+json; charset=UTF-8",s=e.extend({init:function(){s.inherited("init",this,arguments),this._backgroundExecutions={},this._pingTimeouts=[300,600,1e3,1500,2e3,4e3,6e3,1e4],this._defaultOptions={showToastWhenDone:!0}},execute:function(e){var t=this;o.defaults(e,this._defaultOptions),this._initLogger(e.glassContext),this.isExecuting(e.id)&&this.cancel(e,!1);var i=Date.now();e.timestamp=i,this._backgroundExecutions[e.id]={status:"executing",timestamp:i,isRefresh:e.isRefresh},e.showToastWhenDone&&this._createProgressToast(e);var n=JSON.stringify({options:{delivery:{save:{notify:!1}}}});return Promise.resolve().then((function(){return e.glassContext.services.ajax.post("v1/datasets/"+e.id+"/executions",{headers:{"Content-Type":a,Accept:"application/json"},datatype:"json",data:n}).then(function(t,i,n){this._backgroundExecutions[e.id].executionURL=n.getResponseHeader("location"),this._backgroundExecutions[e.id].eventID=t.eventID,this._pingForStatus(e)}.bind(t),(function(i){throw t._rejectDeferredObjects(e,"failed"),new Error("Execution failed: "+i.message)}))}))},_initLogger:function(e){var t=this;!this.logger&&e&&e.getSvc(".Logger").then((function(e){return t.logger=e}))},_createProgressToast:function(e){var t=new n;t.show(this._getToastMessage(e)),t.indefinite(this._getToastMessage(e)),t.onCancel(function(e){this.cancel(e,!0)}.bind(this,e)),t.onHide(function(e){this._hideProgressToast(e.id)}.bind(this,e)),this._backgroundExecutions[e.id].progressToast=t},_hideProgressToast:function(e){var t=this._backgroundExecutions[e];t&&t.progressToast&&(t.progressToast.remove(0),t.progressToast=null)},_showErrorToast:function(e,t){var i=this._backgroundExecutions[e.id];if(e.showToastWhenDone)if(i&&i.progressToast){var n=i.progressToast;i.progressToast=null,n.fail(this._getToastMessage(e,t)),n.hideButton("cancel")}else e.glassContext.appController.showToast(this._getToastMessage(e),{type:"error"})},_showCancelledRefreshToast:function(e){e.glassContext.appController.showToast(this._getToastMessage(e),{type:"info"})},_pingForStatus:function(e){var t=this._backgroundExecutions[e.id];if(t&&e.timestamp===t.timestamp&&t.executionURL&&"cancelled"!==t.status)return"failed"===t.status?(this._rejectDeferredObjects(e,"failed"),void this._cleanupAfterExecutionFinished(e.id)):void(this.isExecuting(e.id)?e.glassContext.services.ajax.get(t.executionURL,{headers:{"Content-Type":a,Accept:"application/json"},datatype:"json"}).then(function(i){t.status=i.status,this._processExecutionStatus(t.status,e)}.bind(this),(function(){this._rejectDeferredObjects(e,"statusPingFailed")})):this._processExecutionStatus(t.status,e))},_processExecutionStatus:function(e,t){var i=this,n=this._backgroundExecutions[t.id];switch(e){case"complete":case"succeeded":"cancelled"===n.status?this._rejectDeferredObjects(t,"cancelled"):(this._resolveDefferedObjects(t.id),t.showToastWhenDone&&t.glassContext.appController.showToast(this._getToastMessage(t)),this.trigger("loadComplete",{id:t.id})),this._cleanupAfterExecutionFinished(t.id);break;case"cancelled":this._rejectDeferredObjects(t,"cancelled"),this._cleanupAfterExecutionFinished(t.id);break;case"failed":this._getErrorMessage(t).then((function(e){var n=i._augmentConnectionErrorMessages(e);i._rejectDeferredObjects(t,"failed",n),i._cleanupAfterExecutionFinished(t.id)}));break;case"executing":case"pending":var r=t.pingTimeoutIndex||0;(r+=1)>=this._pingTimeouts.length&&(r=this._pingTimeouts.length-1),t.pingTimeoutIndex=r,setTimeout(function(){this._pingForStatus(t)}.bind(this),this._pingTimeouts[r]);break;default:this._cleanupAfterExecutionFinished(t.id),console.debug("Unknown status returned  by "+n.executionURL+". Status of: "+e)}},_augmentConnectionErrorMessages:function(e){return["QE-DEF-0283","QE-DEF-0284","QE-DEF-0286"].some((function(t){return 0===e.indexOf(t)}))?i.get("DatasetRefresh_AmbiguousConnection",{errorMessage:e}):e},_rejectDeferredObjects:function(e,t,i){var n=this._backgroundExecutions[e.id];n&&(n.status=t,"failed"===t&&this._showErrorToast(e,i),n.deferredObjects&&n.deferredObjects.forEach((function(e){e.reject({status:t})})))},_logError:function(){var e;this.logger&&(e=this.logger).error.apply(e,arguments)},_getErrorMessage:function(e){var t=this;return this._getItemLastHistoryEntry(e).catch((function(i){return t._logError("Error trying to read history of asset "+e.id,i)})).then((function(i){return i&&t._getHistoryEntryDetailMessage(e,i)})).catch((function(i){return t._logError("Error trying to read history details of asset "+e.id,i)}))},_getItemLastHistoryEntry:function(e){return e.glassContext.services.ajax.get("v1/objects/"+e.id+"/items?types=history").then((function(e){return e&&e.data&&o.max(e.data,(function(e){var t=e.modificationTime;return Date.parse(t)}))}))},_getHistoryEntryDetailMessage:function(e,t){var i=t._meta&&t._meta.links&&t._meta.links.details&&t._meta.links.details.url;return i&&e.glassContext.services.ajax.get(i).then((function(e){var t=e&&e.data&&e.data.messages&&e.data.messages.length&&e.data.messages[0];return t&&t.detail}))},_resolveDefferedObjects:function(e){var t=this._backgroundExecutions[e];t.deferredObjects&&t.deferredObjects.forEach((function(e){e.resolve()}))},_cleanupAfterExecutionFinished:function(e){this._hideProgressToast(e),this._backgroundExecutions[e]={status:this._backgroundExecutions[e].status}},cancel:function(e,t){this._hideProgressToast(e.id);var i=this._backgroundExecutions[e.id];i&&this.isExecuting(e.id)&&(i.status="cancelled",!1!==t&&this._showCancelledRefreshToast(e),this._rejectDeferredObjects(e,"cancelled"),i.executionURL&&e.glassContext.services.ajax.delete(i.executionURL,{headers:{"Content-Type":a,Accept:"application/json"},datatype:"json"}))},whenComplete:function(e){var t=new r,i=this.getStatus(e),n=this._backgroundExecutions[e];return n&&"complete"!==i?"failed"===i||"cancelled"===i?t.reject({status:i}):(n.deferredObjects||(n.deferredObjects=[]),n.deferredObjects.push(t)):t.resolve(),t.promise},getStatus:function(e){return this._backgroundExecutions[e]?this._backgroundExecutions[e].status:null},isExecuting:function(e){var t=this.getStatus(e);return"pending"===t||"executing"===t},_getToastMessage:function(e,i){var n=this._backgroundExecutions[e.id];if(!n)return"";var r="";if(n.isRefresh)switch(n.status){case"executing":case"pending":r="datasetRefreshing";break;case"complete":case"succeeded":r="datasetFinishedRefreshing";break;case"failed":r="datasetRefreshFailed";break;case"cancelled":r="datasetRefreshCancelled"}else switch(n.status){case"executing":case"pending":r="datasetLoading";break;case"complete":case"succeeded":r="datasetFinishedLoading";break;case"failed":r="datasetLoadingFailed";break;case"cancelled":r="datasetLoadingCancelled"}return[t.get(r,{name:e.name}),i].filter((function(e){return!!e})).join("\n")}});return s})),define("dashboard-analytics/widgets/livewidget/nls/DashboardLWResources",{root:!0,cs:!0,da:!0,de:!0,es:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,it:!0,ja:!0,kk:!0,ko:!0,no:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-br":!0,ro:!0,ru:!0,sl:!0,sv:!0,th:!0,tr:!0,zh:!0,"zh-cn":!0,"zh-tw":!0}),define("dashboard-analytics/widgets/livewidget/nls/root/DashboardLWResources",{testString:"test",visualizationSlideoutTitle:"Visualizations",listSeparator:",",pointSeparator:":",minValuePlaceholder:"Enter a number",maxValuePlaceholder:"Enter a number",customRangeErrorMessage:"Value must be a number",propFillColor:"Fill color",propBorderColor:"Border color",propBorderRadius:"Corner radius (px)",propColorPalette:"Current color palette",propColorPaletteChangeLabel:"Change color palette",propNewColorPaletteLabel:"Create a custom color palette",propNewHeatPaletteLabel:"Create a custom heat palette",showTitleLabel:"Show title",titleTypeLabel:"Title type",smartTitleLabel:"Smart title",customTitleLabel:"Custom title",noTitleLabel:"No title",colorPaletteTitle:"Palette",responsiveTitleLabel:"Responsive title",propHeatScalePalette:"Current heat palette",propHeatPaletteChangeLabel:"Change heat palette",propMaintainAxisScales:"Maintain axis scale",propLineAndSymbolColor:"Line and symbol color",propLineAndSymbolPalette:"Line and symbol color palette",propElementColor:"Element color",propColumnColor:"Column color",propColumnPalette:"Column color palette",propColumnHeatPalette:"Column heat palette",propBarColor:"Bar color",propGoalColor:"Target color",propToColor:"To color",propFromColor:"From color",propNumberValidationErrorMessageId:"Enter a number",fontSizeAuto:"Auto",propAutoBinCount:"Number of groups",propAutoBinToggle:"Auto-grouping",tabName_general:"General",tabName_visDetails:"Details",tabName_animation:"Animation",tabName_mediaDetails:"Media details",tabName_webDetails:"Web page details",tabName_imageDetails:"Image details",tabName_visualization:"Visualization",tabName_text:"Text",sectionName_colorsAndThemes:"Color and themes",sectionName_appearance:"Appearance",sectionName_general:"General",sectionName_colorPalette:"Color",sectionName_axis:"Axis",sectionName_axis_label:"Axis",sectionName_legend:"Legend",sectionName_chart:"Chart",sectionName_regionLayer:"Regions layer",sectionName_pointLayer:"Points layer",sectionName_latLongLayer:"Latitude/longitude layer",sectionName_pathLayer:"Path layer",sectionName_xAxis:"X axis",sectionName_yAxis:"Y axis",sectionName_xAxis_title:"X axis title",sectionName_yAxis_title:"Y axis title",sectionName_xAxis_label:"X axis label",sectionName_yAxis_label:"Y axis label",sectionName_column_yAxis:"Column Y axis",sectionName_column_yAxis_label:"Column Y axis label",sectionName_column_yAxis_title:"Column Y axis title",sectionName_line_yAxis:"Line Y axis",sectionName_line_yAxis_label:"Line Y axis label",sectionName_line_yAxis_title:"Line Y axis title",sectionName_title:"Title",sectionName_legendTitle:"Legend title",sectionName_legendLabels:"Legend labels",sectionName_innerValueLabel:"Inner value label",sectionName_style:"Style",propTransparencyDescription:"Make the object more or less transparent. Type in a value between 0 and 100",smart_annotation_unauthorized:"Annotations: unauthorized access",smart_annotation_method:"Annotations: method not allowed",smart_annotation_media:"Annotations: media type not allowed",smart_annotation_input:"Annotations: input invalid",smart_annotation_internal:"Annotations: internal system error",smart_annotation_generic_error:"Annotations: service error",smart_annotation_dialog_title:"Insights",smart_annotation_Show_Insights:"Show insights",smart_annotation_Relationship:"The relationship is",forecast_enter_number:"Enter a number between ",and:" and ",smart_errors:"Annotation errors:",smart_warnings:"Annotation warnings:",smart_annotation_insight_icon_title:"Insights",smart_annotations_toggle_on:"Toggle insights on",smart_annotations_toggle_off:"Toggle insights off",smart_annotation_toggle_on:"Toggle on",smart_annotation_toggle_off:"Toggle off",smart_annotation_insight_unavailable:"Insights are currently not available",smart_annotation_insight_topBottom_percent_unsupported:"Insights are not available when a Top or Bottom % filter is applied",smart_annotation_forecast_topBottom_percent_unsupported:"Forecast is not available when a Top or Bottom % filter is applied",smart_annotation_insight_topBottom_nested_dataItem_unsupported:"Insights are not available when a top or bottom filter is applied and there is more than one column in the field",smart_annotation_forecast_topBottom_nested_dataItem_unsupported:"Forecast is not available when a top or bottom filter is applied and there is more than one column in the field",forecast_title:"Forecast",forecast_show:"Show forecast",forecast_toggle_on:"Toggle forecasting on",forecast_toggle_off:"Toggle forecasting off",statDetails_title:"See statistical details",forecast_optional_factors_max_info:"Maximum of %{max} factors can be added",forecast_optional_factors_num_added:"%{added}/%{max}",forecast_optional_factors:"Optional factors to consider",forecast_optional_factors_placeholderDropzone:"Click or drag data here",forecast_item_tooltip:"Source:",insightsNarrator:"Narrative insights",statDetailsPerspectiveTitle:"Analysis",emptyStatDetailsPanel:"No additional analysis is available for the current visualization.",predict_errors:"Analysis errors",predict_warnings:"Analysis warnings",fpd_invalid_data_source:"This data source does not have an associated smarts module",fpd_network_issue:"There was an issue performing an analysis against this data source",fpd_data_source_category:"Smarts module missing",fpd_response_errors:"Recommended driver errors",fpd_response_warnings:"Recommended driver warnings",catalyst_service_bad_request:"Bad request",catalyst_service_unkown_Id:"Unknown request ID found",catalyst_service_internal_server_error:"Internal Server Error",catalyst_service_generic_error:"Catalyst service error",catalyst_service_error:"This service is not currently available",propLegendPosition:"Legend position",propLeft:"Left",propRight:"Right",propTop:"Top",propBottom:"Bottom",propNone:"None",propLegendDisplay:"Display legend",targetThicknessPlaceHolder:"%{min} to %{max}",targetThicknessErrorMsg:"Enter a whole number between %{min} and %{max}.",possibleKeyDriver_DialogDriversLabelBegin:"Drivers (",possibleKeyDriver_DialogDriversLabelEnd:"selected)",possibleKeyDriver_DialogDriversLabelDivider:"/",possibleKeyDriver_DialogDriversResetToDefaultsLabel:"Reset to defaults",possibelKeyDriver_AddNewDrivers:"Add more drivers",possibleKeyDrivers_NonRecommended_Placeholder:"Search to add more drivers",possibleKeyDrivers_MaxPossibleReached:"Deselect some drivers to add or select others",possibleKeyDrivers_Recommended:"Recommended",visRecommendedTypes:"Recommended visualization types",visRecommender_smartsfailure:"visualization recommendations are not currently available",visMore:"More...",visMoreTooltip:"More visualizations",visOtherTypes:"Other visualization types",visChange:"Change visualization",automaticTypeCaption:"Automatic",propVisType:"Visualization types",dlg_loading:"Loading...",snippetListChartCaption:"Snippet list",convoClusterChartCaption:"Conversation cluster",areaChartCaption:"Area",barChartCaption:"Bar",columnChartCaption:"Column",stackedbarChartCaption:"Stacked bar",stackedcolumnChartCaption:"Stacked column",bubbleChartCaption:"Bubble",marimekkoChartCaption:"Marimekko",cometChartCaption:"Driver analysis",scatterChartCaption:"Scatter",lineChartCaption:"Line",pointChartCaption:"Point",heatChartCaption:"Heat map",bulletChartCaption:"Bullet",waterfallChartCaption:"Waterfall",radarChartCaption:"Radar",boxplotChartCaption:"Box plot",pieChartCaption:"Pie",mapChartCaption:"Map",radialBarChartCaption:"Radial",compositeChartCaption:"Line and column",wordCloudChartCaption:"Word cloud",networkChartCaption:"Network",relationshipNetworkChartCaption:"Relationship network",treemapChartCaption:"Tree map",packedBubbleChartCaption:"Packed bubble",hierarcicalPackedBubbleChartCaption:"Hierarchy bubble",spiralChartCaption:"Spiral",decisionTreeChartCaption:"Decision tree",legacyMapChartCaption:"Legacy map",sunburstChartCaption:"Sunburst",visUsageComparison:"Comparison",visUsageRelationships:"Relationships",visUsageTrend:"Trend",visUsagePartsToWhole:"Parts to whole",visUsageGeospatial:"Geospatial",visUsageAdvanced:"Advanced analytics",visUsageTablesAndSummary:"Tables and summary",visUsageSocialInsights:"Social insights",visUsageOther:"Other",visualizationAnalytics:"Analytics",autoBinActionText:"Auto-group",filterAutobinActionText:"Filter bins",memberCalculationActionText:"Member Calculation",toolbarActionCalculation:"Create calculation",toolbarActionEditCalculation:"Edit calculation",topBottomRankLabel:"Rank (%{label})",toolbarDeleteFilterActionText:"Remove filter",toolbarActionTopKeyDrivers:"Show drivers",toolbarActionCustomGroup:"Custom group",canNotCreateCustomGroup:"We cannot create this custom group.",aria_label_datatable:"Data table",summaryCaption:"Summary",MeasuresCaption:"Measures",MeasuresGroupCaption:"Measures group (%{count})",ValuesCaption:"Values",turnInsightsOn:"Turn insights on",turnInsightsOff:"Turn insights off",decisionRules:"Rules",decisionTree:"Tree diagram",decisionSunburst:"Tree sunburst",switchToDecisionRules:"Switch to decision rules",switchToDecisionTree:"Switch to decision tree",data_group_less_then:"less than %{rangeTo}",data_group_to:"%{rangeFrom} to < %{rangeTo}",data_group_and_above:"%{rangeFrom} and above",nullValueContent:"(no value)",sum:"Sum",count:"Count",countdistinct:"Count distinct",avg:"Average",min:"Minimum",max:"Maximum",automatic:"Custom",variance:"Variance",stddev:"Standard Deviation",median:"Median",calculated:"Calculated",none:"None",measureLabel:"%{measureName}",multiMeasureLabel:"%{measureName} (%{aggregate})",aggregatedColumnLabel:"%{column} (%{aggregationTypeLabel})",promptTitle:"Prompt values",inputLabelPrompt:"Value",inputPlaceholderPrompt:"Enter value",inputInvalidText:"Invalid input for %{dataType} type",unSupportedPrompt:"Unsupported prompt",missingDataSource:"Could not find the right data source.",unSupportedPromptType:"The prompt scenario is not currently supported.",preAggregateLabel:"Apply prompt values from the data source",postAggregateLabel:"Apply prompt values in the report",preAggregateText:"The range uses the values in the data source, not the values displayed in the dashboard.",defaultAggregation_count:"Count",defaultAggregation_countdistinct:"Count distinct",defaultAggregation_max:"Maximum",defaultAggregation_min:"Minimum",defaultAggregation_avg:"Average",defaultAggregation_sum:"Sum",defaultAggregation_auto:"Auto (%{aggregationType})",keydriver_average:"Overall average",keydriver_up_down:"Highlighted groups with high or low averages have more impact on the target. Groups with unusually high or low averages have the strongest impact.",keydriver_different:"Highlighted groups have distributions that differ significantly from the overall distribution. These groups have more impact on the target.",topOperator:"Top",bottomOperator:"Bottom",topBottomFact:"%{operator} %{value}%{percent} by %{columnLabel}",topBottomDimension:"%{operator} %{value}%{percent}",deleteTopBottomCount:"Delete top or bottom count",deleteTopBottomPercent:"Delete top or bottom %",topBottomTitle:"This object only",deleteTopBottom:"Delete top or bottom count",editTopBottom:"Edit top or bottom count",editTopBottomCount:"Edit top or bottom count",editTopBottomPercent:"Edit top or bottom %",deleteDrillOperation:"Cancel drill operation",ariaDeleteTopBottomCountLabel:"Press DELETE key to delete top or bottom count.",ariaDeleteTopBottomPercentLabel:"Press DELETE key to delete top or bottom %.",ariaEditTopBottomCountLabel:"Press ENTER key to edit top or bottom count.",ariaEditTopBottomPercentLabel:"Press ENTER key to edit top or bottom %.",ariaDeleteDrillStateLabel:"Press ENTER key to edit drill operation.",drillUpStateTitle:"Drill up",drillDownStateTitle:"Drill down",ariaEditTopBottomLabel:"Press ENTER key to edit top or bottom count.",ariaDeleteTopBottomLabel:"Press DELETE key to delete top or bottom count.",allKeyDriversLabel:"Auto (all drivers)",filter_drag_and_drop_single_dock:"Drag and drop data here to filter.",filter_drag_and_drop_all_tabs:"Drag and drop data here to filter all tabs.",filter_drag_and_drop_current_tab:"Drag and drop data here to filter this tab.",filter_empty_consume_mode:"No filters have been applied.",filterClearAllItems:"Clear all filters",filterDeleteAllItems:"Delete all filters",filterDockChevronLeft:"Scroll through the data",filterDockChevronRight:"Scroll through the data",filterIconLabel_Single:"Filters",filterIconLabel_Global:"All tabs",filterIconLabel_Tab:"This tab",filterIconTooltip_Single:"Filters",filterIconTooltip_Global:"Filters for all tabs",filterIconTooltip_Tab:"Filters for this tab",filterDropZoneTooltip_Single:"Filter drop zone",filterDropZoneTooltip_Global:"Filter drop zone for all tabs",filterDropZoneTooltip_Tab:"Filter drop zone for this tab",filterOverflowMenu:"More",expand:"Expand",collapse:"Collapse",filterDockItemNameAriaLabel:"Press enter to launch the filter dialog and define the filter.",filterItemCanvasMove:"Add to canvas",addToCascadeSet:"Add to cascade set",removeFromCascadeSet:"Remove from cascade set",filterItemDelete:"Delete filter",filterInvertRange:"everything except: %{from}-%{to}",filterRange:"%{from}-%{to}",filter_date_after_except:"Not after %{from}",filter_date_after:"After %{from}",filter_date_before_except:"Not before %{to}",filter_date_before:"Before %{to}",filter_date_between_except:"Not between %{from}-%{to}",filter_date_between:"Between %{from}-%{to}",filterValueSeparator:",",filterAll:"All",filter:"Filter",filterExcept:"except %{values}",filterDockToolbarButtonLabel:"Filter dock",navigateTitle:"Navigate to",navigateSelectColumn:"Select a column",navigateSelectPath:"Select a navigation path",current_nav_group:"Current navigation group is %{navigation_group_name}",next:"Next",previous:"Previous",multiselectMsg:"%{count} selected",errMsgFilterItemMissingTitle:"The filter value(s) %{itemName} cannot be loaded because these values are not available with this data set",errMsgFilterItemGenericTitle:"Filter values can't be loaded",textFilterItemsNotFound:"No items are available.",nullValueLabel:"(blank)",filterConditionLabel:"Filter condition",filter_includesAll:"Includes all",filter_allMembersOfSet:"All members of the set",modelFilter:"Filter",filtersTitle:"Filter properties",search:"Search",clearTextFilterValue:"Clear",invertFilterSelection:"Invert",modellingLoading:"Loading...",searchAll:"Find all columns",toolbarActionPossibleKeyDrivers:"Edit scope",toolbarActionPossibleKeyDriversSubTitle:"Drag items from the left to be considered in the driver analysis chart",toolbarActionSort:"Sort",toolbarActionSortAscending:"Ascending",toolbarActionSortDescending:"Descending",toolbarActionSortAuto:"Auto (%{sortOrder})",toolbarActionSortCustom:"Custom",toolbarActionFormat:"Format data",toolbarActionFormatText:"Format data (text)",toolbarActionFormatAbbreviation:"Abbreviate",toolbarActionFormatNone:"Auto",toolbarActionFilter:"Filter",toolbarActionTopBottom:"Top or bottom",toolbarActionRmvShape:"Remove shape",toolbarActionToggleShapeDrop:"Infographic shape",toolbarActionToggleShapeDropTitle:"Create an infographic",toolbarActionToggleShapeDropText:"Drag a shape to this field to create an infographic.",toolbarActionAggregationType:"Summarize",toolbarDeleteActionText:"Remove column",toolbarTextActionText:"Style text",toolbarActionFilterLocalKeepSelected:"Keep",toolbarActionFilterLocalExcludeSelected:"Exclude",toolbarActionFilterAllKeepSelected:"Filter",toolbarActionSimpleCalculation:"Simple calculation",toolbarActionDrillBack:"Back",toolbarActionDrillUp:"Drill up",toolbarActionDrillDown:"Drill down",toolbarActionJumpTo:"Drill through",toolbarActionNavigate:"Navigate",toolbarActionCreateFilterGroup:"Create new connection",toolbarActionDisconnectFilterGroup:"Break all links",toolbarActionLinkFilterGroup:"Add to an existing connection",toolbarActionLassoSelect:"Select tool",toolbarActionRefreshDeveloperWidget:"Refresh",textFontFamilySubClassHairline:"Hairline",textFontFamilySubClassThin:"Thin",textFontFamilySubClassThinItalic:"Thin Italic",textFontFamilySubClassExtraLight:"Extra Light",textFontFamilySubClassExtraLightItalic:"Extra Light Italic",textFontFamilySubClassLight:"Light",textFontFamilySubClassLightItalic:"Light Italic",textFontFamilySubClassRegular:"Regular",textFontFamilySubClassRegularItalic:"Regular Italic",textFontFamilySubClassItalic:"Italic",textFontFamilySubClassMedium:"Medium",textFontFamilySubClassMediumItalic:"Medium Italic",textFontFamilySubClassHeavy:"Heavy",textFontFamilySubClassHeavyItalic:"Heavy Italic",textFontFamilySubClassDemiBold:"Demi Bold",textFontFamilySubClassDemiBoldItalic:"Demi Bold Italic",textFontFamilySubClassBold:"Bold",textFontFamilySubClassBoldItalic:"Bold Italic",textFontFamilySubClassExtraBold:"Extra Bold",textFontFamilySubClassExtraBoldItalic:"Extra Bold Italic",textFontFamilySubClassBlack:"Black",textFontFamilySubClassBlackItalic:"Black Italic",textFontFamilySubClassStencil:"Stencil",dlg_ascending:"ascending",dlg_descending:"descending",dlg_custom:"custom",dlg_none:"none",dlg_hierarchy:"hierarchy",dlg_namedSet:"named set",dlg_rank:"rank",visualizationLabel:"Visualization",chartLabel:"%{chartName} chart",dataWidgetDescription:"%{widgetLabel}: %{columnNames}",f12KeyDescription:"Press F12 to navigate within the widget",f10KeyDescription:"Press F10 to launch the widget focus view",playButtonLabel:"Play",dataPlayerValueListLabel:"Data player values",localFilterTitle:"This object only",globalFilterTitle:"All objects",deleteFilter:"Delete filter",editFilter:"Edit filter",ariaEditFilterLabel:"Press ENTER key to edit filter.",ariaDeleteFilterLabel:"Press DELETE key to delete filter.",measureFilterBetween:"Between %{lowerBound} and %{upperBound}",measureFilterNotBetween:"Not between %{lowerBound} and %{upperBound}",dimFilterIn:"Includes: %{in}",dimFilterNotIn:"Excludes: %{out}",gtFilter:"Greater than %{lowerBound}",afterFilter:"After %{lowerBound}",beforeFilter:"Before %{upperBound}",gteFilter:"Greater than or equal to %{lowerBound}",ltFilter:"Less than %{upperBound}",lteFilter:"Less than or equal to %{upperBound}",ariaEditPrompt:"Press ENTER key to change the prompt value",dataPointFilterTitle:"Data points",dataPointFilterIncludeSummary:"Included %{valueCount} data points",dataPointFilterExcludeSummary:"Excluded %{valueCount} data points",widgetFiltersLabel:"Widget filters",coachMarkTitleSpiralTarget:"Edit scope",coachMarkContentSpiralTarget:"This is where you can access and modify the driver selection for your target.",srILVTreeLabel:"List",geomapUnrecognizedLocations:"Unrecognized locations:",geomapAmbiguousLocations:"Ambiguous regions:",visualizationNotifications:"Visualization notifications:",dataNotifications:"Data notifications:",autobinSuggestion:"Turn on auto-grouping",LIVE_empty_visualization_hint_title:"Build your visualization",LIVE_empty_visualization_hint_description:"Drag data here or onto the fields.",LIVE_slots_required_field_description:"%{asterisk} Indicates a required field",LIVE_slots_drag_and_drop_description:"Drag and drop data to the fields above to build and filter the visualization.",tooltipSlotDefaultCaption:"Tooltip",tooltipSlotCompositeLineCaption:"Line tooltip",tooltipSlotCompositeColumnCaption:"Column tooltip",dwErrorLoadingAvailableVisualizations:"We can't load the available visualization definitions",moreDataIndicator:"Your data was clipped at %{threshold} items. Apply a filter to show less.",nonCtxTopBottomInvalid:"Defining a top or bottom rule without a context is not supported for crosstabs. It was removed from this crosstab view.  Redefine the rule on one or more categories in the context of %{columnName}.",dwErrorLoadingVisualizationNotFound:"We can't load the object, because it is missing a visualization definition.",dwErrorLoadingVisualizationListNotFound:"We can't load the visualization.",dwErrorRunningQuery:"We can't retrieve the data from data set %{datasetName}.",dwErrorGeoData:"We're having trouble displaying the geographic data in a map. Please choose another visualization type.",dwPromptSignonCancelWarning:"The data for this visualization is unavailable. Please provide the correct credentials.",dwErrorMissingDataset:"We can't load the visualization, because its associated data set \"%{datasetName}\" isn't available.",dwErrorRenderingVisualization:"We can't load this visualization.",dwErrorVisualizationTooSmall:"The visualization is too small to display the data it contains. Make the visualization larger or limit the data it contains.",errorSourceNotFound:"We can't load the visualization, because its associated source \"%{sourceName}\" isn't available.",errorActionNotSupported:'This action is not supported for data source "%{sourceName}".',errorMeasureNotSupportedOnMultiEdges:"The visualization has measures on multiple edges, which is no longer supported. Please place measures on only one edge.",errorExceedAllowableValue:"The estimated number of cells exceeds the allowable value of 100000. Please apply filtering to projected sets to reduce the number of cells.",propScaleLabel:"Quantity of icons",propScaleDescription:"Select the quantity of icons",propScaleFew:"Low",propScaleDefault:"Default",propScaleMany:"High",lastRefresh:"Last refresh: %{timeInterval} ago",widgetTimer:"Widget timer",datasetItemsUnavailable:"Some data set items used in this visualization are unavailable.",datasetItemUnavailable:"This data set item is unavailable",retry:"Retry",widgetConditionalFormatLabel:"Toggle conditional format controls",widgetConditionalFormatTitle:"Edit conditional formatting color",crosstabName:"Crosstab",WidgetLabelWithDescripion:"%{label}. %{description}",value_is_not_available:"N/A",summaryLabel:"%{label} with value %{value}",infographicLabel:"%{label} with value %{value}",warning:"Warning",swapRowsAndColumns:"Swap rows and columns",hideSummariesLabel:"Hide summaries",showSummariesLabel:"Show summaries",hideRowColumn:"Hide",showAllRowColumn:"Show all",dataAssetPropertiesLabel:"Visualization properties",evAdd:"Add a column",evCollapse:"Collapse",evColumns:"Columns",evLocalFilters:"Local filters",evExpand:"Expand",evFilterTooltip:"Filter",missingColumn:"Missing: %{columnLabel}",missingFiltering:"Missing filters on columns:",missingDataItem:'The referenced data item "%{dataItemId}" is not found in the widget.',heatByLabel:"Heat by",toolbarChangeVisualization:"Change visualization",modellingRelatedTablesNoneFound:"No related tables found",tablesNotJoined:"Relationships between tables are not defined.",fixTableJoin_edit:"View relationships",processing:"Processing...",errorCellWarning:"Some summary values could not be calculated.",aggregateTypeToggler:"Show aggregation type",maxColumnsExceeded:"Maximum number of columns exceeded. %{columns} dropped.",unboundColumns:"Unable to use the following columns: %{columns}.",unboundColumn:"Unable to use the following column: %{columns}.",recommendRequestFailed:"Recommendation request failed. Please contact your administrator.",visualizationDoesNotSupportOLAP:"We cannot create this visualization that is based on an OLAP data source. Please use another supported data source.",showDataBehindVizLabel:"Show data",showDataBehindVizNotSupportedLabel:"Show data is not supported for this visualization type",exploreData:"Explore ...",newExplore:"New Exploration",thumbnails_error_fetching:"Error fetching thumbnails",loadedThumbnailImage:"Loaded %{visType} visualization thumbnail image",autobinAxisLabel:"groups",recommended_visualizations:"Recommended visualizations",all_visualizations:"All visualizations",edit:"Edit",selectTargetDialogTitle:"Select a drill-through target",noTargetInCM:"Unable to find the target of the drill-through",errorDrillDefinition:"Something went wrong while you were adding or editing the drill-through definition.",errorDrillToTarget:'An error occurred to drill to "%{targetName}"',drillThroughMappingViewLabel:"Assign columns from your dashboard to the prompts of the target report",drillthroughScopeRadioLabel:"Apply this definition to:",drillthroughScopeRadioOptionVisualization:"This visualization only",drillthroughScopeRadioOptionConnection:"Visualizations in the same connection that use the same data source",drillthroughScopeRadioOptionDashboard:"Any visualization on the %{perspective} that uses the same data source",drillThroughParametersColumnTitle:'"%{targetName}" prompts:',drillThroughMetadataColumnTitle:'"%{boardName}" data columns:',drillThroughDefinitionNoParameter:"The drill-through target has no prompts.",drillThroughDefinitionErrorQueryingReport:"Correct the problem with the target report, and then try again to create the drill-through definition.",drillThroughDefinitionErrorDlgTitle:"Something went wrong",dlg_back:"Go back",dlg_close:"Close",dlg_ok:"OK",dlg_cancel:"Cancel",dlg_apply:"Apply",dlg_create:"Create",dlg_done:"Done",drillthrough_unsaveMsg:'Continue without saving "%{name}"?',drillthrough_jumpTo:"Drill-through definition: %{name}",drillthrough_jumpToLabel:"Drill through",drillthrough_manage:"Manage...",drillthrough_addNewTarget:"Add a new drill-through definition",drillthrough_manageJumpPaths:"Manage drill-through definitions",drillthrough_manageJumpPaths_edit:'Edit "%{name}"',drillthrough_manageJumpPaths_delete:'Delete "%{name}"',drillthrough_manageAddAnotherTarget:"Add another drill-through definition",drillthrough_manageConfirmeDeleteDrillTargetTitle:"Confirm delete",drillthrough_manageConfirmeDeleteDrillTarget:'Are you sure you want to delete drill-through "%{name}"?',drillthrough_definitionDuplicateDrillTargetErrorTitle:"Duplicate drill-through name",drillthrough_definitionMessage:'Drill-through "%{name}" already exists. Provide a different name',drillthrough_jumpToTarget_notFound:'Target not found for drill-through "%{name}"',drillThroughDefinitionNoParameterSubTitle:"No context will be passed to the target report.",drillthrough_titleLabel:"Name",drillthrough_create_dialogTitle:"Create drill-through definition",drillthrough_edit_dialogTitle:"Edit drill-through definition",drillthrough_subTitle:"The context of the visualization in your source is used to filter the target %{perspective}.",drillthrough_selectColumn:"Select a column",noPrompt:"No prompts",promptDialog:"%{promptType} prompt dialog",formatAutoDescription:"Auto specifies the format inherited from your data source or visualization.",formatDefaultDescription:"Default specifies the format inherited from the system",createCustomGroupAction:"Create data group",removeCustomGroupAction:"Remove data group",editCustomGroupAction:"Edit data group",renameCustomGroupAction:"Rename data group",createCustomGroupErrorToast:"Your data group could not be created.",removeCustomGroupErrorToast:"Your data group could not be removed.",editCustomGroupErrorToast:"Your data group could not be edited.",renameCustomGroupErrorToast:"Your data group could not be renamed.",customGroupLabel:"Create data group",ungroupCustomGroupLabel:"Ungroup",renameCustomGroupLabel:"Rename",createCustomGroupLabel:"Create",customGroupingLabel:"%{columnLabel} (Group)",createCustomBinningErrorToast:"Your auto group could not be created.",removeCustomBinningErrorToast:"Your auto group could not be removed.",createCustomSort:"Create custom sort",unavaiableData:"No data",createCustomSortTitle:"%{name}",createCustomSortDesc:"Select available items then reorder them to create a custom sort.",availableItems:"Available items",selectAll:"Select all",customSortOrder:"Custom sort order",selectAvailableItemsDesc:"Select available items then reorder them here.",moveToTop:"Move to top",clear:"Clear",sortRemainingItemsBy:"Sort remaining items by",removeAll:"Remove all",resetTooltip:"All items will be removed from the %{customSortOrder} list. And, the %{sortRemainingItemsBy} drop-down will revert to the default.",manyItemsWarning:"Selecting many items may impact the performance of your dashboard.",manyItemsSelected:"More than %{maxItems} items have been selected, this may impact the performance of your dashboard.",somethingWentWrong:"Uh oh. Something's not quite right.",tryAgain:"Try again",customSortLabel:"Custom sort",applyError:"Unable to apply %{action}.",searchReturnedNoResults:"Hmm, your search didn't return any results.",extVisSystem:"System",extVisCustom:"Custom",customVisTestVisualization:"Test visualization",extVisCustomVisPreview:"preview",extVisCustomPreviewWidgets:"Developer widgets",extVisCustomVVisualization:"Visualization",extVisCustomVisuals:"Custom visuals",noPermissionToManage:"You do not have permission to manage custom visualizations.",extVisCustomUpdate:"Update",extVisCustomDelete:"Delete",extVisNoCustomVisuals:"No custom visuals",extVisNoCustomVisualsMsg:"There are currently no custom visuals in your organization",extVisAddCustomVisual:"Add a custom visual",extVisNoCustomVisualsAdminMsg:"There are currently no custom visuals. Add one to get started",extVisNoSDKConnection:"No connection has been created to your local file",extVisNoSDKPreviewMsg:"To preview your visualizations, please establish a connection.",extVisMore:"More",extVisDeleteDialogTitle:"Delete custom visual",extVisDeleteDialogBody:"Are you sure you want to delete this custom visualization? This might be in use by other dashboards and reports.",extVisDeleteConfirmation:"Your custom visual was deleted.",extVisDeleteError:"Your custom visual could not be deleted. %{msg}",extVisCloseToast:"Close now",extVisAdd:"Your custom visual was successfully added.",extVisAddError:"Your custom visual could not be added. %{msg}",extVisUpdate:"Your custom visual was successfully updated.",extVisUpdateError:"Your custom visual could not be updated. %{msg}",extVisAddProgress:"Importing %{name}",extVisUpdateProgress:"Updating %{name}",extPermissionTitle:"Restricted access or deleted custom visual",extPermissionBody:"This custom visual cannot be viewed because it has either been deleted or has restricted access.",customVizSaveWarning:"Your custom visuals cannot be saved. They have not been imported.",schematicTestCaption:"Test schematic",schematicServiceRequestError:"Schematic service error",extVisPreviewMessage:"This is a preview. The visualization has not been added to the product yet.",kpiTargetWithDistance:"%{value} (%{distance})",kpiDistanceUndefined:"Undefined",kpiDefaultTargetLabel:"Target",kpiNonNumericTarget:"The target value must be a number.",kpiManualTargetSlotFilled:"Value applied in field",kpiAutoValueSize:"Auto",kpiUnableDrawSparklineLabel:"Unable to draw sparkline",kpiUnableDrawSparklineInfo:"A sparkline requires a minimum of two points in time. Change the data or adjust the filters to see the sparkline.",conditionalFormattingTextColor:"Text color",suppression:"Suppression",suppressNone:"None",suppressRowsAndColumns:"Rows and Columns",suppressRows:"Rows",suppressColumns:"Columns",enableSuppression:"Enable suppression",disableSuppression:"Disable suppression",loadVisDefinitionError:"Unable to load definition for visualization %{id}",emptyVisualization:"Empty visualization",expandCollapse:"Expand & collapse",expandBtnLabel:"Expand",collapseBtnLabel:"Collapse",prop_sizeInputNonNumericValue:"The value must be a number.",prop_sizeValueShouldBeHigher:"The value must be greater than %{value}.",fontPropLabel:"Font family",fontSizePropLabel:"Font size",sectionItemAxisTitle:"Item axis title",sectionItemAxisLabel:"Item axis label",sectionValueAxisTitle:"Value axis title",sectionValueAxisLabel:"Value axis label",sectionRepeatColumnTitle:"Repeat column title",sectionRepeatRowTitle:"Repeat row title","styletext-widget.legend":"Legend","styletext-itemAxis.ticks.labels":"Axis labels","styletext-valueAxis.title":"Axis titles","styletext-itemAxis.title":"Axis titles","styletext-labels":"Data labels","styletext-valueAxis.line.title":"Line titles","styletext-cellValue":"Values","styletext-values":"Values","styletext-rowHeading":"Row headings","styletext-columnHeading":"Column headings",regularFontStyle:"Regular",fontFamily:"family",fontSize:"size",visExportFileName:"Visualization","ds-missingDataSet":"Could not find dataset. Please make sure dataset is created successfully.","ds-missingDashboardId":"Please save dashboard before creating the dataset.","ds-unsupportedDataSourceType":"The %{type} data source type is not supported.",dataCache:"Data cache",dataCache_on:"On",dataCache_off:"No cache",dataCache_auto:"Automatic",queryOptimization:"Query optimization",propshowDataGridInConsumeMode:"Show data grid in preview",dtMatchMetadata:"Use matching metadata to filter the target dashboard.",dtMatchMetadata_info:"If the target dashboard is based on a different data source, apply filters when metadata identifiers match. This might affect performance.",dtOverrideExistingFilters:"Override only global filters that are already present in the target dashboard.\nOther filters on the source visualization are ignored.",OnLoadFilterModifierDatasourceMismatch:"Filters will not be applied to the target because the dashboards are using different sources.",OnLoadFilterModifierColumnMismatch:"One or more filters were not applied because the matching column(s) could not be found.",showValuesOn:"Show values on",showValuesAsRowLabel:"Rows (when best)",showValuesAsColumnLabel:"Columns (when best)",dropdownMultiSelectClearAll:"Clear all selections",dropdownSingleSelectClearAll:"Clear selection",dropdownOpenMenu:"Open menu",dropdownCloseMenu:"Close menu",cascadingFiltersSection:"Cascading filter settings",cascadeStrategy:"Cascade set strategy",cascadeStrategy_FirstToLast:"First to last",cascadeStrategy_MultiDirectional:"Multidirectional",cascade_globalToTab:"Cascade All tabs filters",cascade_tabToLocal:"Cascade This tab filters to local",showAllData:"Show all values",showAllFilterValue:"(%{value})",valuesCascaded:"Values filtered by All tabs",AnalyticsMsgDefault:"The widget selected does not use forecasting or analytic insights",AnalyticsDescriptionDefault:"Select a visualization with analytics support to view and manage the analytics settings.",AnalyticsMsgNoContent:"No visualization selected",AnalyticsMsgMultiSelected:"Multiple widgets selected",AnalyticsDescriptionMultiSelected:"Select one visualization to view and manage the analytics setting for it.",ChartInsightPinnedSectionDescription:"Your favorite narrative insights are also shared when you share the dashboard. Insights might be affected by data changes and are not shown if they do not apply to the current data.",ChartInsightNonPinnedSectionDescription:"Suggested insights are system generated for your visualization. These insights can change if there is a change in the data.",ChartInsightPinnedSectionTitle:"Favorite insights (%{count})",ChartInsightNonPinnedSectionTitle:"Suggested insights (%{count})",ChartInsightPinnedEmpty:"Click the star icon for a suggested insight to add it as a favorite.",ChartInsightAllInsightsPinned:"No new insights are available or all suggested insights were added to favorites.",ChartInsightNoRecommendedInsights:"There are no insights for this visualization.",ChartInsightLoadingMessage:"Finding narrative insights for your data",ChartInsightConsumePinnedInsightsDesc:"The dashboard author has favorited these insights.",MoveUp:"Move insight up",MoveDown:"Move insight down",Star:"Add insight to favorites",Unstar:"Remove insight from favorites",DisabledUnstar:"Favorited insight",PdfPrintSectionLabel:"PDF print settings",PdfPrintOptionsLabel:"Print options",PdfPrintInViewLabel:"In view",PdfPrintExtendedContentLabel:"Extended content",PdfPrintNewPageLabel:"New page"}),define("dashboard-analytics/widgets/livewidget/nls/StringResources",["i18n!./DashboardLWResources","jquery","../../../lib/@waca/core-client/js/core-client/utils/Lexicon"],(function(e,t,i){"use strict";var n=new i({data:e,verbose:!0}),r=function(){};return r.prototype.get=function(e,t){return n.translate(e,t)},new r})),define("dashboard-analytics/drill-through/glassControllers/SelectDrillTargetActionHandler",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../../widgets/livewidget/nls/StringResources","underscore"],(function(e,t,i){"use strict";var n=e.extend({init:function(e){n.inherited("init",this,arguments),this.dashboardApi=e},selectTarget:function(e){var i=this;if(!(e=e||{}).handlers||!e.handlers.onSelect)throw new Error("onSelect handler must be provided");var n={typesToOpen:["report","reportView","exploration"],dataManipulationCallback:this._filterOutExploration.bind(this),extraUrlParameters:["base"],multiSelect:!1,dialogTitle:t.get("selectTargetDialogTitle"),primaryBtnText:t.get("dlg_ok"),onOpenCallback:function(t){i._addDrillTarget(e.handlers.onSelect,t)}};this.dashboardApi.prepareGlassOptions(n);try{return this._selectTargetFromOpenDialog(n)}catch(e){throw new Error(e)}},_filterOutExploration:function(e){e.data&&e.data.length&&(e.data=e.data.filter((function(e){return!e.tags||"exploration"!==e.type||-1!==e.tags.indexOf("dashboard")||-1!==e.tags.indexOf("story")})))},_selectTargetFromOpenDialog:function(e){return this.dashboardApi.getGlassSvc(".ContentDialogFactory").then((function(t){return new Promise((function(i,n){t.createOpenDialog(_extends({},e,{resolve:i,reject:n})).open()}))}))},_addDrillTarget:function(e,t){var n=t[0],r="authoring";"exploration"===n.type&&(r=-1!==n.tags.indexOf("story")?"story":"dashboard"),e({assetId:n.id,name:n.defaultName,type:n.type,searchPath:n.searchPath,isOlapPackage:n.userInterfaces&&i.indexOf(n.userInterfaces,"analysisStudio")>=0,modificationTime:n.modificationTime,perspective:r})}});return n})),define("dashboard-analytics/DynamicFileLoader",["require"],(function(e){"use strict";if(-1===e.toUrl("./").indexOf("dashboard-analytics"))throw new Error("Loader.js MUST be in the dashboard-analytics folder");return{_require:e,load:function(e){if(!Array.isArray(e))throw new Error("modules must be an array");var t=[];e.forEach((function(e){e&&e.length?-1!==e.indexOf("text!")?t.push(e.replace("text!","text!../")):t.push("../"+e):t.push("")}));var i=[],n=[];return t.forEach((function(){var e={},t=new Promise((function(t,i){e.resolve=t,e.reject=i}));n.push(e),i.push(t)})),this._require(t,(function(){for(var e=0;e<t.length;e++)n[e].resolve(e<arguments.length?arguments[e]:void 0)}),(function(e){n[0].reject(e)})),Promise.all(i)}}})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionHeader",["underscore","jquery","../../../../widgets/livewidget/nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,i,n,r,o,a){var s=o.FlexLayout,l=o.Label,c=function(e){function t(t){return e.call(this,t)||this}return _inheritsLoose(t,e),t.prototype.render=function(){return r.createElement(s,{className:"dtEditTitle",direction:"column"},r.createElement(l,{className:"dtEditSubTitle","aria-label":this.props.drillDefinitionName,label:this.props.drillDefinitionName,tabIndex:0}),r.createElement(l,{className:"dtEditMainTitle","aria-label":this.props.mainTitle,label:this.props.mainTitle,tabIndex:0}),r.createElement(l,{className:"dtEditInfo","aria-label":this.props.subTitle,label:this.props.subTitle,tabIndex:0}))},t}(r.Component);return c.propTypes={drillDefinitionName:a.string,mainTitle:a.string,subTitle:a.string},c})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionTitleInput",["underscore","jquery","../../../../widgets/livewidget/nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,i,n,r,o,a){var s=o.Container,l=o.Label,c=o.TextInput,u=function(e){function t(t){var i;return(i=e.call(this,t)||this).handlers=t.handlers,i.state={name:i.props.name},i}_inheritsLoose(t,e);var n=t.prototype;return n.render=function(){return r.createElement(s,{className:"dtTitleInput"},r.createElement(l,{id:"dtTitleInputLabel",type:"caption",label:i.get("drillthrough_titleLabel")}),r.createElement(c,{id:"dtTitleInput",value:this.state.name,onChange:this._onChange.bind(this)}))},n._onChange=function(e){this.handlers.onNameChange(e),this.setState({name:e})},t}(r.Component);return u.propTypes={name:a.string,handlers:a.object},u})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionScope",["underscore","jquery","../../../../widgets/livewidget/nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,i,n,r,o,a){var s=o.Container,l=o.Label,c=o.RadioGroup,u=function(e){function t(t){var i;return(i=e.call(this,t)||this).state={checked:t.checked},i}_inheritsLoose(t,e);var n=t.prototype;return n.render=function(){var e=this,t=[{label:i.get("drillthroughScopeRadioOptionVisualization"),value:"visualization"},{label:i.get("drillthroughScopeRadioOptionConnection"),value:"connection"},{label:i.get("drillthroughScopeRadioOptionDashboard",{perspective:this.props.applicationName}),value:"dashboard"}];return r.createElement(s,{className:"dtEditFooter"},r.createElement(l,{id:"dtScopeRadioLabel",type:"caption",label:i.get("drillthroughScopeRadioLabel")}),r.createElement(c,{direction:"vertical",options:t,"aria-labelledby":"dtScopeRadioLabel",checked:this.state.checked,onChange:function(t){e._onScopeChange(t)}}))},n._onScopeChange=function(e){this.setState({checked:e}),this.props.onChange(e)},t}(r.Component);return u.propTypes={checked:a.string,onChange:a.func,applicationName:a.string},u})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionSelectMenu",["react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types","jquery"],(function(e,t,i,n,r){var o=i.List,a=i.Label,s=13,l=38,c=40,u=9,d=function(e){function i(i){var n;return(n=e.call(this,i)||this).selectMenuRef=t.createRef(),r(document.body).on("click",n._clickawayHandler.bind(_assertThisInitialized(n))),n}_inheritsLoose(i,e);var n=i.prototype;return n._renderMenuItem=function(e){var i=e-1,n=this.props.getRow(this.props.rowId),r=n.state.selectedIndex===i,o=-1===i?this.props.noMappingText:n.state.values[i],s=r?"dtSelectListItem dtSelected":"dtSelectListItem",l=r?"dt-activedescendant":"";return t.createElement(a,{"aria-label":o,title:o,role:"option","data-optId":i,className:s,id:l,label:o})},n._getRefNode=function(){return this.selectMenuRef.current&&this.selectMenuRef.current._node},n._clickawayHandler=function(e){var t=this._getRefNode();if(this.props.onClose&&t&&!t.contains(e.target)){var i=r(t).parent();i&&!i[0].contains(e.target)&&this.props.onClose()}},n._onSelectMenuOpened=function(){this.props.onSelectMenuOpened&&this.props.onSelectMenuOpened(this._getRefNode())},n._onSelectValue=function(e){this.props.onSelectValue&&(e.rowId=this.props.rowId,this.props.onSelectValue(e))},n.componentDidMount=function(){this._onSelectMenuOpened()},n.componentWillUnmount=function(){r(document.body).off("click",this._clickawayHandler.bind(this))},n.render=function(){var e=this.props.getRow(this.props.rowId),i=e.state.selectedIndex+1,n=e.state.values.length+1;return t.createElement(o,{length:n,itemRenderer:this._renderMenuItem.bind(this),className:"dtSelectList","data-rowId":this.props.rowId,ref:this.selectMenuRef,onSelectionChange:this._onSelectValue.bind(this),selectionMode:"single",activeIndex:i,style:{display:"block"},onKeyDown:this._onKeyDown.bind(this)})},n._onKeyDown=function(e){var t,i=r(this._getRefNode()),n=i.find("span.psuedoHover"),o=null,a=e.which===l||e.keyCode===l,d=e.which===c||e.keyCode===c,h=a||d,g=e.which===s||e.keyCode===s;if((e.which===u||e.keyCode===u)&&this.props.onClose(),n.length&&(t=n.next(),o=n.prev(),h&&(n=(n=n.is(":hover")?n.addClass("noPsuedoHover"):n).removeClass("psuedoHover")).attr("id","")),n.length)if(g){var p=Number.parseInt(n.attr("data-optid"))+1;this._onSelectValue({rowId:this.props.rowId,index:p})}else h&&(a?o&&o.length?o.addClass("psuedoHover").removeClass("noPsuedoHover"):i.find("span").last().addClass("psuedoHover").removeClass("noPsuedoHover"):d&&(t&&t.length?t.addClass("psuedoHover").removeClass("noPsuedoHover"):i.find("span").first().addClass("psuedoHover").removeClass("noPsuedoHover")),e.preventDefault(),e.stopPropagation());else h&&(a?i.find("span").last().addClass("psuedoHover").removeClass("noPsuedoHover"):d&&i.find("span").first().addClass("psuedoHover").removeClass("noPsuedoHover"),e.preventDefault(),e.stopPropagation());(n=i.find("span.psuedoHover")).attr("id","dt-activedescendant"),n.focus(),n.length&&!this.props.iswithinVerticalBounds(n,i)&&n.get(0).scrollIntoView()},i}(t.Component);return d.propTypes={rowId:n.string,getRow:n.func,noMappingText:n.string,onSelectMenuOpened:n.func,onSelectValue:n.func,onClose:n.func,iswithinVerticalBounds:n.func},d})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionPrompts",["underscore","jquery","../../../../widgets/livewidget/nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types","./DrillThroughDefinitionSelectMenu"],(function(e,t,i,n,r,o,a,s){var l=o.Container,c=o.ProgressIndicator,u=o.SVGIcon,d=o.FlexItem,h=o.Label,g=o.List,p=13,f=function(e){function n(t){var n;return(n=e.call(this,t)||this).noPromptHeading=i.get("noPrompt"),n.noPromptDetails=i.get("drillThroughDefinitionNoParameter"),n.reportIcon=n.props.iconsFeature.getIcon("reportIcon"),n.currentApplicationIcon="story"===n.props.currentApplicationName?n.props.iconsFeature.getIcon("storyIcon"):n.props.iconsFeature.getIcon("dashboardIcon"),n.chevronLeftIcon=n.props.iconsFeature.getIcon("common-chevron_left"),n.selectedIndexOfRows=[],n.state={rowIdToShowMenu:"-1",selectedIndexOfRows:n.selectedIndexOfRows},n.selectColumnText=i.get("drillthrough_selectColumn"),n}_inheritsLoose(n,e);var o=n.prototype;return o._renderNoPrompt=function(){return r.createElement(l,{className:"dtEditTable dtNoPromptTable"},r.createElement(l,{className:"dtNoPrompt"},r.createElement(l,{className:"dtNoPromptIconContainer"},r.createElement(u,{iconId:"visualizations-drillthrough_no_prompt_16",className:"dtIcon"})),r.createElement(l,{className:"noPromptDetails"},r.createElement("h3",{"aria-label":this.noPromptHeading,title:this.noPromptHeading}," ",this.noPromptHeading," "),r.createElement("p",{"aria-label":this.noPromptDetails,title:this.noPromptDetails,tabIndex:0}," ",this.noPromptDetails," "))))},o._renderLoading=function(){return r.createElement(l,{className:"dtEditTable dtLoading"},r.createElement(c,{tabIndex:0,size:"normal"}))},o._renderHeaderColumn=function(e,t){return r.createElement(d,{className:"dtEditTableCol"},r.createElement(l,{className:"dtTableHeaderTitle"},r.createElement(u,{iconId:e.id,className:"dtIcon"}),r.createElement(h,{ellipsis:!0,type:"caption","aria-label":t,label:t,tabIndex:0})))},o._renderPromptHeader=function(){return r.createElement(l,{className:"dtEditTableHeader"},this._renderHeaderColumn(this.reportIcon,this.props.parametersTitle),this._renderHeaderColumn(this.currentApplicationIcon,this.props.metadataTitle))},o._renderSelectMenu=function(e){return e===this.state.rowIdToShowMenu?r.createElement(s,{noMappingText:this.props.noMappingText,rowId:this.state.rowIdToShowMenu,getRow:this.props.getRow,onSelectMenuOpened:this._onSelectMenuOpened.bind(this),onSelectValue:this._onSelectValue.bind(this),onClose:this._closeSelectMenu.bind(this),iswithinVerticalBounds:this._iswithinVerticalBounds.bind(this)}):null},o._renderPromptRow=function(e){var t=this.props.getRow(e),i=0!==this.state.selectedIndexOfRows.length?this.state.selectedIndexOfRows[e]>=0:t.state.selectedIndex>=0,n=i?"dtEditTableRowsItem mapped":"dtEditTableRowsItem",o=i?"dt-checked":"dt-checked hidden",a=t.caption,s="dtIcon dt-checkbox-icon row_checkIcon row_checkIcon_"+e,c=i?t.state.values[t.state.selectedIndex]:this.selectColumnText,g=e.toString()===this.state.rowIdToShowMenu,p="dtDropDownIcon dtIcon";return p+=g?" open":"",r.createElement(l,{className:n},r.createElement(d,{className:"dtEditTableCol"},r.createElement("div",{tabIndex:"0","aria-label":a}),r.createElement("span",{className:s},r.createElement("label",{className:o})),r.createElement("span",{title:a,className:"dtTableHeaderTitle"},a)),r.createElement(d,{className:"dtEditTableCol selectColoumns"},r.createElement(l,{className:"dtSelect"},r.createElement(l,{"aria-activedescendant":"dt-activedescendant",tabindex:"0",className:"dtColDropdown","data-rowId":e,"aria-expanded":g,onClick:this._toggleSelectMenu.bind(this),onKeyDown:this._onDropDownKeydown.bind(this)},r.createElement(h,{className:"dtColDropdownLabel","aria-label":c,label:c}),r.createElement(l,{className:p},r.createElement(u,{icon:this.chevronLeftIcon,className:"svgIcon"}))),this._renderSelectMenu(e.toString()))))},o._renderPromptRows=function(){return r.createElement(g,{length:this.props.rowSize,itemRenderer:this._renderPromptRow.bind(this),className:"dtEditTableRows"})},o._renderPrompt=function(){return r.createElement(l,{className:"dtEditTable"},this._renderPromptHeader(),this._renderPromptRows())},o.render=function(){return this.props.isLoading?this._renderLoading():!this.props.rowSize&&this.props.isReportPerspective?this._renderNoPrompt():this.props.isReportPerspective?this._renderPrompt():null},o._toggleSelectMenu=function(e){var i=t(e.currentTarget),n=i.parent();i.hasClass("dtColDropdown")&&n.find(".dtSelectList").length?this._closeSelectMenu():i.hasClass("dtColDropdown")&&this._openSelectMenu(e)},o._closeSelectMenu=function(){"-1"!==this.state.rowIdToShowMenu&&this.setState({rowIdToShowMenu:"-1"})},o._onSelectMenuOpened=function(e){var i=t(e);this.$selectNode=i.parent(),i.on("mouseover mousemove mousein mouseout",(function(e){i.find("span").removeClass("noPsuedoHover psuedoHover"),t(e.target).addClass("psuedoHover")})),i.show();var n=this.$selectNode.find(".dtSelectList"),r=n.find("span.dtSelected").addClass("psuedoHover");r.length&&(this._iswithinVerticalBounds(r,n)||r.get(0).scrollIntoView()),n.length&&(n.get(0).focus(),this._onDropDownKeydown_bind=this._onDropDownKeydown.bind(this,n),n.keydown(this._onDropDownKeydown_bind))},o._openSelectMenu=function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.dataset.rowid;this.setState({rowIdToShowMenu:t})},o._onSelectValue=function(e){this._selectValue(e),this._closeSelectMenu()},o._selectValue=function(e){var t=e.rowId,i=e.index-1;this.props.handlers.onValueSelected(t,i),this.selectedIndexOfRows=[];for(var n=0;n<this.props.rowSize;n++){var r=this.props.getRow(n);this.selectedIndexOfRows.push(r.state.selectedIndex)}this.setState({selectedIndexOfRows:this.selectedIndexOfRows})},o._onDropDownKeydown=function(e){(e.which===p||e.keyCode===p)&&this._toggleSelectMenu(e)},o._iswithinVerticalBounds=function(e,t){var i=t.get(0).getBoundingClientRect(),n=e.get(0).getBoundingClientRect();return n.top>=i.top&&n.bottom<=i.bottom},n}(r.Component);return f.propTypes={isLoading:a.bool,iconsFeature:a.object,rowSize:a.number,isReportPerspective:a.bool,currentApplicationName:a.string,parametersTitle:a.string,metadataTitle:a.string,getRow:a.func,noMappingText:a.string,handlers:a.object},f})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionOptions",["jquery","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types","../../../../widgets/livewidget/nls/StringResources"],(function(e,t,i,n,r,o){var a=n.FlexLayout,s=n.FlexItem,l=n.Container,c=n.Checkbox,u=n.Tooltip,d=n.SVGIcon,h=function(e){function t(t){var i;return(i=e.call(this,t)||this).state={matchMetadataAcrossSources:t.matchMetadataAcrossSources,overrideExistingFiltersOnly:t.overrideExistingFiltersOnly},i.infoIcon=t.iconsFeature.getIcon("getInformation"),i}_inheritsLoose(t,e);var n=t.prototype;return n.render=function(){var e=this;return i.createElement(l,{className:"dtEditOptions"},i.createElement(a,{wrap:"wrap",direction:"row"},i.createElement(s,null,i.createElement(c,{className:"metadataMatch",labelText:o.get("dtMatchMetadata"),checked:!!this.state.matchMetadataAcrossSources,onChange:function(t){return e.onMetadataMatchChange(t)}})),i.createElement(s,{alignSelf:"center"},i.createElement(u,{title:o.get("dtMatchMetadata_info")},i.createElement(d,{iconId:this.infoIcon.id,verticalAlign:"top",className:"customVisInfoIcon"})))),i.createElement(c,{className:"overrideExistingFilters",labelText:o.get("dtOverrideExistingFilters"),checked:!!this.state.overrideExistingFiltersOnly,onChange:function(t){return e.onOverrideExistingFiltersChange(t)}}))},n.onMetadataMatchChange=function(e){this.setState({matchMetadataAcrossSources:e}),this.props.onMetadataMatchChange(e)},n.onOverrideExistingFiltersChange=function(e){this.setState({overrideExistingFiltersOnly:e}),this.props.onOverrideExistingFiltersChange(e)},t}(i.Component);return h.propTypes={iconsFeature:r.object,matchMetadataAcrossSources:r.bool,overrideExistingFiltersOnly:r.bool,onMetadataMatchChange:r.func,onOverrideExistingFiltersChange:r.func},h})),define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughDefinitionComponents",["underscore","jquery","../../../../widgets/livewidget/nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types","./DrillThroughDefinitionHeader","./DrillThroughDefinitionTitleInput","./DrillThroughDefinitionScope","./DrillThroughDefinitionPrompts","./DrillThroughDefinitionOptions"],(function(e,t,i,n,r,o,a,s,l,c,u,d){var h=o.Dialog,g=function(e){function t(t){var i;return(i=e.call(this,t)||this).state=_extends({},i.props),i.dialogProps={size:"large",clickaway:!1,width:"680px"},i}_inheritsLoose(t,e);var n=t.prototype;return n._onApply=function(e){e&&e.stopPropagation(),this.props.onOK(this.state)},n._onCancel=function(e){e&&e.stopPropagation(),this.props.onCancel()},n._getSubTitleText=function(){return this.props.isLoading?"":this._isReportPerspective()?this.props.rowSize?i.get("drillThroughMappingViewLabel"):i.get("drillThroughDefinitionNoParameterSubTitle"):i.get("drillthrough_subTitle",{perspective:this.props.perspective})},n._getDialogTitleText=function(){return this.props.isCreate?i.get("drillthrough_create_dialogTitle"):i.get("drillthrough_edit_dialogTitle")},n._isReportPerspective=function(){return"exploration"!==this.props.type},n.renderHeader=function(){return r.createElement(s,{drillDefinitionName:this.props.drillDefinitionName,mainTitle:this._getDialogTitleText(),subTitle:this._getSubTitleText()})},n.renderTitleInput=function(){return r.createElement(l,{name:this.props.drillDefinitionName,handlers:this.props.handlers})},n.renderRadioScope=function(){return r.createElement(c,{checked:this.props.scope,onChange:this.props.handlers.onScopeChange,applicationName:this.props.applicationName})},n.renderOptions=function(){return!this._isReportPerspective()&&r.createElement(d,{iconsFeature:this.props.iconsFeature,matchMetadataAcrossSources:!!this.props.matchMetadataAcrossSources,overrideExistingFiltersOnly:!!this.props.overrideExistingFiltersOnly,onMetadataMatchChange:this.props.handlers.onMetadataMatchChange,onOverrideExistingFiltersChange:this.props.handlers.onOverrideExistingFiltersChange})},n.renderPrompts=function(){return r.createElement(u,{isLoading:this.state.isLoading,iconsFeature:this.props.iconsFeature,rowSize:this.state.rowSize,isReportPerspective:this._isReportPerspective(),currentApplicationName:this.props.applicationName,parametersTitle:this.props.parametersTitle,metadataTitle:this.props.metadataTitle,getRow:this.props.getRow,noMappingText:this.props.noMappingText,handlers:this.props.handlers})},n.componentDidUpdate=function(e){this.props.isLoading!==e.isLoading&&this.setState({isLoading:this.props.isLoading,rowSize:this.props.rowSize})},n.render=function(){return r.createElement(h,_extends({},this.dialogProps,{onClose:this._onCancel.bind(this)}),r.createElement(h.Body,null,this.renderHeader(),this.renderTitleInput(),this.renderPrompts(),this.renderOptions(),this.renderRadioScope()),r.createElement(h.Footer,null,r.createElement(h.Button,{primary:!0,id:"applyDrillDefinition",label:i.get("dlg_apply"),title:i.get("dlg_apply"),onClick:this._onApply.bind(this)}),r.createElement(h.Button,{label:i.get("dlg_cancel"),title:i.get("dlg_cancel"),id:"cancelDrillDefinition",onClick:this._onCancel.bind(this)})))},t}(r.Component);return g.propTypes={getRow:a.func,noMappingText:a.string,iconsFeature:a.object,rowSize:a.number,drillDefinitionName:a.string,metadataTitle:a.string,parametersTitle:a.string,isReportPerspective:a.bool,handlers:a.object,onOK:a.func,onCancel:a.func,scope:a.string,isLoading:a.bool,isCreate:a.bool,type:a.string,applicationName:a.string,perspective:a.string,matchMetadataAcrossSources:a.bool,overrideExistingFiltersOnly:a.bool},g})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/dialogs/internal/MessageComponent",["react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,i){var n=t.Dialog,r=function(t){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i);var n=_possibleConstructorReturn(this,t.call(this,e)),r="dashboardMessageDialog";return e.className?r+=" "+e.className:r+=" none",n.dialogProps={className:r,size:e.size||"small",clickaway:!1},n}return _inherits(i,t),i.prototype.render=function(){return e.createElement(n,_extends({},this.dialogProps,{onClose:this._onClose.bind(this)}),e.createElement(n.Header,{title:this.props.title},this.props.title),e.createElement(n.Body,null,this.props.message),e.createElement(n.Footer,null,e.createElement(n.Button,{primary:!0,id:"ok",label:this.props.okLabel,onClick:this._onClose.bind(this)})))},i.prototype._onClose=function(e){e&&e.stopPropagation(),this.props.onClose&&this.props.onClose()},i}(e.Component);return r.propTypes={size:i.string,className:i.string,title:i.string,message:i.string,onClose:i.func,okLabel:i.string},r})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/nls/DashboardCommonResources",{root:!0,cs:!0,da:!0,de:!0,es:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,it:!0,ja:!0,kk:!0,ko:!0,no:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-br":!0,ro:!0,ru:!0,sl:!0,sv:!0,th:!0,tr:!0,zh:!0,"zh-cn":!0,"zh-tw":!0}),define("dashboard-analytics/lib/@waca/dashboard-common/dist/nls/root/DashboardCommonResources",{dlg_loading:"Loading...",dlg_close:"Close",dlg_ok:"OK",dlg_cancel:"Cancel",dlg_back:"Go back",dlg_done:"Done",dlg_save:"Save",sliderRegionLabel:"Slider control, use right and left arrows to move the slider handles",sliderHandleLabel:"Slider handle",a11ySliderHandleLabel:"Slider handle %{sliderValue}",sliderInputLabel:"value",sidebarAdd:"Add",clearTextFilterValue:"Clear",missingDataSetData:"The data for this data set is not available. Refresh the data set or contact your administrator for access to the source.",toolbarRegionLabel:"Toolbar",toolbarLabel:"%{labelName}:",toolbarNoValueLabel:"%{labelName}",fontSelect:"Font family",fontFamilyStyle:"Font style",regularFontStyle:"Regular",fontSizeSelect:"Font size",fontColorSelect:"Color",fontStyle:"Style",colorPickerTitle:"Selecting a color",bold:"Bold",italic:"Italic",underline:"Underline",fontAlignment:"Alignment",justifyLeft:"Align left",justifyCenter:"Align center",justifyRight:"Align right",insertOrderedList:"Ordered List",insertUnorderedList:"Unordered List",fontColorPicker:"Color picker",textWrap:"Wrap text",restore:"Restore defaults",textAutoFontSize:"Auto",textDefaultFontSize:"Default",textItemTitle:"Title",textLabelShadow:"Label shadow",textContrastLabelColor:"Contrast color",toggleOn:"On",toggleOff:"Off",contrastLabelColorInfo:"Auto adjust label color for accessibility. This overrides the font color.",labelShadowInfo:"Add shadow to text for accessibility.",applyToAll:"Apply styling to all axes",topbottomNumberOfResultsLabel:"Number of results (%{lower} - %{higher})",topbottomPercentLabel:"Percent (%{lower}% - %{higher}%)",topbottomSelectOption:"Top or bottom option",topbottomOptionLabel:"Show",searchByLabel:"By",searchNoMatches:"No matches found",topbottomRankColumnLabel:"Add a rank column to table",topbottomNone:"None",topCount:"Top count",topPercent:"Top %",bottomCount:"Bottom count",bottomPercent:"Bottom %",searchColumn:"Find a column",searchColumnAriaLabel:"Find a column. Type the name of the column to search for then use the down arrow to find the column in a list",searchColumnQualifiedLabel:"%{columnLabel} (%{columnId})",rankColumnLabel:"Rank (%{columnLabel})",topbottomClearLabel:"Reset",formatAuto:"Auto",formatConvertPercent:"Convert decimal to percentage",formatAbbreviate:"Abbreviate",formatUseGrouping:"Use thousands separator",dateStyle:"Date style",dateTimeStyle:"Date/Time style",formatMissingValueCharactersInfo:"Missing value characters specifies the characters to be displayed when the value is missing.",currencySymbolLabel:"Currency symbol",customSymbolPlaceholder:"Add a symbol",customSymbolLabelInfo:"Specifies a character or characters to use as a custom symbol. This symbol will precede the number and any sign.",numberLabel:"Number label",numberPositionLabel:"Label position",negativeSignPosition:"Negative sign position",negativeSign:"Negative sign symbol",numberLabelInfo:"Specifies a label for the formatted number and placed as a prefix or suffix depending on the label position.",nullValueDefault:"<default>",nullValueContent:"(no value)",default:"Default",beginning:"Beginning",end:"End",formatLabel:"Select a format",moreDataIndicator:"Your data was clipped at %{threshold} items. Apply a filter to show less.",evCollapse:"Collapse",duplicate:"Duplicate",copyOf:"Copy of %{name}",unableToDuplicateBoard:'Unable to duplicate "%{name}".',errorLoadingWidgetList:"We can't load the objects.",customWidget:"Custom widget",group:"Group",textFontFamilySubClassHairline:"Hairline",textFontFamilySubClassThin:"Thin",textFontFamilySubClassThinItalic:"Thin Italic",textFontFamilySubClassExtraLight:"Extra Light",textFontFamilySubClassExtraLightItalic:"Extra Light Italic",textFontFamilySubClassLight:"Light",textFontFamilySubClassLightItalic:"Light Italic",textFontFamilySubClassRegular:"Regular",textFontFamilySubClassRegularItalic:"Regular Italic",textFontFamilySubClassItalic:"Italic",textFontFamilySubClassMedium:"Medium",textFontFamilySubClassMediumItalic:"Medium Italic",textFontFamilySubClassHeavy:"Heavy",textFontFamilySubClassHeavyItalic:"Heavy Italic",textFontFamilySubClassDemiBold:"Demi Bold",textFontFamilySubClassDemiBoldItalic:"Demi Bold Italic",textFontFamilySubClassBold:"Bold",textFontFamilySubClassBoldItalic:"Bold Italic",textFontFamilySubClassExtraBold:"Extra Bold",textFontFamilySubClassExtraBoldItalic:"Extra Bold Italic",textFontFamilySubClassBlack:"Black",textFontFamilySubClassBlackItalic:"Black Italic",textFontFamilySubClassStencil:"Stencil"}),define("dashboard-analytics/lib/@waca/dashboard-common/dist/nls/StringResources",["i18n!./DashboardCommonResources","../lib/@waca/core-client/js/core-client/utils/Lexicon"],(function(e,t){"use strict";var i=new t({data:e,verbose:!0}),n=function(){};return n.prototype.get=function(e,t){return i.translate(e,t)},new n})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/dialogs/MessageDialog",["../../lib/@waca/core-client/js/core-client/ui/core/View","./internal/MessageComponent","../../nls/StringResources","react","react-dom"],(function(e,t,i,n,r){return function(e){function o(t){_classCallCheck(this,o);var i=_possibleConstructorReturn(this,e.call(this,t));return i.size=t.size,i.type=t.type,i.title=t.title,i.message=t.message,i.onCloseCallback=t.onCloseCallback,i.reactDomNode=i.$el[0],i}return _inherits(o,e),o.prototype.render=function(){r.render(n.createElement(t,{size:this.size,className:this.type,title:this.title,okLabel:i.get("dlg_ok"),message:this.message,onClose:this._onClose.bind(this)}),this.reactDomNode)},o.prototype._onClose=function(){this.onCloseCallback&&this.onCloseCallback(),this._close()},o.prototype._close=function(){this.reactDomNode&&r.unmountComponentAtNode(this.reactDomNode),this.$el&&(this.$el.remove(),this.$el=null),e.prototype.remove.call(this)},o}(e)})),define("dashboard-analytics/drill-through/controls/dialogs/DrillThroughDefinitionDialog",["../../../lib/@waca/core-client/js/core-client/ui/core/View","../../../DynamicFileLoader","../../../widgets/livewidget/nls/StringResources","underscore","./internal/DrillThroughDefinitionComponents","react-dom","react","../../../lib/@waca/dashboard-common/dist/ui/dialogs/MessageDialog"],(function(e,t,i,n,r,o,a,s){return function(e){function t(){return e.apply(this,arguments)||this}_inheritsLoose(t,e);var l=t.prototype;return l.init=function(){for(var t,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];(t=e.prototype.init).call.apply(t,[this].concat(r));var a=r[0]||{};this.reactDomNode=this.$el[0],this.applicationName=a.applicationName,this.boardName=a.boardName,this.name=a.name||a.targetName,this.targetName=a.targetName,this.type=a.type,this.entryId=a.id,this.assetId=a.assetId,this.modelRefs=a.modelRefs,this.controller=a.controller,this.scope=a.scope,this.ownerId=a.ownerId,this.perspective=a.perspective,this.matchMetadataAcrossSources=a.matchMetadataAcrossSources,this.overrideExistingFiltersOnly=a.overrideExistingFiltersOnly,this.isLoading=a.isLoading,this.mappings=a.mappings,this.columnLabels=a.columnLabels,this.columnLabelValues=n.map(this.columnLabels,(function(e){return e.label})),this.rowSize=this.mappings&&this.mappings.length,this.handlers=a.handlers||{},this.iconsFeature=a.iconsFeature||{},this.isCreate=!!a.isCreate,this.eventGroupId=a.eventGroupId,this.handlers=n.extend(this.handlers,{getRow:this._getRow.bind(this),onValueSelected:this._onValueSelected.bind(this),onScopeChange:this._onScopeChange.bind(this),onNameChange:this._onNameChange.bind(this),onMetadataMatchChange:this._onMetadataMatchChange.bind(this),onOverrideExistingFiltersChange:this._onOverrideExistingFiltersChange.bind(this),onCloseDialog:this._onCloseDialog.bind(this)})},l.apply=function(){var e={name:this.name,targetName:this.targetName,type:this.type,id:this.entryId,assetId:this.assetId,modelRefs:this.modelRefs,mappings:this.mappings,scope:this.scope,ownerId:this.ownerId,perspective:this.perspective,eventGroupId:this.eventGroupId,matchMetadataAcrossSources:this.matchMetadataAcrossSources,overrideExistingFiltersOnly:this.overrideExistingFiltersOnly};this.handlers.canApply(e)?(this.handlers.onApply(e),this.remove()):new s({title:i.get("drillthrough_definitionDuplicateDrillTargetErrorTitle"),message:i.get("drillthrough_definitionMessage",{name:e.name})}).render()},l.render=function(){o.render(a.createElement(r,{getRow:this.handlers.getRow.bind(this),noMappingText:"---",title:i.get("drillthrough_jumpTo",{name:this.name}),iconsFeature:this.iconsFeature,rowSize:this.rowSize,drillDefinitionName:this.name,metadataTitle:i.get("drillThroughMetadataColumnTitle",{boardName:this.boardName}),parametersTitle:i.get("drillThroughParametersColumnTitle",{targetName:this.targetName}),handlers:this.handlers,scope:this.scope,onOK:this.onApply.bind(this),onCancel:this.onCancel.bind(this),isLoading:this.isLoading,isCreate:this.isCreate,type:this.type,applicationName:this.applicationName,perspective:this.perspective,matchMetadataAcrossSources:this.matchMetadataAcrossSources,overrideExistingFiltersOnly:this.overrideExistingFiltersOnly}),this.reactDomNode)},l._getRow=function(e){var t=this.mappings[e],i=t.mapTo,n=-1;if(i&&this.columnLabels&&this.columnLabels.length)for(var r=0;r<this.columnLabels.length;r++)if(i===this.columnLabels[r].columnId){n=r;break}return{caption:t.name,state:{selectedIndex:n,values:this.columnLabelValues}}},l._onValueSelected=function(e,t){var i=this.mappings[e];i.mapTo=-1===t?null:this.columnLabels[t].columnId},l._onScopeChange=function(e){this.scope=e},l._onNameChange=function(e){this.name=e},l._onMetadataMatchChange=function(e){this.matchMetadataAcrossSources=e},l._onOverrideExistingFiltersChange=function(e){this.overrideExistingFiltersOnly=e},l._onCloseDialog=function(){this.cancel()},l._onCancelCallback=function(){this.handlers.back&&this.handlers.back()},l.update=function(e){this.columnLabels=e.columnLabels||this.columnLabels,this.mappings=e.mappings||this.mappings,this.rowSize=this.mappings?this.mappings.length:this.rowSize,this.targetName=e.targetName||this.targetName,e.isLoading||(this.columnLabelValues=n.map(this.columnLabels,(function(e){return e.label}))),this.isLoading=e.isLoading,this.render()},l.remove=function(){this.reactDomNode&&o.unmountComponentAtNode(this.reactDomNode),this.$el&&(this.$el.remove(),this.$el=null),e.prototype.remove.call(this)},l.onApply=function(){this.apply()},l.onCancel=function(){this.remove(),this._onCancelCallback()},t}(e)})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/dialogs/internal/ConfirmationComponent",["../../../nls/StringResources","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,i,n,r){"use strict";var o=n.Dialog,a=function(t){function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,n);var r=_possibleConstructorReturn(this,t.call(this,i)),o="dashboardConfirmationDialog";return i.className&&(o+=" "+i.className),r.dialogProps={size:i.size||"small",clickaway:!1,className:o},r.primaryButtonText=i.primaryButtonText||e.get("dlg_ok"),r.secondaryButtonText=i.secondaryButtonText||e.get("dlg_cancel"),r}return _inherits(n,t),n.prototype.render=function(){return i.createElement(o,_extends({},this.dialogProps,{onClose:this._onCancel.bind(this)}),i.createElement(o.Header,{title:this.props.title},this.props.title),i.createElement(o.Body,null,this.props.message||i.createElement("div",{className:"dialogBody"})),i.createElement(o.Footer,null,i.createElement(o.Button,{primary:!0,id:"ok",label:this.primaryButtonText,title:this.primaryButtonText,onClick:this._onOK.bind(this)}),i.createElement(o.Button,{label:this.secondaryButtonText,title:this.secondaryButtonText,id:"cancel",onClick:this._onCancel.bind(this)})))},n.prototype._onOK=function(e){e&&e.stopPropagation(),this.props.onOK&&this.props.onOK()},n.prototype._onCancel=function(e){e&&e.stopPropagation(),this.props.onCancel&&this.props.onCancel()},n}(i.Component);return a.propTypes={primaryButtonText:r.string,secondaryButtonText:r.string,className:r.string,size:r.string,title:r.string,message:r.string,onOK:r.func,onCancel:r.func},a})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/dialogs/ConfirmationDialog",["jquery","../../lib/@waca/core-client/js/core-client/ui/core/View","./internal/ConfirmationComponent","react-dom","react"],(function(e,t,i,n,r){"use strict";return function(t){function o(){return _classCallCheck(this,o),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(o,t),o.prototype.init=function(){for(var e,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];(e=t.prototype.init).call.apply(e,[this].concat(n));var o=n[0]||{};this.className=o.className,this.size=o.size,this.title=o.title,this.message=o.message,this.viewClass=o.viewClass,this.viewOptions=o.viewOptions,this.confirmCallback=o.confirmCallback,this.cancelCallback=o.cancelCallback,this.className=o.className,this.primaryButtonText=o.primaryButtonText,this.secondaryButtonText=o.secondaryButtonText,this.reactDomNode=this.$el[0]},o.prototype.render=function(){n.render(r.createElement(i,{title:this.title,message:this.message,size:this.size,onOK:this.onOK.bind(this),onCancel:this.onCancel.bind(this),className:this.className,primaryButtonText:this.primaryButtonText,secondaryButtonText:this.secondaryButtonText}),this.reactDomNode),this.viewClass&&(this.view=new this.viewClass(this.viewOptions),this.view.render(),e(".dashboardConfirmationDialog .dialogBody").append(this.view.$el))},o.prototype.remove=function(){this.reactDomNode&&n.unmountComponentAtNode(this.reactDomNode),this.view&&this.view.remove(),this.$el&&this.$el.remove(),this.$el=null,o.inherited("remove",this)},o.prototype.onOK=function(){this.remove(),this.confirmCallback&&this.confirmCallback()},o.prototype.onCancel=function(){this.remove(),this.cancelCallback&&this.cancelCallback()},o}(t)}));var _excluded=["icon","title","onClick","type"],_excluded2=["padding"];function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var i,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createForOfIteratorHelperLoose(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _createForOfIteratorHelperLoose(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _createForOfIteratorHelperLoose(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,i){return e[t]=i}}function c(e,t,i,r){var o=t&&t.prototype instanceof h?t:h,a=Object.create(o.prototype),s=new w(r||[]);return n(a,"_invoke",{value:C(e,i,s)}),a}function u(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function g(){}function p(){}var f={};l(f,o,(function(){return this}));var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==t&&i.call(v,o)&&(f=v);var b=p.prototype=h.prototype=Object.create(f);function y(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){var r;n(this,"_invoke",{value:function(n,o){function a(){return new t((function(r,a){!function n(r,o,a,s){var l=u(e[r],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}(n,o,r,a)}))}return r=r?r.then(a,a):a()}})}function C(e,t,i){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return x()}for(i.method=r,i.arg=o;;){var a=i.delegate;if(a){var s=I(a,i);if(s){if(s===d)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=u(e,t,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}function I(e,t){var i=t.method,n=e.iterator[i];if(void 0===n)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),d;var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:x}}function x(){return{value:void 0,done:!0}}return g.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:g,configurable:!0}),g.displayName=l(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},y(_.prototype),l(_.prototype,a,(function(){return this})),e.AsyncIterator=_,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new _(c(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(b),l(b,s,"Generator"),l(b,o,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var n in t)i.push(n);return i.reverse(),function e(){for(;i.length;){var n=i.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return a.type="throw",a.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),D(i),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var r=n.arg;D(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:T(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},e}function asyncGeneratorStep(e,t,i,n,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(n,r)}function _asyncToGenerator(e){return function(){var t=this,i=arguments;return new Promise((function(n,r){var o=e.apply(t,i);function a(e){asyncGeneratorStep(o,n,r,a,s,"next",e)}function s(e){asyncGeneratorStep(o,n,r,a,s,"throw",e)}a(void 0)}))}}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}define("dashboard-analytics/drill-through/controls/dialogs/internal/DrillThroughManageComponents",["underscore","jquery","../../../../widgets/livewidget/nls/StringResources","../../../../lib/@waca/dashboard-common/dist/ui/dialogs/ConfirmationDialog","react-dom","react","@ba/ba-ui-carbon-toolkit","prop-types"],(function(e,t,i,n,r,o,a,s){var l=a.Dialog,c=a.TruncatedText,u=a.ListItem,d=a.Container,h=a.SVGIcon,g=a.List,p=a.FlexItem,f=a.ProgressIndicator,m=a.Button,v=function(e){function t(t){return e.call(this,t)||this}return _inheritsLoose(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,i=e.title,n=e.onClick,r=e.type,a=_objectWithoutPropertiesLoose(e,_excluded),s="svgIcon visDT-ManageView-item visDT-ManageView-icon "+r;return o.createElement(p,null,o.createElement(d,null,o.createElement(h,_extends({icon:t,alt:i,ariaLabelledby:i,onClick:n,className:s},a))))},t}(o.Component),b=function(e){function t(t){return e.call(this,t)||this}return _inheritsLoose(t,e),t.prototype.render=function(){var e=this.props,t=e.padding,i=_objectWithoutPropertiesLoose(e,_excluded2);return o.createElement(p,null,o.createElement(d,_extends({padding:t},i)))},t}(o.Component),y=function(r){function a(e){var t;return(t=r.call(this,e)||this).state=_extends({},t.props,{listData:[],visibleListData:[],isLoading:!0,isClean:!0}),t.dialogProps={size:"small",width:"450px",maxWidth:"800px",clickaway:!1},t}_inheritsLoose(a,r);var s=a.prototype;return s.componentDidMount=function(){this._updateData(!0)},s._updateData=function(t){t=void 0===t?this.state.isClean:t;var n=this.props.drillThroughModelApi.getDrillDefinitionEntries(this.props.content),r=this.props.content.getFeature("Visualization").getDataSource().getId(),o=[],a=this.props.iconsFeature,s=a.getIcon("reportIcon"),l=a.getIcon("dashboardIcon"),c=a.getIcon("storyIcon");e.each(n,(function(t){(function(t,i){if(e.isArray(t))for(var n=0;n<t.length;n++)if(t[n]===i)return!0;return!1})(t.getModelRefs(),r)&&o.push({getIcon:function(){return{authoring:s.id,story:c.id,dashboard:l.id}[t.getPerspective()]},getId:function(){return t.getId()},getName:function(){return t.getName()},editJumpTo:i.get("drillthrough_manageJumpPaths_edit",{name:t.getName()}),removeJumpTo:i.get("drillthrough_manageJumpPaths_delete",{name:t.getName()})})})),this.setState({listData:o,visibleListData:o.slice(),isLoading:!1,isClean:!!t})},s._onApply=function(e){e&&e.stopPropagation(),this.props.applyDrillManage(this.state)},s._onCancel=function(e){e&&e.stopPropagation(),this.props.onCancel()},s._itemRenderer=function(e,t){var i=this,n=_extends({},t),r=this.state.visibleListData[e],a=this.props.iconsFeature,s=a.getIcon("common-edit"),l=a.getIcon("remove");return o.createElement(u,_extends({},n,{"data-index":e,className:"visDT-ManageView-item-container","data-id":r.getId()}),o.createElement(v,{icon:r.getIcon(),type:"disable"}),o.createElement(b,{padding:1}),o.createElement(p,{grow:!0,className:"visDT-ManageView-item visDT-ManageView-item-target"},o.createElement(c,{value:r.getName(),title:r.getName(),tabIndex:"0"})),o.createElement(b,{padding:1}),o.createElement(v,{icon:s,title:r.editJumpTo,type:"edit",onClick:this._onEdit.bind(this),onKeyUp:function(e){"Enter"===e.key&&i._onEdit(e)},role:"button",tabIndex:"0"}),o.createElement(b,{padding:1}),o.createElement(v,{height:16,width:16,icon:l,title:r.removeJumpTo,type:"delete",role:"button",tabIndex:"0",onClick:this._onDelete.bind(this),onKeyUp:function(e){"Enter"===e.key&&i._onDelete(e)}}))},s._addNewItem=function(){var e=this.props.dashboard.getFeature("Icons"),t=i.get("drillthrough_manageAddAnotherTarget"),n=e.getIcon("add16"),r=function(){return"addNewTarget"},a=function(){return t},s=function(){return n};return o.createElement(u,{className:"visDT-ManageView-item-container visDT-ManageView-add",onClick:this._onAddNewTarget.bind(this),"data-id":r()},o.createElement(m,{label:a(),icon:s(),intent:"primary",variant:"frameless"}))},s._onEdit=function(e){var t=this._getId(e);return t?this.props.handlers.onEdit(this.props.content,t,this._getEditDrillThroughModelOptions()):Promise.reject("Invalid drill through target")},s._onDelete=function(e){var t=this,r=this._getId(e),o=r?this.props.drillThroughModelApi.getDrillDefinitionEntry(r):null;if(!o)throw new Error("Invalid drill through target");new n({className:"confirmDeleteDrillTarget",title:i.get("drillthrough_manageConfirmeDeleteDrillTargetTitle"),message:i.get("drillthrough_manageConfirmeDeleteDrillTarget",{name:o.getName()}),confirmCallback:function(){t.props.handlers.onDelete(r,t._getEditDrillThroughModelOptions())}}).render()},s._onAddNewTarget=function(){return this.props.handlers.onCreate(this.props.content,this._getEditDrillThroughModelOptions())},s._getItem=function(e){return t(e.currentTarget).closest(".visDT-ManageView-item-container")},s._getId=function(e){var t=this._getItem(e);return t.length>0?t[0].getAttribute("data-id"):null},s._getEditDrillThroughModelOptions=function(){return{undoRedoOptions:{silent:!0},callback:this._updateData.bind(this)}},s.render=function(){var e;return this.state.openDialog?(e=this.state.isLoading?o.createElement(d,{id:"overlay"},o.createElement(f,{tabIndex:0,size:"normal"})):o.createElement(d,{className:"visDT-ManageView-container"},o.createElement(g,{length:this.state.visibleListData.length,itemRenderer:this._itemRenderer.bind(this),fullHeight:"true",className:"visDT-ManageView-list",tabIndex:"-1"}),this._addNewItem()),o.createElement(l,_extends({},this.dialogProps,{onClose:this._onCancel.bind(this)}),o.createElement(d,{className:"visDT-ManageView"},o.createElement(l.Header,null,o.createElement(c,{value:i.get("drillthrough_manageJumpPaths",{drillthrough_manageJumpPaths:i.get("drillthrough_manageJumpPaths"),name:this.props.label})})),o.createElement(l.Body,null,e),o.createElement(l.Footer,null,o.createElement(l.Button,{primary:!0,id:"applyDrillManage",label:i.get("dlg_apply"),title:i.get("dlg_apply"),onClick:this._onApply.bind(this),disabled:this.state.isClean}),o.createElement(l.Button,{label:i.get("dlg_cancel"),title:i.get("dlg_cancel"),id:"cancelDrillManage",onClick:this._onCancel.bind(this)}))))):null},a}(o.Component);return v.propTypes={icon:s.object,title:s.string,onClick:s.func,type:s.string},b.propTypes={padding:s.number},y.propTypes={label:s.string,openDialog:s.bool,applyDrillManage:s.func,onCancel:s.func,iconsFeature:s.object,content:s.object,dashboard:s.object,drillThroughModelApi:s.object,handlers:s.object},y})),define("dashboard-analytics/drill-through/controls/dialogs/DrillThroughManageDialog",["jquery","../../../widgets/livewidget/nls/StringResources","../../../lib/@waca/core-client/js/core-client/ui/core/View","./internal/DrillThroughManageComponents","react-dom","react"],(function(e,t,i,n,r,o){return function(e){function i(){return e.apply(this,arguments)||this}_inheritsLoose(i,e);var a=i.prototype;return a.init=function(){for(var i,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var a=r[0]||{};if((i=e.prototype.init).call.apply(i,[this].concat(r)),this.label=t.get("drillthrough_manageJumpPaths"),this.applyDrillManage=a.handlers.okCallback,this.cancelDrillManage=a.handlers.cancelCallback,this.reactDomNode=this.$el[0],this.handlers=a.handlers,!this.handlers)throw new Error("Handlers must be provided to manage drill through definitions");this.content=a.content,this.dashboard=a.dashboard,this.drillThroughModelApi=a.drillThroughModelApi,this.iconsFeature=this.dashboard.getFeature("Icons")},a.render=function(){r.render(o.createElement(n,{label:this.label,openDialog:!0,applyDrillManage:this.onApply.bind(this),onCancel:this.onCancel.bind(this),iconsFeature:this.iconsFeature,content:this.content,dashboard:this.dashboard,drillThroughModelApi:this.drillThroughModelApi,handlers:this.handlers}),this.reactDomNode)},a.remove=function(){this.reactDomNode&&r.unmountComponentAtNode(this.reactDomNode),this.$el&&(this.$el.remove(),this.$el=null),e.prototype.remove.call(this)},a.onApply=function(){this.applyDrillManage(),this.remove()},a.onCancel=function(){this.cancelDrillManage(),this.remove()},i}(i)})),define("dashboard-analytics/cmHelper/CMHelper",["../lib/@waca/baglass/js/baglass/api/Url"],(function(e){var t=null,i=function(){return t||(t=new e),t},n=function(){};n.ALL_PROPS=(n.ID=1)|(n.DEFAULT_NAME=2)|(n.PERMISSIONS=4);return n.getObjectInfo=function(e,t,i,r){if(!(i=i||{}).data){var o=(s=[],(a=r||n.ALL_PROPS)&n.ID&&s.push("id"),a&n.DEFAULT_NAME&&s.push("defaultName"),a&n.PERMISSIONS&&s.push("permissions"),s.length>0?s.join(","):void 0);o&&(i.data={fields:o})}var a,s,l=e.getBaseObjectsURL()+"/"+t;return e.get(l,i)},n.getReportName=function(e,t){return n.getObjectInfo(e,t,void 0,n.CM_DEFAULT_NAME).then((function(e){var t=(e=e||{}).data||[];return t.length>0?t[0].defaultName:{errorCode:404,errorKey:"noTargetInCM"}}))},n.getPermissions=function(e,t){return n.getObjectInfo(e,t,void 0,n.PERMISSIONS).then((function(e){var t=(e=e||{}).data||[];if(t.length>0)return t[0].permissions;throw new Error("Invalid CM Store Id provided")}))},n.canExecute=function(e,t){return n.getPermissions(e,t).then((function(e){return e&&e.length>0&&-1!==e.indexOf("execute")}))},n.getPathRef=function(e,t){if(!e)throw new Error("Empty glassContext option provided");return i().getPathRef(e.glassContext,t)},n.getPathRefInfo=function(e,t){if(!e)throw new Error("Empty glassContext option provided");if(t)return i().getPathRefInfo(e.glassContext,t.storeId,t.fields,t.searchPath);throw new Error("Empty query options provided")},n.reset=function(){t=null},n})),define("dashboard-analytics/drill-through/controls/DrillThroughManageUndoRedo",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../../lib/@waca/core-client/js/core-client/utils/UniqueId"],(function(e,t){return e.extend({init:function(e){e=e||{},this._drillThroughModelApi=e.drillThroughModelApi},applyUndoRedo:function(e,t,i,n,r){if("UndoRedoController"===i&&"reset"===n){var o="undo"===r.undoRedoTransactionType?e.prevValue:e.value;this._drillThroughModelApi.applyModelChange(o,{silent:!0})}},rollback:function(e){e.transactionId===this._mainTransaction&&(e.options.silent=!0,this._drillThroughModelApi.applyModelChange(this.callbackPayload.prevValue,e.options))},startTransaction:function(e,i,n,r){var o=Date.now();this._transactionType=r||this.TRANSACTION_TYPE_DEFAULT,this._transactionArgs=n||{};var a=n&&n.transactionId||t.get(e);return this._mainTransaction||this._transactionInProgress(i)?i.silent=!0:((i=i||{}).payloadData=i.payloadData||{},this._mainTransaction=a,i.payloadData.undoRedoTransactionId=this._mainTransaction,i.silent=!0,this.callbackPayload={prevValue:JSON.parse(JSON.stringify(this._drillThroughModelApi.toJSON()))}),{startStart:o,startEnd:Date.now(),options:i,transactionId:a}},_transactionInProgress:function(e){return e&&e.payloadData&&e.payloadData.undoRedoTransactionId},endTransaction:function(e){if(e.transactionId===this._mainTransaction){e.options.silent=!1;var t=this._drillThroughModelApi.toJSON();this.callbackPayload.value=t,e.options=e.options||{},e.options.sender="DrillThroughTransaction",e.options.senderContext={applyFn:this.applyUndoRedo.bind(this,this.callbackPayload)},this._drillThroughModelApi.applyModelChange(t,e.options)}}})})),define("dashboard-analytics/util/AjaxHelper",[],(function(){"use strict";return new function(){return{showAjaxServiceErrorMessage:function(e,t){var i="";if(t){var n=t.responseJSON;if(n){if(n.messages)i=t.responseJSON.messages.join("\n");else if(n.cause)try{var r=JSON.parse(n.cause);r.messages&&(i=r.messages.join("\n"))}catch(e){i=n.cause}}else i=t.responseText}i&&i.length>0&&e.showErrorMessage(i,"Error")}}}})),define("dashboard-analytics/drill-through/controls/DrillThroughController",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../glassControllers/SelectDrillTargetActionHandler","./dialogs/DrillThroughDefinitionDialog","./dialogs/DrillThroughManageDialog","../../widgets/livewidget/nls/StringResources","../../cmHelper/CMHelper","./DrillThroughManageUndoRedo","../../util/AjaxHelper"],(function(e,t,i,n,r,o,a,s){var l=e.extend({init:function(e,t){l.inherited("init",this,arguments),this.dashboardApi=e,this.drillService=t,this.iconsFeature=this.dashboardApi.getFeature("Icons"),this.boardModel=this.dashboardApi.getFeature("internal").getBoardModel(),this.boardModel&&this.boardModel.on("removeLayouts",this._onRemoveLayouts,this)},createDrillDefinition:function(e,i){return this._selectDrillTargetActionHandler||(this._selectDrillTargetActionHandler=new t(this.dashboardApi)),this._selectDrillTargetActionHandler.selectTarget({handlers:{onSelect:function(t){return this._onSelectDrillTarget(e,t,i)}.bind(this)}})},_onSelectDrillTarget:function(e,t,n){var r,o=e.getFeature("Visualization");return this.drillService.getDrillThroughModelApi().then(function(a){return o.getDataSource().getLocalizedName().then(function(s){var l={back:this.createDrillDefinition.bind(this,e,n),onApply:this.addUpdateDrillDefinitionEntry.bind(this,n),canApply:this._drillDefinitionIsUniqueName.bind(this,a)},c={controller:this,applicationName:this.dashboardApi.getApplicationName(),boardName:this.dashboardApi.getFeature("internal").getBoardModel().name,sourceName:s,targetName:t.name,type:t.type,assetId:t.assetId,assetSearchPath:t.assetSearchPath,ownerId:e.getId(),modelRefs:[o.getDataSource().getId()],handlers:l,perspective:t.perspective,scope:"connection",isLoading:"exploration"!==t.type,iconsFeature:this.iconsFeature,isCreate:!0,eventGroupId:this.dashboardApi.getFeature("EventGroups").getGroupId(e.getId())};if((r=new i(c)).render(),"exploration"!==t.type)return this.drillService.getDrillThroughMappingManager().doMapping(t.assetId,e).then((function(e){var t={isLoading:!1,mappings:e&&e.parameterMappings,columnLabels:e&&e.columnLabels};r.update(t)}))}.bind(this))}.bind(this)).catch(function(e){r&&r.remove(),this._showError(e)}.bind(this))},onOperationCancel:function(e){e.callback&&e.callback()},editDrillDefinition:function(e,t,n){var r,o=e.getFeature("Visualization");return this.drillService.getDrillThroughModelApi().then(function(a){return o.getDataSource().getLocalizedName().then(function(s){var l=a.getDrillDefinitionEntry(t),c={back:this.onOperationCancel.bind(this,n),onApply:this.addUpdateDrillDefinitionEntry.bind(this,n),canApply:this._drillDefinitionIsUniqueName.bind(this,a)},u={id:t,assetId:l.getAssetId(),assetSearchPath:l.getAssetSearchPath(),applicationName:this.dashboardApi.getApplicationName(),boardName:this.dashboardApi.getFeature("internal").getBoardModel().name,sourceName:s,name:l.getName(),scope:l.getScope(),type:l.getType(),ownerId:e.getId(),matchMetadataAcrossSources:l.getMatchMetadataAcrossSources(),overrideExistingFiltersOnly:l.getOverrideExistingFiltersOnly(),modelRefs:[o.getDataSource().getId()],handlers:c,perspective:l.getPerspective(),isLoading:"exploration"!==l.getType(),iconsFeature:this.iconsFeature,eventGroupId:this.dashboardApi.getFeature("EventGroups").getGroupId(e.getId())};if((r=new i(u)).render(),"exploration"!==l.getType())return this._getTargetNameFromCM(l).then(function(){return this.drillService.getDrillThroughMappingManager().doMapping(l.getAssetId(),e,l.getMappings()).then((function(e){var t={isLoading:!1,targetName:l.getTargetName(),mappings:e&&e.parameterMappings,columnLabels:e&&e.columnLabels};r.update(t)}))}.bind(this))}.bind(this))}.bind(this)).catch(function(e){r&&r.remove(),this._showError(e)}.bind(this))},manageDrillDefinition:function(e){var t=new a(e=e||{}),i=t.startTransaction("manageDrillThrough",null),r=function(e,t){this.createDrillDefinition(e,t)}.bind(this);return e.handlers={onEdit:this.editDrillDefinition.bind(this),onCreate:r,onDelete:this.removeDrillDefinition.bind(this),okCallback:t.endTransaction.bind(t,i),cancelCallback:t.rollback.bind(t,i)},new n(e)},removeDrillDefinition:function(e,t){return this.drillService.getDrillThroughModelApi().then(function(i){t=t||{};var n=i.deleteDrillDefinitionEntry(e,t.undoRedoOptions);return n&&t.callback&&t.callback(!1),n}.bind(this))},addUpdateDrillDefinitionEntry:function(e,t){return this.drillService.getDrillThroughModelApi().then(function(i){e=e||{};var n=i.addUpdateDrillDefinitionEntry(t,e.undoRedoOptions);return e.callback&&e.callback(!1),n}.bind(this))},_selectDrillTarget:function(){return this._selectDrillTargetActionHandler||(this._selectDrillTargetActionHandler=new t(this.dashboardApi)),this._selectDrillTargetActionHandler.selectTarget()},_getTargetNameFromCM:function(e){return new Promise(function(t,i){var n=this;e.getTargetName()?t():this.dashboardApi.getGlassSvc(".Content").then((function(r){o.getReportName(r,e.getAssetId()).then(function(n){n.errorCode?i(n):(e.setTargetName(n),t())}.bind(n))}))}.bind(this))},_drillDefinitionIsUniqueName:function(e,t){for(var i=e.getDrillDefinitionEntries(),n=0;n<i.length;n++){var r=i[n];if(t.modelRefs[0]===r.getModelRefs()[0]&&r.getId()!==t.id&&r.getName()===t.name)return!1}return!0},_showError:function(e){var t=e.jqXHR||e||{};return t.responseText||(t.responseText=e.messages?e.messages:e.errorKey?r.get(e.errorKey):r.get("errorDrillDefinition")),s.showAjaxServiceErrorMessage(this.dashboardApi,t),Promise.resolve()},_onRemoveLayouts:function(e){var t=e.value.removedWidgets,i=e.data,n=i.undoRedoTransactionId,r=i.transactionToken,o=Object.keys(t||{}),a=n||r.tranactionId;this._removeDrillThrougDefinitions(o,a)},_removeDrillThrougDefinitions:function(e,t){var i=this.drillService.getDrillThroughModelApiSync(),n=i.getDrillDefinitionEntries(),r=this.dashboardApi.getFeature("Transaction"),o={transactionId:t},a=r.startTransaction(o),s={payloadData:{undoRedoTransactionId:a.transactionId,transactionToken:a}},l=this.dashboardApi.getFeature("EventGroups");n.forEach((function(t){"visualization"===t.getScope()&&-1!==e.indexOf(t.getOwnerId())?i.deleteDrillDefinitionEntry(t.getId(),s):"connection"!==t.getScope()||l.groupExists(t.getEventGroupId())||i.deleteDrillDefinitionEntry(t.getId(),s)})),r.endTransaction(a)}});return l})),define("dashboard-analytics/apiHelpers/SlotAPIHelper",[],(function(){var e=["values","x","y"],t=function(e){if(!e)throw new Error("Invalid SlotAPI")};return function(){function i(){}return i.isValuesSlot=function(i){return t(i),-1!==e.indexOf(i.getId())},i.isMultiMeasureSeriesDataItem=function(e,t){return e.getDataItemList()[t].getColumnId()===i.MULTI_MEASURES_SERIES},i.isMultiMeasuresSeriesSlot=function(e){return t(e),!!e.getDataItemList().find((function(e){return e.getColumnId()==i.MULTI_MEASURES_SERIES}))},i.isMultiMeasuresValueSlot=function(e){return e.getDefinition().isMultiMeasureSupported()&&e.getDataItemList().length>1},i.isMultiMeasuresSeriesOrValue=function(e,t){var n=e.getDataItemList(),r=n.length>=t&&n[t];return i.isMultiMeasuresSeriesOrValueDataItem(r)},i.isMultiMeasuresSeriesOrValueDataItem=function(e){return e&&-1!==[i.MULTI_MEASURES_SERIES,i.MULTI_MEASURES_VALUE].indexOf(e.getColumnId())},i.getMappedSlotListByDataset=function(e,t){return e.getSlots().getMappedSlotList().filter((function(e){return-1!==e.getDefinition().getDatasetIdList().indexOf(t)}))},i.getDataSlotById=function(e,t){var i=e.getSlots();return i?i.getSlot(t):null},i.getMetadataColumnForDataSlotHasOneMappedDataItem=function(e,t,i){var n=t.getDataItemList(),r=i||0;if(Array.isArray(r)){if(1!==r.length)return null;r=r[0]}return r<n.length?e.getMetadataColumn(n[r].getColumnId()):null},i.getValidDataItems=function(e){return e.getDataItemList().filter((function(e){return e.getColumnId()!==i.MULTI_MEASURES_SERIES}))},i.isSlotSortable=function(e,t,i){t=void 0===t?0:t;var n=e.getDefinition();if(n&&void 0!==n.getProperty("sortable"))return n.getProperty("sortable");if("fact"===e.getDataItemList()[t].getType()&&n&&void 0!==n.getProperty("supportSortActionForMeasures"))return n.getProperty("supportSortActionForMeasures");for(var r=i.getDefinition().getProperty("dataSlots"),o=0;o<r.length;o++)if("location"===r[o].subtype)return!1;if("category"===n.getProperty("type")||"any"===n.getProperty("type"))return!0;var a=i.getSlots().getMappedSlotList();if(2===a.length){var s=function(e,t){return e[0].getDefinition().getType()===t||e[1].getDefinition().getType()===t};return s(a,"category")&&s(a,"ordinal")}return!1},i.isSlotTopBottomable=function(e,t,n){if(!(!t||null!=n)&&(i.isMultiMeasuresSeriesSlot(t)||i.isMultiMeasuresValueSlot(t)))return!1;if(n=n||0,Array.isArray(n)&&1!=n.length)return!1;var r=t.getDataItemList()[n];if(!r)return!1;var o=r.getMetadataColumn();if(null===o)return!1;var a=o.getType(),s=r.getType();if("fact"===a||"fact"===s){if(!e.getProperty("supportsNonContextualTopBottomAction"))return!1}else if(!e.getProperty("supportsContextualTopBottomAction"))return!1;return"property"!==o.getSourceCategory()},i.getMultiMeasureSeriesSlot=function(e,t){return e.getSlots().getSlotList().find((function(e){var i=e.getDefinition(),n=i&&i.getProperty("tags");return n&&n.indexOf("ca.dashboard.repeatHere=true")>-1&&t===i.getDatasetIdList()[0]}))},i.doesDataItemSupportBinning=function(e,t){var i=!1;return"ordinal"!==e.getDefinition().getType()&&(i=!!t.getBinning()||"fact"===t.getMetadataColumn().getType()),i},_createClass(i,null,[{key:"MULTI_MEASURES_SERIES",get:function(){return"_multiMeasuresSeries"}},{key:"MULTI_MEASURES_VALUE",get:function(){return"_multiMeasuresValue"}}]),i}()})),define("dashboard-analytics/dataSources/utils/DatasourceUtil",["underscore","bi/moser/moser.min","../../apiHelpers/SlotAPIHelper"],(function(e,t,i){var n=[t.default.UseSpecType.FILE.value(),t.default.UseSpecType.DATASET.value()],r=function(){function r(){}return r._shouldVerifyJoin=function(i,o,a){if(void 0===o&&(o=[]),!(!i.getInterfaceType||!i.getImplType)){for(var s=i.getId(),l=!0,c=0;c<o.length&&l;c++){var u=o[c],d=i.getMetadataColumn(u),h=d?d.getTableName():null;if(!d||!h){l=!1;break}var g=a.getOriginalSourceType(s,u);if(g&&-1===n.indexOf(g)){l=!1;break}}return l}var p=r.MoserJS_Inst||t,f=[];return void 0===e.find(o,(function(e){if(!r.isMultiMeasuresSeriesOrValue(e)){var t=i.getMetadataColumn(e),o=t?t.getTable():null;if(!t||!o)return!0;if(-1===f.indexOf(o.idForExpression)){f.push(o.idForExpression);var a=p.default.ModuleUtils.getObjectUseSpec(o);if(a)return-1===n.indexOf(a.getType().value())}}}))},r.isMultiMeasuresSeriesOrValue=function(e){return 0===e.indexOf(i.MULTI_MEASURES_SERIES)||0===e.indexOf(i.MULTI_MEASURES_VALUE)},r.getTableRef=function(e,t){var i=[];return e&&t.forEach((function(t){var n=e.getMetadataColumn(t),r=n&&n.getTableName();r&&-1===i.indexOf(r)&&i.push(r)})),i},r.isSupportedNonJoinTableDatascourceType=function(e,t){return void 0===t&&(t=[]),!(!e||"package"===e.getSourceType()||0===t.length)&&r._shouldVerifyJoin(e,t)},r.mustVerifyJoinTablesInSameDataSource=function(t,i,n,o){var a;if(void 0===n&&(n=[]),"package"===(t.getType&&t.getType()||t.getSourceType&&t.getSourceType()))return!1;var s=i&&i.hierarchies&&i.hierarchies.map((function(e){return e.hierarchyUniqueName}))||i&&i.getItemIds&&i.getItemIds();return!(!e.isArray(s)||!s.length)&&((a=n).push.apply(a,s),r._shouldVerifyJoin(t,n,o))},r.haveTableJoinsInSameDataSource=function(t,i,n){var r=t.hasJoinedTables?t.hasJoinedTables.bind(t):t.tablesHaveJointRelationship.bind(t);return!!e.find(n,(function(t){return e.find(i,(function(e){return r(e,t)}))}))},r.haveATableReference=function(t,i,n){return void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===n&&(n=!1),!(n&&t.length!==i.length||0===t.length&&0===i.length)&&!!e.find(t,(function(e){return-1!==i.indexOf(e)}))},r.mergeSynchronizePageContextFilter=function(t,i){if(!i||0===i.length)return t;var n=function(t,i){return!!e.find(t,(function(e){return e.getItemName().toLowerCase()===i}))},r={},o=function(e){return r[e]=r[e]||[]};t.forEach((function(e){o(e.getScope()).push(e)})),i.filter((function(e){return"global"!==e.scope})).forEach((function(t){var i=t.filterName.toLowerCase(),a=o(t.scope);n(a,i)||a.push(t.getAPI()),r.global=e.filter(r.global,(function(e){return e.getItemName().toLowerCase()!==i}))}));var a,s=i.filter((function(e){return"global"===e.scope}));for(var l in s.forEach((function(e){var t=e.filterName.toLowerCase(),i=!0;for(var a in r)if("global"!==a&&n(r[a],t)){i=!1;break}i&&o("global").push(e.getAPI())})),r)r[l]&&r[l].length>0&&(a=a?a.concat(r[l]):r[l]);return a||[]},r.metadataColumnSupportsFiltering=function(e){if(!e)return!1;var t=(e.getAggregateMode||e.getAggregationMode).bind(e);return!("fact"===e.getType()&&("static"===t()||"calculated"===e.getDefaultAggregation()))},r}();return r.getPageContextItemTableRef=function(t,i){var n=[];return(i.getItemIds?i.getItemIds():e.pluck(i.hierarchies,"hierarchyUniqueName")).forEach((function(e){var i=t.getMetadataColumn(e);if(i){var r=i.getTableName();-1===n.indexOf(r)&&n.push(r)}})),n},r.isOrdinalAttribute=function(e,t){var i=e.getDefinition().getType(),n=t.getMetadataColumn().getType();return"ordinal"===i&&"attribute"===n},r})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/utils/ContentUtil",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.getPageContent=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"page",i=null;e;)t&&e.getType()===t&&(i=e),e=e.getContainer();return i},e.getContentAndItsDescendants=function(e){var t,i={contents:[],contentList:[],groups:[],groupCount:0};return function e(t,i){if(t)if(Array.isArray(t))t.forEach((function(t){e(t,i)}));else if("group"===t.getType()){i.groupCount++,i.groups.push(t),t.getChildren().forEach((function(t){e(t,i)}))}else i.contentList.push(t)}(e,i),(t=i.contents).push.apply(t,i.groups.concat(i.contentList)),{contents:i.contents,groupCount:i.groupCount}},e}()})),define("dashboard-analytics/util/ContentUtil",["underscore","../lib/@waca/dashboard-common/dist/utils/ContentUtil"],(function(e,t){return function(){function i(){}return i.getPageContext=function(e){var t=e.getFeature("PageContextService");return t&&t.getPageContext()},i._resolvePageContextItems=function(t){if(t.length<1)return[];var i=[];return e.some(t,(function(t){t.isDataPointType()?e.each(t.getDataPoints(),(function(t){var n=[];e.each(t,(function(e){n.push(e.u)})),i.push(n.join(","))})):e.each(t.getValues(),(function(e){i.push(e.u.toString())}))})),i},i.getContextFromSelection=function(e,t,n){var r=e.getFeature("WidgetAPI.deprecated").getVisApi(),o=e.getFeature("Visualization").getSlots();if(!(n&&n.dataPoints&&i._isIntersectionSelection(n,o))){var a=i.getSelectors(e,t),s=r.getPageContextAPI().getPageContextItems(a);return i._resolvePageContextItems(s)}return[]},i.getSelectors=function(e,i){var n=e.getFeature("Visualization"),r=i.getFeature("EventGroups"),o=t.getPageContent(e);return{scope:o&&o.getId(),eventGroupId:r.getGroupId(e.getId()),sourceId:n.getDataSource().getId(),origin:"visualization",eventSourceId:e.getId()}},i.getColumnIdList=function(e,t){void 0===e&&(e=[]);var i=[];return e.forEach((function(e){e.getDataItemList().forEach((function(e){t&&e.getType()!==t||i.push(e.getColumnId())}))})),i},i._isIntersectionSelection=function(e,t){var i=!1,n=!1,r=e.dataPoints[0].categories.map((function(e){return e.dataItemId})),o=t.getMappedSlotList();return r&&o.forEach((function(e){-1!==e.getId().indexOf("column_level")&&(i=!0,e.getDataItemList().forEach((function(e){i=i&&-1!==r.indexOf(e.getId())}))),-1!==e.getId().indexOf("row_level")&&(n=!0,e.getDataItemList().forEach((function(e){n=n&&-1!==r.indexOf(e.getId())})))})),i&&n},i}()})),define("dashboard-analytics/drill-through/managers/DrillThroughMappingManager",["../../dataSources/utils/DatasourceUtil","underscore","../../widgets/livewidget/nls/StringResources","../../util/ContentUtil","../../lib/@waca/dashboard-common/dist/utils/ContentUtil"],(function(e,t,i,n,r){var o=["name","modelFilterItem","type","capabilities"];return function(){function a(e,t){this.dashboard=e,this.drillService=t}var s=a.prototype;return s.getParameters=function(e){var n=this;return this.dashboard.getGlassSvc(".DrillInfoService").then((function(r){var a={type:"report",storeId:e};return r.getParameters(a).then((function(e){var i=e.parameters||[],n=[];return t.each(i,(function(e){n.push(t.pick(e,o))})),n})).catch((function(e){n.dashboard.getGlassCoreSvc(".Logger").error("Could not get prompt information from the selected report.",e),n.dashboard.showErrorMessage(i.get("drillThroughDefinitionErrorQueryingReport"),i.get("drillThroughDefinitionErrorDlgTitle"))}))}))},s.doMapping=function(e,t,i){var n=this;return this.getParameters(e).then((function(e){return e.length?t.getFeature("Visualization").getDataSource().getModule().then((function(r){return n._mapToMetadata(e,t,i,r)})):Promise.resolve()}))},s._mapToMetadata=function(e,i,n,r){var o=this.getMetadataIds(i,r),a=[];return e.forEach((function(e){if(n){var i=t.find(n,(function(t){return t.modelFilterItem===e.modelFilterItem&&t.name===e.name}));i&&i.mapTo&&(e.mapTo=i.mapTo,-1===o.indexOf(i.mapTo)&&a.push(i.mapTo))}else e.mapTo=t.find(o,(function(t){return e.modelFilterItem===t}))})),{parameterMappings:e,columnLabels:this._getColumnLabels(i,o.concat(a))}},s._getColumnLabels=function(i,n){var r=[],o=i.getFeature("Visualization").getDataSource();return n.forEach((function(t){var i=e.isMultiMeasuresSeriesOrValue(t)?null:o.getMetadataColumn(t);i&&r.push({columnId:t,label:i.getLabel()})})),t.sortBy(r,"label")},s.getMetadataIds=function(e,i){var n=this,r=[],o=e.getFeature("Visualization"),a=o.getDataSource(),s=this.dashboard.getFeature("EventGroups");if(s){var l=s.getGroupId(e.getId());s.getContentIdList(l).forEach((function(e){r.push.apply(r,n._collectWidgetMetadata(e,a.getId()))}))}return this._collectLocalFilterMetadata(o,r),this._collectPageContextMetadata(e,r,o,"visualization",i),this._collectPageContextMetadata(e,r,o,"filter",i),t.uniq(r)},s._collectWidgetMetadata=function(e,t){var i=this.dashboard.getCanvas().getContent(e),n=[];if(i.getFeature("Visualization")){var r=i.getFeature("Visualization").getDataSource();if(!r||r.getId()!==t)return n;i.getFeature("Visualization").getSlots().getDataItemList().forEach((function(e){var t=e.getMetadataColumn();t&&n.push(t.getId())}))}return n},s._collectLocalFilterMetadata=function(e,t){e.getLocalFilters().getFilterList().forEach((function(e){t.push(e.columnId)}))},s._collectPageContextMetadata=function(e,i,o,s,l){var c=this.dashboard.getAppConfig("pageContainerType"),u=r.getPageContent(e,c),d=n.getPageContext(this.dashboard),h=o.getDataSource(),g=u&&u.getId(),p=h.getId(),f=d.getPageContextItems({scope:g,sourceId:p,origin:s});if("global"!==g){var m,v=d.getPageContextItems({scope:"global",sourceId:p,origin:s});(m=f).push.apply(m,v)}if(f.length){"filter"===s&&(f=a.getNetSynchronizedFilterPageContext(o,e,f,l));var b=f.map((function(e){return e.getItemId()}));i.push.apply(i,t.uniq(b))}},a.getNetSynchronizedFilterPageContext=function(t,i,n,r){var o=t.getDataSource();if("package"===o.getType())return n;var a=t.getSlots().getMappedSlotList(),s=[];a.forEach((function(e){e.getDataItemList().forEach((function(e){s.push(e.getMetadataColumn().getTableName())}))})),n=n.filter((function(t){var i=e.getPageContextItemTableRef(o,t.getPageContextSpec());return e.haveTableJoinsInSameDataSource(r,i,s)}));var l=i.getFeature("WidgetAPI.deprecated").getVisApi().ownerWidget;return e.mergeSynchronizePageContextFilter(n,l.getSynchDataFilterEntries())},a}()})),define("dashboard-analytics/features/content/common/DataPointActionBase",["../../../lib/@waca/dashboard-common/dist/utils/ContentUtil","underscore"],(function(e,t){return function(){function i(e){e=e||{},this.dashboard=e.dashboardAPI,this.logger=this.dashboard.getGlassCoreSvc(".Logger"),this.content=e.content,this.globalFilters=this.dashboard.getFeature("GlobalFilters"),this.eventGroups=this.dashboard.getFeature("EventGroups"),this.transaction=this.dashboard.getFeature("Transaction")}var n=i.prototype;return n._getLocalFilters=function(){return this.localFilters||(this.visualization=this.visualization||this.content.getFeature("Visualization"),this.localFilters=this.visualization.getLocalFilters()),this.localFilters},n._getSelector=function(){var t=this.dashboard.getAppConfig("pageContainerType"),i=e.getPageContent(this.content,t);return{origin:"visualization",sourceId:this._getVisualization().getDataSource().getId(),scope:i&&i.getId(),eventGroupId:this.eventGroups.getGroupId(this.content.getId()),eventSourceId:this.content.getId(),_strictMatch:!0}},n._getVisualization=function(){return this.visualization=this.visualization||this.content.getFeature("Visualization"),this.visualization},n._groupSelections=function(e){var i={};if(e&&e.length){var n=null,r=null;return t.pluck(e,"categories").forEach((function(e){r=[],n=[],e&&e.forEach((function(e){n.push(e.columnId),e.u=e.value,e.d=e.label,e.parentId&&(e.p={u:e.parentId}),r.push(e)}));var o=t.uniq(n).join();i[o]||(i[o]=[]),i[o].push(r)})),i}},i}()})),define("dashboard-analytics/drill-through/jumpTo/JumpToTarget",["underscore","../../util/AjaxHelper","../../lib/@waca/dashboard-common/dist/utils/ContentUtil","../../cmHelper/CMHelper","../../widgets/livewidget/nls/StringResources","../../features/content/common/DataPointActionBase"],(function(e,t,i,n,r,o){return function(o){function a(e){var t;return(t=o.call(this,e)||this).drillDefinitionEntry=e.drillDefinitionEntry,t.selections=e.selections,t.rangeValueTypes={boundRange:"boundRange",unboundedRange:"unboundedRange",unboundedStartRange:"unboundedStartRange",unboundedEndRange:"unboundedEndRange"},t.negativeFilterOps=["notin","notbetween"],t.rangeFilterOps=["gt","gte","lt","lte","between"],t}_inheritsLoose(a,o);var s=a.prototype;return s.getId=function(){return this.drillDefinitionEntry.getId()},s.getName=function(){return this.drillDefinitionEntry.getName()},s.jumpTo=function(){var e=this;return this._buildDrillTargetSpec().then((function(t){(t=t||{}).content=t.content||{},t.content.cmProperties=t.content.cmProperties||{};var i=r.get("drillthrough_unsaveMsg",{name:decodeURIComponent(t.content.pathRef)}),n=e.drillDefinitionEntry.getPerspective();return"authoring"===n&&(n=void 0),e.dashboard.closeApplication(n,t.content.cmProperties.id,{unsaveMessage:i}).then(e.dashboard.openApplication.bind(e.dashboard,n,t))})).catch((function(i){var o=i.jqXHR||i||{};return 404===i.code?o.responseText=r.get("drillthrough_jumpToTarget_notFound",{name:e.drillDefinitionEntry.getName()}):o.responseText=o.responseText?o.responseText:o.statusText,o.responseText?(t.showAjaxServiceErrorMessage(e.dashboard,o),Promise.resolve()):e.dashboard.getGlassSvc(".Content").then((function(i){return n.getReportName(i,e.drillDefinitionEntry.getAssetId()).then((function(i){return o.responseText=r.get("errorDrillToTarget",{targetName:i}),t.showAjaxServiceErrorMessage(e.dashboard,o),Promise.resolve()}))}))}))},s._buildDrillTargetSpec=function(){var t=this,i={};this.dashboard.prepareGlassOptions(i);var r=this.drillDefinitionEntry.getAssetId(),o=this.drillDefinitionEntry.getAssetSearchPath();return n.getPathRefInfo(i,{storeId:r,searchPath:o,fields:["searchPath"]}).then((function(i){if(!i)return{};var n=i.objRef;e.isEmpty(n)||n===r||t.drillDefinitionEntry.setAssetId(n);var a=i.searchPath;e.isEmpty(a)||a===o||t.drillDefinitionEntry.setAssetSearchPath(a);var s={content:{cmProperties:{id:n},isViewer:!0,altDrillFlag:!0,prompt:!1,format:"HTML",editSpecification:"",pathRef:i.pathRef}};return"exploration"===t.drillDefinitionEntry.getType()?s.content.filters=JSON.stringify({options:{overrideExistingFiltersOnly:t.drillDefinitionEntry.getOverrideExistingFiltersOnly(),matchMetadataAcrossSources:t.drillDefinitionEntry.getMatchMetadataAcrossSources()},filters:t._getDashboardParameterValues()}):s.content.parameterValuesJSON=JSON.stringify(t._getReportParameterValues()),s}))},s._getDashboardParameterValues=function(){return this.dashboardParameterValues||(this.dashboardParameterValues=this._getMergedConvertedFilter()),this.dashboardParameterValues},s._getMergedConvertedFilter=function(){var e=this._getFilterInfo(),t=e.globalFilters,i=e.localFilters,n=e.selectionFilters,r=e.dataPointFilter,o={};return this._getSimpleFilterContext(t,o),this._getSimpleFilterContext(i,o),this._getSimpleFilterContext(r,o),this._getSimpleFilterContext(n,o),Object.values(o)},s._getSimpleFilterContext=function(e,t,i){var n=this;void 0===e&&(e=[]),void 0===i&&(i=!1),0!==e.length&&e.forEach((function(e){var r;e.columnId?i&&t[e.columnId]&&t[e.columnId].values&&e.values?(r=t[e.columnId].values).push.apply(r,e.values):(t[e.columnId]=e,t[e.columnId].assetId=n._getVisualization().getDataSource().getAssetId()):n._getSimpleFilterContext(e.values,t,!0)}))},s._getFilterInfo=function(){var e=this._getVisualization(),t=e.getDataSource(),n=e.getLocalFilters(),r=this.dashboard.getAppConfig("pageContainerType");return{localFilters:n.getFilterList(),globalFilters:this.globalFilters.getFilterList({origin:"filter",sourceId:t.getId(),scope:i.getPageContent(this.content,r).getId(),eventGroupId:this.eventGroups.getGroupId(this.content.getId())}),selectionFilters:this.globalFilters.getFilterList({origin:"visualization",sourceId:t.getId(),scope:i.getPageContent(this.content,r).getId(),eventGroupId:this.eventGroups.getGroupId(this.content.getId())}),dataPointFilter:this._getDataPointFilter()}},s._getDataPointFilter=function(){var t=[];return this.selections&&this.selections.dataPoints&&this.selections.dataPoints.forEach((function(i){i.categories&&i.categories.forEach((function(i){var n=e.findWhere(t,{columnId:i.columnId});n||(n={columnId:i.columnId,operator:"in",values:[]},t.push(n)),n.values.push({u:i.value,d:i.label})}))})),t},s._getReportParameterValues=function(){var t=this,i={},n=this.drillDefinitionEntry.getMappings();return e.each(n,(function(e){var n=t._getParamterValues(e);if(n)if(t._isRangeParameter(e.capabilities)){var r=t._buildRangeValues(n,e.type);i[e.name]=r}else{if(n.startValue||n.endValue){var o=[];n.startValue&&o.push(n.startValue),n.endValue&&o.push(n.endValue),n=o}n.length>0&&(i[e.name]=[],n.forEach((function(n){i[e.name].push({use:t._getUseValueFromValue(n,e.type),display:t._getDisplayValueFromValue(n)})})))}})),i},s._getParamterValues=function(t){var i;if(t&&t.mapTo&&(this._isRangeParameter(t.capabilities)||(i=this._getValuesFromSelections(t.mapTo)),i&&i.length||(i=this._getValuesFromFilters(t.mapTo,this._getLocalFilters().getFilterList())),!i||Array.isArray(i)&&!i.length||"object"==typeof i&&e.isEmpty(i))){var n=[].concat(this.globalFilters.getFilterList(this._getNetPageContextSelectors("filter")));n.push.apply(n,this.globalFilters.getFilterList(this._getNetPageContextSelectors("visualization"))),i=this._getValuesFromFilters(t.mapTo,n)}return i},s._getValuesFromSelections=function(t){var i=null,n=this.selections&&this.selections.dataPoints||[];if(n.length||(n=this.content.getFeature("DataPointSelections").getSelections()),e.pluck(n,"facts").forEach((function(e){e&&e.forEach((function(e){e.columnId===t&&(i=null!==e.value&&void 0!==e.value?[e.value]:null)}))})),i)return i;var r=this._groupSelections(n);i=this._getValues(r,t);var o=this.dashboard.getCanvas().getSelectedContentList(),a=1===o.length?o[0]:null;if(!a||a===this.content)return i;var s=this._getNetPageContextSelectors("visualization");s.eventSourceId=a.getId();var l,c=this._getValuesFromFilters(t,this.globalFilters.getFilterList(s));c&&c.length&&(l=i=i||[]).push.apply(l,c);return this._uniqueValues(i)},s._getValues=function(e,t){if(e){var i=[];for(var n in e){-1!==n.split(",").indexOf(t)&&e[n].forEach((function(e){e.forEach((function(e){e.columnId===t&&i.push(e)}))}))}return this._uniqueValues(i)}},s._uniqueValues=function(e){void 0===e&&(e=[]);var t=[],i={};return e.forEach((function(e){i[e.u]||(i[e.u]=1,t.push(e))})),t},s._getFilterSpec=function(e,t,i){void 0===i&&(i=null);for(var n=0;n<t.length;n++){if(t[n].columnId===e){var r;if(i)(r=i.values).push.apply(r,t[n].values);else i=t[n];break}t[n].values&&t[n].values.length&&(i=this._getFilterSpec(e,t[n].values,i))}return i},s._getValuesFromFilters=function(e,t){var i,n=t&&this._getFilterSpec(e,t);if(n&&!this._isNegativeOperation(n)&&n.values&&(i=n.values,this._isRangeFilter(n))){var r,o;switch(n.operator){case"between":r=i[0],o=i[1];break;case"gt":case"gte":r=i[0];break;case"lt":case"lte":o=i[0]}i={startValue:r,endValue:o}}return i},s._getNetPageContextSelectors=function(e){var t=i.getPageContent(this.content);return{scope:t&&t.getId(),sourceId:this._getVisualization().getDataSource().getId(),origin:e}},s._isNegativeOperation=function(e){return-1!==this.negativeFilterOps.indexOf(e.operator)},s._isRangeFilter=function(e){return-1!==this.rangeFilterOps.indexOf(e.operator)},s.remove=function(){this.drillDefinitionEntry=null,this.selections=null},s._isRangeParameter=function(e){return e&&(-1!==e.indexOf(this.rangeValueTypes.unboundedRange)||-1!==e.indexOf(this.rangeValueTypes.boundRange))},s._buildRangeValues=function(t,i){var n,r;t&&(e.isArray(t)&&t.length>=1?(n=t[0],r=t[0]):(n=t.startValue,r=t.endValue));var o={};return n&&r?o[this.rangeValueTypes.boundRange]={start:{use:this._getUseValueFromValue(n,i),display:this._getDisplayValueFromValue(n)},end:{use:this._getUseValueFromValue(r,i),display:this._getDisplayValueFromValue(r)}}:n?o[this.rangeValueTypes.unboundedEndRange]={start:{use:this._getUseValueFromValue(n,i),display:this._getDisplayValueFromValue(n)}}:r&&(o[this.rangeValueTypes.unboundedStartRange]={end:{use:this._getUseValueFromValue(r,i),display:this._getDisplayValueFromValue(r)}}),e.isEmpty(o)?null:[o]},s._getUseValueFromValue=function(e,t){return"object"==typeof e?"memberUniqueName"===t?void 0===e.value?e.u:e.value:void 0===e.label?void 0===e.d?e.value:e.d:e.label:e},s._getDisplayValueFromValue=function(e){return"object"==typeof e?void 0===e.label?void 0===e.d?e.value:e.d:e.label:e},a}(o)})),define("dashboard-analytics/util/JumpToActionHelper",["../drill-through/jumpTo/JumpToTarget","underscore"],(function(e,t){var i=function(){};return i.getJumpToTargets=function(i){var n=(i=i||{}).drillDefinitions,r=i.sourceId,o={},a=[];return t.each(n,(function(t){for(var n=t.getModelRefs(),s=0;s<n.length;s++)if(n[s]===r){var l=new e({content:i.content,dashboardAPI:i.dashboardApi,drillDefinitionEntry:t,selections:i.selections});o[t.getId()]=l,a.push(l);break}})),{targets:a,targetsMap:o}},i})),define("dashboard-analytics/drill-through/models/DrillThroughService",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../controls/DrillThroughController","../managers/DrillThroughMappingManager","../../util/JumpToActionHelper","underscore"],(function(e,t,i,n,r){var o=e.extend({init:function(e){o.inherited("init",this,arguments),this.dashboardApi=e.dashboardApi,this._drillThroughController=new t(this.dashboardApi,this),this._mappingManager=new i(this.dashboardApi)},getDrillThroughModelApi:function(){if(!this.drillThrough){var e=this.dashboardApi.getFeature("internal").getBoardModel();this.drillThrough=e.get("drillThrough")}return Promise.resolve(this.drillThrough.getAPI())},getDrillThroughModelApiSync:function(){return this.drillThrough||(this.drillThrough=this.dashboardApi.getFeature("internal").getBoardModel().get("drillThrough")),this.drillThrough.getAPI()},getDrillThroughByWidgetAndGroups:function(e,t){var i=this.dashboardApi.getFeature("internal").getBoardModel(),n=[],o=i.drillThrough.getModels(),a=i.eventGroups.findGroup(e.get("id"));return o.forEach((function(i){("visualization"===i.scope&&i.ownerId===e.get("id")||"connection"===i.scope&&a&&a.widgetIds.indexOf(i.ownerId)>-1||"dashboard"===i.scope)&&(i.mappings&&i.mappings.length&&(i.mappings=JSON.parse(JSON.stringify(i.mappings)),i.mappings.forEach((function(i){if(i.mapTo){var n,o=e.data&&e.data.dataViews;if(r.find(o,(function(e){return r.find(e&&e.dataItems,(function(e){var t=e&&e.itemId===i.mapTo;return t&&(n=e),t}))})),!n){var a=e.localFilters;n=r.find(a,(function(e){return e.id===i.mapTo||e.columnId===i.mapTo})),t&&!n&&delete i.mapTo}}}))),n.push(i))})),n},addDrillThroughOnAddFragment:function(e,t,i,n){var r=e&&e.drillThrough;if(r&&r.length){var o=this.getDrillThroughModelApiSync();this._applyTargetMatchingRulesForAddFragment(r,o,n),r.forEach((function(e){var n=e.modelRefs[0];t&&t[n]&&(e.modelRefs=[t[n]]);var r={},a=i[e.ownerId];a&&(r.newOwnerId=a),o.addUpdateDrillDefinitionEntry(e,r)}))}},_applyTargetMatchingRulesForAddFragment:function(e,t,i){var n=this,r=this._getTargetEventGroupInfo(i);if(r){var o=t.getDrillDefinitionEntries();e.forEach((function(e){if("visualization"===e.scope)e.id=null;else if("connection"===e.scope){var t=n._findMatchingDrillThroughInTargetGroup(e,o,r.defaultEventGroupId);e.id=t?t.getId():null}e.eventGroupId=r.defaultEventGroupId}))}},_getTargetEventGroupInfo:function(e){if(e){var t=this.dashboardApi.getFeature("EventGroups"),i=t&&t.getGroupIdsOnPage(e),n=this.dashboardApi.getCanvas().getContent(e);return{eventGroupsOnPage:i,defaultEventGroupId:t&&t.getDefaultGroupId(n)}}return null},_findMatchingDrillThroughInTargetGroup:function(e,t,i){return t.find((function(t){return i===t.getEventGroupId()&&e.name===t.getName()&&function(t){return e.assetId===t.getAssetId()||e.assetSearchPath===t.getAssetSearchPath()}(t)&&e.type===t.getType()&&e.perspective===t.getPerspective()&&r.isEqual(e.modelRefs,t.getModelRefs())&&r.isEqual(e.mappings,t.getMappings())&&e.scope===t.getScope()}))},getDrillThroughController:function(){return this._drillThroughController},getDrillThroughMappingManager:function(){return this._mappingManager},getJumpToTargets:function(e){return n.getJumpToTargets(e)},getDeploymentReferences:function(){var e=this.getDrillThroughModelApiSync().getDrillDefinitionEntries(),t=this.dashboardApi.getGlassCoreSvc(".UserProfile"),i=t&&t.preferences,n=i&&i.contentLocale||"en-us",r=[];return e.forEach((function(e){var t;r.push({objects:[{type:e.getType(),searchPath:'storeID("'+e.getAssetId()+'")'}],name:(t={},t[n]=e.getAssetId(),t)})})),r}});return o})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/MultilingualAttribute",["../lib/@waca/core-client/js/core-client/ui/core/Class","underscore"],(function(e,t){var i=e.extend({translationLocale:null,init:function(e,t,n){if(i.inherited("init",this,arguments),"string"!=typeof t&&(n=t,t=void 0),this.defaultLocale=n.defaultLocale||"Default",this.contentLocale=n.contentLocale||"en",this.translationLocale=n.translationLocale,e&&e.translationTable)this.translationTable=e.translationTable;else if(this.translationTable={},this.translationLocale)this.setValue(e,this.translationLocale);else if(t)this.setValue(e,t);else if(n.availableDashboardLocales){var r=[];n.availableDashboardLocales.forEach((function(e){r[e]="dummyString"}));var o=this._determineCorrectLocale(r);this.setValue(e,o)}else this.setValue(e,this.defaultLocale)},startTranslation:function(e){this.translationLocale=e},stopTranslation:function(){this.translationLocale=null},getCurrentModelLocale:function(){return this.translationLocale?this.translationLocale:this._determineCorrectLocale(this.translationTable)},setValue:function(e,t){t?e?"object"===(void 0===e?"undefined":_typeof(e))&&e.translationTable?this.translationTable[t]=e.translationTable[t]:this.translationTable[t]=e:delete this.translationTable[t]:console.error("Trying to set multilingual property without specifying a locale")},getValue:function(e){return e?this.translationTable[e]:this.translationLocale&&void 0!==this.translationTable[this.translationLocale]?this.translationTable[this.translationLocale]:this.translationTable[this._determineCorrectLocale(this.translationTable)]||""},_determineCorrectLocale:function(e){if(void 0!==e[this.contentLocale])return this.contentLocale;var t=this.contentLocale.substr(0,2);if(-1!==this.defaultLocale.indexOf(t)&&void 0!==e[this.defaultLocale])return this.defaultLocale;if(void 0!==e[t])return t;for(var i=Object.keys(e).filter((function(e){return e.substring(0,2)===t})).sort();i.length>0;){var n=i.shift();if(void 0!==e[n])return n}if(void 0!==e[this.defaultLocale])return this.defaultLocale;for(var r=Object.keys(e).sort();r.length>0;){var o=r.shift();if(void 0!==this.translationTable[o])return o}return this.defaultLocale||"Default"},setDefaultLocale:function(e){this.translationTable.hasOwnProperty(e)||this.switchLocale({from:this.defaultLocale,to:e}),this.defaultLocale=e},switchLocale:function(e){var t=e.from,i=e.to;this.translationTable[t]&&(this.translationTable[i]=this.translationTable[t],this.removeTranslation(t))},removeTranslation:function(e){delete this.translationTable[e]},toString:function(){return this.getValue()},toJSON:function(){return{translationTable:t.extend({},this.translationTable)}},needsTranslation:function(){return!t.isEmpty(this.translationTable)&&void 0===this.translationTable[this.translationLocale]},getLanguages:function(){return this.translationTable?Object.keys(this.translationTable):[]}});return i})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/Model",["underscore","../lib/@waca/core-client/js/core-client/ui/core/Class","../lib/@waca/core-client/js/core-client/ui/core/Events","./MultilingualAttribute"],(function(e,t,i,n){var r=0,o=(new Date).valueOf();var a=null;return a=t.extend([i],{nestedModels:{},nestedCollections:{},localizedProps:[],whitelistAttrs:[],runtimeAttrs:[],init:function(t,i){i=i||{},a.inherited("init",this,arguments),this.runtimeAttrs.length&&(this._persistedRuntimeAttrs={}),this.set(t,e.defaults(i,{silent:!0})),null!==this.id&&void 0!==this.id||(this.id=this._generateUniqueId("model")),this.contentReferences=[],this.colorProperties=[]},trigger:function(e,t){return t&&t.data&&t.data.transactionToken&&"event"===t.data.transactionToken.source&&(t.data.transactionToken=JSON.parse(JSON.stringify(t.data.transactionToken)),t.data.transactionToken.eventGenerated=!0),a.inherited("trigger",this,arguments)},_generateUniqueId:function(e){return function(e){var t=(new Date).valueOf();return t!==o?(r=0,o=t):r++,[e,("0000000000000000"+t.toString(16)).slice(-16),"_",("00000000"+r.toString(16)).slice(-8)].join("")}(e)},resolvePropertyName:function(e,t){return t&&_typeof(this[e])===(void 0===t?"undefined":_typeof(t))?e:"function"==typeof this[e]?"_"+e+"Prop":e},getId:function(){return this.id},toJSON:function(t,i){var n={},r=function t(i){return i?i.toJSON&&e.isFunction(i.toJSON)?i.toJSON():e.isArray(i)?e.map(i,(function(e){return t(e)})):function(e){try{return JSON.parse(JSON.stringify(e))}catch(e){throw new Error("Error attempting to clone object:\n"+e.message)}}(i):i},o=this.whitelistAttrs;return i&&(o=this.whitelistAttrs.filter((function(t){return!e.contains(i,t)}))),e.each(o,function(e){-1!==this.runtimeAttrs.indexOf(e)?void 0!==this._persistedRuntimeAttrs[e]&&(n[e]=r(this._persistedRuntimeAttrs[this.resolvePropertyName(e)])):void 0!==this[e]&&(n[e]=r(this[this.resolvePropertyName(e)]))}.bind(this)),t&&e.each(t,function(e){void 0!==this[this.resolvePropertyName(e)]&&(n[e]=r(this[this.resolvePropertyName(e)]))}.bind(this)),n},getUsedCustomColors:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];if(t){for(var o in this.nestedCollections)if(this[o]){var a=this[o].getModels();a.forEach((function(e){r=r.concat(e.getUsedCustomColors(t))}))}for(var s in this.nestedModels)this[s]&&(r=r.concat(this[s].getUsedCustomColors(t)));var l=this.colorProperties.length>0?this.colorProperties:n;return l.forEach((function(e){var n=i.get(e);t.ids.forEach((function(e,i){n&&-1!==n.indexOf(e)&&r.push(t.fills[i])}))})),e.uniq(r,!1)}},getContentReferences:function(){var t=this,i=[];for(var n in this.nestedCollections){if(this[n])this[n].getModels().forEach((function(e){i=i.concat(e.getContentReferences())}))}for(var r in this.nestedModels)this[r]&&(i=i.concat(this[r].getContentReferences()));return this.contentReferences.forEach((function(e){var n=e.get?e.get():t.get(e.name);n&&i.push({value:n,type:e.type})})),e.uniq(i,!1,(function(e){return e.value}))},_setCollection:function(e,t,i){var n=this.resolvePropertyName(e,t);if(this[n]&&"function"==typeof this[n].set)this[n].reset(t,i);else{var r;r=t instanceof this.nestedCollections[n]?t:new this.nestedCollections[n](t,i),this[n]=r;var o=function(e,t){return e[t]||(e.options?e.options[t]:null)};r.on("all",function(e){if(e&&!e.stopPropagation){var t=o(e,"senderContext"),i=o(e,"sender"),r="change:"+n,a={eventName:r,name:e.name,value:e.value,prevValue:e.prevValue,model:this,data:e.data||(e.options?e.options.payloadData:null),collection:this.collection||null,sender:i,senderContext:t,origCollectionEvent:e};this.trigger(r,a)}}.bind(this))}},_setNestedModel:function(e,t,i){var n,r=this.resolvePropertyName(e,t);this[r]&&"function"==typeof this[r].set?this[r].set(t,i):(n=t instanceof this.nestedModels[r]?t:new this.nestedModels[r](t,i),this[r]=n,n.on("all",function(e){if(e&&!e.stopPropagation){var t="change:"+r,i={eventName:t,name:e.name,value:e.value,prevValue:e.prevValue,model:this,sender:e.sender||(e.options?e.options.sender:null),senderContext:e.senderContext||(e.options?e.options.senderContext:null),origModelEvent:e,data:e.data||(e.options?e.options.payloadData:null)};this.trigger(t,i)}}.bind(this)))},_setLocalized:function(e,t,i){var r=null,o=null;"object"!==(void 0===(t=null===t?void 0:t)?"undefined":_typeof(t))||t.translationTable?r=t:(t.locale&&(o=t.locale),t.value&&(r=t.value));var a=this.resolvePropertyName(e,r);o||(o=this[a]?this[a].getCurrentModelLocale():i.defaultLocale||"Default");var s=!!i.payloadData&&i.payloadData.forceEvent,l=this[a]?this[a].getValue(o):null;if((l!==r||s)&&(this[a]?this[a].setValue(r,o):this[a]=new n(r,o,i),!i.silent||s)){var c="change:"+a,u={eventName:c,name:a,value:this[a].getValue(),upValue:{value:r,locale:o},prevValue:{value:l,locale:o},model:this,collection:this.collection||null,sender:i.sender||this,senderContext:i.senderContext,data:i.payloadData};this.trigger(c,u)}},_setValue:function(e,t,i){var n=this.resolvePropertyName(e,t),r=!!i.payloadData&&i.payloadData.forceEvent,o=!!i.payloadData&&i.payloadData.runtimeOnly,a=this[n];if((a!==t||r)&&(this[n]=t,!i.silent||r)){var s="change:"+n,l={eventName:s,name:n,value:t,prevValue:a,model:this,collection:this.collection||null,sender:i.sender||this,senderContext:i.senderContext,data:i.payloadData};this.trigger(s,l)}o||-1===this.runtimeAttrs.indexOf(n)||(this._persistedRuntimeAttrs[n]=t)},_set:function(t,i,n){this.nestedCollections[t]?this._setCollection(t,i,n):this.nestedModels[t]?this._setNestedModel(t,i,n):((n=n?e.clone(n):{}).senderContext=n.senderContext?n.senderContext:{applyFn:this.applyFn.bind(this)},-1!==this.localizedProps.indexOf(t)?this._setLocalized(t,i,n):this._setValue(t,i,n))},set:function(e,t){if("object"===(void 0===e?"undefined":_typeof(e))&&null!==e)for(var i in e)e.hasOwnProperty(i)&&this._set(i,e[i],t);return this},applyFn:function(e,t,i,n){if(i){var r={};r[i]=e;var o={sender:t};n&&(o.payloadData=n),this.set(r,o)}},get:function(e){var t=this.resolvePropertyName(e);return-1!==this.localizedProps.indexOf(t)?this[t]&&this[t].getValue():this[t]},getPersisted:function(e){return-1!==this.runtimeAttrs.indexOf(e)?this._persistedRuntimeAttrs[e]:this.get(e)},replaceIds:function(t){if(this.id){var i=t[this.id];i||(i=this._generateUniqueId("model"),t[this.id]=i),this.from=this.id,this.id=i}e.each(this.items,(function(e){e.replaceIds&&e.replaceIds(t)}))},getMultilingualAttribute:function(e){return-1!==this.localizedProps.indexOf(e)&&this[e]?{propertyName:e,propertyParentModel:this,multilingualProperty:this[e]}:null},getMultilingualAttributes:function(){var e=this,t=[];return this.localizedProps.forEach((function(i){var n=e.getMultilingualAttribute(i);n&&t.push(n)})),t}})})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/utils/CommonUtil",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.defaults=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];if("object"!==(void 0===i?"undefined":_typeof(i))||!i)return e;var r=function(e,t){if(!t)return e;var i=Object.getOwnPropertyNames(t),n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var o;if(n){if(r>=i.length)break;o=i[r++]}else{if((r=i.next()).done)break;o=r.value}var a=o;e.hasOwnProperty(a)||(e[a]=t[a])}return e};return i.reduce(r,e)},e.isObject=function(e){return"function"==typeof e||"object"===(void 0===e?"undefined":_typeof(e))&&null!==e},e.isEmpty=function(e){return null==e||0===Object.keys(e).length},e.uniq=function(e){return Array.isArray(e)?Array.from(new Set(e)):e},e.uniqBy=function(e,t){if(!Array.isArray(e))return e;var i=[],n=new Map,r=e,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var l=s;n.has(l[t])||(n.set(l[t],!0),i.push(l))}return i},e.values=function(e){return null==e?[]:Object.values(e)},e.clone=function(e){return Array.isArray(e)?e.slice(0):Object.assign({},e)},e.deepClone=function(e){return JSON.parse(JSON.stringify(e))},e.deepExtend=function(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n&&t?e.deepClone(t):t||{};return Object.keys(i||{}).forEach((function(t){"object"===_typeof(i[t])?r[t]?e.deepExtend(r[t],i[t]):r[t]=e.deepClone(i[t]):r[t]=i[t]})),r},e.positionComparator=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=function(t,i){if(null==t&&null==i)return 0;if(null==t)return 1;if(null==i)return-1;var n=t-i;return Math.abs(n)<=e?0:n};return function(e,i){var n=t(e.y,i.y);return 0===n?t(e.x,i.x):n}},e}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/Collection",["underscore","../lib/@waca/core-client/js/core-client/ui/core/Events","./Model","../utils/CommonUtil"],(function(e,t,i,n){var r=t.extend({init:function(e,t){r.inherited("init",this,arguments),this.models=[],this.modelMap={},e=e||[],t=t||{};var n=Object.assign({},t,{add:!0,remove:!1,merge:!1});this.model=this.modelClass||t.modelClass||i,this.set(e,n)},getModels:function(){return this.models},get:function(e){var t=this.modelMap[e];return t||(e?this.modelMap[e.id]:void 0)},add:function(e,t){return this.set(e,Object.assign({merge:!1,add:!0,remove:!1},t))},remove:function(e,t){t=Object.assign({},t),e=null==e?[]:e;var i=!Array.isArray(e),n=[],r=e=i?[e]:e,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var l=s,c=this.get(l);if(c){n.push(c),delete this.modelMap[c.id];var u=this.models.indexOf(c),d=this.models[u];this.models.splice(u,1);var h=t.senderContext?t.senderContext:{applyFn:function(e,t,i,n){e?this.remove(c,{sender:t,silent:!1,payloadData:n}):this.add(c,{sender:t,silent:!1,payloadData:n})}.bind(this)};if(!t.silent){t.index=u;var g={name:"remove",value:c,eventName:"remove",collection:this,model:c,options:t,data:t.payloadData,sender:t.sender?t.sender:this,senderContext:h};d&&d.trigger("remove",g)}d&&this._stopTrackingModel(d)}}return i?n[0]:n},reset:function(e,t){t=t||{};for(var i=0,n=this.models.length;i<n;i++)this._stopTrackingModel(this.models[i],t);if(t.previousModels=this.models,this.models=[],this.modelMap={},e&&(e=this.add(e,Object.assign({silent:!0},t))),!t.silent){var r={name:"reset",eventName:"reset",collection:this,options:t};this.trigger("reset",r)}return e},reorder:function(e,t,i){i=Object.assign({},i);var n=this.get(e),r=this.get(t);if(n&&e!==t){var o=this.models.indexOf(n),a=this.models[o+1]?this.models[o+1].id:void 0;this.models.splice(o,1);var s=this.models.indexOf(r);if(s>=0?this.models.splice(s,0,n):this.models.push(n),!i.silent&&o!==s&&t!==a&&(o+1!==this.models.length||-1!==s)||i.forceEvent){var l={applyFn:function(e,t,i,n){this.reorder(e.modelId,e.beforeId,{sender:t,silent:!1,payloadData:n})}.bind(this)},c={name:"reorder",eventName:"reorder",collection:this,value:{modelId:e,beforeId:t},prevValue:{modelId:e,beforeId:a},options:i,data:i.payloadData,sender:i.sender?i.sender:this,senderContext:l};this.trigger("reorder",c)}}},set:function(e,t){t=n.defaults({},t,{add:!0,remove:!0,merge:!0,insert:!1}),e=e||[];var i,r,o,a,s=!Array.isArray(e);e=s?[e]:n.clone(e);var l=[],c=[],u={},d=t.add,h=t.merge,g=t.remove,p=t.insert;for(i=0,a=e.length;i<a;i++)(r=e[i])instanceof this.model||(e[i]=r=new this.model(r,Object.assign({},t,this.modelConstructorOptions))),t.cbValidator&&!t.cbValidator(r)||(u[r.id]=r,o=this.modelMap[r.id],h&&o?o.set(r.toJSON(),t):d&&!o&&l.push(r));function f(e){this.modelMap[e.id]=e,p?this.models.unshift(e):this.models.push(e),this._trackModel(e);var i=t.senderContext?t.senderContext:{applyFn:function(t,i,n,r){t?this.add(e,{sender:i,silent:!1,payloadData:r}):this.remove(e,{sender:i,silent:!1,payloadData:r})}.bind(this)};if(!t.silent){var n={name:"add",value:e,eventName:"add",collection:this,model:e,options:t,data:t.payloadData,sender:t.sender||this,senderContext:i};e.trigger("add",n)}}for(function(){if(g){for(i=0,a=this.models.length;i<a;i++)o=this.models[i],u[o.id]||c.push(o);c.length&&this.remove(c,t)}}.bind(this)(),i=0,a=l.length;i<a;i++)f.bind(this)(l[i]);return s?e[0]:e},_trackModel:function(e){this.modelMap[e.id]=e,e.on("all",this._onModelEvent,this),e.on("change:id",function(t){delete this.modelMap[t.prevValue];var i=!1,n=this.models,r=Array.isArray(n),o=0;for(n=r?n:n[Symbol.iterator]();;){var a;if(r){if(o>=n.length)break;a=n[o++]}else{if((o=n.next()).done)break;a=o.value}var s=a;if(t.value===s.id&&s!==e){var l=this.models.indexOf(e);this.models.splice(l,1),i=!0;break}}i||(this.modelMap[t.value]=e)}.bind(this))},_stopTrackingModel:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e){var t=e.eventName;("add"!==t&&"remove"!==t||e.collection===this)&&(n.defaults(e,{model:e.sender,collection:this}),this.trigger(t,e))},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))}});return r._underscoreMethods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"],r._underscoreMethods.forEach((function(t){e[t]&&(r.prototype[t]=function(){var i=Array.prototype.slice.call(arguments,0);return i.unshift(this.models),e[t].apply(e,i)})})),r._underscoreAttributeMethods=["groupBy","countBy","sortBy","indexBy"],r._underscoreAttributeMethods.forEach((function(t){e[t]&&(r.prototype[t]=function(i,n){var r=i instanceof Function?i:function(e){return e.get(i)};return e[t](this.models,r,n)})})),r})),define("dashboard-analytics/drill-through/models/DrillThroughDefinitionEntry",["../../lib/@waca/dashboard-common/dist/core/Model"],(function(e){var t=e.extend({whitelistAttrs:["id","name","type","assetId","assetSearchPath","scope","modelRefs","mappings","ownerId","perspective","eventGroupId","matchMetadataAcrossSources","overrideExistingFiltersOnly"],init:function(e){t.inherited("init",this,arguments),this.targetName=e.targetName,this.api={getId:this._getId.bind(this),getName:this._getName.bind(this),getTargetName:this._getTargetName.bind(this),setTargetName:this._setTargetName.bind(this),getType:this._getType.bind(this),getAssetId:this._getAssetId.bind(this),setAssetId:this._setAssetId.bind(this),getAssetSearchPath:this._getAssetSearchPath.bind(this),setAssetSearchPath:this._setAssetSearchPath.bind(this),getPerspective:this._getPerspective.bind(this),setPerspective:this._setPerspective.bind(this),getScope:this._getScope.bind(this),getModelRefs:this._getModelRefs.bind(this),getMappings:this._getMappings.bind(this),update:this._update.bind(this),removeModelRef:this._removeModelRef.bind(this),getOwnerId:this._getOwnerId.bind(this),getEventGroupId:this._getEventGroupId.bind(this),getMatchMetadataAcrossSources:this._getMatchMetadataAcrossSources.bind(this),getOverrideExistingFiltersOnly:this._getOverrideExistingFiltersOnly.bind(this)}},getAPI:function(){return this.api},_getId:function(){return this.id},_getName:function(){return this.name},_getType:function(){return this.type},_getAssetId:function(){return this.assetId},_setAssetId:function(e){this.assetId=e},_getPerspective:function(){return this.perspective||"authoring"},_setPerspective:function(e){this.perspective=e},_getAssetSearchPath:function(){return this.assetSearchPath},_setAssetSearchPath:function(e){this.assetSearchPath=e},_getTargetName:function(){return this.targetName},_setTargetName:function(e){this.targetName=e},_getScope:function(){return this.scope},_getModelRefs:function(){return this.modelRefs},_getMappings:function(){return this.mappings},_update:function(e,t){this.set(e,t)},_removeModelRef:function(){},_getOwnerId:function(){return this.ownerId},_getEventGroupId:function(){return this.eventGroupId},_getMatchMetadataAcrossSources:function(){return this.matchMetadataAcrossSources},_getOverrideExistingFiltersOnly:function(){return this.overrideExistingFiltersOnly}});return t})),define("dashboard-analytics/drill-through/models/DrillThroughModel",["../../lib/@waca/dashboard-common/dist/core/Collection","./DrillThroughDefinitionEntry","underscore"],(function(e,t,i){var n=e.extend({modelClass:t,init:function(e,t){n.inherited("init",this,[e,t]),this.logger=t.logger,this.boardModel=t.boardModel,this.dashboard=t.dashboardApi,this.api={getDrillDefinitionEntry:this._getDrillDefinitionEntry.bind(this),getDrillDefinitionEntries:this._getDrillDefinitionEntries.bind(this),deleteDrillDefinitionEntry:this._deleteDrillDefinitionEntry.bind(this),addUpdateDrillDefinitionEntry:this._addUpdateDrillDefinitionEntry.bind(this),getNumOfDrillDefinitions:this._getNumOfDrillDefinitions.bind(this),toJSON:this.toJSON.bind(this),applyModelChange:this.reset.bind(this)}},destroy:function(){n.inherited("destroy",this,arguments)},getAPI:function(){return this.api},_getDrillDefinitionEntry:function(e){return this.get(e)?this.get(e).getAPI():null},_getDrillDefinitionEntries:function(e){var t=[];return this.each(function(i){var n=i.getAPI();if(e)if("visualization"===n.getScope())e.getId()===n.getOwnerId()&&t.push(n);else if("connection"===n.getScope()){var r=this.dashboard.getFeature("EventGroups").getGroupId(e.getId());r&&r===n.getEventGroupId()&&t.push(n)}else"dashboard"===n.getScope()&&t.push(n);else t.push(n)}.bind(this)),t},_addUpdateDrillDefinitionEntry:function(e,n){n=n||{};var r,o,a=(e=e||{}).id?(r=this.models,o=e.id,i.find(r,(function(e){return e.id===o}))):null;return a?a.getAPI().update(e,n):(n.newOwnerId&&(e.ownerId=n.newOwnerId),a=new t(e),this.add([a],n)),a.getAPI()},_deleteDrillDefinitionEntry:function(e,t){for(var i,n=0;n<this.models.length;n++){var r=this.models[n];if(r.getAPI().getId()===e){i=this.remove(r,t);break}}return!(!i||i.id!==e)},_getNumOfDrillDefinitions:function(){return this.models.length}});return n})),define("dashboard-analytics/dataSources/models/synchronizeData/SynchronizeDataEntry",["../../../lib/@waca/dashboard-common/dist/core/Model","../../utils/DatasourceUtil","underscore"],(function(e,t,i){var n=function(e,t){return i.find(e,(function(e){return e.itemId===t}))},r=function(e,n,r){return i.find(e,(function(e){return e.sourceId===n&&(!r||t.haveATableReference(r,e.tableRef,!0))}))},o=e.extend({whitelistAttrs:["sourceId","tableRef","scope","eventGroupId","synchronizeItems","itemId","items"],init:function(){o.inherited("init",this,arguments)},inSameScope:function(e,t){return this.scope===e&&this.eventGroupId===t},getSourceId:function(){return this.sourceId},getTableRef:function(){return this.tableRef},setTableRef:function(e){this.tableRef=e},getSynchronizeItems:function(){return this.synchronizeItems},getSources:function(){var e=[];e.push(this.sourceId);var t=function(t){-1===e.indexOf(t.sourceId)&&e.push(t.sourceId)};return i.each(this.synchronizeItems,(function(e){i.each(e.items,t)})),e},getSynchronizeItemId:function(e,t,i){var o=n(this.synchronizeItems,e);return o&&(o=r(o.items,t,i)),o},addSynchronizeItem:function(e,t,i,o){this.synchronizeItems=this.synchronizeItems||[];var a=n(this.synchronizeItems,e);a||(a=this.synchronizeItems[this.synchronizeItems.push({itemId:e})-1]),a.items=a.items||[],r(a.items,t,o)||a.items.push({sourceId:t,itemId:i,tableRef:o})},hasSynchronizeData:function(){this._removeEmptyContents();var e=!1;return this.synchronizeItems&&this.synchronizeItems.length>0&&(e=!!i.find(this.synchronizeItems,(function(e){return e.items&&e.items.length>0}))),e},inSameTable:function(e){return e&&this.tableRef===e},_removeEmptyContents:function(){var e;this.synchronizeItems&&(this.synchronizeItems.forEach((function(t){t.items&&t.items.length>0&&(e||(e=[]),e.push(t))})),this.synchronizeItems=e)}});return o})),define("dashboard-analytics/dataSources/models/synchronizeData/SynchContextHelper",["underscore","../../utils/DatasourceUtil"],(function(e,t){var i=function(){return!0},n=function(e,t){for(var i,n=t.getTableName(),r=_createForOfIteratorHelperLoose(e);!(i=r()).done;){if(n===i.value)return!0}return!1},r=function(t,i,r,o){var a=[];return i.forEach((function(e){for(var i,s=_createForOfIteratorHelperLoose(t);!(i=s()).done;){var l=i.value,c=l.getLabel().toLocaleLowerCase();if(r&&l.getId()===e){a.push(c);break}if(!r&&c===e&&n(o,l)){a.push(l.getId());break}}})),e.uniq(a)},o=function(){function e(e){void 0===e&&(e={}),this.itemId=e.itemId}return e.prototype.getColumnId=function(){return this.itemId},e}(),a=function(){function e(e){var t=this;return void 0===e&&(e={}),this.generateDataItemIds(e.itemIds),{getDataItemList:function(){return t.dataItemAPIs}}}return e.prototype.generateDataItemIds=function(e){var t=this;void 0===e&&(e=[]),this.dataItemAPIs=[],e.forEach((function(e){t.dataItemAPIs.push(new o({itemId:e}))}))},e}(),s=function(){function e(e,t){if(!t)throw new Error("item object is not provided.");return this.item=t,this.module=e,{getLabel:this.getLabel.bind(this),getItemId:this.getItemId.bind(this),getId:this.getItemId.bind(this),getTableName:this.getTableName.bind(this)}}var t=e.prototype;return t.getLabel=function(){return this.item.itemLabel||this.item.getLabel()},t.getItemId=function(){return this.item.itemId||this.item.getItemId()},t.getTableName=function(){var e=this.module.getMetadataColumn(this.getItemId());return e?e.getTableName():void 0},e}(),l=function(){function i(e){if(void 0===e&&(e={}),!e.fromObject)throw new Error("fromObject is not provided.");this.fromObject=e.fromObject,this.module=e.module,this.synchDataEntry=e.synchDataEntry,this.projectedItems=c.createSynchProjectedItems(this.module,e.projectedItems),this.ownerWidget=e.ownerWidget,this.widgetIds=[e.widgetId],this.getTableRef()}var n=i.prototype;return n.getAPI=function(){return this.api||(this.api={getSourceId:this.getSourceId.bind(this),getEventGroupId:this.getEventGroupId.bind(this),getEventSourceId:this.getEventSourceId.bind(this),getTableRef:this.getTableRef.bind(this),getOrigin:this.getOrigin.bind(this),getModule:this.getModule.bind(this),setModule:this.setModule.bind(this),getSynchDataEntry:this.getSynchDataEntry.bind(this),getProjectedItems:this.getProjectedItems.bind(this),setProjectedItems:this.setProjectedItems.bind(this),haveJoinedTables:this.haveJoinedTables.bind(this),getSynchronizeItemId:this.synchDataEntry.getSynchronizeItemId.bind(this.synchDataEntry),getSynchronizeItems:this.synchDataEntry.getSynchronizeItems.bind(this.synchDataEntry),addSynchronizeItem:this.synchDataEntry.addSynchronizeItem.bind(this.synchDataEntry),toJSON:this.synchDataEntry.toJSON.bind(this.synchDataEntry),getWidgetIds:this.getWidgetIds.bind(this)}),this.api},n.getSourceId=function(){return this.fromObject.getSourceId()},n.getEventGroupId=function(){return this.fromObject.getEventGroupId()},n.getEventSourceId=function(){return this.fromObject.getEventSourceId()},n.getTableRef=function(){return this.tableRef=this.tableRef||(this.fromObject.getTableRef?this.fromObject.getTableRef():t.getTableRef(this.module,this.projectedItems.map((function(e){return e.getItemId()})))),this.tableRef},n.getOrigin=function(){return this.fromObject.getOrigin()},n.getModule=function(){return this.module},n.setModule=function(e){this.module=e},n.getSynchDataEntry=function(){return this.synchDataEntry},n.setSynchDataEntry=function(e){this.synchDataEntry=e},n.getProjectedItems=function(){return this.projectedItems||this.visAPI&&(this.projectedItems=this.visAPI.getDataSlots()),this.projectedItems},n.setProjectedItems=function(e){void 0===e&&(e=[]),this.projectedItems=e},n.mergeProjectedItems=function(t){var i=this,n=t.getProjectedItems();this.projectedItems=this.projectedItems||[],n.forEach((function(t){e.find(i.projectedItems,(function(e){return t.getItemId()===e.getItemId()}))||i.projectedItems.push(t)})),this.tableRef=e.uniq(this.getTableRef().concat(t.getTableRef()))},n.haveJoinedTables=function(e){return c.haveJoinedTables(this,e)},n.getTableNames=function(){return this.module.getTableNames()},n.addWidgetId=function(e){-1===this.widgetIds.indexOf(e)&&this.widgetIds.push(e)},n.getWidgetIds=function(){return this.widgetIds},i}(),c=function(){function n(){}return n.createNewSynchContext=function(e){return void 0===e&&(e={}),t.isSupportedNonJoinTableDatascourceType(e.module,e.projectedItems?e.projectedItems.map((function(e){return e.getItemId()})):null)?new l(e):null},n.getNetSlotsToClearBrushing=function(t){void 0===t&&(t={});var n=t.sourceModule,o=t.targetModule,s=t.dataSlots||[],l=t.tableNames||[],c=t.pageContext,u=t.selector,d=t.itemIds||[],h=t.newSelectionIsEmpty,g=t.newSectionFromSource,p=function(e){var t=[];return e.forEach((function(e){(e.getDataItemList()||[]).forEach((function(e){t.push(e.getColumnId())}))})),t}(s),f=e.difference(d,p);if(0===f.length&&!g)return s;var m=c.getNetPageContext(u),v=[];m.forEach((function(t){v=v.concat(e.pluck(t.hierarchies,"hierarchyUniqueName"))}));var b=function(e,t,n,o){var a=r(e.getMetadataColumns(i),o,!0,n);return 0===a.length&&(a=r(t.getMetadataColumns(i),o,!0,n)),a}(n,o,l,h?v:d);if(f=r(o.getMetadataColumns(i),b,!1,l),h){var y=e.clone(s);return f.length>0&&y.push(new a({itemIds:f})),y}return 0===f.length?[]:[new a({itemIds:f})]},n.getKey=function(e,t){return e+(t?t.join("_"):"")},n.haveJoinedTables=function(e,i){if(e.getSourceId()!==i.getSourceId())return!1;var n=e.getModule(),r=e.getTableRef(),o=i.getTableRef();return t.haveTableJoinsInSameDataSource(n,r,o)},n.createSynchProjectedItems=function(e,i){void 0===i&&(i=[]);var n=[];return e&&i.forEach((function(i){t.isMultiMeasuresSeriesOrValue(i.getItemId())||n.push(new s(e,i))})),n},n.replaceUseValue=function(e,t){var i=new RegExp("([^->].*)(->.*)");if(i.test(t.u))return t.u=t.u.replace(i,e.getId()+"$2"),!0},n}();return c})),define("dashboard-analytics/dataSources/models/synchronizeData/SynchronizeDataHelper",["underscore","./SynchContextHelper","../../utils/DatasourceUtil"],(function(e,t,i){var n=function(){return!0},r=function(e){return"string"==typeof e},o=function(e){return Number.isInteger(e)};return function(){function a(){}return a.matchColumByName=function(t,r,o,a){var s;void 0===a&&(a={});var l=o.getLabel().toLowerCase(),c=t.getSourceId(),u=r.getSourceId();if(!a.projectedItems||0===a.projectedItems.length)throw new Error("cannot match column when no items are projected");var d=e.find(a.projectedItems,(function(e){return e.getLabel().toLowerCase()===l}));if(d)return r.getMetadataColumn(d.getItemId());s=i.getTableRef(r,a.projectedItems.map((function(e){return e.getItemId()})));for(var h=r.getMetadataColumns(n),g=0;g<h.length;g++){var p=h[g],f=!1;if(c!==u?f=!0:o.getTableName()!==p.getTableName()&&(i.haveTableJoinsInSameDataSource(r,[o.getTableName()],[p.getTableName()])||(f=-1!==s.indexOf(p.getTableName()))),f&&p.getLabel().toLocaleLowerCase()===l)return p}},a.matchItemByValue=function(e,t){for(var i=0;i<e.length;i++)if(n=t.d,a=e[i].d,r(n)&&r(a)||o(n)&&o(a)?n===a:(r(n)?parseInt(n,10):n)===(r(a)?parseInt(a,10):a))return t.u=e[i].u,!0;var n,a;return!1},a.clone=function(e){return JSON.parse(JSON.stringify(e))},a.mergeDuplicates=function(n,r,o,a){e.each(o,(function(o){var s=o.items;e.each(s,(function(s){var l=a[t.getKey(s.sourceId,s.tableRef)];if(l){var c=l.getSynchronizeItems(),u=e.find(c,(function(e){return e.itemId===s.itemId}));if(u){var d,h=u.items;e.find(h,(function(e,t){return!(e.sourceId!==n||e.itemId!==o.itemId||!i.haveATableReference(r,e.tableRef,!0))&&(d=t,!0)}))&&h.splice(d,1)}}}))}))},a.isBoolean=function(e){return"boolean"==typeof e||e instanceof Boolean},a}()})),define("dashboard-analytics/dataSources/models/synchronizeData/SynchJoinTable",["underscore","../../utils/DatasourceUtil","./SynchContextHelper","./SynchronizeDataHelper"],(function(e,t,i,n){var r=function(){function r(e,t,i){this.module=t,this.column=e,this.handlers=i,this.joinedTableValues={}}var o=r.prototype;return o.getItemId=function(){return this.column.getId()},o.getLabel=function(){return this.column.getLabel()},o.getTableRef=function(){this.column.getTableName()},o.matchedColumnByName=function(e){var t=this.module.getMetadataColumn(e);return!!t&&this.column.getLabel().toLowerCase()===t.getLabel().toLowerCase()},o.getJointTupleValue=function(e,t){var i=this.joinedTableValues[e];if(i)return i[t.u]},o.matchJointedTableValue=function(r,o){var a=this.module.getMetadataColumn(r.getItemId());if(!a)return Promise.resolve(null);var s=a.getTableName(),l=this.column.getTableName();if(l!==s&&t.haveTableJoinsInSameDataSource(this.module,[l],[s])){var c,u=a.isOlapColumn(),d=!this.column.isOlapColumn()&&this.column.isNumericDataType(),h=this.getJointedTableEntry(a.getId()),g=!this.column.isOlapColumn()&&this.column.isDateTimeDataType();if(u||!d&&!g)return this.handlers.loadValues(this.module,this.column.getId()).then((function(t){return t=t||[],(c=e.find(t,(function(e){return o.d===e.d})))&&(h[o.u]=c),c}));if(d)c=h[o.u]=o;else{var p=n.clone(o);i.replaceUseValue(this.column,p)&&(c=h[o.u]=p)}return Promise.resolve(c)}return Promise.resolve(null)},o.getJointedTableEntry=function(e){return this.joinedTableValues[e]=this.joinedTableValues[e]||{},this.joinedTableValues[e]},r}();return function(){function e(e,t){if(void 0===t&&(t={}),!e)throw new Error("module object is not provided.");if(!t.handlers)throw new Error("handlers object is not provided.");this.module=e,this.handlers=t.handlers,this.columns={}}var t=e.prototype;return t.getColumn=function(e){if(this.columns[e])return this.columns[e];var t=this.module.getMetadataColumn(e);return t&&(this.columns[e]=new r(t,this.module,this.handlers)),this.columns[e]},t.getColumns=function(){return this.columns},e}()})),define("dashboard-analytics/filters/pagecontext/PageContextTupleSet",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../../../app/nls/StringResources","underscore"],(function(e,t,i){var n=e.extend({init:function(e){n.inherited("init",this,e),i.each(e,function(e,t){this[t]=e}.bind(this)),this.api={getValues:this.getValues.bind(this),getValueIds:this.getValueIds.bind(this),getValueCaptions:this.getValueCaptions.bind(this),getValueCaption:this.getValueCaption.bind(this),getValueCount:this.getValueCount.bind(this),getValueId:this.getValueId.bind(this),getValueParentIds:this.getValueParentIds.bind(this),getValueParentId:this.getValueParentId.bind(this),getExclude:this.getExclude.bind(this),getIsNamedSet:this.getIsNamedSet.bind(this),isDataPointType:this.isDataPointType.bind(this),getDataPointCount:this.getDataPointCount.bind(this),getDataPoints:this.getDataPoints.bind(this),getDataPoint:this.getDataPoint.bind(this),getDataPointValues:this._getDataPointValues.bind(this),getExcludeForSpec:this.getExcludeForSpec.bind(this),getNetValues:this.getNetValues.bind(this)};var t=this.get()?i.clone(this.get()):{};i.each(t,function(e){var t=this._createLookupKey(e);this._addLookupKey(t)}.bind(this))},getAPI:function(){return this.api},getGlobalContext:function(){return this._globalContextCb?this._globalContextCb():null},setGlobalContextCb:function(e){this._globalContextCb=e},getValueCount:function(){return this.getGlobalContext()?this._getValueCount(this._intersectTupleSets(this.getGlobalContext(),!0)):this._getValueCount()},getValueIds:function(){return this.getGlobalContext()?this._getValueIds(this._intersectTupleSets(this.getGlobalContext(),!0)):this._getValueIds()},getValues:function(e){return void 0===e&&(e=!0),e&&this.getGlobalContext()?this._getValues(this._intersectTupleSets(this.getGlobalContext(),!0)):this._getValues()},getNetValues:function(){return i.flatten(this.getSpec())},getValueCaptions:function(){return this.getGlobalContext()?this._getValueCaptions(this._intersectTupleSets(this.getGlobalContext(),!0)):this._getValueCaptions()},getValueId:function(e){e=e||0;var t=this.getValueIds();return t&&e<t.length?t[e]:null},getValueCaption:function(e){e=e||0;var t=this.getValueCaptions();return t&&e<t.length?t[e]:null},getValueParentIds:function(){return this.getGlobalContext()?this._getValueParentIds(this._intersectTupleSets(this.getGlobalContext(),!0)):this._getValueParentIds()},getValueParentId:function(e){e=e||0;var t=this.getValueParentIds();return t&&e<t.length?t[e]:null},isDataPointType:function(){var e=this.get();if(e){var t=e[i.keys(e)[0]];return Array.isArray(t)&&t.length>=2}return!1},getDataPoints:function(){return this._getDataPoints()},getDataPoint:function(e){e=e||0;var t=this.getDataPoints();return t&&e<t.length?t[e]:null},getDataPointCount:function(){var e=this.getDataPoints();return e&&e.length>0?e.length:0},getSpec:function(){var e=this.getGlobalContext();return e?this._intersectTupleSetsForSpec(e):this.getValuesArray()},mergeValues:function(e,t){var i;switch(e.command){case"remove":i=this._removeValues(e);break;case"update":i=this._updateValues(e);break;case"replace":i=this._replaceValues(e);break;default:i={modified:!1}}return i.modified&&this.set(i.valuesMap,t),i.modified},_removeValues:function(e){var t=!1,n=this.get()?i.clone(this.get()):{};return i.each(e.values,function(e){var i=this._createLookupKey(e);this._existsInMap(i)&&(n[i]=null,delete n[i],this._removeLookupKey(i),t=!0)}.bind(this)),{modified:t,valuesMap:n}},_updateValues:function(e){var t=!1,n=this.get()?i.clone(this.get()):{};return i.each(e.values,function(e){var i=this._createLookupKey(e);this._existsInMap(i)||(n[i]=this._createTupleValue(e),this._addLookupKey(i),t=!0)}.bind(this)),{modified:t,valuesMap:n}},_replaceValues:function(e){var t=!1,n={};if(!Object.keys(e.values).length){var r=this.get()?i.clone(this.get()):{};i.each(r,function(e){var i=this._createLookupKey(e);this._existsInMap(i)&&(r[i]=null,delete r[i],this._removeLookupKey(i)),t=!0}.bind(this))}return i.each(e.values,function(e){var i=this._createLookupKey(e);n[i]=this._createTupleValue(e),this._addLookupKey(i),t=!0}.bind(this)),{modified:t,valuesMap:n}},_createLookupKey:function(e){if(i.isArray(e)){for(var t="",n=0;n<e.length;n++){var r=e[n];t=t.concat(r.u)}return t}return e.u},_createTupleValue:function(e){if(i.isArray(e))return e;var t={u:e.u,d:e.d};return e.p&&(t.p=e.p),t},_existsInMap:function(e){return!(!this._keyMap||!this._keyMap[e])},_addLookupKey:function(e){this._keyMap||(this._keyMap={}),this._keyMap[e]=!0},_removeLookupKey:function(e){this._keyMap&&delete this._keyMap[e]},removeCachedValues:function(){delete this._keyMap},add:function(e,t){var n=this.get()?i.clone(this.get()):[];i.each(e,(function(e){n.push(e)})),this.set(n,t)},_getValueCount:function(e){return e=e||this.get(),i.isArray(e)?e.length:e?i.keys(e).length:0},_getValueCaptions:function(e){e=e||this.get();var n=[];return e&&i.each(e,function(e){var r=i.isArray(e)&&e.length?e[0].d:e.d;n.push(i.isEmpty(""+r)?t.get("filterBlank"):r)}.bind(this)),n},_getValueIds:function(e){e=e||this.get();var t=[];return e&&i.each(e,function(e){var i=this._createLookupKey(e);t.push(i)}.bind(this)),t},_getValues:function(e){e=e||this.get();var t=[];return e&&i.each(e,function(e){var i=Array.isArray(e)&&1===e.length?e[0]:e;t.push(i)}.bind(this)),t},_getDataPointValues:function(e){var t=this.getDataPoints(),i=-1;if(this.hierarchies.forEach(function(t,n){t.hierarchyUniqueName!==e||(i=n)}.bind(this)),-1!==i){for(var n=[],r=0;r<t.length;r++)n.push(t[r][i]);return n}},_getValueParentIds:function(e){e=e||this.get();var t=[];return e&&i.each(e,(function(e){e[0].parentId&&t.push(e[0].parentId)})),t},_intersectTupleSets:function(e,t){var n=this,r=e?e.tupleSet:null,o=e&&e.getExclude()||!1;if(!r)return this.getValuesArray();if(!i.keys(r).length)return this.getValuesArray();var a={},s=0;if(o)return i.each(this.get(),function(e,t){r[t]||(a[t]=e)}.bind(this)),this.getValuesArray(a);if(this.getExclude()&&void 0===i.find(this.getValuesArray(r),(function(e){return n.get()&&-1===i.keys(n.get()).indexOf(e[0].u)})))return[];var l={};return i.each(r,function(e,t){l[JSON.stringify(e)]=t}.bind(this)),i.each(this.get(),function(e,t){this._isMemberAtGlobalLevelSelected(l,e)&&(a[t]=e,s++)}.bind(this)),0===s?t?[]:this.getValuesArray(r):this.getValuesArray(a)},_isMemberAtGlobalLevelSelected:function(e,t){return!!e[JSON.stringify(t)]},_intersectTupleSetsForSpec:function(e){var t=e?e.tupleSet:null,i=e&&e.getExclude()||!1,n=e&&e.getValueCount()||0,r=this.getExclude(),o=this.getValueCount();if(n&&!o)return this.getValuesArray(t);if(n){var a=this.getValuesArray(t);if(!r)return this._intersectTupleSets(e);if(!i){var s=[];return a.forEach(function(e){this.get()&&this.get()[e[0].u]||s.push(e)}.bind(this)),s}if(i)return a.concat(this.getValuesArray())}return this.getValuesArray()},setExclude:function(e){this.exclude=e},getExclude:function(){return!!this.exclude},getIsNamedSet:function(){return!!this.isNamedSet},getExcludeForSpec:function(){var e=this.getGlobalContext(),t=e&&e.getExclude()||!1,i=e&&e.getValueCount()||0,n=this.getExclude(),r=this.getValueCount();return i?r?t&&n:t:n},getValuesArray:function(e){if(e=e||this.get(),Array.isArray(e))return e;var t=[];return e&&i.each(e,function(e){i.isArray(e)?t.push(e):t.push([e])}.bind(this)),t},hasData:function(){return!!(this.get()||this.getExclude()||this.getIsNamedSet())},_getDataPoints:function(){return this.isDataPointType()?i.values(this.get()):null}});return n})),define("dashboard-analytics/filters/pagecontext/PageContextRangeConditions",["underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class"],(function(e,t){var i=t.extend({init:function(t){i.inherited("init",this,t),e.each(t,function(e,t){this[t]=e}.bind(this)),this.api={getFrom:this.getFrom.bind(this),getTo:this.getTo.bind(this),getAttributeUniqueName:this.getAttributeUniqueName.bind(this),getRangeMinBound:this.getRangeMinBound.bind(this),getRangeMaxBound:this.getRangeMaxBound.bind(this),getInvert:this.getInvert.bind(this),getValueCaptions:this.getValueCaptions.bind(this),getValueCount:this.getValueCount.bind(this),hasRangeCondition:this.hasRangeCondition.bind(this),isLarger:this._isLarger.bind(this),isSmaller:this._isSmaller.bind(this),isDataPointType:this.isDataPointType.bind(this),hasData:this.hasData.bind(this)}},getAPI:function(){return this.api},getFrom:function(e){return this._intersectRanges(e).from},getTo:function(e){return this._intersectRanges(e).to},hasRangeCondition:function(e){var t=this._intersectRanges(e);return""!==t.from||""!==t.to},getAttributeUniqueName:function(e){var t=e&&e.conditionIdx||0,i=e&&e.subrangeIdx||0;if(this.get()&&this.get()[t])return this.get()[t].attributeUniqueNames[i];var n=this.getGlobalContextAPI();return n?n.getAttributeUniqueName(e):null},getValueCaptions:function(){return this.get()?[this.getFrom(),this.getTo()]:[]},getValueCount:function(){return this.hasRangeCondition()&&this.get()&&this.get().length?2:0},getRangeMinBound:function(e,t){void 0===e&&(e=0);var i=this.getGlobalContextAPI();return null===e?i&&i.getFrom&&i.getFrom(t)||"0":i&&i.getFrom&&!i.getInvert()?i.getFrom(t)||e.toString()||"":e.toString()||""},getRangeMaxBound:function(e,t){void 0===e&&(e=0);var i=this.getGlobalContextAPI();return null===e?i&&i.getTo&&i.getTo(t)||"0":i&&i.getTo&&!i.getInvert()?i.getTo(t)||e.toString()||"":e.toString()||""},getInvert:function(){var e=this.getGlobalContextAPI();return e?e.getInvert():this.get()&&this.get()[0]&&this.get()[0].invert||!1},getSpec:function(){var e=[],t={from:[this.getFrom()],to:[this.getTo()],invert:this.getInvert(),attributeUniqueNames:[this.getAttributeUniqueName()]};return e.push(t),e},getGlobalContextAPI:function(){if(this._globalContextCb){var e=this._globalContextCb();return e?e.getAPI():null}return null},setGlobalContextCb:function(e){this._globalContextCb=e},updateRangeConditions:function(e,t,i){var n=this._initializeRangeCondition(e,t);return n?(this.set([n],i),!0):(this.set([],i),!1)},isDataPointType:function(){return!1},hasData:function(){var e=this.get();return!!e&&Object.keys(e).length>0},_initializeRangeCondition:function(t,i){if(t&&!e.isEqual(t,{})){var n={from:[t.from||""],to:[t.to||""]};return 0===t.from&&(n.from=[0]),0===t.to&&(n.to=[0]),t.invert&&(n.invert=t.invert),n.attributeUniqueNames=t.levelId?[t.levelId]:[i],this._validateRangeCondition(n),n}return null},_validateRangeCondition:function(e){if(!e.attributeUniqueNames||1!==e.attributeUniqueNames.length)throw new Error("PAGECONTEXT: Multi-level hierarchies require itemIds to specify which level the range applies to");if(!e.from&&!e.to)throw new Error("PAGECONTEXT: Multi-level hierarchies require from and to")},_thisFromTo:function(e){var t=e&&e.conditionIdx||0,i=e&&e.subrangeIdx||0,n=this.get()?this.get()[t]:null,r=n&&n.from&&n.from[i]||"";n&&0===n.from[0]&&(r=0);var o=n&&n.to&&n.to[i]||"";return n&&0===n.to[0]&&(o=0),{from:r,to:o}},_intersectRanges:function(t){var i=this._thisFromTo(t),n=this.getGlobalContextAPI();if(!n)return i;var r,o,a=i.from,s=i.to,l=n.getFrom(t),c=n.getTo(t);return n.getInvert()?(r=e.isNull(a)||e.isUndefined(a)||""===a?l:this._isSmaller(a,l)?a:l,o=e.isNull(s)||e.isUndefined(s)||""===s?c:this._isLarger(s,c)?s:c):(r=this._isLarger(a,l)?a:l,o=this._isSmaller(s,c)?s:c),this._isLarger(r,o)&&(r=l,o=c),{from:r,to:o}},_isLarger:function(e,t){if(""===e)return!1;if(""===t)return!0;var i=parseFloat(e);if(!isNaN(i)&&isFinite(e)){var n=parseFloat(t);if(!isNaN(n)&&isFinite(t))return i>n}return e>t},_isSmaller:function(e,t){return""!==e&&(""===t||!this._isLarger(e,t))}});return i})),define("dashboard-analytics/filters/pagecontext/PageContextEntry",["../../lib/@waca/dashboard-common/dist/core/Model","./PageContextTupleSet","./PageContextRangeConditions","underscore","../../lib/@waca/core-client/js/core-client/utils/UniqueId"],(function(e,t,i,n,r){var o=e.extend({whitelistAttrs:["origin","table","alias","filterName","sourceId","synchDataId","hierarchies","tupleSet","conditions","scope","metadataSourceId","hierarchyNames","hierarchyUniqueNames","exclude","eventSourceId","eventGroupId","isNamedSet","isSticky","type","isSynchronizedEntry","isModeledFilter","expression"],runtimeAttrs:["tupleSet","exclude"],init:function(e,r){o.inherited("init",this,arguments),this.api={getMetadataSourceId:this.getMetadataSourceId.bind(this),getItemName:this.getItemName.bind(this),getItemId:this.getItemId.bind(this),getItemIds:this.getItemIds.bind(this),getSourceId:this.getSourceId.bind(this),getScope:this.getScope.bind(this),getKey:this.getKey.bind(this),shouldOpenViewOnLoad:this.shouldOpenViewOnLoad.bind(this),isHierarchy:this.isAHierarchy.bind(this),getHierarchyCount:this._getHierarchyCount.bind(this),getIsNamedSet:this.getIsNamedSet.bind(this),getIsSticky:this.getIsSticky.bind(this),isValueDataItem:this.isValueDataItem.bind(this),isRange:this.isRange.bind(this),getOrigin:this.getOrigin.bind(this),setOpenViewOnLoad:this.setOpenViewOnLoad.bind(this),getError:this.getError.bind(this),setError:this.setError.bind(this),getExclude:this.getExclude.bind(this),setExclude:this.setExclude.bind(this),getValueCount:this.getValueCount.bind(this),getGlobalContext:this.getGlobalContext.bind(this),getDataType:this.getDataType.bind(this),getValueType:this.getValueType.bind(this),getUsage:this.getUsage.bind(this),updateEventGroupId:this.updateEventGroupId.bind(this),getEventGroupId:this.getEventGroupId.bind(this),getEventSourceId:this.getEventSourceId.bind(this),updateMetadata:this.updateMetadata.bind(this),resetToPersistedValues:this.resetToPersistedValues.bind(this),getPageContextSpec:this.getPageContextSpecItem.bind(this),getPageContextSpecItem:this.getPageContextSpecItem.bind(this),getMetadataInfo:this.getMetadataInfo.bind(this),getSynchDataId:this.getSynchDataId.bind(this),setSynchDataId:this.setSynchDataId.bind(this),resetSynchDataId:this.resetSynchDataId.bind(this),hasData:this.hasData.bind(this),getIsSynchronizedEntry:this.getIsSynchronizedEntry.bind(this),getIsColumnUnavailable:this.getIsColumnUnavailable.bind(this),getIsModeledFilter:this.getIsModeledFilter.bind(this)},this._rangeConditions=null,this._tupleSet=null,(this.condition||this.conditions)&&(delete this.condition,this._rangeConditions=new i({set:this.setRangeConditionsCb.bind(this),get:this.getRangeConditionsCb.bind(this)}),this._extendAPI(this._rangeConditions.getAPI())),this.tupleSet&&!n.isObject(this.tupleSet)&&this.set({tupleSet:JSON.parse(this.tupleSet)},r),this._rangeConditions||(this._tupleSet=new t({set:this.setTupleSetCb.bind(this),get:this.getTupleSetCb.bind(this),exclude:this.getExclude(),isNamedSet:this.getIsNamedSet(),hierarchies:this.hierarchies}),this._extendAPI(this._tupleSet.getAPI())),this.id=this.getKey(),this._globalContextCb=null},getAPI:function(){return this.api},getOrigin:function(){return this.origin},getDataType:function(){return this.dataType},getUsage:function(){return this.usage},setOpenViewOnLoad:function(e){this.openViewOnLoad=e},isRange:function(){return null!==this._rangeConditions},getError:function(){return this.error},setError:function(e){this.error=e},_extendAPI:function(e){n.each(e,function(e,t){this.api[t]=e}.bind(this))},getGlobalContext:function(){return this._globalContextCb?this._globalContextCb():null},setGlobalContextCb:function(e){this._globalContextCb=e,this._tupleSet&&this._tupleSet.setGlobalContextCb(e),this._rangeConditions&&this._rangeConditions.setGlobalContextCb(e)},setFilterName:function(e){this.filterName=e,this.hierarchyNames&&(this.hierarchyNames[0]=e)},getItemName:function(){var e=this.hierarchyNames||[];return this.filterName||e[0]||""},getItemId:function(e){return e=e||0,this.hierarchyUniqueNames[e]},getItemIds:function(){return this.hierarchyUniqueNames},getSourceId:function(){return this.sourceId},isAHierarchy:function(){return this.isHierarchy},getIsColumnUnavailable:function(){return this.isColumnUnavailable},getIsNamedSet:function(){return!!this.isNamedSet},getIsSticky:function(){return!!this.isSticky},isValueDataItem:function(){return this.getIsNamedSet()&&0===this.getValueCount()},getValueType:function(){return this.type},getIsSynchronizedEntry:function(){return this.isSynchronizedEntry},shouldOpenViewOnLoad:function(){return this.openViewOnLoad&&!this.isModeledFilter},getScope:function(){return this.scope},getMetadataSourceId:function(){return this.metadataSourceId},getIsModeledFilter:function(){return!!this.isModeledFilter},getUnscopedKey:function(){var e=this._getBaseKeyProps();return e.huns=this._getHierarchies(),delete e.scope,JSON.stringify(e)},getKey:function(){var e=this._getBaseKeyProps();return e.huns=this._getHierarchies(),JSON.stringify(e)},getGlobalKey:function(){var e=this._getBaseKeyProps();return e.scope="global",e.huns=this.hierarchyUniqueNames,JSON.stringify(e)},_getBaseKeyProps:function(){var e={origin:this.origin,sourceId:this.sourceId,scope:this.scope};return this.eventGroupId&&(e.eventGroupId=this.eventGroupId),e},_getHierarchyCount:function(){return this.hierarchies.length},_getHierarchies:function(){return"visualization"===this.origin&&this.hierarchies?n.clone(this.hierarchies).sort((function(e,t){return e.hierarchyUniqueName>t.hierarchyUniqueName?1:0})):this.hierarchyUniqueNames?n.clone(this.hierarchyUniqueNames).sort():null},setRangeConditionsCb:function(e,t){this.set({conditions:e},t)},getRangeConditionsCb:function(){return this.conditions},setTupleSetCb:function(e,t){this.set({tupleSet:e},t)},getTupleSetCb:function(){return this.tupleSet},setExclude:function(e,t){this.get("exclude")!==e&&(this.set({exclude:e},t),this._tupleSet&&this._tupleSet.setExclude(e))},getExclude:function(){return!!this.exclude},setSynchDataId:function(e,t){this.set({synchDataId:e},t)},getSynchDataId:function(){return this.synchDataId},resetSynchDataId:function(e){this.set({synchDataId:null},e)},_getExcludeForSpec:function(){return this._tupleSet?this._tupleSet.getExcludeForSpec():this.getExclude()},getValueCount:function(){return this._tupleSet?this._tupleSet.getValueCount():0},getPageContextSpecItem:function(){var e={origin:this.origin,table:this.table||"",alias:this.alias,filterName:this.getItemName(),sourceId:this.sourceId,exclude:this._getExcludeForSpec(),hierarchies:this.hierarchies?this.hierarchies:this._restructureHierarchiesForSpec(this.hierarchyUniqueNames,this.hierarchyNames),isModeledFilter:this.getIsModeledFilter(),error:null};return this.getIsSynchronizedEntry()&&(e.isSynchronizedEntry=!0),this._tupleSet&&(e.tupleSet=this._tupleSet.getSpec()),this._rangeConditions&&this._rangeConditions.hasRangeCondition()&&(e.conditions=this._rangeConditions.getSpec()),e},_restructureHierarchiesForSpec:function(e){for(var t=[],i=0;i<e.length;++i){var n={hierarchyUniqueName:e[i],attributes:[]};t.push(n)}return t},mergeValues:function(e,t){return n.isUndefined(e.condition)?this._tupleSet.mergeValues(e,t):(this._rangeConditions||(this._rangeConditions=new i(this)),this._rangeConditions.updateRangeConditions(e.condition,this.getItemId(),t))},addToTupleSet:function(e,t){this._tupleSet&&this._tupleSet.add(e,t)},clearValues:function(e){var t;return this.conditions?(this.set({conditions:{}},e),t=!0):this.tupleSet?(this.get("exclude")&&(e||(e={payloadData:{undoRedoTransactionId:r.get("clear_values_")}}),this.setExclude(!1,e)),this._tupleSet.removeCachedValues(),this.set({tupleSet:null},e),t=!0):(this.setExclude(!1,e),t=!0),t},updateEventGroupId:function(e,t){this.set({eventGroupId:e},t),this.set({id:this.getKey()},t)},getEventGroupId:function(){return this.eventGroupId},getEventSourceId:function(){return this.eventSourceId},updateMetadata:function(e){this._metadataInfo=e,e.dataType&&(this.dataType=e.dataType),e.usage&&(this.usage=e.usage),void 0!==e.isHierarchy&&(this.isHierarchy=e.isHierarchy),!0===e.isColumnUnavailable?this.isColumnUnavailable=!0:this.isColumnUnavailable=!1},updateConditions:function(){"attribute"===this.usage?(delete this.conditions,this._rangeConditions=null,this._tupleSet=new t({set:this.setTupleSetCb.bind(this),get:this.getTupleSetCb.bind(this),exclude:this.getExclude(),isNamedSet:this.getIsNamedSet(),hierarchies:this.hierarchies}),this._extendAPI(this._tupleSet.getAPI())):(this.conditions=[],this._tupleSet=null,delete this.condition,this._rangeConditions=new i({set:this.setRangeConditionsCb.bind(this),get:this.getRangeConditionsCb.bind(this)}),this._extendAPI(this._rangeConditions.getAPI()))},toJSON:function(){var e=o.inherited("toJSON",this,[[],["tupleSet"]]),t=this.getPersisted("tupleSet");return void 0!==t&&(e.tupleSet=JSON.stringify(t)),e},resetToPersistedValues:function(e){var t=!1;return this.get("exclude")!==this.getPersisted("exclude")&&(t=!0,this.setExclude(this.getPersisted("exclude"),e)),this.get("tupleSet")!==this.getPersisted("tupleSet")&&(t=!0,this.setTupleSetCb(this.getPersisted("tupleSet"),e)),t},getMetadataInfo:function(){return this._metadataInfo},hasData:function(){return this._tupleSet?this._tupleSet.hasData():!!this._rangeConditions&&this._rangeConditions.hasData()}});return o})),define("dashboard-analytics/features/dashboard/queryService/QueryServiceUtils",["underscore"],(function(e){var t;return(t=function(){function t(){}return t.extractQueryResultDataValuesForProperty=function(t){for(var i,n=t.getRowCount(),r={},o=0;o<n;o++){var a=t.getValue(o,0)[0];r[(e.isNull(a.d)?"\0":null)||a.d||a]=a}var s=r["\0"];return s?(delete r["\0"],i=[s].concat(e.values(r))):i=e.values(r),i},t.extractListOfQueryResultData=function(e){for(var t=e.getRowCount(),i=[],n=0;n<t;n++){var r=e.getValue(n,0)[0];i.push(r)}return i},t.getPromptValues=function(t,i){return t&&t.length?(n=t[0].u?"memberUniqueName"===i||"hierarchyUniqueName"===i?"u":"d":"memberUniqueName"===i||"hierarchyUniqueName"===i?"value":"label",e.pluck(t,n)):t;var n},t}()).COLUMN_QUERY_SIZE_LIMIT=1e3,t})),define("dashboard-analytics/dataSources/models/synchronizeData/SynchronizeDataModel",["../../../lib/@waca/dashboard-common/dist/core/Collection","./SynchronizeDataEntry","./SynchronizeDataHelper","./SynchContextHelper","./SynchJoinTable","../../../filters/pagecontext/PageContextEntry","../../../lib/@waca/core-client/js/core-client/utils/UniqueId","../../../features/dashboard/queryService/QueryServiceUtils","../../utils/DatasourceUtil","underscore"],(function(e,t,i,n,r,o,a,s,l,c){var u=e.extend({modelClass:t,init:function(e){var t=e.boardModel,i=e.dashboard;u.inherited("init",this,arguments),this.boardModel=t,this.dashboard=i,this.logger=this.dashboard.getGlassCoreSvc(".Logger"),this.modules={},this.items={},this.loadValuesPromises={},this.synchronizeDataEntries={},this.filterDockItems={},this.jointedTablesBrushData={},this.widgets={},this.eventListener=this.boardModel.on("change:pageContext",this._onChangePageContext,this),this.eventListenerRemoveLayouts=this.boardModel.on("removeLayouts",this._onRemoveWidget,this),this.dashboard.on("brushing:undoRedo",this._onUndoRedo,this),this.dashboard.on("filterIndicator:removeEntry",this._onRemoveFilterIndicatorEntry,this),this.dashboard.on("widget:renderComplete",this._onRenderComplete,this)},destroy:function(){u.inherited("destroy",this,arguments),this.eventListener&&(this.eventListener.off(),this.eventListener=null),this.eventListenerRemoveLayouts&&(this.eventListenerRemoveLayouts.off(),this.eventListenerRemoveLayouts=null),this.widgets={},this.dashboard.off("brushing:undoRedo",this._onUndoRedo,this),this.dashboard.off("filterIndicator:removeEntry",this._onRemoveFilterIndicatorEntry,this),this.dashboard.off("widget:renderComplete",this._onRenderComplete,this)},loadBrushedContext:function(e,t,i){var r=this;if(!e||!i)return Promise.resolve();var o=t.getSlots().getDataItemList();if(!o||0===o.length)return Promise.resolve();var a=n.createSynchProjectedItems(i.getModule(),o.map((function(e){return{getItemId:function(){return e.getColumnId()},getLabel:function(){return e.getLabel()}}}))),s={origin:"visualization",scope:i.getScope(),eventGroupId:i.getEventGroupId()},l=e.getPageContextItems(s);if(0===l.length)return Promise.resolve();var u=[];return l.forEach((function(e){var t=e.getPageContextSpec(),n={module:i.getModule(),itemIds:c.pluck(t.hierarchies,"hierarchyUniqueName"),data:t.tupleSet};u.push(r._synchJointedTables(a,n))})),Promise.all(u)},_findJoinedTableTupleValue:function(e,t){for(var i,n,r=e.getPageContextSpec(),o=c.pluck(r.hierarchies,"hierarchyUniqueName"),a=this._isArrayOfArray(r.tupleSet)?r.tupleSet:[r.tupleSet],s=function(e){if(a.forEach((function(r){r.forEach((function(r,a){if(e===a){i=o[e];var s=t.getJointTupleValue(o[e],r);s&&(n||(n=[]),n.push([s]))}}))})),n)return{v:{itemId:i,value:n}}},l=0;l<o.length;l++){var u=s(l);if("object"==typeof u)return u.v}},_duplicatePageContext:function(e,t){var i=e.arguments.command,n=e.brushSource,r=e.scope,o=e.data;if(o)for(var a,s=t.synchOptions.pageContext,c=_createForOfIteratorHelperLoose(o);!(a=c()).done;){var u=a.value,d=u.itemIds,h=void 0===d?[]:d,g=u.tuple,p=void 0===g?[]:g,f=u.sourceId;if(!l.haveATableReference(n.tableRef,u.tableRef)){r.isSynchronizedEntry=!0;var m=Object.assign({sourceId:f,hierarchies:h.map((function(e){return{hierarchyUniqueName:e}})),hierarchyUniqueNames:h},r);s.updateFilterContext(m,{command:i,values:p},t)}}},handleBrushingSelection:function(e,t){var i=this;void 0===e&&(e={}),void 0===t&&(t={});var r=t.synchOptions||{};return this._doBrushingSelection(e,t).then((function(o){if(o){o.arguments={command:e.command,pending:e.pending};var s=e.slotsToClear&&0===e.slotsToClear.length;e.synchDataId=a.get(""),(o.data||[]).map((function(t){return t.synchDataId=e.synchDataId,t.append=s,t.getNetSlotsToClear=n.getNetSlotsToClearBrushing,t})),i._duplicatePageContext(o,t),r.newSelectionIsEmpty(e.tuple)&&e.slotsToClear.length>0&&(e.slotsToClear=n.getNetSlotsToClearBrushing({pageContext:r.pageContext,selector:{origin:"visualization",scope:e.brushingSpec.scope,eventGroupId:e.brushingSpec.eventGroupId,sourceId:e.brushingSpec.sourceId},sourceModule:o.brushSource.getModule(),targetModule:o.brushSource.getModule(),dataSlots:e.slotsToClear,itemIds:e.itemIds,tableNames:o.brushSource.getTableRef(),newSectionFromSource:!0,newSelectionIsEmpty:!0}))}return o})).finally((function(){i._resetData()}))},_resetData:function(){this.modules={},this.items={},this.loadValuesPromises={},this.synchronizeDataEntries={}},_doBrushingSelection:function(e,t){var i=this;if(void 0===e&&(e={}),void 0===t&&(t={}),e.pending)return Promise.resolve();var n=e.brushingSpec;this._resetBrushing(t);var r={scope:{origin:"visualization",scope:n.scope,eventGroupId:n.eventGroupId,eventSourceId:n.eventSourceId},itemIds:e.itemIds,tuple:e.tuple};return this._getModulesWithinSameEventGroup(n.sourceId,n.eventGroupId,n.eventSourceId).then((function(e){if(e){var o=i._synchBrushingSelection(r,t,e);return o&&(o.scope=r.scope),n.tableRef=e.brushSource.getTableRef(),o}}))},_getNetPageContextItems:function(e,t,i,n){var r={scope:e,eventGroupId:t,origin:i||"visualization"};return n&&(r.synchDataId=n),this.pageContext?this.pageContext.getNetPageContextItems(r):[]},_getModulesWithinSameEventGroup:function(e,t,i){var n=this,r={},o=this.dashboard.getFeature("internal"),a=[],s=o.getBoardModel();this.pageContext=this.pageContext||s.get("pageContext").getAPI();var l=s.get("eventGroups").get(t);l&&l.get("widgetIds").forEach((function(e){var t=function(e){var t,i=e?e.data:null;return i&&(t=i.dataViews),t}(s.findWidgetById(e));t&&t.forEach((function(t){t.modelRef&&(-1===a.indexOf(t.modelRef)&&a.push(t.modelRef),r[t.modelRef]||(r[t.modelRef]=[]),t.dataItems&&r[t.modelRef].push({widgetId:e,projectedItems:t.dataItems.map((function(e){return{getItemId:function(){return e.itemId},getLabel:function(){return e.itemLabel}}}))}))}))}));var u=this.dashboard.getFeature("dataSources.deprecated"),d=[];return c.each(a,(function(e){this.modules[e]?d.push(Promise.resolve(this.modules[e])):d.push(u?u.getModule(e):Promise.resolve(null))}),this),Promise.all(d).then(function(e){c.each(e,(function(e){e&&!(e.getSourceId()in this.modules)&&(this.modules[e.getSourceId()]=e)}),this)}.bind(this)).then((function(){return n._createSynchBrushEntries(t,i,r)}))},_createBrushEntry:function(e,t,i,n){var r,o=this;for(var a in t){var s=t[a];if(s.length&&(c.find(s,(function(t){if(t.projectedItems.length){var s=o.modules[a];if(!i||t.widgetId===i)return r=n(a,e,s,t.projectedItems,i),!0}return!1})),r))break}return r},_createSynchBrushEntries:function(e,t,i){var r=this,o=[],a=function(e,t,i,r,o){var a={getSourceId:function(){return e},getEventGroupId:function(){return t},getEventSourceId:function(){return r.widgetId}};return n.createNewSynchContext({fromObject:a,module:i,projectedItems:r,widgetId:o})},s=this._createBrushEntry(e,i,t,a);if(!s)return s;for(var l in i){var u=i[l];u.length&&u.forEach((function(i){if(i.projectedItems.length&&i.widgetId!==t){var u=r.modules[l],d=a(l,e,u,i.projectedItems,i.widgetId);if(d)if(n.haveJoinedTables(s,d))s.mergeProjectedItems(d),s.addWidgetId(i.widgetId);else{var h=c.find(o,(function(e){return n.haveJoinedTables(e,d)}));h?(h.mergeProjectedItems(d),h.addWidgetId(i.widgetId)):o.push(d)}}}))}return{brushSource:s,entries:o}},_synchJointedTables:function(e,t){void 0===t&&(t={});var i=t.module,n=t.itemIds;if(!e||0===e.length||!n||0==n.length||!t.data||0===t.data.length)return Promise.resolve();var o=[],a=this._isArrayOfArray(t.data)?t.data:[t.data];return n.forEach(function(t,n){var s={loadValues:this._loadValues.bind(this)},l=this.jointedTablesBrushData[i.getSourceId()]=this.jointedTablesBrushData[i.getSourceId()]||new r(i,{handlers:s}),c=l.getColumn(t);c&&e.forEach((function(e){if(c.getItemId()!==e.getItemId()&&c.matchedColumnByName(e.getItemId())){var t=l.getColumn(e.getItemId());a.forEach((function(e){e.forEach((function(e,i){n===i&&o.push(t.matchJointedTableValue(c,e))}))}))}}))}.bind(this)),Promise.all(o)},_clearBrushing:function(e){return!e||!c.flatten(e).length},_synchClearBrushing:function(e,t,n){var r=this;if(void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n={}),!n.entries||0===n.entries.length||!this._clearBrushing(e.tuple))return null;var o=[],a=i.clone(t),s=a.payloadData=a.payloadData||{};return s.brushedSourceModule=n.brushSource.getModule(),s.ignorePageContextChanged=!0,[n.brushSource].concat(n.entries).forEach((function(t){o.push({sourceId:t.getSourceId(),tableRef:t.getTableRef(),itemIds:e.itemIds,sourceModule:n.brushSource.getModule(),tuple:e.tuple,options:a,ignoreSynchBrushData:r._getIgnoreSynchBrushDataWidgetIdList(t.getWidgetIds())})})),o.length>0?{data:o,brushSource:n.brushSource}:null},_synchBrushingSelection:function(e,t,n){var r=this;if(void 0===t&&(t={}),void 0===n&&(n={}),!n.entries||0===n.entries.length)return null;if(this._clearBrushing(e.tuple))return this._synchClearBrushing(e,t,n);var o=this._constructBrushingData(e,n),a=[];if(c.each(o.entries,(function(t){a.push(this._synchEntry(t.pageContextEntry,{source:o.source,target:t.targetSynchDataEntry,brushing:!0,scope:e.scope}))}),this),a.length>0){var s,l=i.clone(t),u=l.payloadData=l.payloadData||{};return u.brushedSourceModule=n.brushSource.getModule(),u.ignorePageContextChanged=!0,a.forEach((function(e,t){if(e){s||(s=[]);var i=o.entries[t].pageContextEntry,a=o.entries[t].targetSynchDataEntry,u=o.entries[t].isArrayOfArray?i.tupleSet:i.tupleSet.length>0?i.tupleSet[0]:[],d={sourceId:a.getSourceId(),tableRef:a.getTableRef(),itemIds:c.pluck(i.hierarchies,"hierarchyUniqueName"),sourceModule:n.brushSource.getModule(),tuple:u,options:l,ignoreSynchBrushData:r._getIgnoreSynchBrushDataWidgetIdList(a.getWidgetIds())};s.push(d)}}),this),{brushSource:n.brushSource,data:s}}},_getIgnoreSynchBrushDataWidgetIdList:function(e){var t=this;void 0===e&&(e=[]);var i=[],n=[];return e.forEach((function(e){var r=t.widgets[e];r&&(r.getEdgeSelection()?i.push(r.getId()):n.push(r.getId()))})),n.length?i:[]},_constructBrushingData:function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=this._getSynchDataEntry(t.brushSource.getSourceId(),e.scope,t.brushSource.getTableRef());t.brushSource.setSynchDataEntry(i);var n=this._getTargetBrushingEntries(t.entries,e.scope);return{source:t.brushSource.getAPI(),entries:this._constructPageContextEntries(e.itemIds,e.tuple,t.brushSource,n)}},_constructPageContextEntries:function(e,t,n,r){var o=this,a=[];return c.each(r,(function(r){var s=o._isArrayOfArray(t),l=i.clone(t),c={hierarchies:o._getHierarchies(e),tupleSet:s?l:[l],sourceId:n.getSourceId()};a.push({pageContextEntry:c,targetSynchDataEntry:r,isArrayOfArray:s})})),a},_getHierarchies:function(e){return Array.isArray(e)?c.map(e,(function(e){return{hierarchyUniqueName:e}})):c.isString(e)?[{hierarchyUniqueName:e}]:[]},_isArrayOfArray:function(e){return c.isArray(e)&&e.length>0&&c.isArray(e[0])},synchTupleSet:function(e,t,n){var r=!1,o=i.clone(n);return c.each(o,(function(n){c.each(n,(function(n,o){var a=t[o].hierarchyUniqueName,s=this._getValues(e.getSourceId(),a)||[];i.matchItemByValue(s,n)&&(r=!0)}),this)}),this),r?o:n},toJSON:function(){var e={};return this.each(function(i){if(i.hasSynchronizeData()){var r=i.toJSON(),o=new t(r);e[n.getKey(o.getSourceId(),o.getTableRef())]=o}}.bind(this)),c.each(e,(function(t){i.mergeDuplicates(t.getSourceId(),t.getTableRef(),t.getSynchronizeItems(),e)})),c.each(e,(function(t){t.hasSynchronizeData()||delete e[n.getKey(t.getSourceId(),t.getTableRef())]})),c.map(e,(function(e){return e.toJSON()}))},_hasFilterDockItemMatchByColumnName:function(e,t){var i=t.getLabel(),n=!1;for(var r in e){if(c.find(e[r],(function(e){return e.getItemName()===i}))){n=!0;break}}return n},onAddRemoveFilterItem:function(e,t,i){if(e&&t){var n=this.filterDockItems[t]=this.filterDockItems[t]||{},r=n[e.getSourceId()]=n[e.getSourceId()]||{};i?r[e.getItemId()]=r[e.getItemId()]||e:delete r[e.getItemId()]}},_synchEntry:function(e,t){void 0===t&&(t={});var n=[],r=i.clone(e.hierarchies);if(c.each(r,(function(i,r){var o={id:i.hierarchyUniqueName,tupleSet:e.tupleSet,conditions:e.conditions,index:r,source:t.source,target:t.target,scope:t.scope,origin:t.origin,brushing:t.brushing};n.push(this._synchItemUseValues(e.hierarchies,o))}),this),n.length>0){var o=!1,a=[],s=[];return n.forEach((function(t,n){var r=!!i.isBoolean(t)&&t;r&&(o||(o=r),a.push(e.hierarchies[n]),e.tupleSet.forEach((function(e,t){var i;t<s.length?i=s[t]:(i=[],s.push(i)),e.forEach((function(e,t){n===t&&i.push(e)}))})))})),e.hierarchies=a,e.tupleSet=s,o&&(e.sourceId=t.target.getSourceId()),o}return!1},_synchItemUseValues:function(e,t){var n,r=(t=t||{}).source,o=t.target,a=this.modules[r.getSourceId()],s=this.modules[o.getSourceId()],l=r.getSynchronizeItemId(t.id,o.getSourceId(),o.getTableRef());if(l)n=s.getMetadataColumn(l.itemId);else{var c=a.getMetadataColumn(t.id);if(c){var u={projectedItems:o.getProjectedItems()};n=i.matchColumByName(a,s,c,u)}}if(!n)return Promise.resolve(!1);this._synchConditions(t.conditions,n);var d=!!t.conditions||this._synchByValues(s,{sourceColumn:r.getModule().getMetadataColumn(t.id),targetColumn:n,hierarchies:e,tupleSet:t.tupleSet,conditions:t.conditions,currentIndex:t.index,scope:t.scope,origin:t.origin,brushing:t.brushing});return d&&(e[t.index].hierarchyUniqueName=n.getId(),l||r.addSynchronizeItem(t.id,o.getSourceId(),n.getId(),o.getTableRef()),o.addSynchronizeItem(n.getId(),r.getSourceId(),t.id,r.getTableRef()),this._addSynchronizeDataEntry(r),this._addSynchronizeDataEntry(o)),d},_synchConditions:function(e,t){e&&t&&c.each(e,(function(e){var i=e.attributeUniqueNames;c.isArray(i)&&i.length>0&&(i[0]=t.getId())}))},_emptyTupleSet:function(e){return!(e&&e.length&&e[0]&&e[0].length)},_synchByValues:function(e,t){void 0===t&&(t={});var r=t.tupleSet;if(t.brushing&&this._emptyTupleSet(r))return Promise.resolve(!0);var o=t.currentIndex,a=!1;return i.clone(r).forEach((function(e,i){e.forEach((function(e,s){r[i][s]&&s===o&&(n.replaceUseValue(t.targetColumn,r[i][s])?a=!0:(t.hierarchies.splice(s,1),r[i].splice(s,1)))}))})),a},_addItemValues:function(e,t,i){e in this.items||(this.items[e]={}),this.items[e][t]=i},_getModule:function(e){return this.modules[e]},_loadValues:function(e,t){var i=e.getSourceId()+t,n=this.loadValuesPromises[i];return n||(n=this.loadValuesPromises[i]=this._loadValuesForMetadataColumn(e,t)),n.then(function(i){return this._addItemValues(e.getSourceId(),t,i),i}.bind(this))},_getSynchDataEntry:function(e,i,r){var o=this.synchronizeDataEntries[n.getKey(e,r)];if(!o||!o.inSameScope()||!o.inSameTable(r)){var a={sourceId:e,scope:i.scope,eventGroupId:i.eventGroupId,tableRef:r};o=new t(a)}return o},_getTargetBrushingEntries:function(e,t){var i={};return c.each(e,function(e){var r=e.getTableRef(),o=e.getSourceId(),a=this._getSynchDataEntry(o,t,r);e.setSynchDataEntry(a),i[n.getKey(o,r)]=e.getAPI()}.bind(this)),i},_addSynchronizeDataEntry:function(e){var t=n.getKey(e.getSourceId(),e.getTableRef()),i=this.synchronizeDataEntries[t];if(i)i.set({synchronizeItems:e.getSynchronizeItems()},{silent:!0});else{var r=e.toJSON(),o=this.add(r,{silent:!0});this.synchronizeDataEntries[t]=o}},_loadValuesForMetadataColumn:function(e,t){return this.dashboard.getFeature("QueryService").getColumnValues(e.getSourceId(),[t],[],"asc").then((function(e){return s.extractListOfQueryResultData(e)}))},_getValues:function(e,t){return e in this.items?this.items[e][t]:null},_getConditionValue:function(e){var t={};return c.isArray(e)&&e.length&&(t.from=e[0].from[0],t.to=e[0].to[0],t.invert=e[0].invert),t},_resetBrushing:function(e){((e=e||{}).payloadData||{}).isBrushed=!0,this.undoRedo=[]},_onChangePageContext:function(e){if(this._canProcessPageContextChange(e)){var t=i.clone(e.data);t.ignoreUndoPageContextChanged=0!==this.undoRedo.length,t.ignoreRedoPageContextChanged=!1,e.data=t,this.undoRedo.push(e);for(var n=0;n<this.undoRedo.length-1;n++)this.undoRedo[n].data.ignoreRedoPageContextChanged=!0}},_onUndoRedo:function(e){"undo"===(e=e||{}).undoRedoTransactionType?e.ignorePageContextChanged=e.ignoreUndoPageContextChanged:"redo"===e.undoRedoTransactionType&&(e.ignorePageContextChanged=e.ignoreRedoPageContextChanged)},_onRemoveFilterIndicatorEntry:function(e){var t=(e=e||{}).pageContext.getPageContextItem({id:e.filterToDelete});if(t){var i=t.getSynchDataId();if(t.getIsModeledFilter())e.pageContext.deletePageContextItems({id:e.filterToDelete});else if(!i||"visualization"!==t.getOrigin()&&!t.isValueDataItem()){if("visualization"===t.getOrigin())e.pageContext.deletePageContextItems({id:e.filterToDelete,eventSourceId:t.getEventSourceId()});else if(t.isValueDataItem()){if(e.pageContext.deletePageContextItems({id:e.filterToDelete})){var n=this.filterDockItems[t.getScope()]=this.filterDockItems[t.getScope()]||{};delete(n[t.getSourceId()]=n[t.getSourceId()]||{})[t.getItemId()]}}else e.pageContext.clearPageContextItemValues({id:e.filterToDelete})}else if(i){var r=JSON.parse(e.filterToDelete),o={sourceIdsToUpdate:{},removedItems:[],payloadData:{undoRedoTransactionId:a.get("delete_viz_filter_entry_"),transactionToken:e.transactionToken}};if(this._getNetPageContextItems(r.scope,r.eventGroupId,"visualization",i).forEach((function(t){e.pageContext.deleteVisTypePageContext({id:t.getKey()},o)})),!o.handlers||!o.handlers.filterContextUpdated)throw new Error("Invalid delete filter indicator options");var s={removedList:o.removedItems,removedItems:o.removedItems,sourceIdsToUpdate:o.sourceIdsToUpdate};o.handlers.filterContextUpdated(s,{transactionId:o.transactionId})}}},_canProcessPageContextChange:function(e){return((e=e||{}).data||{}).isBrushed&&"add"!==e.name},_onRenderComplete:function(e){void 0===e&&(e={});var t=e.widget,i=t&&t.widgetAPI?t.widgetAPI.getId():null;i&&(this.widgets[i]={getEdgeSelection:function(){return t.getEdgeSelection()},getSourceId:function(){return t.widgetAPI.getVisApi().getModule().getSourceId()},getId:function(){return t.widgetAPI.getId()}})},_onRemoveWidget:function(e){var t=this;void 0===e&&(e={}),((e.value||{}).parameter||[]).forEach((function(e){delete t.widgets[e]}))}});return u})),define("dashboard-analytics/dataSources/models/synchronizeData/SynchronizeService",["underscore","./SynchronizeDataModel"],(function(e,t){return function(){function i(e){var i=e.features;this.boardModel=i.internal.getBoardModel(),this.dashboard=i.API,this.canvas=i.Canvas,this.eventGroups=i.EventGroups,this.synchronizeData=new t({boardModel:this.boardModel,dashboard:this.dashboard}),this.canvas.on("change:content:selections",this._handleSelectionChange,this)}var n=i.prototype;return n.destroy=function(){this.canvas.off("change:content:selections",this._handleSelectionChange,this)},n.getAPI=function(){return this.synchronizeData},n._getSelectionCommand=function(e){return"select"===e.info.actionName?"update":"remove"},n._handleSelectionChange=function(t){var i=this,n=t.transactionToken;(t.info.events||[]).forEach((function(t){var r,o=i.canvas.getContent(t.info.contentId);if(t.info.value){var a=o.getFeature("DataPointSelections.utils"),s=i._getSelectionCommand(t);r=a.getLegacySelection(t.info.value,s,[])}else{r={command:"remove",edgeSelect:!1,multiTuple:!1,itemIds:[],tuple:[],slotsToClear:o.getFeature("Visualization").getSlots().getMappedSlotList()}}var l=o.getFeature("SelectionController.deprecated");r.brushingSpec=l.getBrushingItemSpec(r.itemIds),i.synchronizeData.handleBrushingSelection(r,{payloadData:{undoRedoTransactionId:n&&n.transactionId},multiTuple:r.multiTuple,synchOptions:{pageContext:i.boardModel.get("pageContext").getAPI(),newSelectionIsEmpty:function(t){return!t||!e.flatten(t).length}},skipFilterFocus:!0})}))},i}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/glass/controllers/BaseSlideoutActionHandler",["../../lib/@waca/baglass/js/baglass/app/NavbarButtonSlideoutController","jquery"],(function(e,t){var i=function(e){return e&&e.isOpen()},n=function(){this._slideout.hide({force:!0}),delete this._slideout};return e.extend({isAppviewScope:!0,commonOptions:{enableTabLooping:!1,defaultWidth:"344px"},getCustomSpec:function(e){return{options:t.extend({},this.commonOptions,this.getExtraCustomSpec(e))}},getExtraCustomSpec:function(){return{}},onShowCallback:function(e,i){this._slideout=i,this._slideout.$el.addClass("dashboardPane");var n=function(){try{t(window).resize()}catch(e){console.error(e)}};this._slideout.on("done:show",n),this._slideout.on("hide",n),e.target.plugin.actionController=this},onHideCallback:function(){!0===i(this._slideout)&&n.call(this)},onHide:function(){!0===i.call(this,this._slideout)&&n.call(this)},_createSlideout:function(){}})})),define("dashboard-analytics/dataSources/glassControllers/SourceActionHandler",["../../lib/@waca/dashboard-common/dist/glass/controllers/BaseSlideoutActionHandler","../nls/StringResources"],(function(e,t){"use strict";var i=e.extend({getExtraCustomSpec:function(e){var t={id:"dashboardPanel",reuseSlideout:!0,width:this.commonOptions.defaultWidth,position:"left",resizable:{min:300},pinning:{isPinned:!0,float:!1,display:!1},content:{module:"dashboard-analytics/dataSources/views/DataSourcePanel"},enableTabLooping:!1};if(e&&e.target&&e.target.plugin){var i=e.target.plugin.itemSpec;i&&(i.title||i.label)&&(t.label=i.title||i.label)}return t},onShowCallback:function(e,t){i.inherited("onShowCallback",this,arguments),t&&t.$el.addClass("datasetSlideout")},getCoachMarkSpec:function(e){var i=e.target.coachMark,n="story"===e.glassContext.appController.getCurrentContentView().getDashboardApi().getApplicationName();return i.title=t.get("addDataCoachMarkTitle"),i.contents=n?t.get("addDataStoryCoachMarkContents"):t.get("addDataDashboardCoachMarkContents"),i}});return i})),define("dashboard-analytics/dataSources/glassControllers/AddSourceActionHandler",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../nls/StringResources","underscore"],(function(e,t,i){"use strict";var n=e.extend({init:function(e){n.inherited("init",this,arguments),this.dashboardApi=e.dashboardApi},execute:function(){var e=["module","dataSet2","uploadedFile","package"];this.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard","reportDatasource","enabled")&&e.push("report");var i={typesToOpen:e,multiSelect:!1,dialogTitle:t.get("addDataSourceDialogTitle"),primaryBtnText:t.get("addDataSourceDialogButtonLabel"),onOpenCallback:this.addDataSource.bind(this)},n=this._getRequiredCapabilityToAddSource();if(n&&(i.capabilitiesRequired=[n]),this.dashboardApi.prepareGlassOptions(i),!this._openDialogInstance)return this.dashboardApi.getGlassSvc(".ContentDialogFactory").then((function(e){e.createOpenDialog(i).open()}));this._openDialogInstance.open(i)},_getRequiredCapabilityToAddSource:function(){var e=this.dashboardApi.getFeature("Capabilities");return e&&e.getCurrentAuthoringCapability()},addDataSource:function(e){var t=e[0],n={assetId:t.id,name:t.defaultName,type:t.type,searchPath:t.searchPath,isOlapPackage:t.userInterfaces&&i.indexOf(t.userInterfaces,"analysisStudio")>=0,modificationTime:t.modificationTime},r=this.dashboardApi.getFeature("dataSources.deprecated").getSourcesCollection().addSource(n);this.dashboardApi.triggerDashboardEvent("dataSourcePanel:dataSourceAdded",{sender:r})}});return n})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/glass/controllers/WidgetBaseActionHandler",["../../lib/@waca/core-client/js/core-client/ui/core/Class","jquery"],(function(e,t){return e.extend({slideout:null,pressed:!1,onPress:function(e){var t;return this.pressed?(this.onHide(),this.pressed=!1):(this.pressed=!0,t=this.getOptions(e).then(this._createSlideout.bind(this,e))),e.target.plugin.actionController=this,t||Promise.resolve()},onHide:function(){this.slideout&&(this.slideout.hide({force:!0}),this.slideout=null)},getOptions:function(){return Promise.resolve({})},_createSlideout:function(e,t){var i={id:"dashboardPanel",reuseSlideout:!0,position:"left",width:"344px",resizable:{min:300},content:t,enableTabLooping:!1,pinning:{float:!1,isPinned:!0,display:!1}};(t.title||t.label)&&(i.label=t.title||t.label),this.slideout=e.glassContext.appController.currentAppView.openSlideout(i),this.slideout.$el.addClass("dashboardPane"),this.slideout.on("done:show",this._onShow.bind(this,e)),this.slideout.on("hide",this._onHide.bind(this,e))},_onShow:function(e){this.pressed=!0,e.target.plugin.setPressed(),this._resize()},_onHide:function(e){this.pressed=!1,this.slideout=null,e.target.plugin.setUnpressed(),this._resize()},_resize:function(){try{t(window).resize()}catch(e){console.error(e)}}})})),define("dashboard-analytics/visualizations/LiveVisualizationActionHandler",["../lib/@waca/dashboard-common/dist/glass/controllers/WidgetBaseActionHandler","../widgets/livewidget/nls/StringResources","../DynamicFileLoader"],(function(e,t,i){"use strict";return e.extend({getOptions:function(e){var i=this._getDashboardView(e),n={className:"visualizationSlideout",dashboardApi:i.getDashboardApi(),services:i.services,title:t.get("visualizationSlideoutTitle"),module:"dashboard-analytics/visualizationPanel/VisualizationPanelView",getEntries:this.getEntries.bind(this,e)};return Promise.resolve(n)},getEntries:function(e){return this.createWidgetAddUIHelper(e).then((function(e){return e.getEntries()})).then(this.getSpecs.bind(this,e))},getSpecs:function(e,t){return this.createWidgetAddUIHelper(e).then((function(e){var i={},n={onItemClick:function(t,i){return e.addWidgetBySelection(t,i,{selectOptions:{flyout:!1}})},onItemStartDrag:e.addWidgetByDrag.bind(e)};return i.options=n,i.items=t,i}))},_getDashboardView:function(e){return e.glassContext.appController.currentAppView.currentContentView},_getUiHelperClass:function(){return i.load(["dashboard-analytics/widgets/livewidget/LiveWidgetUIHelper"]).then(function(e){return e[0]}.bind(this))},createWidgetAddUIHelper:function(e){var t=this._getDashboardView(e);return this._getUiHelperClass().then((function(e){var i=new e({dashboardApi:t.getDashboardApi(),services:t.services});return i.panelAttributes={dashboardApi:t.dashboardApi,cdnUrl:t.getCDNUrl(),ajaxSvc:t.ajaxSvc},i}))}})})),define("text!dashboard-analytics/filters/dock/templates/filterDock.html",[],(function(){return'<div class="filter-dock-begin" title="{{=it.tooltip}}" aria-label="{{=it.tooltip}}" tabindex="0">\n\t<div class="filterDockIconContainer">\n\t\t<svg class="svgIcon filterDockIcon">\n\t\t\t <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#{{!it.filterDockIcon}}"></use>\n\t\t</svg>\n\t</div>\n    <div class="filterDockIconLabel">{{=it.label}}</div>\n</div>\n<div class="filter-dock-middle" aria-label="{{=it.dropZoneTooltip}}" tabindex="0">\n\t<div class="empty-view"><span>{{=it.emptyLabel}}</span></div>\n\t<div class="filterDockChevronLeft wa-cardpage-icons_chevron_left_24 invisible" title="{{=it.chevron_left}}" aria-label="{{=it.chevron_left}}" tabindex="0">\n    <svg class="svgIcon" viewBox="1 5 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t<path d="M4.8 13.1l7-7 1.4 1.4-5.5 5.6 5.5 5.5-1.4 1.5z"></path>\n\t\t</svg>\n\t</div>\n\t<div class="filter-items-container">\n\t\t<div class="filterInsertMarker inFront">\n\t\t\t<div class="marker">\n\t\t\t\t<div class="filterInsertMarkerLine"></div>\n\t\t\t\t<div class="filterInsertMarkerTop inFront"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="filterInsertMarker atBack">\n\t\t\t<div class="marker">\n\t\t\t\t<div class="filterInsertMarkerLine"></div>\n\t\t\t\t<div class="filterInsertMarkerTop atBack"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t <div class="filterDockChevronRight wa-cardpage-icons_chevron_right_24 invisible"  title="{{=it.chevron_right}}" aria-label="{{=it.chevron_right}}" tabindex="0">\n\t\t <svg class="svgIcon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t <path d="M26.3 16L10.8 31.5l-3.1-3.2L20 16 7.7 3.7 10.8.5z"></path>\n \t\t</svg>\n\t </div>\n</div>\n<div class="filter-dock-overflow" role="application" >\n\t  <div class="wa-dropdown dropdown filter-menu" tabindex="0" title="{{=it.overflowMenuAriaLabel}}" aria-label="{{=it.overflowMenuAriaLabel}}"></div>\n</div>\n'})),define("text!dashboard-analytics/filters/dock/templates/filterDockItem.html",[],(function(){return'<div class="filterInsertMarker inMiddle">\n\t<div class="marker">\n\t\t<div class="filterInsertMarkerLine"></div>\n\t\t<div class="filterInsertMarkerTop"></div>\n\t</div>\n</div>\n<div class="wa-filterDock-filterItem" data-id="{{!it.name}}">\n\t<div class="wa-filterDock-filterItem-top">\n\t\t{{? it.missingData}}\n\t\t<span class="wa-filterDock-error wa-cardpage-icons_warning_32 wa-hide"></span><span class="wa-filterDock-filterName inDock" title="{{!it.missingDataName}}"  aria-label="{{!it.filterDockItemNameAriaLabel}}" tabindex="0" role="application">{{!it.missingDataName}}</span>\n\t\t{{??}}\n\t\t<span class="wa-filterDock-error wa-cardpage-icons_warning_32 wa-hide"></span><span class="{{? it.isModeledFilter }} modelFilter_pageContext {{?}} wa-filterDock-filterName inDock" title="{{!it.name}}"  aria-label="{{!it.filterDockItemNameAriaLabel}}" tabindex="0" role="application">{{!it.name}}</span>\n\t\t{{?}}\n\t\t<span class="filter-menu-position" tabindex="0" role="application" title="{{!it.overflowMenuAriaLabel}}" aria-label="{{!it.overflowMenuAriaLabel}}">\n\t\t\t<span class="wa-glass_menu">\n\t\t\t\t<svg class="svgIcon">\n\t\t\t\t\t<svg viewBox="0 0 16 16" width="100%" height="100%">\n\t\t\t\t\t\t<circle cx="8" cy="2" r="1"></circle>\n\t\t\t\t\t\t<circle cx="8" cy="7" r="1"></circle>\n\t\t\t\t\t\t<circle cx="8" cy="12" r="1"></circle>\n\t\t\t\t\t</svg>\n\t\t\t\t</svg>\n\t\t\t</span>\n\t\t</span>\n\t\t<span class="wa-dropdown dropdown filter-menu wa-no-pointer-event"></span>\n\t</div>\n\t<div class="wa-filterDock-filterItem-bottom {{? !it.selectedCount && !it.isNamedSet && !it.isModeledFilter }} wa-hide {{?}}" >\n\t\t<span class="wa-filterDock-filterItemText" title="{{!it.text}}">{{!it.text}}</span>\n\t\t{{? !it.isRange && !it.isNamedSet && !it.isModeledFilter }}\n\t\t<span class="wa-filterDock-filterSelectCount">{{=it.selectedCount}}</span>\n\t\t{{?}}\n\t</div>\n\t<span class="wa-filterDock-filterItemMount" tabindex="-1"></span>\n</div>\n'})),define("text!dashboard-analytics/filters/utils/templates/menu.html",[],(function(){return'<span {{? it.menuIcon}} class="{{=it.menuIcon}}  dropdown-toggle" {{??}} class="dropdown-toggle"{{?}}  data-toggle="dropdown">\n\t<svg class="svgIcon">\n\t\t{{? !it.hideItemMenuIcon}}\n\t\t<svg viewBox="0 0 32 32" width="100%" height="100%">\n\t\t\t<title>menuoverflow</title>\n\t\t\t<g>\n\t\t\t\t<circle cx="16" cy="8" r="2"></circle>\n\t\t\t\t<circle cx="16" cy="16" r="2"></circle>\n\t\t\t\t<circle cx="16" cy="24" r="2"></circle>\n\t\t\t</g>\n\t\t</svg>\n\t\t{{?}}\n\t</svg>\n</span>\n<ul class="dropdown-menu">\n\t{{~it.menuItems :menu:index}}\n\t<li data-action="{{=menu.action}}" {{?menu.authorOnly}}authoring-only="true" {{?}} class="{{? index == 0}}firstMenuItem {{?}}{{? index == it.menuItems.length - 1}}lastMenuItem {{?}}{{? menu.itemClass}}{{=menu.itemClass}}{{?}}" {{? menu.itemTooltip}} title="{{=menu.itemTooltip}}" {{?}} tabindex="0">{{=menu.label}} </li>\n\t{{? menu.items}}\n\t<ul>\n\t\t{{~menu.items :menuChild:childIndex}}\n\t\t\t<li data-action="{{=menuChild.action}}" class="{{? index == 0}}firstMenuItem {{?}}{{? index == it.menuItems.length - 1}}lastMenuItem {{?}}{{? menuChild.itemClass}}{{=menuChild.itemClass}}{{?}}">{{=menuChild.label}}</li>\n\t\t{{~}}\n\t </ul>\n\t{{?}}\n\t{{~}}\n</ul>\n'})),define("dashboard-analytics/filters/utils/FilterMenu",["../../lib/@waca/core-client/js/core-client/ui/core/View","jquery","underscore","text!./templates/menu.html"],(function(e,t,i,n){var r=null;return r=e.extend({templateString:n,events:{"click li":"menuActionHandler","keydown li":"_handleKeydown"},cacheMenuItems:null,init:function(e){this.menuActionHandler=e.menuActionHandler,r.inherited("init",this,arguments),this.onMenuHideHandler=e.onMenuHideHandler,this.onMenuShowHandler=e.onMenuShowHandler},render:function(e){if(this.viewModel=e.viewModel||this.viewModel,this.mountNode=e.mountNode||this.mountNode,this.isAuthoring=e.isAuthoring||this.isAuthoring,!i.isEqual(this.cacheMenuItems,this.viewModel.menuItems)){if(this.cacheMenuItems=this.viewModel.menuItems,!this.mountNode)throw new Error("No mount node is defined for filter menu");this.$el.empty(),this.$el.html(this.dotTemplate(this.viewModel)),this.mountNode.append(this.$el),this.isAuthoring?this.showAuthoringMenuOptions():this.showConsumeMenuOptions(),this._onRenderComplete()}return Promise.resolve()},updateMenuItems:function(e){if(!e||!this.viewModel)return Promise.resolve({});var t=this._getIndexMapOfMenuItemActions();return e.forEach(function(e){this.viewModel.menuItems[t[e.action]]=e}.bind(this)),this.render({})},_getIndexMapOfMenuItemActions:function(){var e={};return this.viewModel.menuItems.forEach((function(t,i){e[t.action]=i})),e},showAuthoringMenuOptions:function(){this.$el.find('[authoring-only="true"]').show()},showConsumeMenuOptions:function(){this.$el.find('[authoring-only="true"]').hide()},_onRenderComplete:function(){this.onMenuShowHandler&&this.$el.parent().on("show.bs.dropdown",this.onMenuShowHandler),this.onMenuHideHandler&&this.$el.parent().on("hide.bs.dropdown",this.onMenuHideHandler)},onMenuShownHandler:function(){this.scrollIntoView()},toggle:function(){this.$(".dropdown-toggle").dropdown("toggle")},isOpen:function(){return this.$el.hasClass("open")},showDeleteMenuOnly:function(){var e=this.$(".dropdown-menu li[data-action]");i.each(e,(function(e){"filter-menu-delete-action"!==t(e).attr("data-action")&&t(e).addClass("disabled")}))},remove:function(){this.$el.parent().off("shown.bs.dropdown",this.onMenuShownHandler),this.menuActionHandler=null,this.onMenuShowHandler&&(this.onMenuShowHandler=null),this.onMenuHideHandler&&(this.onMenuHideHandler=null),this.viewModel=null,this.mountNode=null,this.isAuthoring=null,r.inherited("remove",this)},_handleKeydown:function(e){var i=e.which||e.keyCode||e.charCode,n=t(e.target);switch(i){case 9:e.shiftKey?n.hasClass("firstMenuItem")&&(n.closest("ul").find(".lastMenuItem").focus(),e.preventDefault()):n.hasClass("lastMenuItem")&&(n.closest("ul").find(".firstMenuItem").focus(),e.preventDefault());break;case 13:this.menuActionHandler(e);case 27:this.toggle(),n.closest(".filter-dock-overflow").focus()}},toggleDisableOverflow:function(e){var t=this.$el.find(".dropdown-menu li");t.toggleClass("data-action-disabled",e),t.hasClass("data-action-disabled")&&0===t.parents(".wrapper").length&&t.wrap("<div class='wrapper'></div>"),!t.hasClass("data-action-disabled")&&t.parents(".wrapper").length>0&&t.unwrap()}})})),define("text!dashboard-analytics/filters/controls/templates/FilterErrorView.html",[],(function(){return'<div class="filterError">\n\t<div class="errorContainer error">\n\t\t<div class="dashboardMessageContainer error">\n\t\t\t<div class="errorIcon">\n\t\t\t\t<svg>\n\t\t\t\t\t<use xlink:href="#{{!it.errorIcon.id}}"></use>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t{{!it.title}}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"));else if("function"==typeof define&&define.amd)define("dashboard-analytics/lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/icons-js/error--filled_24",["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"],t);else{var i=t("object"==typeof exports?require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"):e["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"]);for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}("undefined"!=typeof self?self:this,(function(e){return webpackJsonPBaGraphics([751],{"6873601dfe1d9459c1a9":function(t,i){t.exports=e},"8da09f6f694f6e49e853":function(e,t,i){"use strict";var n=i("9689a9c94ae38b47fa2c"),r=i.n(n),o=i("9ce58a7deea14f49ef01"),a=i.n(o),s=new r.a({id:"error--filled_24_v7",use:"error--filled_24_v7-usage",viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="error--filled_24_v7"><path d="M12,1C5.9,1,1,5.9,1,12s4.9,11,11,11s11-4.9,11-11S18.1,1,12,1z M16.3,17.5L6.5,7.7l1.2-1.2l9.8,9.8L16.3,17.5z" /></symbol>'});a.a.add(s),t.a=s},"9585c422192455fe4bd0":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("6873601dfe1d9459c1a9"),r=(i.n(n),i("8da09f6f694f6e49e853"));t.default=r.a}},["9585c422192455fe4bd0"])})),define("dashboard-analytics/filters/controls/FilterErrorView",["jquery","../../lib/@waca/core-client/js/core-client/ui/core/View","text!./templates/FilterErrorView.html","../../widgets/livewidget/nls/StringResources","../../lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/icons-js/error--filled_24"],(function(e,t,i,n,r){"use strict";var o=t.extend({templateString:i,init:function(e){o.inherited("init",this,arguments),this.commonView=e.commonView},renderViewComposition:function(t){return this.commonView.renderInFilterItemView().then(function(i){e(i.mountNode).empty();var n=this._generateErrorHtml(t);this.$el.html(n),this.$el.appendTo(i.mountNode),this.commonView.initializeMountNodeForDropDownFilterView&&this.commonView.initializeMountNodeForDropDownFilterView()}.bind(this))},_generateErrorHtml:function(e){return this.dotTemplate({title:e&&e.message?e.message:n.get("errMsgFilterItemGenericTitle"),errorIcon:r.default})}});return o})),define("dashboard-analytics/filters/dock/FilterDockItemView",["../../lib/@waca/core-client/js/core-client/ui/core/View","text!./templates/filterDockItem.html","../utils/FilterMenu","../controls/FilterErrorView","../../widgets/livewidget/nls/StringResources","../../lib/@waca/core-client/js/core-client/utils/ClassFactory","jquery","underscore"],(function(e,t,i,n,r,o,a,s){var l=e.extend([],{templateString:t,className:"filterItemWrapper",events:{"touchend span:not(.modelFilter_pageContext).wa-filterDock-filterName":"openDropdownFilterViewAction","primaryaction span:not(.modelFilter_pageContext).wa-filterDock-filterName":"openDropdownFilterViewAction","touchend .filter-menu-position":"toggleDropdownMenu","primaryaction .filter-menu-position":"toggleDropdownMenu","escapeaction .wa-filterDock-filterName, .wa-filterDock-filterItemMount":"handleFilterViewEscapeAction","escapeaction .filter-menu-position, .filter-menu":"handleDropdownMenuEscapeAction"},_AMD:o,init:function(e){l.inherited("init",this,arguments),this.onOpenDropdownFilterView=e.onOpenDropdownFilterView,this.toggleCardHighlighting=e.toggleCardHighlighting;var t={menuActionHandler:e.menuActionHandler,onMenuShowHandler:this._onMenuShow.bind(this),onMenuHideHandler:this._onMenuHide.bind(this),iconsFeature:e.iconsFeature};this.menu=new i(t);var n=r.get("missingColumn",{columnLabel:e.viewModel.name});this.getViewModel=e.getViewModel,this.vm=s.extend(s.clone(e.viewModel),{hideItemMenuIcon:!0,filterDockItemNameAriaLabel:r.get("filterDockItemNameAriaLabel"),missingData:e.missingData,missingDataName:n}),this.render(this.vm).then(this.menu.render.bind(this.menu,{viewModel:this.vm,mountNode:this.getFilterMenuMountNode()})),e.isAuthoringMode||this.hideItemMenu()},render:function(e){return this.$el.empty(),this.$el.attr("data-dockkey",s.escape(e.dockKey)).attr("data-contentid",s.escape(e.contentId)).html(this.dotTemplate(e)),this._updateError(e.error),Promise.resolve()},updateMenuState:function(e){return this.menu.updateMenuItems(e.menuItems)},initializeMountNodeForDropDownFilterView:function(e){this.isFilterViewOpen()||(e&&e.length&&this.getWidgetMountNode().addClass(e),this.$(".filter-menu-position").attr("tabindex","-1"),this.$filterOutClickCatcher=a("<div>").attr("id","filterOutClickCatcher"),a("body").append(this.$filterOutClickCatcher),this.$filterOutClickCatcher.on("dragstart",(function(e){return e.stopPropagation(),e.preventDefault(),!1})),this.$filterOutClickCatcher.on("click touchend",function(e){e.preventDefault(),e.stopPropagation(),this.getWidgetMountNode().toggle(!1),this.toggleCardHighlightHelper(!1),this.$filterOutClickCatcher&&this.$filterOutClickCatcher.off&&this.$filterOutClickCatcher.off("click dragstart"),this.$filterOutClickCatcher&&this.$filterOutClickCatcher.remove&&this.$filterOutClickCatcher.remove(),this.$filterOutClickCatcher=null,this.$(".filter-menu-position").attr("tabindex","0")}.bind(this))),this.getWidgetMountNode().toggle(!0),this.setMountNodeOffSet()},openDropdownFilterViewAction:function(e){e.preventDefault(),this.onOpenDropdownFilterView&&(this.onOpenDropdownFilterView(),this.toggleCardHighlightHelper(!0))},toggleDropdownMenu:function(e){e.stopPropagation(),e.preventDefault();var t=this.$(".filter-menu-position").offset();this.$(".filter-menu").offset(t),this.menu.render({viewModel:this.getViewModel(),mountNode:this.getFilterMenuMountNode()}),this.menu.toggle()},getWidgetMountNode:function(){return this.$widgetMountNode=this.$widgetMountNode?this.$widgetMountNode:this.$(".wa-filterDock-filterItemMount"),this.$widgetMountNode},renderInFilterItemView:function(e){return e&&e.viewClass&&this.getWidgetMountNode().addClass(e.viewClass),Promise.resolve({mountNode:this.getWidgetMountNode()})},renderError:function(e){return this.errorView=new n({commonView:this}),this.errorView.renderViewComposition(e)},processError:function(e){return this.renderError(e)},getFilterMenuMountNode:function(){return this.$filterMenuMountNode=this.$filterMenuMountNode?this.$filterMenuMountNode:this.$(".filter-menu"),this.$filterMenuMountNode},_setMountNodeLeftOffset:function(e){var t=this.getWidgetMountNode().width(),i=a(".filterDockContainer"),n=i.width()+i.offset().left;e.left+t>n&&(e.left-=t-this.$(".wa-filterDock-filterItem-bottom").width())},setMountNodeOffSet:function(){var e=this.$(".wa-filterDock-filterItem-bottom").offset();this._setMountNodeLeftOffset(e),this.$(".wa-filterDock-filterItemMount").offset(e)},adjustMountNodeHeight:function(e,t){var i,n=this.$(".wa-filterDock-filterItemMount").offset(),r=a("#main").height()-n.top;i=r<t&&r>e?r+"px":r>=t?"":e+"px",this.$(".wa-filterDock-filterItemMount").css("height",i)},_updateFilterName:function(e){var t=this.$el.find(".wa-filterDock-filterName"),i=t.text(),n=e.name;if(this.vm.missingData){var o=r.get("missingColumn",{columnLabel:n});t.attr("title",o),t.text(o)}else i!==n&&(t.attr("title",n),t.text(n))},_updateError:function(e){this.$el.find(".wa-filterDock-error").toggleClass("wa-hide",!e)},update:function(e){this._updateFilterName(e),this._updateError(e.error),this.onSelectStatUpdate(e.selectedCount,null,e.text,e.isModeledFilter),this.updateMenuState(e)},onSelectStatUpdate:function(e,t,i,n){n||0!==e&&i?this.$(".wa-filterDock-filterItem-bottom").css("visibility","visible"):this.$(".wa-filterDock-filterItem-bottom").css("visibility","hidden"),this.$(".wa-filterDock-filterSelectCount").prop("innerHTML",e),this.$(".wa-filterDock-filterItemText").prop("innerHTML",s.escape(i)),this.$(".wa-filterDock-filterItemText").prop("title",i)},onViewClose:function(){this.$filterOutClickCatcher&&this.$filterOutClickCatcher.click()},isFilterViewLoaded:function(){return this.getWidgetMountNode().find(".commonFilterControlContainer, .filterError").length>0},isFilterViewOpen:function(){return this.getWidgetMountNode().is(":visible")},isAnyFilterViewOpen:function(){return a(".wa-filterDock-filterItemMount").is(":visible")},isSideMenuOpen:function(){return this.menu.$el.hasClass("open")},hideFilterItemView:function(){this.getWidgetMountNode().toggle(!1)},_onMenuShow:function(){this.$filterMenuMountNode.removeClass("wa-no-pointer-event"),this.toggleCardHighlightHelper(!0)},_onMenuHide:function(){this.$filterMenuMountNode.addClass("wa-no-pointer-event"),this.toggleCardHighlightHelper(!1)},setWidgetMountNodeHeight:function(e){this.getWidgetMountNode().css("height",e)},remove:function(){this.onOpenDropdownFilterView=null,this.toggleCardHighlighting=null,this.menu.remove(),this.$widgetMountNode&&(this.$widgetMountNode.remove(),this.$widgetMountNode=null),l.inherited("remove",this)},toggleCardHighlightHelper:function(e){this.toggleCardHighlighting&&this.toggleCardHighlighting(e)},toggleWarningIcon:function(e,t){var i=this.$el.find(".wa-filterDock-error");i.toggleClass("wa-hide",!t),e&&i.attr("title",e)},handleFilterViewEscapeAction:function(){this.$filterOutClickCatcher&&this.$filterOutClickCatcher.trigger("click"),this.$(".wa-filterDock-filterName").focus()},handleDropdownMenuEscapeAction:function(){this.menu.isOpen()&&this.menu.toggle(),this.$(".filter-menu-position").focus()},showItemMenu:function(){this.$(".filter-menu-position").removeClass("hide")},hideItemMenu:function(){this.$(".filter-menu-position").addClass("hide")}});return l})),define("dashboard-analytics/filters/FilterMetadataHelper",[],(function(){"use strict";function e(){}return e.getColumnMetadataInfo=function(t,i,n){return t.getModule(i).then((function(t){var i=t.getMetadataColumn(n);return e.getFilterMetadataInfo(i)}))},e.isDateType=function(e){return"date"===e||"time"===e||"datetime"===e||"timestamp"===e},e.supportsConditionFilters=function(e){var t=!0;if(e.supportsConditionFilters)t=e.supportsConditionFilters();else{if(e.isNamedSet())return!1;var i=e.getTaxonomyList();i&&i.forEach((function(e){var i=e.getFamily();"cLatitude"!==i&&"cLongitude"!==i||(t=!1)}))}return t},e.isStatic=function(e){return e.getAggregateMode?"static"===e.getAggregateMode():"static"===e.getAggregationMode()},e.getFilterMetadataInfo=function(e,t,i){void 0===i&&(i=0);var n,r,o,a,s={};if(t){var l=t.getDataItemList()[i];r=(n=l.getMetadataColumn()).isHierarchy()&&!(l.getDrillUpValue()&&l.getDrillDownValue()),o=l.getType(),a=l.getAggregation()}else e&&(n=e);if(n){s.dataType=n.getDataType(),s.usage=void 0!==o?o:n.getType(),s.isHierarchy=void 0!==r?r:n.isHierarchy(),s.isProperty="property"===n.getSourceCategory(),s.isStatic=this.isStatic(n),s.isNamedSet=n.isNamedSet(),s.supportsConditionFilters=this.supportsConditionFilters(n),s.aggregationType=void 0!==a?a:n.getDefaultAggregation(),s.objectType=n.getObjectType&&n.getObjectType();var c=n.getFormat();c&&void 0!==c.maximumFractionDigits?s.maximumFractionDigits=c.maximumFractionDigits:s.maximumFractionDigits=2}return s},e})),define("dashboard-analytics/filters/finder/FilterTypes",[],(function(){"use strict";return{TREE:"TREE",NON_NUMERICAL:"NON_NUMERICAL",DATE_TIME:"DATE_TIME",RANGE:"RANGE"}})),define("dashboard-analytics/filters/finder/FilterTable",["./FilterTypes"],(function(e){"use strict";var t={filterDock:{}};return t.filterDock[e.RANGE]={path:"dashboard-analytics/filters/controls/RangeFilterController"},t.filterDock[e.TREE]={path:"dashboard-analytics/filters/controls/HierarchicalFilterController"},t.filterDock[e.NON_NUMERICAL]={path:"dashboard-analytics/filters/controls/NonNumericFilterController"},t.filterDock[e.DATE_TIME]={path:"dashboard-analytics/filters/controls/DateTimeFilterController"},t})),define("dashboard-analytics/filters/finder/FilterModuleFinder",["./FilterTable","./FilterTypes","../FilterMetadataHelper"],(function(e,t,i){"use strict";function n(){}return n.getModule=function(n){var r,o,a,s=n.dataType,l=n.usage,c=void 0===n.isHierarchy?null:n.isHierarchy;a=s&&l&&null!==c?Promise.resolve({dataType:s.toLowerCase(),usage:l,isHierarchy:c}):i.getColumnMetadataInfo(n.dataSources,n.sourceId,n.itemId);return a.then((function(a){return s=a.dataType,l=a.usage,c=a.isHierarchy,o="filterWidget"===n.origin?"filterDock":n.origin,r="fact"===l?t.RANGE:function(e){return!!i.isDateType(s)&&("filterDock"!==e.origin||e.isRange)}(n)?t.DATE_TIME:c?t.TREE:t.NON_NUMERICAL,"localFilter"===n.origin?n.content&&n.content.getFeature("LocalFiltersUI")?n.content.getFeature("LocalFiltersUI").getLocalFilterUI(r).path:{path:null}:e[o][r].path}))},n})),define("dashboard-analytics/util/DashboardFormatter",["../lib/@waca/core-client/js/core-client/i18n/Formatter","../widgets/livewidget/nls/StringResources"],(function(e,t){"use strict";return new function(){return{format:function(i,n){return n&&(n=n.validFormatSpec||n.formatSpec||n),null==i||""===i?n&&n.defaultValue?n.defaultValue:t.get("nullValueContent"):"ERROR"===i?t.get("value_is_not_available"):n&&i!==t.get("value_is_not_available")?e.format(i,n):i},formatNull:function(e,t){return t&&(t=t.validFormatSpec||t.formatSpec||t),null===e?t&&t.defaultValue?t.defaultValue:"(null)":this.format(e,t)},getNumberFromFormattedValue:function(t){var i=e.formatNumber(1e3).substring(1,2),n=e.formatNumber(.1).substring(1,2),r=new RegExp("\\"+i,"g"),o=new RegExp("\\"+n,"g");return Number((t+"").replace(r,"").replace(o,"."))}}}})),define("dashboard-analytics/filters/dock/FilterDockItemController",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../../lib/@waca/core-client/js/core-client/utils/ClassFactory","../../lib/@waca/core-client/js/core-client/i18n/Formatter","./FilterDockItemView","../../widgets/livewidget/nls/StringResources","jquery","underscore","../FilterMetadataHelper","../finder/FilterModuleFinder","../../util/DashboardFormatter"],(function(e,t,i,n,r,o,a,s,l,c){var u=e.extend({_AMD:t,init:function(e){var t=this;u.inherited("init",this,arguments),this.dashboardApi=e.dashboardApi,this.featureChecker=e.featureChecker,this.pageContextAPI=e.pageContextAPI,this.scope=e.scope,this.item=e.item,this.filterContent=e.filterContent,this.dataFilters=e.dataFilters,this.filtersUI=e.filtersUI,this.cascadingFilters=e.cascadingFilters,this.onDelete=e.onDelete,this.dockKey=e.dockKey,this.getFilterItem=e.getFilterItem,this.ajaxSvc=e.ajaxSvc,this.parentLayoutId=e.parentLayoutId,this.singleDockMode=e.singleDockMode,this.excludeAddToCanvas=e.excludeAddToCanvas,this.id=a.uniqueId("FilterDockItemController_"),this.dataSources=e.dataSources,this.cascadeSets=e.cascadeSets,this.cascadeSetsController=e.cascadeSetsController,this.transaction=this.dashboardApi.getFeature("Transaction"),this.windowResizeHandler=this._onWindowResize.bind(this),o(window).on("resize",this.windowResizeHandler),this.registerEvents();var i={menuActionHandler:this.menuActionHandler.bind(this),getFilterController:this.getFilterController.bind(this),isAuthoringMode:"authoring"===this.dashboardApi.getMode(),iconsFeature:this.dashboardApi.getFeature("Icons")};this.ready=this._whenMetadataReady().then((function(){t.item&&a.extend(i,{onOpenDropdownFilterView:t.openDropdownFilterView.bind(t),isItemAHierarchy:t.isHierarchy()})})).catch((function(e){t.excludeAddToCanvas=!0,a.extend(i,{onOpenDropdownFilterView:t.openDropdownErrorFilterView.bind(t,e),missingData:!0})})).finally((function(){return t.view=new n(a.extend(i,{viewModel:t._getViewModel(),getViewModel:t._getViewModel.bind(t)})),t.registerSourceUsage()}))},_onWindowResize:function(){this.view&&this.filterInstance&&this.filterInstance.isOpen()&&this.view.adjustMountNodeHeight(this.filterInstance.MIN_HEIGHT,this.filterInstance.HEIGHT)},_getItemMetadataLabel:function(){var e;if(this.featureChecker.checkValue("dashboard","DataFilters","enabled"))e=this._getContentMetadataColumn();else{var t=this.dashboardApi.getFeature("DataSources"),i=this.getDataSourceId(),n=this.getColumnId();e=t.getDataSource(i).getMetadataColumn(n)}return e&&e.getLabel()},_getDataFilter:function(){var e=this._getContentDataItems().map((function(e){return e.getColumnId()})),t=this.dataFilters.getFilterList({contentType:"self",columnIds:e});return t&&t.length&&t[0]},_getContentDataItems:function(){return this.filterContent.getFeature("Visualization").getSlots().getDataItemList()},_getContentDataItemsLabel:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled"))return this._getContentDataItems().map((function(e){return e.getLabel()})).join(", ")},_getContentMetadataColumn:function(){var e=this.filterContent.getFeature("Visualization").getSlots().getDataItemList();return e&&e.length&&e[0].getMetadataColumn()},getDataSourceId:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this.filterContent.getFeature("Visualization").getDataSource();return e&&e.getId()}return this.item.getSourceId()},getColumnId:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getColumnIdList();return e&&e.length&&e[0]}return this.item.getItemId()},getScope:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this.filterContent.getContainer();return e.getContainer()?e.getId():"global"}return this.item.getScope()},getDataType:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentMetadataColumn().getDataType():this.item.getDataType()},getType:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentMetadataColumn().getType():this.item.getUsage()},getName:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentMetadataColumn().getLabel():this.item.getItemName()},getValueCount:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getValueList();return this.isRange()?0===e[0].from&&0===e[0].to?0:e.length:e?e.length:0}return this.item.getValueCount()},getValueCaptions:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getDataFilter().getValueList().map((function(e){return e.map((function(e){return e.label})).join(", ")})):this.item.getValueCaptions()},isModeledFilter:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentMetadataColumn().isFilter():this.item.getIsModeledFilter()},isHierarchy:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentMetadataColumn().isHierarchy():this.item.isHierarchy()},isNamedSet:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentMetadataColumn().isNamedSet():this.item.getIsNamedSet()},isValueDataItem:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getValueList();return this.isNamedSet()&&!(e&&e.length)}return this.item.isValueDataItem()},isExclude:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getDataFilter().isExclude():this.item.getExclude()},isColumnUnavailable:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this._getContentDataItems().some((function(e){return e.isColumnUnavailable()})):this.item.getIsColumnUnavailable()},isRange:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getValueList();return!(!e||!e.length)&&(e[0].hasOwnProperty("from")||e[0].hasOwnProperty("to"))}return this.item.isRange()},getFrom:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getValueList();return e&&e.length?e[0].from:null}return this.item.getFrom()},getTo:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getValueList();return e&&e.length?e[0].to:null}return this.item.getTo()},getInvert:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getDataFilter().getValueList();return!(!e||!e.length)&&!!e[0].invert}return this.item.getInvert()},getError:function(){return this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this.filterContent.getFeature("state").getError():this.item.getError()},getMaximumFractionDigits:function(){if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var e=this._getContentMetadataColumn(),t=e&&e.getFormat();return t&&t.maximumFractionDigits}var i=this.item.getMetadataInfo();return i&&i.maximumFractionDigits},_getViewModel:function(){return{name:this._getContentDataItemsLabel()||this._getItemMetadataLabel()||this.item.getItemName(),dockKey:this.dockKey,contentId:this.filterContent&&this.filterContent.getId(),text:this._getFilterText()||this.generateAllMembersString(),isRange:this.isRange(),isNamedSet:this.isNamedSet(),selectedCount:this._getSelectCount(),menuItems:this._getMenuItems(),menuIcon:"wa-glass_menu",error:this.getError(),overflowMenuAriaLabel:r.get("filterOverflowMenu"),isModeledFilter:this.isModeledFilter()}},registerEvents:function(){this.dashboardApi.on("pagecontext:filterContextUpdated",this.onFilterContextUpdated,this),this.dashboardApi.on("filterDock:showItemMenu",this.showItemMenu,this),this.dashboardApi.on("filterDock:hideItemMenu",this.hideItemMenu,this)},unregisterEvents:function(){this.dashboardApi.off("pagecontext:filterContextUpdated",this.onFilterContextUpdated,this),this.dashboardApi.off("filterDock:hideItemMenu",this.showItemMenu,this),this.dashboardApi.off("filterDock:hideItemMenu",this.hideItemMenu,this)},registerSourceUsage:function(){var e=this.dashboardApi.getFeature("dataSources.deprecated");this.sourceCollection=e.getSourcesCollection(),this.sourceCollection.registerUsage(this.id,this.getDataSourceId())},unregisterSourceUsage:function(){this.sourceCollection&&this.sourceCollection.deregisterUsage(this.id)},_getMenuItems:function(){var e=[];if(this.excludeAddToCanvas||this.isModeledFilter()||!this.singleDockMode&&"global"===this.getScope()||e.push({label:r.get("filterItemCanvasMove"),action:"filter-menu-add-to-canvas-action"}),this._isCascadingFiltersEnabled()){var t={label:r.get("addToCascadeSet"),action:"add-to-cascadeset"};this.cascadeSets.findCascadeSet(this.getColumnId(),this.getDataSourceId())&&(t.label=r.get("removeFromCascadeSet"),t.action="remove-from-cascadeset"),e.push(t)}return e.push({label:r.get("filterItemDelete"),action:"filter-menu-delete-action"}),e},_isCascadingFiltersEnabled:function(){return this.cascadingFilters.isCascadingFiltersEnabled()&&!!this.cascadeSets},generateSelectedValueString:function(){var e;if(this.isRange()){var t=this.getFrom(),i=this.getTo();e=""===t&&""===i||0===t&&0===i?"":this._getLabel(t,i)}else e=this.isValueDataItem()?r.get("filter_allMembersOfSet"):this._generateMemberString();return e},generateAllMembersString:function(){return this.isNamedSet()?r.get("filter_allMembersOfSet"):""},_getLabel:function(e,t){var n,o=this.getDataType();if(u.isDateDataType(o)){var a=this._formatDateTime(o,e,t);n=this._generateDateTimeLabel(a,e,t,this.getInvert())}if(!n){var s={type:o},l=this.getMaximumFractionDigits();void 0!==l&&(s.maximumFractionDigits=l),e=i.format(e,s),t=i.format(t,s),n=r.get(this.getInvert()?"filterInvertRange":"filterRange",{from:e,to:t})}return n.length?n:""},_generateDateTimeLabel:function(e,t,i,n){var o;return e&&(t=e.from||t,i=e.to||i,this._dateIsAfter(t,i)?o=r.get(n?"filter_date_after_except":"filter_date_after",{from:t}):this._dateIsBefore(t,i)?o=r.get(n?"filter_date_before_except":"filter_date_before",{to:i}):this._dateIsBetween(t,i)&&(o=r.get(n?"filter_date_between_except":"filter_date_between",{from:t,to:i}))),o},_dateIsAfter:function(e,t){return!(!e||!e.length||t&&t.length)},_dateIsBefore:function(e,t){return!(!t||!t.length||e&&e.length)},_dateIsBetween:function(e,t){return!!(e&&e.length&&t&&t.length)},_formatDateTime:function(e,t,n){var r;return(t.length||n.length)&&(r={from:"",to:""},t.length&&(r.from=i.format(t,{type:e})),n.length&&(r.to=i.format(n,{type:e}))),r},_generateMemberString:function(){var e,t=[],i=this.getValueCaptions();return a.each(i,(function(e){var i=e||0===e;t.push(i?e:c.format(null))})),e=t.join(r.get("filterValueSeparator")+" "),this.isExclude()&&(e=0===this.getValueCaptions().length?r.get("filterAll"):r.get("filterExcept",{values:e})),e},menuActionHandler:function(e){if(!o(e.currentTarget).hasClass("disabled")){var t=e.currentTarget.dataset.action;"filter-menu-delete-action"===t?this._deleteSelf():"filter-menu-add-to-canvas-action"===t?this._addToCanvas():"add-to-cascadeset"===t?this._addToCascadeSet():"remove-from-cascadeset"===t&&this._removeFromCascadeSet(this.getColumnId(),this.getDataSourceId())}},_whenMetadataReady:function(){var e=this,t=this.dashboardApi.getFeature("dataSources.deprecated");return this.dataSources=t,this.item.getMetadataInfo()?new Promise((function(t,i){e.isColumnUnavailable()&&i(new Error(r.get("errMsgFilterItemMissingTitle",{itemName:e.getColumnId()}))),t(null)})):s.getColumnMetadataInfo(t,this.getDataSourceId(),this.getColumnId()).then((function(t){if(a.isEmpty(t))throw new Error(r.get("errMsgFilterItemMissingTitle",{itemName:e.getColumnId()}));e.item.updateMetadata(t)}))},_addToCanvas:function(){var e=this.transaction.startTransaction(),t=this._getAddToCanvasParentId(),i=this.dashboardApi.getFeature("Canvas"),n={spec:{properties:this._getItemContextProperties(),type:"filter"},containerId:t};0===i.getContent(t).findContent({type:"templateDropZone"}).length&&(n.layout={height:-1!==["string","date","datetime","time","timestamp"].indexOf(this.getDataType().toLowerCase())?"532px":"382px",width:"350px"}),i.addContent(n,e)},_addToCascadeSet:function(){var e=this;if(this.cascadeSets.getCascadeSetList().filter((function(t){return t.getDataSourceId()===e.getDataSourceId()})).length>1)throw new Error("Unexpected number of cascade sets for datasource "+this.getDataSourceId());var t=this.transaction.startTransaction();this.cascadeSets&&this.cascadeSets.addToCascadeSet(this.getColumnId(),this.getDataSourceId(),null,-1,t),this.transaction.endTransaction(t)},_removeFromCascadeSet:function(e,t,i){if(this._isCascadingFiltersEnabled()){var n=!i;i=i||this.transaction.startTransaction(),this.cascadeSets.removeFromCascadeSet(e,t,i),n&&this.transaction.endTransaction(i)}},_updateCascadeSetsOnDeleteItem:function(e,t,i){this.cascadeSets&&this._isCascadingFiltersEnabled()&&(this.cascadeSetsController.setIsDeletingFilterItem(!0),this.cascadeSets.deleteItem(e,t,i),this.cascadeSetsController.setIsDeletingFilterItem(!1))},_getAddToCanvasParentId:function(){var e=this.getScope();return this.singleDockMode&&(e=this.parentLayoutId),e},_deleteItemFromPageContext:function(e){var t={payloadData:{undoRedoTransactionId:e.transactionId,transactionToken:e}};this.pageContextAPI.updateFilterContext({item:this.item,scope:this.scope,origin:"filter",eventSourceId:this.filterInstance?this.filterInstance.id:null},{command:"delete"},t),this.filterContent&&(this.filtersUI.removeFilterContent(this.filterContent.getId(),e),delete this.filterContent)},_deleteSelf:function(){this.dashboardApi.triggerDashboardEvent("filterItem:filterItemBlur");var e=this.transaction.startTransaction(),t=this.getColumnId(),i=this.getDataSourceId();this._updateCascadeSetsOnDeleteItem(t,i,e),this._deleteItemFromPageContext(e),this.transaction.endTransaction(e),this.onDelete(this)},onFilterContextUpdated:function(e){(e=e||{}).ignorePageContextChanged&&e.ignorePageContextChanged()||this.view&&this.view.updateMenuState(this._getViewModel())},_getSelectCount:function(){return this.isExclude()?"-":this.getValueCount()},openDropdownErrorFilterView:function(e){this.view.initializeMountNodeForDropDownFilterView(),this.view.processError(e)},openDropdownFilterView:function(){var e=this;this.view.initializeMountNodeForDropDownFilterView();var t=this.view.isFilterViewLoaded();if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){var i=this.filterContent.getFeature("Visualization").getDefinition();return this.view.renderInFilterItemView({viewClass:i.getProperty("viewClass")}),this.filterContent.render(t?null:this.view.getWidgetMountNode()[0])}return this.getFilterController().then((function(){return e.view.adjustMountNodeHeight(e.filterInstance.MIN_HEIGHT,e.filterInstance.HEIGHT),t?e.filterInstance.onOpen():e.filterInstance.render()})).catch(this.view.processError.bind(this.view))},getFilterController:function(){if(this.filterInstance)return this.filterInstance.ready.then(function(){return Promise.resolve(this.filterInstance)}.bind(this)).catch((function(e){return Promise.reject(e)}));var e=this.isRange(),t=a.extend({origin:"filterDock",isRange:e},this.item.getMetadataInfo());return l.getModule(t).then(function(e){return this._initializeFilterController(e)}.bind(this))},_initializeFilterController:function(e){return this._AMD.loadModule(e).then(function(e){var t=e,i=this._getFilterControllerParams(),n=new t(i.options,i.extraOptions);return n.viewConfig.showHeader=!1,n.initialize().then(function(){return this.filterInstance=n,Promise.resolve(this.filterInstance)}.bind(this))}.bind(this)).catch(function(e){return this.filterInstance&&(this.filterInstance.remove(),this.filterInstance=null),this.view.processError(e)}.bind(this))},_getFilterControllerParams:function(){var e={};return e.options={dashboardApi:this.dashboardApi,pageContextAPI:this.pageContextAPI,containerPageId:this.scope,initialConfigJSON:{properties:this._getItemContextProperties()},ajaxSvc:this.ajaxSvc,hasSearchIcon:!0},e.extraOptions={commonView:this.view},e},_getItemContextProperties:function(){return{itemName:this.item.getItemName(),itemId:this.getColumnId(),sourceId:this.getDataSourceId(),dataType:this.getDataType(),isNamedSet:this.isNamedSet(),usage:this.getType(),isHierarchy:this.isHierarchy(),scope:this.getScope()}},update:function(){if(this.view){var e={name:this._getItemMetadataLabel()||this.item.getItemName(),text:this._getFilterText(),selectedCount:this._getSelectCount(),isModeledFilter:this.isModeledFilter(),error:this.getError()};this.view.update(e)}},_getFilterText:function(){return this.isModeledFilter()?r.get("modelFilter"):this.generateSelectedValueString()},getItemDOMnode:function(){return this.view.$el},remove:function(){this.unregisterEvents(),this.unregisterSourceUsage(),this.filterInstance&&(this.filterInstance.remove(),this.filterInstance=null),this.windowResizeHandler&&o(window).off("resize",this.windowResizeHandler),this.view&&(this.view.remove(),this.view=null),this.pageContextAPI=null,this.scope=null,this.item=null},showItemMenu:function(){this.view&&this.view.showItemMenu&&this.view.showItemMenu()},hideItemMenu:function(){this.view&&this.view.hideItemMenu&&this.view.hideItemMenu()}});return u.genFilterItemDockKey=function(e){return e.getKey()},u.isDateDataType=function(e){return"date"===e||"time"===e||"datetime"===e||"timestamp"===e},u})),define("dashboard-analytics/filters/dock/CascadeSetView",["../../lib/@waca/core-client/js/core-client/ui/core/View"],(function(e){return function(e){function t(t){var i,n=t.parentCtrl,r=t.cascadeSet,o=t.filterItems;return(i=e.call(this)||this).cascadeSet=r,i.parentCtrl=n,i.filterItems=o,r.on("change:addColumn",i.parentCtrl.renderFilterItems,i.parentCtrl),r.on("change:removeColumn",i.parentCtrl.renderFilterItems,i.parentCtrl),r.on("change:setPosition",i.parentCtrl.renderFilterItems,i.parentCtrl),i}_inheritsLoose(t,e);var i=t.prototype;return i.addFilterItem=function(e){var t=this,i=!1,n=this.cascadeSet.getColumnIdList();return this.cascadeSet.getDataSourceId()===e.getDataSourceId()&&-1!==n.indexOf(e.getColumnId())&&(this.$el.children().detach(),n.map((function(n){var r=t._getFilterItem(n,t.cascadeSet.getDataSourceId());r&&(t.$el.append(r.getItemDOMnode()),n===e.getColumnId()&&(i=!0))}))),i},i.getDataSourceId=function(){return this.cascadeSet.getDataSourceId()},i.getCascadeSet=function(){return this.cascadeSet},i._getFilterItem=function(e,t){return Object.values(this.filterItems).find((function(i){return i.getDataSourceId()===t&&i.getColumnId()===e}))},i.getNode=function(){return this.$el},i.remove=function(){e.prototype.remove.call(this),this.cascadeSet.off("change:addColumn",this.parentCtrl.renderFilterItems,this.parentCtrl),this.cascadeSet.off("change:removeColumn",this.parentCtrl.renderFilterItems,this.parentCtrl),this.cascadeSet.off("change:setPosition",this.parentCtrl.renderFilterItems,this.parentCtrl),this.cascadeSet=null,this.parentCtrl=null},_createClass(t,[{key:"className",get:function(){return"filter-dock-cascade-container"}}]),t}(e)})),define("dashboard-analytics/filters/dock/CascadeSetsController",["./CascadeSetView"],(function(e){return function(){function t(e){var t=e.cascadeSets,i=e.filterItems,n=e.getParentElem,r=e.populateFilterItems,o=e.cascadingFilters;this.cascadeSets=t,this.filterItems=i,this.getParentElem=n,this.populateFilterItems=r,this.cascadingFilters=o,t&&(this.cascadeSets.on("change:addToCascadeSet",this.onAddToCascadeSet,this),this.cascadeSets.on("change:removeFromCascadeSet",this.onRemoveFromCascadeSet,this),this.cascadeSets.on("change:reorderCascadeSets",this.onReorderCascadeSets,this))}var i=t.prototype;return i._getCascadeViews=function(){var e=this;return this.cascadeSets&&!this.cascadeViews&&(this.cascadeViews=this.cascadeSets.getCascadeSetList().map((function(t){return e._getCascadeView(t)}))),this.cascadeViews||[]},i._getCascadeView=function(t){return new e({cascadeSet:t,filterItems:this.filterItems,parentCtrl:this})},i._findCascadeView=function(e){return this.cascadeViews&&this.cascadeViews.find((function(t){return t.cascadeSet===e}))},i.onAddToCascadeSet=function(){return this.cascadeViews&&this.cascadeViews.forEach((function(e){return e.remove()})),this.cascadeViews=null,this.renderFilterItems()},i._validateView=function(e){return this.cascadeSets.getCascadeSetList().find((function(t){return t===e.cascadeSet}))},i.onRemoveFromCascadeSet=function(e){var t=e.info.value[1],i=this._getCascadeViews().findIndex((function(e){return e.getDataSourceId()===t}));if(-1!==i){var n=this._getCascadeViews()[i];if(!this._validateView(n))this._getCascadeViews().splice(i,1)[0].remove();return this.renderFilterItems()}},i.onReorderCascadeSets=function(e){var t=e&&e.info&&e.info.value;if(this.cascadeViews&&t&&t.length&&this.cascadeViews.find((function(e){return e.getCascadeSet()&&-1!==t.indexOf(e.getCascadeSet().getId())})))return this.cascadeViews.forEach((function(e){return e.remove()})),this.cascadeViews=null,this.renderFilterItems();return!1},i.addToCascadeView=function(e){return this._getCascadeViews().some((function(t){return t.addFilterItem(e)}))},i.renderCascadeViewsAfterFilterItem=function(e){var t=this,i=null,n={dataSourceId:"",columnId:""};e&&(n.dataSourceId=e.getDataSourceId(),n.columnId=e.getColumnId(),i=e.getItemDOMnode());var r=this._getCascadeViews().filter((function(e){var t=e.getCascadeSet().getPosition();return n.dataSourceId===t.dataSourceId&&n.columnId===t.columnId}));return r.forEach((function(e){i?e.getNode().insertAfter(i):t.getParentElem().prepend(e.getNode()),i=e.getNode()})),r.length},i.setIsDeletingFilterItem=function(e){this._isDeletingFilterItem=e},i.renderFilterItems=function(){if(!this._isDeletingFilterItem)return this.populateFilterItems({isGeneralUpdate:function(){return!0}})},i.destroy=function(){this.cascadeSets&&(this.cascadeSets.off("change:addToCascadeSet",this.onAddToCascadeSet,this),this.cascadeSets.off("change:removeFromCascadeSet",this.onRemoveCascadeSet,this),this.cascadeSets.off("change:reorderCascadeSets",this.onReorderCascadeSets,this)),this.cascadeViews&&this.cascadeViews.forEach((function(e){return e.remove()})),this.cascadeViews=null,this.cascadeSets=null,this.filterItems=null,this.getParentElem=null,this.populateFilterItems=null},t}()})),define("text!dashboard-analytics/filters/dock/templates/filterItemAvatar.html",[],(function(){return'<div class="avatar">\n  <div class="metadataContainer">\n    <div class="listitem metadata">\n      {{!it.itemName}}\n    </div>\n  </div>\n</div>\n'})),define("text!dashboard-analytics/filters/dock/templates/cascadeSetAvatar.html",[],(function(){return'<div class="avatar">\n  <div class="metadataContainer">\n    <div class="filter-dock-cascade-container">\n      <div class="listitem metadata avatar-cascade-container">\n        <div class="wa-filterDock-filterItem avatar-cascade-item">{{!it.itemName}}</div>\n        <div class="wa-filterDock-filterItem avatar-cascade-item">...</div>\n      </div>\n    </div>\n  </div>\n</div>'})),define("dashboard-analytics/filters/dock/FilterItemsContainer",["../../lib/@waca/core-client/js/core-client/ui/core/Class","../../lib/@waca/core-client/js/core-client/utils/dom-utils","jquery","underscore","text!./templates/filterItemAvatar.html","text!./templates/cascadeSetAvatar.html","doT"],(function(e,t,i,n,r,o,a){var s=e.extend([],{DND_DRAG_INDEX_FROM_FILTER_PANEL:-2,_filterItemWrapper:"wa-filterDock-filterItem-top",_avatarTemplateFn:a.template(r),_cascadeSetAvatarTemplateFn:a.template(o),init:function(e){s.inherited("init",this,arguments),this.$el=e.$el,this.id=e.id,this.dashboardApi=e.dashboardApi,this.featureChecker=e.featureChecker,this.cascadeSets=e.cascadeSets,this.logger=e.logger,this.pageContextAPI=e.pageContextAPI,this.filtersUI=e.filtersUI,this.handlers=e.handlers,this.avatars={},this.$ancestor=this.$el.closest(".filter-dock-middle"),this.$ancestor.attr("id",this.id),this.$ancestor.addClass(this.id),this.currentCursor=i("body").css("cursor"),this._initializeDnD(),this.cascadeSets&&this.cascadeSets.registerItemPositionsCallback(this._getItemPositionsInFilterDock.bind(this))},destroy:function(){this.htm5DndSvc&&(this.htm5DndSvc.unregisterDropZone(this),this.htm5DndSvc=null),this._dndTarget&&(this._dndTarget.remove(),this._dndTarget=null),this.widgetAddUIHelper&&this.widgetAddUIHelper.destroy(),this.avatars={},s.inherited("destroy",this,arguments)},mouseHoverOverIsValid:function(e){return this.$ancestor&&n.isNumber(this.dragStartIndex)&&t.withinElementBoundaries(e,this.$ancestor[0])},cleanupVisualDisplay:function(){this._removeInsertMarker()},onDragHoverFilterDock:function(e,t,i){var r=this.getDropPosition(i),o=r&&r.isValid&&r.insertBefore?r.insertBefore.index:null;if(n.isNumber(o)||this._isContainerEmpty()){this.dragStartIndex=this.DND_DRAG_INDEX_FROM_FILTER_PANEL;var a=e&&e.data&&e.data.columns.map((function(e){return{columnId:e.metadataColumn.getId(),dataSourceId:e.metadataColumn.getSourceId()}}));this._executeDragOver(i,a,!0,r)}else this._removeInsertMarker()},_isContainerEmpty:function(){return 0===this.$el.find(".filterItemWrapper").length},onDragStart:function(e){this.cleanupInsertMarker();var t=this.$el.find(".filterItemWrapper").index(i(e.target).closest(".filterItemWrapper"));-1!==t&&(this.dragStartIndex=t)},onDragEnter:function(e,t,i){return i.preventDefault(),!1},onDragMove:function(e,t,r){if(this._updateDragStartIndex(r),n.isNumber(this.dragStartIndex)){i("body").css("cursor",this.currentCursor);var o=this.handlers.getFilterItem(e.data.dockkey),a=[{columnId:o.getItemId(),dataSourceId:o.getSourceId()}];this._executeDragOver(r,a)}else this._removeInsertMarker(),i("body").css("cursor","not-allowed");return!1},_executeDragOver:function(e,t,i,n){if(this.mouseHoverOverIsValid(e)||this._isContainerEmpty()){if(i||e.preventDefault(),(n=n||this.getDropPosition(e))&&n.isValid&&n.insertBefore)if(this.cascadeSets&&!this._canDropCascadeSets(t,n.insertBefore.item))this._removeInsertMarker();else{var r=this._getItemsInFilterDock();this._processDragOver(r,n)}else this._removeInsertMarker();this._onChevronEnter(e)}},_canDropCascadeSets:function(e,t){return this.cascadeSets&&this.cascadeSets.canDrop(e,this._toPosition(t))},_processDragOver:function(e,t){var i=this._calcInsertMarkerLocation(e,t);-1===i?this.showInsertMarker&&this._removeInsertMarker():t.insertBefore.displayInsertMarker?this.showInsertMarker&&!t.insertBefore.dndPastEnd||this._renderInsertMarker(e,i,{pastBeginOfList:0===t.insertBefore.index,pastEndOfList:t.insertBefore.dndPastEnd}):this._removeInsertMarker()},_calcInsertMarkerLocation:function(e,t){if(!t||!t.isValid||!t.insertBefore)throw new Error("Invalid position provided when requesting the calculation of the insert marker location");var i=-1;return-1===t.insertBefore.index?this.dragStartIndex!==e.length-1&&(i=e.length-1):this.dragStartIndex!==t.insertBefore.index&&(i=this._calcInsertMarkerInMiddleOfFilterDock(t)),i},_calcInsertMarkerInMiddleOfFilterDock:function(e){var t=-1;return this.dragStartIndex===this.DND_DRAG_INDEX_FROM_FILTER_PANEL||this.dragStartIndex>e.insertBefore.index?t=e.insertBefore.index:e.insertBefore.displayInsertMarker&&e.insertBefore.index-1>=this.dragStartIndex&&(t=e.insertBefore.index,e.insertBefore.index-1===this.dragStartIndex&&(this.showInsertMarker=!0)),t},_renderInsertMarker:function(e,t,n){if(this._removeInsertMarker(),!n)throw new Error("Invalid options provided when request to render insert marker");if(n.pastBeginOfList)this.$beginInsertMarker||(this.$beginInsertMarker=this.$ancestor.find(".filterInsertMarker.inFront")),this.$beginInsertMarker.addClass("showMarker");else if(n.pastEndOfList){this._getEndInsertMarker().addClass("showMarker")}else{var r=i(e[t]);this.$insertMarker=r.find(".inMiddle"),this.$insertMarker.addClass("showMarker")}this.markerDisplayAtIndex=t,this.showInsertMarker=!0},_removeInsertMarker:function(){this.markerDisplayAtIndex=-1,this.showInsertMarker=!1,this.$insertMarker&&(this.$insertMarker.removeClass("showMarker"),this.$insertMarker=null),this.$beginInsertMarker&&this.$beginInsertMarker.removeClass("showMarker"),this.$endInsertMarker&&this.$endInsertMarker.removeClass("showMarker")},_onChevronEnter:function(e){!e||"mousemove"!==e.type&&"touchmove"!==e.type&&"dragover"!==e.type||(this._canClickOnLeftChevronBoundaries(e)?this.leftChevronIntervalId||(this.leftChevronIntervalId=setInterval(function(){this.leftChevronIntervalId&&this._canClickOnLeftChevronBoundaries(e)?this.handlers.chevron.onClickOnLeftChevron():this.clearIntervals()}.bind(this),this.handlers.chevron.delay||300)):this._canClickOnRightChevronBoundaries(e)?this.rightChevronIntervalId||(this.rightChevronIntervalId=setInterval(function(){this.rightChevronIntervalId&&this._canClickOnRightChevronBoundaries(e)?this.handlers.chevron.onClickOnRightChevron():this.clearIntervals()}.bind(this),this.handlers.chevron.delay||300)):this.clearIntervals())},_canClickOnLeftChevronBoundaries:function(e){var i=this.handlers&&this.handlers.chevron?this.handlers.chevron.getLeftChevron():null;return i&&!i.hasClass("disable")&&t.withinElementBoundaries(e,i[0])},_canClickOnRightChevronBoundaries:function(e){var i=this.handlers&&this.handlers.chevron?this.handlers.chevron.getRightChevron():null;return i&&!i.hasClass("disable")&&t.withinElementBoundaries(e,i[0])},getDropPosition:function(e){var t={},i=this.$ancestor.find(".filterItemWrapper").get(),r=this._getDropPosition(e,i);return r&&(t=n.extend(t,r)),t},clearIntervals:function(){window.clearInterval(this.rightChevronIntervalId),this.rightChevronIntervalId=null,window.clearInterval(this.leftChevronIntervalId),this.leftChevronIntervalId=null},cleanupInsertMarker:function(){this.dragStartIndex=null,this._removeInsertMarker()},onDrop:function(e,t,r){this.cleanupInsertMarker();var o=this._getItemsInFilterDock(),a=this._getDropPosition(r,o);if(i("body").css("cursor",this.currentCursor),a.isValid){if(a.insertBefore&&a.insertBefore.dockKey&&a.insertBefore.dockKey===e.data.dockkey)return;if(n.find(o,function(t){return this._getDockKey(i(t))===e.data.dockkey}.bind(this))){var s=this._getItemPositionsInFilterDock(),l=this.dashboardApi.getFeature("Transaction").startTransaction();if(e.data.isCascadeSet)this.cascadeSets.updateCascadeSetsOnDropSet(this._toPosition(this.handlers.getFilterItem(e.data.dockkey)),this._toPosition(a.insertBefore.item),s,l);else{var c=this._toPosition(this.handlers.getFilterItem(e.data.dockkey)),u=this.cascadeSets&&this.cascadeSets.getFinalDropTargetIndex(c,this._toPosition(a.insertBefore.item))||-1;this.featureChecker.checkValue("dashboard","DataFilters","enabled")?this.filtersUI.setPosition(e.data.contentid,-1===u?a.insertBefore.index:u,l):this.pageContextAPI.reOrderPageContextItems(this.handlers.getFilterItem(e.data.dockkey),-1===u?a.insertBefore.item:this._getItemAtIndex(u),l.transactionId),this.cascadeSets&&this.cascadeSets.updateCascadeSetsOnDrop(c,this._toPosition(a.insertBefore.item),l),this.renderFilterItems()}this.dashboardApi.getFeature("Transaction").endTransaction(l)}}},renderFilterItems:function(){return this.handlers.populateFilterItems&&this.handlers.populateFilterItems({isGeneralUpdate:function(){return!0}})},_toPosition:function(e){return e&&e.getItemId&&e.getSourceId&&{columnId:e.getItemId(),dataSourceId:e.getSourceId()}},_getItemAtIndex:function(e){return e===this._getItemsInFilterDock().length?null:this.handlers.getFilterItem(n.unescape(this._getItemsInFilterDock()[e].dataset.dockkey))},_getItemPositionsInFilterDock:function(){var e=this;return this._getItemsInFilterDock().map((function(t){var i=e.handlers.getFilterItem(n.unescape(t.dataset.dockkey));return i&&{dataSourceId:i.getSourceId(),columnId:i.getItemId()}})).filter(Boolean)},_getFilterItemNode:function(e){return this.$el.find('[data-dockkey="'+n.escape(e)+'"]').get()},getDnDPayload:function(e){return Promise.resolve({data:e})},_initializeDnD:function(){var e=this.dashboardApi.getFeature("DashboardDnd.internal");this._dndManager=e,this._dndTarget=this._dndManager.addDropTarget(this.$ancestor,{accepts:function(e){return e&&"wa-filterDock-filterItem-top"===e.type||"filter-dock-cascade-container"===e.type}.bind(this),onDrop:this.onDrop.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragMove:this.onDragMove.bind(this)}),this.$ancestor.on("mousedown dragleft dragright",{itemContainer:this},function(e){i(e.target).hasClass("wa-filterDock-filterItem-top")||i(e.target.parentNode).hasClass("wa-filterDock-filterItem-top")?(e.data.itemContainer.onDragStart(e),this._dndManager.startDrag({event:e,avatar:e.data.itemContainer._getAvatar(i(e.target)),type:"wa-filterDock-filterItem-top",data:e.data.itemContainer._getEntry(e),moveXThreshold:15,moveYThreshold:15})):this._initializeCascadeSetDnD(e,this._getDockKey(i(e.target)),this._getContentId(i(e.target)))}.bind(this))},_initializeCascadeSetDnD:function(e,t,n){var r=this,o=function(e){return i(r._cascadeSetAvatarTemplateFn(function(e){var t={};if(e instanceof i){var n=e.closest(".filter-dock-cascade-container").children(".filterItemWrapper"),r=i(n[0]).find(".wa-filterDock-filterName").text();t.itemName=r,t.itemBoundingClientRect=e.get()[0].getBoundingClientRect()}return t}(e)))};(this.cascadeSets&&i(e.target).hasClass("filter-dock-cascade-container")||i(e.target.parentNode).hasClass("filter-dock-cascade-container"))&&(e.data.itemContainer.onDragStart(e),this._dndManager.startDrag({event:e,avatar:o(i(e.target)),type:"filter-dock-cascade-container",data:function(t,n){return{dockkey:t,contentid:n,options:o(i(e.target)),isCascadeSet:!0}}(t,n),moveXThreshold:10,moveYThreshold:10}))},_getEntry:function(e){var t=i(e.target).closest(".filterItemWrapper");return{dockkey:this._getDockKey(t),contentid:this._getContentId(t),options:this._getAvatar(t)}},_getDockKey:function(e){return e instanceof i?n.unescape(e.closest(".filterItemWrapper").data("dockkey")):""},_getContentId:function(e){return e instanceof i?n.unescape(e.closest(".filterItemWrapper").data("contentid")):""},_getAvatarContext:function(e){var t={};return e instanceof i&&(t.itemName=e.closest(".filterItemWrapper").find(".wa-filterDock-filterName").text(),t.itemBoundingClientRect=e.get()[0].getBoundingClientRect()),t},_getAvatar:function(e){var t=this._getDockKey(e);if(t&&!(t in this.avatars)){var n=i(this._avatarTemplateFn(this._getAvatarContext(e)));this.avatars[t]=n}return this.avatars[t]},_getDropPosition:function(e,t){var r={};if(!e)return r;var o=this._getMousePosition(e),a=o.pageX,s=o.pageY,l=this.$el[0].getBoundingClientRect();if(!t||0===t.length)return r.isValid=!0,r;var c,u=this.$ancestor[0].getBoundingClientRect(),d=i(t[0]).find(".wa-filterDock-filterName")[0].getBoundingClientRect();if(s<d.top||s>d.bottom||a<u.left||a>u.right)return r;if(r.isValid=!0,a<l.left&&a>=u.left){var h=a<=(c=t[0].getBoundingClientRect()).right,g=this._getDockKey(i(t[0]));r.insertBefore={item:this.handlers.getFilterItem(g),dockKey:g,index:0,displayInsertMarker:h}}else if(a>=l.right&&a<=u.right){var p=i(t[t.length-1]),f=(c=p[0].getBoundingClientRect()).right+parseInt(p.css("margin-left"),10)+parseInt(p.css("margin-right"),10),m=a>=c.left&&a<=f;r.insertBefore={item:null,dockKey:null,index:-1,dndPastEnd:!0,displayInsertMarker:m}}else r=n.extend(r,this._findMiddleDroppedPositonForDnd(t,l,u,a));return r},_isWithinThreeQuartersOfElementLeftRightBoundary:function(e,t){var i=Math.round((t.right-t.left)/4);return e>=Math.round(t.left)&&e<=Math.round(t.left+3*i)},_findMiddleDroppedPositonForDnd:function(e,t,n,r){for(var o,a,s,l=0,c=e.length;l<c;l++){if(o=e[l].getBoundingClientRect(),(a=l+1<c?e[l+1].getBoundingClientRect():void 0)&&r>=o.right&&r<=a.left){l+=1,s=!0;break}if(this._isWithinThreeQuartersOfElementLeftRightBoundary(r,o)){s=!0;break}if(r<=o.right)break}var u=l<c;return{isValid:u||r<=n.right,insertBefore:u?{item:this.handlers.getFilterItem(this._getDockKey(i(e[l]))),dockKey:this._getDockKey(i(e[l])),index:l,displayInsertMarker:s}:{item:null,dockKey:null,index:-1,dndPastEnd:!0,displayInsertMarker:!0}}},_getMousePosition:function(e){if(i.fn.supportTouch){var t=e.originalEvent.changedTouches;if(t.length>0)return{pageX:t[0].pageX,pageY:t[0].pageY}}return{pageX:e.originalEvent.pageX,pageY:e.originalEvent.pageY}},_getItemsInFilterDock:function(){return this.$el.find(".filterItemWrapper").get()},_updateDragStartIndex:function(e){!n.isNumber(this.dragStartIndex)&&e.originalEvent&&e.originalEvent.dataTransfer&&(e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.types.length>0&&"filteritem"===e.originalEvent.dataTransfer.types[0].toLowerCase()&&(this.dragStartIndex=this.DND_DRAG_INDEX_FROM_FILTER_PANEL))},_getEndInsertMarker:function(){return this.$endInsertMarker||(this.$endInsertMarker=this.$ancestor.find(".filterInsertMarker.atBack")),this.$endInsertMarker}});return s})),define("dashboard-analytics/filters/dock/ActiveFilterIndicator",["../../lib/@waca/core-client/js/core-client/ui/core/View","../../lib/@waca/core-client/js/core-client/utils/BrowserUtils","underscore"],(function(e,t,i){return function(e){function n(i){var n,r=i.scopes,o=i.pageContextAPI,a=i.featureChecker,s=i.animate;return(n=e.call(this,arguments)||this).scopesObject=r,n.pageContextAPI=o,n.featureChecker=a,n._animate=!0,void 0!==s&&(n._animate=s),t.isIE()&&!t.isIEEdge()&&n.$el.addClass("ie"),n}_inheritsLoose(n,e);var r=n.prototype;return r.show=function(e){e&&this.getActiveCount()>0?(this.setCount(this.getActiveCount()),this.$el.parent().is(":visible")&&this._animate?this.$el.fadeIn():this.$el.show()):this.$el.parent().is(":visible")&&this._animate?this.$el.fadeOut():this.$el.hide()},r._isModeledFilter=function(e){return(e.getMetadataColumnList()||[]).filter((function(e){return e.isFilter()})).length>0},r.getActiveCount=function(){var e=this,t=0;return i.values(this.scopesObject).forEach((function(n){if(e.featureChecker&&e.featureChecker.checkValue("dashboard","DataFilters","enabled"))t+=i.filter(n.getFeature("DataFilters").getFilterList(),(function(t){return t.getValueList().length>0||e._isModeledFilter(t)})).length;else{var r=n.getContainer()?n.getId():"global";t+=i.filter(e.pageContextAPI.getPageContextItems({scope:r,origin:"filter"}),(function(e){return e.getValueCount()>0||e.getIsModeledFilter&&e.getIsModeledFilter()})).length}})),t},r.setCount=function(e){0!==e?(e>99&&(e="99+"),this.$el.text(e)):this._animate?this.$el.fadeOut("default",function(){this.$el.text(e)}.bind(this)):(this.$el.hide(),this.$el.text(e))},r.setScope=function(e,t){this.scopesObject[e]=t},r.getNode=function(){return this.$el},r.remove=function(){n.inherited("remove",this,arguments),this.scopesObject=null,this.pageContextAPI=null},_createClass(n,[{key:"tagName",get:function(){return"div"}},{key:"className",get:function(){return"filterAppliedIndicator"}}]),n}(e)})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/api/DnDProviderAPI",[],(function(){return function(){function e(){_classCallCheck(this,e)}return e.prototype.accepts=function(){},e.prototype.onDrop=function(){},e}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/Events",["../lib/@waca/core-client/js/core-client/utils/UniqueId","../lib/@waca/core-client/js/core-client/ui/core/Events"],(function(e,t){return function(t){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(i,t),i.prototype.on=function(i,n,r){var o=t.prototype.on.call(this,i,n,r),a=this._events[i].length-1,s=this._events[i][a];return s.id=e.get("__api_eventHandler_"),s.eventName=i,o},i.prototype.setTransaction=function(e){this.transaction||(this.transaction=e)},i.prototype.trigger=function(e,t){var i=this,n=[].concat(this._events.all||[]),r=[],o=e.split(":");if(o.length>1){var a=[];o.forEach((function(e){var t=e;a.length>0&&(t=a[a.length-1]+":"+e),a.push(t)})),a.forEach((function(t){i._events[t]&&(t===e?n.push.apply(n,i._events[t]):r.push.apply(r,i._events[t]))}))}else this._events[e]&&n.push.apply(n,this._events[e]);for(var s=0;s<n.length;s++)if("function"==typeof n[s].handler)try{n[s].handler.call(n[s].context,t,e)}catch(t){console.error("Error when trigger event:"+e,t)}if(this.transaction&&t.transactionToken)for(var l=function(e){if("function"==typeof r[e].handler){var n=r[e].id,o=r[e].eventName;i.transaction.registerTransactionHandler(t.transactionToken,n,(function(t){var n=r[e].handler;i._events[o].find((function(e){return e.handler===n}))&&n.call(r[e].context,{name:o,info:{events:t},transactionToken:t[0].transactionToken},t)}),t)}},c=0;c<r.length;c++)l(c);else for(var u=0;u<r.length;u++)"function"==typeof r[u].handler&&r[u].handler.call(r[u].context,t,e)},i}(t)})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/EventEmitter",["./Events","../utils/CommonUtil"],(function(e,t){return function(){function i(t,n){_classCallCheck(this,i),this.events=t.events||new e,this.events.setTransaction(n),this.name=t.name,this.isDisableTriggerOnSelf=!0,this.enableEventPropagation(t)}return i.prototype.enableTriggerOnSelf=function(){this.isDisableTriggerOnSelf=!1},i.prototype.enableEventPropagation=function(e){this.info=e.info,this.namespace=e.namespace,this.callStack=e.callStack,this.parentEventEmitter=e.parentEventEmitter},i.prototype.on=function(){return this.events.on.apply(this.events,arguments)},i.prototype.off=function(){return this.events.off.apply(this.events,arguments)},i.prototype.deepFreeze=function(e){if(!Object.isFrozen(e)){var t=Object.getOwnPropertyNames(e),i=Array.isArray(t),n=0;for(t=i?t:t[Symbol.iterator]();;){var r;if(i){if(n>=t.length)break;r=t[n++]}else{if((n=t.next()).done)break;r=n.value}var o=r,a=e[o];e[o]=a&&"object"===(void 0===a?"undefined":_typeof(a))?this.deepFreeze(a):a}e=Object.freeze(e)}return e},i.prototype.trigger=function(e,i){i||(e=JSON.parse(JSON.stringify(e)));var n=e.transactionToken,r=e.bubbleInfo,o=r?r.callStack:null;if(!this.isDisableTriggerOnSelf){var a=Object.assign({},e.tracking);a.callStack=o?o.concat():[];var s=(e.type||"change")+":"+e.name,l=this.deepFreeze({name:s,info:e.info||{},tracking:a,transactionToken:n,context:e.context||{}});this.events.trigger(s,l)}if(this.parentEventEmitter){o||(o=[]),o.unshift(this.callStack);var c={name:this.namespace?this.namespace+":"+e.name:e.name,info:t.deepExtend(this.info,e.info,!0),type:e.type,tracking:e.tracking,transactionToken:e.transactionToken,bubbleInfo:{callStack:o},context:Object.assign({},e.context)};this.parentEventEmitter.trigger(c,!0)}},i}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/APIEventSupport",["./EventEmitter","underscore"],(function(e,t){return function(){function i(t,n,r,o){var a=this;_classCallCheck(this,i),this.apiImplementation=t,this.eventSpec=this.createSpec(n),this.apiName=r;var s=this.getEventEmitterOptions(),l=o&&o["Dashboard.Transaction"];this.eventEmitter=new e(s,l),this.apiImplementation.getEventSupport=function(){return a},this.apiImplementation.on=this.on.bind(this),this.apiImplementation.off=this.off.bind(this),this.eventSpec.serializeActions&&(this.apiImplementation.serializeActions=this.serializeActions.bind(this))}return i.prototype.isSupported=function(e){return!!this.getActionSpec(e)},i.prototype.extendAPI=function(e,t){this.apiInstance=e,t.prototype.on&&this.eventEmitter.enableTriggerOnSelf()},i.prototype.serializeActions=function(){var e=[],t=this.eventSpec.actions,i={};if(t){var n=void 0;for(n in t){if(t[n].isResolvePostResponse)throw new Error("serializeActions is not supported when isResolvePostResponse = true for "+n);var r=this.getUndoActions(t[n],n);if(1!==r.length)throw new Error("serializeActions is not supported when undoActions length is not 1");if(Array.isArray(r[0].params)){var o=!0;if(r[0].params.forEach((function(e){null!=e&&(o=!1)})),!o){var a=JSON.stringify(r[0]);i[a]||(i[a]=!0,e.push(r[0]))}}}}return this.eventSpec.serializeActions.children&&this.eventSpec.serializeActions.children.forEach((function(t){if("function"==typeof t.getObject){var i=t.getObject();if(i&&"function"==typeof i.serializeActions){var n=i.serializeActions();n.forEach((function(e){e.callStack=t.callStack})),e.push.apply(e,n)}}})),e},i.prototype.createSpec=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.actions,n=void 0,r=function(){var t,r=n,o=i[n].transactionParamIndex;if(i[n].getUndoActions||(i[n].getUndoActions=function(){return[{name:r,params:[]}]}),i[n].autoCreateTransaction&&!i[n].onBeforeAction&&!i[n].onAfterAction&&i[n].transactionAPI){var a=i[n].transactionAPI;i[n].onBeforeAction=function(e){var t={};return e[o]||(e[o]=a.startTransaction(),t.transactionCreated=!0),t},i[n].onAfterAction=function(e,t,i){i.transactionCreated&&a.endTransaction(e[o])}}i[n].getAction||(i[n].getAction=function(t){var i=t.filter((function(i,n){return!(n===t.length-1&&e._isTransactionToken(i))}));return{name:r,params:i}}),i[n].getInfo||(i[n].getInfo=function(t){var i=t.filter((function(i,n){return!(n===t.length-1&&(n===o||e._isTransactionToken(i)))})),n={};return 1===i.length?n.value=i[0]:i.length>1&&(n.value=i),n}),i[n].getTransactionToken||(i[n].getTransactionToken=(t=i[n],function(i){var n=null;if(i.length>0){var r=i[void 0===t.transactionParamIndex?i.length-1:t.transactionParamIndex];e._isTransactionToken(r)&&(n=r)}return n}))};for(n in i)r();return t},i.prototype._isTransactionToken=function(e){return e&&(e.transactionId||e.__transaction)},i.prototype.getUndoActions=function(e,t,i,n){var r=e.getUndoActions(i,n);return r.forEach((function(e){e.name||(e.name=t)})),r},i.prototype.onBeforeAction=function(e,t,i){var n={},r=this.getActionSpec(e);r&&i&&i.transactionToken&&(t[void 0!==r.transactionParamIndex?r.transactionParamIndex:t.length]=i.transactionToken);return r&&"function"==typeof r.onBeforeAction&&(n.options=r.onBeforeAction(t)),r&&"function"==typeof r.getUndoActions&&!r.isResolvePostResponse&&(n.undoActions=this.getUndoActions(r,e,t)),n},i.prototype.onAfterAction=function(e,i,n,r,o){var a=this.getActionSpec(e);if(a&&"function"==typeof a.getAction&&"function"==typeof a.getInfo&&"function"==typeof a.getTransactionToken&&"function"==typeof a.getUndoActions){var s=a.getAction(i,n);if(s.name=e,a.isResolvePostResponse&&(r.undoActions=this.getUndoActions(a,e,i,n)),(a.isTriggerEvent||function(e,t){var i=t.length>1;if(!i){var n=t[0]||{};if(!(i=e.name!==n.name))i=(e.params?JSON.stringify(e.params):"[]")!==(n.params?JSON.stringify(n.params):"null")}return i})(s,r.undoActions,n)){var l=a.getInfo(i,n,r);a.info&&t.extend(l,a.info),l.actionName||(l.actionName=e);var c=a.getTransactionToken(i)||{__transaction:!0};"event"===(c=JSON.parse(JSON.stringify(c))).source?c.eventGenerated=!0:c.source="event";var u=void 0;u="function"==typeof a.getEventName?a.getEventName(i):a.eventName;var d={type:a.type||"change",name:u,info:l,tracking:{action:s,undoActions:r.undoActions},transactionToken:c,context:o?o.toJSON():void 0};o&&o.addEvent(d),this.triggerEvent(d)}a&&"function"==typeof a.onAfterAction&&a.onAfterAction(i,n,r.options)}},i.prototype.getActionSpec=function(e){return this.eventSpec.actions&&this.eventSpec.actions[e]},i.prototype.enableChildEventPropagation=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof e.getEventSupport){var i=e.getEventSupport();t.parentEventEmitter=this.eventEmitter,i.enableEventPropagation(t)}},i.prototype.enableEventPropagation=function(e){this.propagationInfo=e,this.eventEmitter&&this.eventEmitter.enableEventPropagation(this.getEventEmitterOptions())},i.prototype.getEventEmitterOptions=function(){var e=this.eventSpec.propagationInfo?JSON.parse(JSON.stringify(this.eventSpec.propagationInfo)):{};if(this.propagationInfo){var i=void 0;for(i in this.propagationInfo)e[i]?t.extend(e[i],this.propagationInfo[i]):e[i]=this.propagationInfo[i]}return e.name=this.apiName,e},i.prototype.triggerEvent=function(e){this.eventEmitter&&this.eventEmitter.trigger(e)},i.prototype.on=function(e,t,i){if(this.eventEmitter)return this.eventEmitter.on(e,t,i)},i.prototype.off=function(e,t,i){this.eventEmitter&&this.eventEmitter.off(e,t,i)},i}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/APIExtension",["./APIEventSupport"],(function(e){return function(){function t(e){_classCallCheck(this,t),this.apiImplementation=e,this.apiExtensions={};var i=void 0;if("function"==typeof e.getAPISpec&&(i=e.getAPISpec()),i){var n=void 0;for(n in i){var r=this.createExtension(e,n,i.events,i.name,i.features);r&&(this.apiExtensions[n]=r,this._enabled=!0)}}}return t.getAPIExtension=function(e){return e.__apiExtension||(e.__apiExtension=new t(e)),e.__apiExtension},t.prototype.extendAPI=function(e,t){var i=void 0;for(i in this.apiExtensions)this.apiExtensions[i].extendAPI&&this.apiExtensions[i].extendAPI(e,t)},t.prototype.createExtension=function(t,i,n,r,o){if("events"===i)return new e(t,n,r,o)},t.prototype.isEnabled=function(){return!!this._enabled},t.prototype.getSupport=function(e){return this.apiExtensions[e]},t.prototype.isSupported=function(e){for(var t in this.apiExtensions)if(this.apiExtensions[t].isSupported(e))return!0;return!1},t.prototype.onBeforeAction=function(e,t,i){var n={},r=void 0;for(r in this.apiExtensions)n[r]=this.apiExtensions[r].onBeforeAction(e,t,i);return n},t.prototype.onAfterAction=function(e,t,i,n,r){var o=void 0;for(o in this.apiExtensions)n[o]=this.apiExtensions[o].onAfterAction(e,t,i,n[o],r)},t}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/APIContext",["underscore"],(function(e){return function(){function t(i){_classCallCheck(this,t),this.options=i,e.extend(this,i),this._events=[]}return t.prototype.toJSON=function(){return this.options},t.prototype.addEvent=function(e){this._events.push(e)},t.prototype.getEventList=function(){return this._events},t}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/utils/MemUtil",[],(function(){var e=new WeakMap,t=function(){};return function(){function i(){_classCallCheck(this,i)}return i.destroy=function(i){var n=e.get(i.__proto__);if(!n)for(var r in n={},e.set(i.__proto__,n),i.__proto__)"function"==typeof i.__proto__[r]&&(n[r]=t);for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&("function"==typeof i[o]?i[o]=t:delete i[o]);i.__proto__=n,i.__destroyed__=!0},i.isDestroyed=function(e){return e.__destroyed__},i}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/core/APIFactory",["./APIExtension","./APIContext","../utils/MemUtil"],(function(e,t,i){var n=function(){},r={},o={},a=function e(t,i){_classCallCheck(this,e),Object.defineProperty(this,"getInterfaceType",{configurable:!1,value:function(){return t}}),Object.defineProperty(this,"getImplType",{configurable:!1,value:function(){return i}})},s=function(t){return e.getAPIExtension(t)},l=function(e,n,a){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=new WeakMap;c.set(r,n),c.set(o,l.logger);var u=l.isDeprecated,d=s(n),h=n[a];if(!h)throw new Error('The method "'+a+'" is not part of the provided implementation');if(!(h instanceof Function))throw new Error('The method "'+a+'" is not a function in the provided implementation');u?e[a]=function(){try{throw new Error}catch(t){(c.get(o)||console).log('The function "'+a+'" of the API "'+e.getInterfaceType()+'" is deprecated',{callStack:t.stack})}var t=c.get(r);if(t)try{return t[a].apply(t,arguments)}catch(e){if(!t||t.__api__destroyed)throw new Error("Access to a destroyed API instance");throw e}}:d.isEnabled()&&d.isSupported(a)?e[a]=function(){var e=[].concat(Array.prototype.slice.call(arguments)),n=void 0;e[0]instanceof t&&(n=e[0],e.shift());var o=d.onBeforeAction(a,e,n),s=c.get(r),l=void 0;try{l=s[a].apply(s,e)}catch(e){if(!s||i.isDestroyed(s))throw new Error("Access to a destroyed API instance");throw e}return l instanceof Promise?l.then((function(t){d.onAfterAction(a,e,t,o,n)})):d.onAfterAction(a,e,l,o,n),l}:e[a]=function(){var e=c.get(r);return e[a].apply(e,arguments)}},c=function(e,t,i){Object.defineProperty(e,t,{value:i,writable:!1})},u=function(e,t,r,o){if(!(r instanceof Function))throw new Error("The interface is not a class");if(s(t).extendAPI(e,r),t.destroy||(t.destroy=n),t.destroy instanceof Function&&!t.____destroy____){var a=new WeakMap,u={},d={};a.set(u,t),a.set(d,e),t.____destroy____=t.destroy,t.destroy=function(){var e=a.get(u),t=a.get(d);e.off&&e.off(),e.____destroy____.apply(e,arguments),t&&i.destroy(t),e&&i.destroy(e)}}for(var h=Object.getOwnPropertyNames(r.prototype),g=0;g<h.length;g++){var p=h[g];r.prototype[p]instanceof Function&&"constructor"!==p&&l(e,t,p,o)}var f=Object.getOwnPropertyNames((function e(){_classCallCheck(this,e)})),m=Object.keys(r),v=Object.getOwnPropertyNames(r).filter((function(e){return!f.includes(e)}));m.push.apply(m,v);for(var b=0;b<m.length;b++){var y=m[b];r[y]instanceof Function||c(e,y,r[y])}if(o.deprecatedPropList)for(var _=0;_<o.deprecatedPropList.length;_++){var C=o.deprecatedPropList[_];c(e,C,t[C])}},d=function(e,t){return new a(e.name,t)};return new(function(){function e(){_classCallCheck(this,e)}return e.prototype.setParentChildRelation=function(e,t,i){var n=s(t),r=i&&i.propagationInfo,o=s(e).getSupport("events");o&&n.getSupport("events")&&o.enableChildEventPropagation(t,r)},e.prototype.createAPI=function(e,t,i){if(!t||0===t.length)throw new Error("An interface must be defined");s(e);for(var n=e.constructor?e.constructor.name:"anonymous",r=d(t[0],n),o=0;o<t.length;o++){var a=t[o];u(r,e,a,i||{})}return r},e.prototype.refreshAPI=function(e,t){if(e instanceof a==!1)throw new Error("An API instance must be created");return t.forEach((function(e){s(e)})),Object.getOwnPropertyNames(e).forEach((function(i){if(Object.getOwnPropertyDescriptor(e,i).configurable){var n=void 0;if(t&&(n=t.find((function(e){return e[i]instanceof Function}))),!n)throw new Error('The method "'+i+'" is not part of the provided implementations');l(e,n,i)}})),e},e.prototype.createAPIFromSpec=function(e){if(!e||0===e.length)throw new Error("A spec must be defined");var t=e.length>0&&e[0].implementation.constructor?e[0].implementation.constructor.constructor.name:"anonymous",i=d(e[0].interface,t);return e.forEach((function(e){s(e.implementation),u(i,e.implementation,e.interface,e.options||{})})),i},e}())})),define("dashboard-analytics/features/dashboard/dnD/api/impl/MetadataDnD",["../../../../../lib/@waca/dashboard-common/dist/api/DnDProviderAPI","../../../../../lib/@waca/dashboard-common/dist/core/APIFactory","underscore"],(function(e,t,i){var n=["MODEL_ITEM","GRID_HEADER_ITEM"];return function(){function r(e){void 0===e&&(e={}),this.features=e.features;var t=this.features.CanvasDnD;if(!t)throw new Error("MetadataDnD should depend on the CanvasDnD dashboard feature");t.registerProvider(this.getAPI())}var o=r.prototype;return o.getAPI=function(){return this.api||(this.api=t.createAPI(this,[e])),this.api},o.destroy=function(){this.api=null},o.accepts=function(e,t){return r.canAccepts(e,t)},r.canAccepts=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),!(!(e.data&&e.data.utils&&e.data.utils.isValid(t))||-1===n.indexOf(e.type))},o.onDrop=function(e){if(void 0===e&&(e={}),!e.data||-1===n.indexOf(e.type))return null;var t=[],r=[],o=e.data.columns?e.data.columns:[],a=i.map(o,(function(e){return e.original.metadataColumn})),s=i.reduce(a,(function(e,t){var n=t.getParent(),r=n&&"DrillGroup"===n.getObjectType()&&"function"==typeof n.getIdentifier?n.getId():null,o=t.getId();if(r&&o){var a={};return a[o]=r,i.defaults(e,a)}return e}),{}),l=i.map(o,(function(e){return e.metadataColumn})),c=[];l.forEach((function(e){e.isFilter()?r.push({id:e.getId(),columnId:e.getId()}):(c.push(e.getId()),t.push({itemId:e.getId(),itemLabel:e.getLabel()}))}));var u=e.data.utils.getColumnsWithMembers();l.forEach((function(e){var t=u[e.getId()];if(t&&t.length>0){var i={id:e.getId(),columnId:e.getId(),overrideHierarchyDefaultSelection:!0,excludedValues:[],operator:"in",type:null,values:[]};t.forEach((function(e){i.values.push({d:e.memberCaption,u:e.id})})),r.push(i)}}));var d={type:"live",data:{dataViews:[{modelRef:e.data.sourceId,dataItems:t}]}};return d.data.dataViews.forEach((function(e){e.dataItems.forEach((function(e){e.navigationPathId=s[e.itemId]||null}))})),r.length&&(d.localFilters=r),Promise.resolve(d)},r}()})),define("dashboard-analytics/filters/dock/FilterDockView",["../../lib/@waca/core-client/js/core-client/ui/core/View","text!./templates/filterDock.html","jquery","./FilterDockItemController","./CascadeSetsController","../utils/FilterMenu","./FilterItemsContainer","./ActiveFilterIndicator","../../features/dashboard/dnD/api/impl/MetadataDnD","../../dataSources/utils/DatasourceUtil","underscore"],(function(e,t,i,n,r,o,a,s,l,c,u){var d="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",h=e.extend({templateString:t,className:"filterDock",events:{"primaryaction .filter-dock-begin":"clickFilterDockIcon","primaryaction .filterDockChevronLeft":"clickOnLeftChevron","primaryaction .filterDockChevronRight":"clickOnRightChevron","primaryaction .filter-dock-overflow":"toggleDropdownMenu","touchend .filter-dock-overflow":"toggleDropdownMenu","escapeaction .filter-dock-overflow, .filter-menu":"closeDropdownMenu"},scope:null,label:null,tooltip:null,dropZoneTooltip:null,chevronAnimationDuration:300,init:function(e,t){this.handlers={},t.className&&(this.className+=" "+t.className),this.content=e.content,this.dataFilters=this.content.getFeature("DataFilters"),this.filtersUI=this.content.getFeature("FiltersUI"),this.id=t.id,this.scope=t.scope,this.selector={origin:"filter",scope:this.scope},this.datasource="",this.label=t.label,this.tooltip=t.tooltip,this.dropZoneTooltip=t.dropZoneTooltip,this.overflowMenuAriaLabel=t.overflowMenuAriaLabel,this.chevron_left=t.chevron_left,this.chevron_right=t.chevron_right,this.parentLayoutId=t.parentLayoutId,this.singleDockMode=t.singleDockMode,this.excludeAddToCanvas=t.excludeAddToCanvas,h.inherited("init",this,arguments),this.onClickFilterDockIcon=e.handlers.onClickFilterDockIcon,this.onAddRemoveFilterItem=e.handlers.onAddRemoveFilterItem,this.ajaxSvc=t.ajaxSvc,this.dashboardApi=e.dashboardApi,this.canvas=e.canvas,this.transaction=this.dashboardApi.getFeature("Transaction"),this._iconsFeature=this.dashboardApi.getFeature("Icons"),this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this.featureChecker=this.dashboardApi.getGlassCoreSvc(".FeatureChecker"),this.cascadingFilters=this.dashboardApi.getFeature("CascadingFilters"),this.pageContextAPI=e.pageContextAPI,this.viewModel=e.viewModel,this.authorHint=e.authorHint,this.consumeHint=e.consumeHint,this.filterItemsMap={},this.menu=new o({menuActionHandler:e.handlers.menuActionHandler}),this.handlers.windowResizeHandler=this._evaluateScrollState.bind(this),this.handlers.animationFinished=this.trigger.bind(this,"animation-finished"),i(window).on("resize",this.handlers.windowResizeHandler),this.on("resize",this._evaluateScrollState,this),this.$el.on(d,this.handlers.animationFinished),this.afi=new s({scopes:"global"===this.scope?{globalScope:this.canvas.getContent()}:{tabScope:this.canvas.getContent(this.scope)},featureChecker:this.dashboardApi.getGlassCoreSvc(".FeatureChecker"),pageContextAPI:this.pageContextAPI,location:"Icon"}),this.populateFilterItemsPayload=[],this._initializeCascadeScope()},_evaluateScrollState:function(){this._setChevronActiveStates(),this._enableScrolling(this._shouldWeEnableScrolling())},render:function(e){var t=this;return this.$el.html(this.dotTemplate({scope:this.scope,label:this.label,tooltip:this.tooltip,dropZoneTooltip:this.dropZoneTooltip,chevron_left:this.chevron_left,chevron_right:this.chevron_right,overflowMenuAriaLabel:this.overflowMenuAriaLabel,emptyLabel:e?this.authorHint:this.consumeHint,isAuthoring:e,filterDockIcon:this._iconsFeature.getIcon("filter").id})),this._getItemsEl(),this.menu.render({viewModel:this.viewModel,mountNode:this.getFilterMenuMountNode()}).then((function(){e||t.hideMenu(),t.populateFilterItems(),t.$el.find(".filterDockIconContainer").append(t.afi.getNode()),t.afi.setCount(t.afi.getActiveCount()),t.initalizeDnD()}))},populateFilterItems:function(e){var t=this;if((e=e||{}).isInScope&&!e.isInScope(this.scope))return Promise.resolve();u.isEmpty(e)||this.populateFilterItemsPayload.push(e);return function e(n){return t.payloadInProgress?Promise.resolve():(t.payloadInProgress=n,(!!i.isFunction(n.isGeneralUpdate)&&n.isGeneralUpdate()||n.beforeItem)&&(t._currentScrollLeft=t._getItemsEl().scrollLeft(),t.removeAllFilterItems()),t.renderItems().then(t._setupFilterItemWrapperInteraction.bind(t)).finally((function(){t.payloadInProgress=null;var n=t.populateFilterItemsPayload.pop();if(t.populateFilterItemsPayload.length>0)return e(n);n&&0===t.populateFilterItemsPayload.length&&(t._setChevronActiveStates(),t._enableScrolling(t._shouldWeEnableScrolling()),t.populateFilterItemsPayload=[],function(e){return!!i.isFunction(e.isAdd)&&e.isAdd()}(n)&&function(e){return i.isFunction(e.getItems)&&e.getItems().some((function(e){return"filter"===e.getOrigin()}))}(n)&&t.$el.find(".filter-dock-middle").focus())})))}(e)},_getItemsEl:function(){return this.$filterItemsContainer||(this.$filterItemsContainer=this.$el.find(".filter-items-container")),this.$filterItemsContainer},_getElementToInsertBefore:function(){if(!this.$insertBefore){var e=this._getItemsEl();this.$insertBefore=e.find(".filterInsertMarker.atBack")}return this.$insertBefore},_shouldWeEnableScrolling:function(){var e=this._getItemsEl(),t=e[0].offsetWidth;return e[0].scrollWidth>t},removeStaleFilterItemsFromMap:function(e){var t=e.getItems().map((function(e){return n.genFilterItemDockKey(e)}));for(var i in this.filterItemsMap)this.filterItemsMap.hasOwnProperty(i)&&-1!==t.indexOf(i)&&this.removeFilterItem(this.filterItemsMap[i])},renderItems:function(){var e=this,t=this.pageContextAPI.getPageContextItems(this.selector),i=Promise.resolve(),n=[],r=this.filtersUI&&this.filtersUI.getFilterContentList();return this.cascadeSetsController.renderCascadeViewsAfterFilterItem(),t.forEach((function(t,o){t.shouldOpenViewOnLoad()&&n.push(t),i=i.then((function(){return e.addFilterItem(t,r&&r[o],null).then((function(t){return e.cascadeSetsController.renderCascadeViewsAfterFilterItem(t),t}))}))})),i.then((function(){e._currentScrollLeft&&e._currentScrollLeft>0&&(e._getItemsEl().scrollLeft(e._currentScrollLeft),e._currentScrollLeft=0),n.forEach((function(t){e._showDropdownFilterForItem(t)}));var i=!t||0===t.length;e._toggleEmptyView(i),e.menu.toggleDisableOverflow(i),e._enableScrolling(e._shouldWeEnableScrolling()),e._setChevronActiveStates()}))},changeToConsumeMode:function(){this.$el.find(".empty-view > span").text(this.consumeHint),this.hideMenu()},changeToAuthorMode:function(){this.$el.find(".empty-view > span").text(this.authorHint),this.showMenu()},removeAllFilterItems:function(){for(var e in this.filterItemsMap)this.filterItemsMap.hasOwnProperty(e)&&this.removeFilterItem(this.filterItemsMap[e])},_initializeCascadeScope:function(){this.cascadeSets=this.content.getFeature("CascadeSets"),this.cascadeSetsController&&this.cascadeSetsController.destroy(),this.cascadeSetsController=new r({cascadeSets:this.cascadeSets,filterItems:this.filterItemsMap,getParentElem:this._getItemsEl.bind(this),populateFilterItems:this.populateFilterItems.bind(this),cascadingFilters:this.cascadingFilters})},switchTabScope:function(e){this.content=e,this.dataFilters=this.content.getFeature("DataFilters"),this.filtersUI=this.content.getFeature("FiltersUI"),this.scope=e.getId(),this.selector.scope=this.scope,this._initializeCascadeScope(),this.afi.setScope("tabScope",this.canvas.getContent(this.scope)),this.afi.setCount(this.afi.getActiveCount()),this.removeAllFilterItems(),this.renderItems(),this._setupFilterItemWrapperInteraction()},addDatasourceToFilterSelector:function(e){this.datasource=e,this.selector.sourceId=this.datasource,this.selector._strictMatch=!0,this.datasource||(delete this.selector.sourceId,delete this.selector._strictMatch)},switchDatasource:function(e,t){this.addDatasourceToFilterSelector(e),t&&t.silent||(this.afi.setScope("tabScope",this.canvas.getContent(this.scope)),this.afi.setCount(this.afi.getActiveCount()),this.removeAllFilterItems(),this.renderItems(),this._setupFilterItemWrapperInteraction())},initalizeDnD:function(){var e=this.dashboardApi.getFeature("DashboardDnd.internal");this._dndTarget=e.addDropTarget(this.$el,{accepts:function(e){var t=u.map(e&&e.data&&e.data.columns,(function(e){return e.metadataColumn}));if(0===t.length)return!1;for(var i=0;i<t.length;i++)if(!c.metadataColumnSupportsFiltering(t[i]))return!1;return l.canAccepts(e,{fromFilterDock:!0})}.bind(this),onDragMove:this.onDragOver.bind(this),onDragLeave:this.onDragLeave.bind(this),onDrop:this.onDrop.bind(this),priority:-100})},onDrop:function(e,t,i){var n=this;if(this.itemsContainer){this.itemsContainer.clearIntervals(),this.itemsContainer.cleanupInsertMarker();var r=this.itemsContainer.getDropPosition(i);if(r&&r.isValid){var o=this.transaction.startTransaction(),a=this.transaction.startTransaction(o);return this._updateFilterContent(e,r,o).then((function(){n._updateFilterContext(e,r,a)}))}}},_updateFilterContent:function(e,t,i){var n=this;if(!this.featureChecker.checkValue("dashboard","DataFilters","enabled"))return this.transaction.endTransaction(i),Promise.resolve();var r=[];return u.map(e&&e.data&&e.data.columns,(function(e){return e.metadataColumn})).forEach((function(o){var a=t&&t.insertBefore&&t.insertBefore.index;r.push(n.filtersUI.addFilterContent(void 0,a).then((function(t){var r=t.getFeature("Visualization");r.setDataSource(e.data.sourceId),r.getSlots().createDataItems([{columnId:o.getId()}],i),n.filtersUI.createFilterVisualization(t.getId(),i)}),i))})),Promise.all(r).then((function(){n.transaction.endTransaction(i)}))},_updateFilterContext:function(e,t,i){for(var n=this,r=i.transactionId,o=null,a=u.map(e&&e.data&&e.data.columns,(function(e){return e.metadataColumn})),s=function(){var s=a[l],c={sourceId:e.data.sourceId,itemId:s.getId(),itemName:s.getLabel(),dataType:s.getDataType(),usage:s.getType(),scope:n.scope,isHierarchy:s.isHierarchy(),isNamedSet:s.isNamedSet(),openViewOnLoad:1===a.length&&!s.isNamedSet(),isModeledFilter:"Filter"===s.getObjectType()},d={command:"update"};if("range"===n._getPageContextType(s.getDataType(),s.getType()))d.condition={};else{d.values=[];var h=e.data.utils.getColumnsWithMembers()[s.getId()];u.each(h,(function(e){return d.values.push({u:e.id,d:e.memberCaption})})),c.openViewOnLoad=c.openViewOnLoad&&0===d.values.length}var g=o||t.insertBefore&&t.insertBefore.item;n.pageContextAPI.updateFilterContext(c,d,{beforeItem:g,initialDrop:!0,payloadData:{undoRedoTransactionId:r,transactionToken:i}});var p=n.pageContextAPI.getPageContextItem(c),f=n.itemsContainer._toPosition(p),m=n.itemsContainer._toPosition(g);n.cascadeSets&&n.cascadeSets.updateCascadeSetsOnDrop(f,m,i),o=p},l=a.length-1;l>=0;l--)s();this.transaction.endTransaction(i)},_getPageContextType:function(e,t){return"fact"===t||"date"===e||"time"===e||"datetime"===e||"timestamp"===e?"range":"tupleset"},handleSkipDragOver:function(e,t){this.onDragOver(e,t)},onDragOver:function(e,t,i){this.itemsContainer&&this.itemsContainer.onDragHoverFilterDock(e,t,i)},onDragLeave:function(){this.itemsContainer&&this.itemsContainer.clearIntervals()},addFilterItem:function(e,t,r){var o=this,a=new Promise((function(a){var s=n.genFilterItemDockKey(e),l=o.filterItemsMap[s];if(l)l.update(),a(null);else{var c={item:e,filterContent:t,filtersUI:o.filtersUI,dataFilters:o.dataFilters,pageContextAPI:o.pageContextAPI,dashboardApi:o.dashboardApi,featureChecker:o.featureChecker,scope:o.scope,ajaxSvc:o.ajaxSvc,dockKey:s,onDelete:o.removeFilterItem.bind(o),getFilterItem:o.getFilterItem.bind(o),parentLayoutId:o.parentLayoutId,singleDockMode:o.singleDockMode,excludeAddToCanvas:o.excludeAddToCanvas,cascadingFilters:o.cascadingFilters,cascadeSets:o.cascadeSets,cascadeSetsController:o.cascadeSetsController},u=new n(c);o.filterItemsMap[s]=u,o.onAddRemoveFilterItem(e,o.scope,!0),u.ready.then((function(){var e=o._getItemsEl(),t=e.find(".filterItemWrapper").get();if(u.view)if(o.cascadeSetsController.addToCascadeView(u))a(u);else if(0!==t.length&&r&&r.insertBefore&&r.insertBefore.node){i(u.getItemDOMnode()).insertBefore(r.insertBefore.node)}else{var n=o._getElementToInsertBefore();n&&n.length>0?u.getItemDOMnode().insertBefore(n):e.append(u.getItemDOMnode())}else a();a(u)}))}}));return this._toggleEmptyView(!1),this.menu.toggleDisableOverflow(!1),a},_getLeftChevron:function(){return this._leftChevron||(this._leftChevron=this.$el.find(".filterDockChevronLeft")),this._leftChevron},_getRightChevron:function(){return this._rightChevron||(this._rightChevron=this.$el.find(".filterDockChevronRight")),this._rightChevron},_enableSwipeChevron:function(e,t){(e?this._getLeftChevron():this._getRightChevron()).toggleClass("disable",!t)},_enableScrolling:function(e){var t=this._getLeftChevron(),i=this._getRightChevron();t.toggleClass("invisible",!e),i.toggleClass("invisible",!e)},_showDropdownFilterForItem:function(e){var t=this,i=n.genFilterItemDockKey(e),r=this.filterItemsMap[i];r&&this._scrollItemIntoView(r).then((function(){r.openDropdownFilterView().then((function(){r.item.setOpenViewOnLoad(!1),t._setChevronActiveStates()}))}))},_scrollItemIntoView:function(e){var t=this;return new Promise((function(i){var n=t._getItemsEl();n.stop();var r=n.scrollLeft(),o=e.getItemDOMnode().position();n.animate({scrollLeft:r+o.left},t.chevronAnimationDuration,i)}))},removeFilterItem:function(e){this.filterItemsMap[e.dockKey]&&this.filterItemsMap[e.dockKey].remove?(this.onAddRemoveFilterItem(e.item,this.scope,!1),this.filterItemsMap[e.dockKey].remove()):this.logger.warn("called from deleteSelf if we do this....!"),delete this.filterItemsMap[e.dockKey],this._enableScrolling(this._shouldWeEnableScrolling()),this._setChevronActiveStates();var t=Object.keys(this.filterItemsMap).length;this._toggleEmptyView(0===t),this.menu.toggleDisableOverflow(0===t)},remove:function(){this._dndTarget&&(this._dndTarget.remove(),this._dndTarget=null),this.moveWidgetSvc&&(this.moveWidgetSvc.removeDropTarget(this.$el[0]),this.moveWidgetSvc=null),this.htm5DndSvc&&(this.htm5DndSvc.unregisterDropZone(this),this.htm5DndSvc=null),this._cleanupFilterItemWrapperInteraction(),this.afi&&(this.afi.remove(),this.afi=null),i(window).off("resize",this.handlers.windowResizeHandler),this.$el.off(d,this.handlers.animationFinished),this.off("resize",this._evaluateScrollState,this),this.filterItemsMap&&(u.each(this.filterItemsMap,(function(e){e&&e.remove&&e.remove()})),this.filterItemsMap=null),this.handlers={},this.cascadeSetsController&&(this.cascadeSetsController.destroy(),this.cascadeSetsController=null),h.inherited("remove",this,arguments)},showDock:function(e){this.$el.toggle(e)},clickFilterDockIcon:function(){this.onClickFilterDockIcon&&this.onClickFilterDockIcon(this.scope)},_toggleEmptyView:function(e){this.$emptyView||(this.$emptyView=this.$el.find(".empty-view")),this.$emptyView.toggleClass("empty",e)},_setLeftChevronActiveState:function(){var e=!1,t=this._getItemsEl();if(t.length>0){var i=t.scrollLeft();this._getLeftChevron().toggleClass("disable",0===i),0!==i&&(e=!0)}return e},_setRightChevronActiveState:function(){var e=!1,t=this._getItemsEl();if(t.length>0){var i=Math.round(t[0].offsetWidth+t.scrollLeft()-.5),n=t[0].scrollWidth,r=this._getRightChevron();Math.abs(i-n)<=2?r.addClass("disable"):(r.removeClass("disable"),e=!0)}return e},_setChevronActiveStates:function(){return{leftActive:this._setLeftChevronActiveState(),rightActive:this._setRightChevronActiveState()}},clickOnLeftChevron:function(){if(!this._getLeftChevron().hasClass("disable")){var e=this._getItemsEl(),t=e.scrollLeft(),i=e[0].offsetWidth/2;e.animate({scrollLeft:t-i},this.chevronAnimationDuration,this._setChevronActiveStates.bind(this))}},clickOnRightChevron:function(){if(!this._getRightChevron().hasClass("disable")){var e=this._getItemsEl(),t=e.scrollLeft(),i=e[0].offsetWidth/2;e.animate({scrollLeft:t+i},this.chevronAnimationDuration,this._setChevronActiveStates.bind(this))}},isExpanded:function(){return this.$el.hasClass("filterDockExpanded")},isCollapsed:function(){return this.$el.hasClass("filterDockCollapsed")},isSizedByDrag:function(){return this.$el.hasClass("d-dragged")},toggleCollapse:function(){if(this.$el.toggleClass("filterDockCollapsed").hasClass("filterDockCollapsed"))return this.$el.removeClass("filterDockExpanded"),this.afi.show(!0),!0},expandDock:function(){this.$el.addClass("filterDockExpanded"),this.$el.removeClass("filterDockCollapsed"),this.afi.show(!1),this._getItemsEl().fadeIn()},resetDockWidth:function(){this._enableScrolling(!1),this.$el.removeClass("filterDockCollapsed filterDockExpanded d-dragged"),this.$el.attr("style",null),this.afi.show(!1),this._getItemsEl().fadeIn()},getFilterMenuMountNode:function(){return this.$(".filter-menu")},getFilterItem:function(e){return e&&this.filterItemsMap[e]?this.filterItemsMap[e].item:null},_cleanupFilterItemWrapperInteraction:function(){this.itemsContainer&&(this.itemsContainer.destroy(),this.itemsContainer=null),this.swipeGesture&&(this.swipeGesture.destroy(),this.swipeGesture=null)},_setupFilterItemWrapperInteraction:function(){this._cleanupFilterItemWrapperInteraction(),this.itemsContainer=new a({$el:this._getItemsEl(),id:this.id+"_"+this.viewId,dashboardApi:this.dashboardApi,featureChecker:this.featureChecker,cascadeSets:this.cascadeSets,logger:this.logger,pageContextAPI:this.pageContextAPI,filtersUI:this.filtersUI,handlers:{populateFilterItems:this.populateFilterItems.bind(this),getFilterItem:this.getFilterItem.bind(this),chevron:{onClickOnLeftChevron:this.clickOnLeftChevron.bind(this),onClickOnRightChevron:this.clickOnRightChevron.bind(this),getLeftChevron:this._getLeftChevron.bind(this),getRightChevron:this._getRightChevron.bind(this),delay:this.chevronAnimationDuration}}})},toggleDropdownMenu:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.menu.toggle()},closeDropdownMenu:function(){this.menu.isOpen()&&this.toggleDropdownMenu(),this.$(".filter-dock-overflow").focus()},hideMenu:function(){this.menu.hide()},showMenu:function(){this.menu.show()},_getDnD_uploadedTableRef:function(e,t){if(e&&e.data&&e.data.sourceId){var i=this.dashboardApi.getFeature("DataSources");return c.getTableRef(i.getDataSource(e.data.sourceId),[t.getId()])}}});return h})),define("dashboard-analytics/filters/dock/FilterDockController",["./FilterDockView","../../widgets/livewidget/nls/StringResources"],(function(e,t){return function(){function i(e,i){this.scope=i,this.dashboardApi=e.dashboardApi,this.ajaxSvc=this.dashboardApi.getGlassCoreSvc(".Ajax"),this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this.content=e.content,this.singleDockMode=e.singleDockMode,this.excludeAddToCanvas=e.excludeAddToCanvas,this.parentLayoutId=e.parentLayoutId,this.stringResources=this.dashboardApi.getDashboardCoreSvc(".StringResources"),this.stringResources.register(t,90),e.handlers.menuActionHandler=this.menuActionHandler.bind(this),e.viewModel.menuItems=this._getDefaultMenuItems(),e.viewModel.menuIcon="wa-cardpage_menu_hamburger_overflow",this.view=this._createView(e),this.dashboardApi.on("pagecontext:filterContextUpdated",this.onFilterContextUpdated,this),this.dashboardApi.on("pagecontext:shapingModelChanged",this.onShapingModelChanged,this)}var n=i.prototype;return n._getDefaultMenuItems=function(){return[{label:this.stringResources.get("filterClearAllItems"),action:"filter-menu-clearall-action"},{label:this.stringResources.get("filterDeleteAllItems"),action:"filter-menu-deleteall-action"}]},n.menuActionHandler=function(e){var t=this,i=e.currentTarget.dataset.action;switch(i){case"filter-menu-deleteall-action":return this.dashboardApi.getCanvasWhenReady().then((function(e){return e.getFilters().removeFilters({scope:t.scope,multi:!0})}));case"filter-menu-clearall-action":return this.dashboardApi.getCanvasWhenReady().then((function(e){return e.getFilters().clearFilters({scope:t.scope,multi:!0})}));default:return this.logger.warn("Unknown dock menu action requested: "+i),Promise.resolve(!1)}},n._createView=function(t){var i=this,n=new e(t,{scope:this.scope,ajaxSvc:this.ajaxSvc,label:this._getLabel(this.scope),tooltip:this._getTooltip(this.scope),dropZoneTooltip:this._getDropZoneTooltip(this.scope),overflowMenuAriaLabel:this.stringResources.get("filterOverflowMenu"),className:"global"===this.scope?"global":"other",id:"global"===this.scope?"filterDock__global":"filterDock__other",parentLayoutId:this.parentLayoutId,singleDockMode:this.singleDockMode,excludeAddToCanvas:this.excludeAddToCanvas,chevron_left:this.stringResources.get("filterDockChevronLeft"),chevron_right:this.stringResources.get("filterDockChevronRight")});return n.on("animation-finished",(function(){i.dashboardApi.triggerDashboardEvent("filterDock:resized")})),n},n._getLabel=function(e){return this.singleDockMode?this.stringResources.get("filterIconLabel_Single"):"global"===e?this.stringResources.get("filterIconLabel_Global"):this.stringResources.get("filterIconLabel_Tab")},n._getTooltip=function(e){return this.singleDockMode?this.stringResources.get("filterIconTooltip_Single"):"global"===e?this.stringResources.get("filterIconTooltip_Global"):this.stringResources.get("filterIconTooltip_Tab")},n._getDropZoneTooltip=function(e){return this.singleDockMode?this.stringResources.get("filterDropZoneTooltip_Single"):"global"===e?this.stringResources.get("filterDropZoneTooltip_Global"):this.stringResources.get("filterDropZoneTooltip_Tab")},n.getView=function(){return this.view},n.render=function(e){this.view.render(e)},n.resize=function(){this.view.trigger("resize")},n.destroy=function(){this.view.remove(),this.view=null,this.dashboardApi&&(this.dashboardApi.off("pagecontext:filterContextUpdated",this.onFilterContextUpdated,this),this.dashboardApi.off("pagecontext:shapingModelChanged",this.onShapingModelChanged,this),this.dashboardApi=null,this.onFilterContextUpdatedBindedToThis=null)},n.showDock=function(e){this.view.showDock(e)},n.switchDatasource=function(e,t){this.view.switchDatasource(e,t)},n.changeToConsumeMode=function(){this.view.changeToConsumeMode()},n.changeToAuthorMode=function(){this.view.changeToAuthorMode()},n.onFilterContextUpdated=function(e){this._updateFilterItems(e)},n.onShapingModelChanged=function(e){this._updateFilterItems(e)},n._updateFilterItems=function(e){if((!(e=e||{}).ignorePageContextChanged||!e.ignorePageContextChanged())&&(this.view.populateFilterItems(e),this.view.afi.setCount(this.view.afi.getActiveCount()),this.view.afi.show(this.view.isCollapsed()),e.isDelete())){var t=e.getItems();this._isSetTypeFilter(t)?this._removeSetTypeFilterItems(e):this.view.removeStaleFilterItemsFromMap(e)}},n._removeSetTypeFilterItems=function(e){var t=e.getItemExpressionID();if(t){var i=this.view.getFilterItem(t);if(i){var n={dockKey:t};i.getIsModeledFilter()&&(n.item=i),this.view.removeFilterItem(n)}}},n._isSetTypeFilter=function(e){if(e&&1===e.length){var t=e[0];return t.getIsModeledFilter()||t.isValueDataItem()}return!1},n.changeScope=function(e){var t=e&&e.getId();this.view&&t&&this.scope!==t&&(this.content=e,this.scope=t,this.view.switchTabScope(e))},n.isExpanded=function(){return this.view.isExpanded()},n.isCollapsed=function(){return this.view.isCollapsed()},n.toggleCollapse=function(){return this.view.toggleCollapse()},n.expandDock=function(){return this.view.expandDock()},n.isSizedByDrag=function(){return this.view.isSizedByDrag()},n.resetDockWidth=function(){this.view.resetDockWidth()},i}()})),define("text!dashboard-analytics/filters/utils/templates/Dragger.html",[],(function(){return'<div id="filter-dock-dragger-container">\n\t<svg class="svgIcon" role="img" focusable="false" viewBox="0 0 8 16">\n\t\t<path d="M5.667 16h-1V0h1v16zM3.333 0h-1v16h1V0z"></path>\n\t</svg>\n</div>\n'})),define("dashboard-analytics/filters/utils/Dragger",["../../lib/@waca/core-client/js/core-client/ui/core/View","text!../utils/templates/Dragger.html","jquery"],(function(e,t,i){return function(e){function n(){for(var n,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];n=e.call.apply(e,[this].concat(o))||this;var s=o[0];return n.prevSelector=s.prevSelector,n.nextSelector=s.nextSelector,n.parent=s.parent,n.$parent=s.parent.$el,n.$el=i(t),n.minPercent=s.minPercent,i(n.$el).addClass("draggable"),n.render(),n}_inheritsLoose(n,e);var r=n.prototype;return r.render=function(){this._onMouseDownHandler=this.onMouseDownHandler.bind(this),this.$parent.append(this.$el),this.$el.on("mousedown",this._onMouseDownHandler),this.$el.on("touchstart",this._onMouseDownHandler)},r.onMouseDownHandler=function(e){this.$prev&&this.$next||(this.$prev=this.parent.$(this.prevSelector),this.$next=this.parent.$(this.nextSelector)),this.$prev.css("transition","none"),this.$next.css("transition","none"),this.registerEventHandlers(),e.preventDefault()},r.onMouseMoveHandler=function(e){this.$prev.removeClass("filterDockCollapsed filterDockExpanded").addClass("d-dragged"),this.$next.removeClass("filterDockCollapsed filterDockExpanded").addClass("d-dragged"),this.$el.addClass("d-dragging");var t=this.$prev.outerWidth()+this.$next.outerWidth(),i=e.pageX-this.$prev.offset().left,n=((i-=10)-this.$el.width()/2)/t,r=1-n,o=!0;100*n<this.minPercent&&(this.$prev.attr("style",null),this.$next.attr("style",null),this.$prev.addClass("filterDockCollapsed"),this.$next.addClass("filterDockExpanded"),o=!1),100*r<this.minPercent&&(this.$prev.attr("style",null),this.$next.attr("style",null),this.$prev.addClass("filterDockExpanded"),this.$next.addClass("filterDockCollapsed"),o=!1),this.parent.trigger("resize"),o&&(this.$prev.css("flex-grow",n.toString()),this.$next.css("flex-grow",r.toString())),e.preventDefault()},r.onMouseUp=function(){this.$el.removeClass("d-dragging"),this.$prev.css("transition",""),this.$next.css("transition",""),this.deregisterEventHandlers()},r.registerEventHandlers=function(){var e=i("body");this._onMouseMoveHandler&&(e.off("mousemove",this._onMouseMoveHandler),e.off("touchmove",this._onMouseMoveHandler)),this._onMouseMoveHandler=this.onMouseMoveHandler.bind(this),this._onMouseUp=this.onMouseUp.bind(this),e.on("mousemove",this._onMouseMoveHandler).on("touchmove",this._onMouseMoveHandler).on("mouseup",this._onMouseUp).on("touchend",this._onMouseUp)},r.deregisterEventHandlers=function(){i("body").off("mousemove",this._onMouseMoveHandler).off("touchmove",this._onMouseMoveHandler).off("mouseup",this._onMouseUp).off("touchend",this._onMouseUp),this._onMouseMoveHandler=null,this._onMouseUp=null},r.remove=function(){this.deregisterEventHandlers(),this.$prev=null,this.$next=null,this.parent=null,this.$parent=null,e.prototype.remove.call(this)},n}(e)})),define("dashboard-analytics/filters/dock/FilterContainerView",["../../lib/@waca/core-client/js/core-client/ui/core/View","./FilterDockController","jquery","underscore","../utils/Dragger","../../widgets/livewidget/nls/StringResources"],(function(e,t,i,n,r,o){var a=e.extend({className:"filterDockContainer",tabDock:null,globalDock:null,init:function(e){a.inherited("init",this,arguments),this.dashboard=e.dashboardApi,this.canvas=this.dashboard.getFeature("Canvas"),this.viewModel={},this.filterControllers=[],this.extraOptions=e.extraOptions,this.stringResources=this.dashboard.getDashboardCoreSvc(".StringResources"),this.stringResources.register(o,90),this._isActive=!1},getApi:function(){var e=this;return{isGlobalDockShown:!this.extraOptions||!1!==this.extraOptions.showGlobalDock,currentScope:function(){return e.tabDock.scope},activate:this.activate.bind(this),deactivate:this.deactivate.bind(this),isActive:this.isActive.bind(this),switchDatasource:this.switchDatasource.bind(this)}},_setupEvents:function(){this.tabDock&&this.dashboard.on("tab:tabChanged",this.onScopeChanged,this),this.dashboard.on("filterDock:resized",this._resize,this),this.on("resize",this._resize,this),this.$el.on("shown.bs.collapse hidden.bs.collapse",this._resizeWindow.bind(this))},_teardownEvents:function(){this.dashboard.off("tab:tabChanged",this.onScopeChanged,this),this.dashboard.off("filterDock:resized",this._resize,this),this.off("resize",this._resize,this),this.$el.off("shown.bs.collapse hidden.bs.collapse",this._resizeWindow.bind(this))},_createNewFilterDocks:function(e,t,i){var n=[],r=!e.showTabDock;return e.showGlobalDock&&n.push(this._createGlobalDock(r,t,i)),e.showTabDock&&n.push(this._createTabDock(e.currentScopeId,t,i)),n},_createGlobalDock:function(e,i,n){var r=e?this.stringResources.get("filter_drag_and_drop_single_dock"):this.stringResources.get("filter_drag_and_drop_all_tabs"),o=this._getCommonOptions(i,n);return o.singleDockMode=e,o.authorHint=r,o.consumeHint=this.stringResources.get("filter_empty_consume_mode"),o.content=this.canvas.getContent(),this.globalDock=new t(o,"global"),this.globalDock},_createTabDock:function(e,i,n){var r=this._getCommonOptions(i,n);return r.authorHint=this.stringResources.get("filter_drag_and_drop_current_tab"),r.consumeHint=this.stringResources.get("filter_empty_consume_mode"),r.excludeAddToCanvas=this.extraOptions&&!0===this.extraOptions.excludeAddToCanvas,r.content=this.canvas.getContent(e),this.tabDock=new t(r,e),this.tabDock},_getCommonOptions:function(e,t){return{parentEl:this.$el,pageContextAPI:e,dashboardApi:this.dashboard,canvas:this.canvas,viewModel:this.viewModel,handlers:{onClickFilterDockIcon:this.onClickFilterDockIcon.bind(this),onAddRemoveFilterItem:t.onAddRemoveFilterItem.bind(t)}}},_insertDragger:function(){this.dragger=new r({parent:this,prevSelector:".global.filterDock",nextSelector:".other.filterDock",minPercent:6})},_resize:function(){n.each(this.filterControllers,(function(e){return e.resize()}))},_resizeWindow:function(){i(window).resize()},_getBoardDetails:function(){var e=this.dashboard.getFeature("internal").getBoardModel(),t=!0;if(e.layout)switch(e.layout.type){case"singlePage":case"absolute":case"container":t=!1}var i,r=!(this.extraOptions&&!1===this.extraOptions.showGlobalDock);if(t&&e.layout&&e.layout.items.length>0&&e.layout.items[0]&&e.layout.items[0].id){var o=this.dashboard.getFeature("Canvas").getSelectedContentList({type:"page"});i=!n.isEmpty(o)&&o[0].getId()||e.layout.items[0].id}else i=e.layout&&e.layout.id;return{showTabDock:t,showGlobalDock:r,currentScopeId:i}},activate:function(){this._isActive||(this._isActive=!0,this._setupEvents())},switchDatasource:function(e,t){this.tabDock.switchDatasource(e,t)},deactivate:function(){this._isActive&&(this._isActive=!1,this._teardownEvents())},isActive:function(){return this._isActive},render:function(){var e=this,t="authoring"===this.dashboard.getMode();return Promise.all([this._getPageContextAPI(),this._getSynchronizeDataService()]).then((function(i){var r=i[0],o=i[1],a=e._getBoardDetails(),s=[];return e.filterControllers=e._createNewFilterDocks(a,r,o),n.each(e.filterControllers,(function(i,n){1===n&&e._insertDragger(),e.$el.append(i.view.$el),s.push(i.render(t))})),e.$el.addClass("collapse"),e.$el.attr("data-toggle",!1),e.$el.attr("id","filterDockContainer"),e.extraOptions&&e.extraOptions.extraClassName&&e.$el.addClass(e.extraOptions.extraClassName),e.activate(),Promise.all(s)}))},changeToAuthorMode:function(){var e=this;return Promise.resolve().then((function(){e.expand(),n.each(e.filterControllers,(function(e){return e.changeToAuthorMode()})),e.dashboard.triggerDashboardEvent("filterDock:showItemMenu")}))},changeToConsumeMode:function(){var e=this;return Promise.resolve().then((function(){return n.each(e.filterControllers,(function(e){return e.changeToConsumeMode()})),e._getFilterCount()})).then((function(t){0===t?e.collapse():e.dashboard.triggerDashboardEvent("filterDock:hideItemMenu")}))},_getPageContextAPI:function(){return Promise.resolve(this.dashboard.getFeature("PageContextService").getPageContext())},_getFilterCount:function(){return this._getPageContextAPI().then((function(e){return e.getPageContextItems({origin:"filter",_strictMatch:!0}).length}))},_getSynchronizeDataService:function(){return this.dashboard.getFeature("SynchronizeDataService")},onScopeChanged:function(e){e.isTabWidget||this.tabDock.changeScope(this.canvas.getContent(e.modelId))},disable:function(){this.$el.addClass("filter-dock-disabled")},enable:function(){this.$el.removeClass("filter-dock-disabled")},expand:function(){this._isAnimationEnabled()?this.$el.collapse("show"):this.$el.show()},collapse:function(){this._isAnimationEnabled()?this.$el.collapse("hide"):this.$el.hide()},_isAnimationEnabled:function(){return!(this.extraOptions&&!1===this.extraOptions.enableAnimation)},removeTabDock:function(){this.tabDock&&(this.tabDock.destroy(),this.tabDock=null,this.dashboard.off("tab:tabChanged",this.onScopeChanged,this)),this.globalDock&&this.globalDock.view.$el.removeClass("global").addClass("only")},onClickFilterDockIcon:function(e){this.tabDock&&(this.tabDock.isCollapsed()||this.tabDock.isSizedByDrag()?this.tabDock.resetDockWidth():this.globalDock&&(this.globalDock.isCollapsed()||this.globalDock.isSizedByDrag())?this.globalDock.resetDockWidth():"global"===e&&this.tabDock.toggleCollapse()?this.globalDock&&this.globalDock.expandDock():this.globalDock&&this.globalDock.toggleCollapse()&&this.tabDock.expandDock())},remove:function(){this.deactivate(),this.filterControllers.length=0,this.tabDock&&(this.tabDock.destroy(),this.tabDock=null),this.globalDock&&(this.globalDock.destroy(),this.globalDock=null),this.dragger&&(this.dragger.remove(),this.dragger=null),a.inherited("remove",this,arguments)}});return a})),define("text!dashboard-analytics/filters/dock/templates/filterCollapsibleView.html",[],(function(){return'<div id="filter-dock-collapse-handle-content" class="filterDockCollapseHandle {{? it.extraOptions && it.extraOptions.extraClassName}}{{=it.extraOptions.extraClassName}}{{?}}"tabindex="0">\n  <div id="filter-dock-collapse-handle-icon">\n    <svg class="svgIcon">\n      {{? it.extraOptions && it.extraOptions.handleIcon }}\n      <use style="pointer-events: none; " xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#{{=it.extraOptions.handleIcon}}"></use>\n      {{??}}\n      <svg viewBox="1 5 16 16" width="100%" height="100%">\n          <path d="M4.8 13.1l7-7 1.4 1.4-5.5 5.6 5.5 5.5-1.4 1.5z"></path>\n        </svg>\n      {{?}}\n    </svg>\n  </div>\n  <div class="filter-dock-collapse-count">\n  </div>\n</div>'})),define("dashboard-analytics/filters/dock/FilterContainerCollapseView",["../../lib/@waca/core-client/js/core-client/ui/core/View","doT","text!./templates/filterCollapsibleView.html","../../widgets/livewidget/nls/StringResources"],(function(e,t,i,n){return function(e){function r(r){var o;if((o=e.call(this,arguments)||this).dashboard=r.dashboardApi,o._filterContainerView=o.dashboard.getFeature(".CanvasExtensions").getExtension("filterDock"),o._isExpand=!1,o.extraOptions=r.extraOptions,o.targetId=r.targetId||"filterDockContainer",o.dashboard.on("filterDock:disable",o.disable,_assertThisInitialized(o)),o.dashboard.on("filterDock:enable",o.enable,_assertThisInitialized(o)),o.dashboard.on("filterDock:collapse",o.collapse,_assertThisInitialized(o)),o.dashboard.on("filterDock:expand",o.expand,_assertThisInitialized(o)),o.canvas=o.dashboard.getFeature("Canvas"),o.canvas.getPropertyNameList().indexOf("fillColor")>-1){var a=o.dashboard.getFeature("internal").getBoardModel();o.removeModelEventHandler=a.on("change:layout",o._onChangeLayout,_assertThisInitialized(o)),o._colorsFeature=o.dashboard.getFeature("Colors");var s=o.canvas.getPropertyValue("fillColor");o._backgroundColorClass="fill-"+o._colorsFeature.getColorClassName(s),o._applyBackgroundColor()}else o._backgroundColorClass="";return o.tooltipExpand=n.get("expand"),o.tooltipCollapse=n.get("collapse"),o.contentTemplateFn=function(){return t.template(i)({extraOptions:this.extraOptions})},o.featureChecker=o.dashboard.getGlassCoreSvc(".FeatureChecker"),o}_inheritsLoose(r,e);var o=r.prototype;return o._onChangeLayout=function(e){if("change:fillColor"===e.eventName){var t=this.canvas.getPropertyValue("fillColor");this.isExpanded()?this._backgroundColorClass="fill-"+this._colorsFeature.getColorClassName(t):(this._removeBackgroundColor(),this._backgroundColorClass="fill-"+this._colorsFeature.getColorClassName(t),this._applyBackgroundColor())}},o._removeBackgroundColor=function(){this.$el.removeClass(this._backgroundColorClass)},o._applyBackgroundColor=function(){this.$el.addClass(this._backgroundColorClass)},o.remove=function(){this.dashboard.off("filterDock:disable",this.disable,this),this.dashboard.off("filterDock:enable",this.enable,this),this.dashboard.off("filterDock:collapse",this.collapse,this),this.dashboard.off("filterDock:expand",this.expand,this),this.$("#filter-dock-collapse-handle-icon").off("click"),this.removeModelEventHandler&&this.removeModelEventHandler.remove(),e.prototype.remove.call(this)},o._getPageContextAPI=function(){return this.dashboard.getFeature("PageContextService").getPageContext()},o._getFilterCount=function(){var e=[];if(this.featureChecker.checkValue("dashboard","DataFilters","enabled")){[this.canvas.getContent()].concat(this.canvas.getContent().getChildren()).forEach((function(t){e.push.apply(e,t.getFeature("DataFilters").getFilterList())}))}else{var t=this._getPageContextAPI();e.push.apply(e,t.getPageContextItems({origin:"filter",_strictMatch:!0}))}return e.length},o.onClick=function(){this.isExpanded()?this.dashboard.triggerDashboardEvent("filterDock:collapse"):this.dashboard.triggerDashboardEvent("filterDock:expand")},o.disable=function(){this.$el.addClass("filter-dock-disabled"),this._filterContainerView&&this._filterContainerView.disable()},o.enable=function(){this.$el.removeClass("filter-dock-disabled"),this._filterContainerView&&this._filterContainerView.enable()},o.isExpanded=function(){return this._isExpand},o._toggleExpand=function(e){this.$el.toggleClass("filter-dock-collapse-handle-container-expanded",e),this.$el.toggleClass("filter-dock-collapse-handle-container-collapsed",!e);var t=e?this.tooltipExpand:this.tooltipCollapse;this.$el.find("#filter-dock-collapse-handle-icon").attr("title",t),this.$el.find(".filterDockCollapseHandle").attr("area-label",t)},o.expand=function(){this._toggleExpand(!1),this._filterContainerView.expand(),this._isExpand=!0,this._removeBackgroundColor(),this.dashboard.triggerDashboardEvent("filterDock:expanded")},o.collapse=function(){this._toggleExpand(!0),this._filterContainerView.collapse(),this._isExpand=!1,this._applyBackgroundColor()},o.changeToConsumeMode=function(){this._filterContainerView.changeToConsumeMode(),0===this._getFilterCount()&&this.collapse()},o.changeToEditMode=function(){this.isExpanded()||this.expand(),this._filterContainerView.changeToAuthorMode()},o.show=function(e){e=!!e,this.$el.toggle(e)},o._setupLifeCycleHandlers=function(){var e=this;this.dashboard.getDashboardSvc(".LifeCycleManager").then((function(t){t.registerLifeCycleHandler("post:mode.edit",e.changeToEditMode.bind(e)),t.registerLifeCycleHandler("post:mode.consume",e.changeToConsumeMode.bind(e))}))},o._shouldDisplayCollapsed=function(){var e=this.dashboard.getFeature("Renderer.internal");return!this.dashboard.getFeature("DashboardState").getUiState().authoring&&(0===this._getFilterCount()||e&&e.isMobile())},o.render=function(){this.$el.empty(),this.$el.html(this.dotTemplate({})),this.$el.append(this.contentTemplateFn()),this._shouldDisplayCollapsed()?this.collapse():this.expand(),this._setupLifeCycleHandlers()},_createClass(r,[{key:"id",get:function(){return"filter-dock-collapse-handle-container"}},{key:"events",get:function(){return{primaryaction:"onClick"}}}]),r}(e)})),define("dashboard-analytics/dialogs/CommonViewWrapper",["underscore","../lib/@waca/core-client/js/core-client/ui/core/View","../lib/@waca/core-client/js/core-client/utils/ClassFactory","../filters/finder/FilterModuleFinder","../filters/FilterMetadataHelper"],(function(e,t,i,n,r){var o=t.extend({className:"localFilterViewWrapper",init:function(e){o.inherited("init",this,arguments),this.options=e.state||e,this.showBoxShadow=this.options.showBoxShadow,this.logger=this.options.dashboardApi.getGlassCoreSvc(".Logger")},preload:function(){var t={origin:"localFilter"},o=r.getFilterMetadataInfo(this.options.metadataColumn,this.options.slot,this.options.mapIndex);e.extend(t,o),e.extend(this.options,o);var a=this.options.dashboardApi.getFeature("dataSources.deprecated");return t.dataSources=a,t.content=this.options.content,n.getModule(t).then((function(e){return i.loadModule(e)})).then(function(e){return this.options.commonView=this,this.filterController=new e(this.options),this.filterController.initialize().catch(function(e){this.logger.error(e)}.bind(this))}.bind(this))},remove:function(){this._removing||(this._removing=!0,this.toolbar&&this.toolbar.flyout&&this.toolbar.flyout.close(),this.filterController&&(this.filterController.remove(),this.filterController=null),o.inherited("remove",this,arguments))},renderInFilterItemView:function(e){e&&e.viewClass&&this.$el.addClass(e.viewClass);var t={mountNode:this.$el.get(0)};return Promise.resolve(t)},renderCallBack:function(e){return this.setToolBar(e),Promise.resolve()},onViewClose:function(){this.remove()},onFlyoutClose:function(){this.filterController&&this.filterController.onClose&&!this.filterController.closed&&this.filterController.onClose()},bindFlyoutClose:function(e){e.on("flyout:hide",this.onFlyoutClose.bind(this)),e.on("toolbar:show",this.onFlyoutShow.bind(this))},_renderFilterInstance:function(){return this.filterController?this.filterController.render():Promise.resolve()},setToolBar:function(e){this.toolbar=e,this.bindFlyoutClose(e)},onFlyoutShow:function(){return this._renderFilterInstance()}});return o})),define("dashboard-analytics/dataSources/views/internal/CachingPageContainer",["react","classnames","prop-types"],(function(e,t,i){var n=function(i){function n(){return i.apply(this,arguments)||this}return _inheritsLoose(n,i),n.prototype.render=function(){var i=this,n={pageContainer:!0};return this.props.className&&(n[this.props.className]=!0),e.createElement("div",{className:t(n)},this.props.pages.map((function(n){var r=n.id,o=n.component,a=n.props,s=n.className,l=r===i.props.currentPageId,c={containerPage:!0,currentContainerPage:l};return s&&(c[s]=!0),e.createElement("div",{key:r,className:t(c),style:{transform:l?"scale(1)":"scale(0)",position:l?"inherit":"absolute"}},e.createElement(o,_extends({isVisible:l},a&&a()||{})))})))},n}(e.Component);return n.propTypes={pages:i.arrayOf(i.shape({id:i.string.isRequired,component:i.func.isRequired,className:i.string,props:i.func}).isRequired).isRequired,currentPageId:i.string.isRequired,className:i.string},n})),define("dashboard-analytics/dataSources/views/internal/TransientStateManager",["underscore"],(function(e){return function(){function t(e){var t=e.transientState,i=e.transientStateKey,n=e.typeToCreator,r=e.onStateChange,o=e.validatePage;this._transientState=t,this._transientStateKey=i,this._typeToCreator=n,this._onStateChange=r,this._descriptors=[],this._values=[];this._validatePage=o||function(){return!0},this._init()}var i=t.prototype;return i._init=function(){var e=this.getCurrentDescriptor();if(e){var t=e.type,i=e.payload;this._validatePage(t,i)&&this._prepareCurrentValue(e)}},i._prepareCurrentValue=function(e){if(!this._getValue(e)){var t=e.type,i=e.payload;this._setValue(e,this._typeToCreator[t](i))}},i._getIndex=function(t){for(var i=0;i<this._descriptors.length;i++)if(e.isEqual(this._descriptors[i],t))return i;return-1},i._getValue=function(e){return this._values[this._getIndex(e)]},i._setValue=function(e,t){this._descriptors.push(e),this._values.push(t)},i.setCurrentDescriptor=function(e,t){void 0===t&&(t={});var i={type:e,payload:t};this._transientState.set(this._transientStateKey,i),this._prepareCurrentValue(i),this._onStateChange()},i.getCurrentDescriptor=function(){return this._transientState.get(this._transientStateKey)},i.getCurrentValue=function(){var e=this.getCurrentDescriptor();if(e)return this._getValue(e)},i.getValues=function(){return this._values},i.removeDescriptor=function(e,t){var i=this._getIndex(this.getCurrentDescriptor()),n=this._getIndex({type:e,payload:t});n>=0&&(this._descriptors.splice(n,1),this._values.splice(n,1),i===n&&this._transientState.set(this._transientStateKey,null),this._onStateChange())},i.destroy=function(){delete this._transientState,delete this._typeToCreator,delete this._onStateChange,delete this._descriptors,delete this._values},t}()})),define("dashboard-analytics/dataSources/views/internal/DataSourcePanelIconHelper",[],(function(){var e={"#common-add-new":"add16","#common-menuoverflow":"overflowVertical"},t=["warning","error"],i={module:"common-titan-model",uploadedFile:"common-upload",DEFAULT:"common-dataset"};return function(){function n(e){var t=e.iconsFeature;this.iconsFeature=t}var r=n.prototype;return r.getIcon=function(e){return this.iconsFeature.getIcon(e)},r.getIconInternalId=function(e){var t=this.getIcon(e);return t&&t.id},r.getOverflowIcon=function(){return this.getIcon("overflowVertical")},r.getActionIconId=function(i){var n=e[i]||t.indexOf(i)>=0&&"minor-warning";return n&&this.getIconInternalId(n)},r.getDataSourceIcon=function(e){var t=i[e]||i.DEFAULT;return this.getIconInternalId(t)},r.getDataSourceWarningIcon=function(){return this.getIconInternalId("minor-warning")},r.getDataSourceErrorIcon=function(){return this.getIconInternalId("critical")},n}()})),define("dashboard-analytics/dataSources/views/internal/pages/DataSourcePanelPage",["underscore","jquery","react","prop-types","@ba/ba-ui-carbon-toolkit","../DataSourcePanelIconHelper","dashboard-analytics/lib/@waca/core-client/js/core-client/utils/JQueryTabbable"],(function(e,t,i,n,r,o){var a=r.Breadcrumb,s=r.Button,l=r.FlexItem,c=r.FlexLayout,u=function(e){function n(t){var n;return(n=e.call(this,t)||this).state={buttons:n.props.buttons||[]},n._rootNode=i.createRef(),n._iconHelper=new o({iconsFeature:n.props.dashboardApi.getFeature("Icons")}),n._buttonsPromise=n._setupButtonsState(),n}_inheritsLoose(n,e);var r=n.prototype;return r._setupButtonsState=function(){var e=this,t=this._loadButtonsDefinition();if(t)return t.then((function(t){if(t)return e._buildButtonsDefinition(t).then((function(t){return e.setState({buttons:t})}))}))},r.resetFocus=function(){if(this._rootNode.current){var e=t(this._rootNode.current).find(":focusable");if(e[0])return e[0].focus(),!0}},r.getButtonCollectionId=function(){},r.getButtonConstructorPayload=function(){return{dashboardApi:this.props.dashboardApi}},r._loadButtonsDefinition=function(){var e=this.getButtonCollectionId();return e&&this.props.dashboardApi.findGlassCollection(e)},r._buildButtonsDefinition=function(e){var t=this,i=e.map((function(e){return _extends({},e)}));return i.sort((function(e,t){return(e.weight||0)-(t.weight||0)})),Promise.all(i.map((function(e){return t._loadButtonActionControllers(e).then((function(t){return e.actionController=t,e}))})))},r._loadButtonActionControllers=function(e){var t=this;return new Promise((function(i){return require([e.actionController],(function(e){return i(new e(t.getButtonConstructorPayload()))}))}))},r.render=function(){return i.createElement(c,{className:"dataSourcePanelStructure",direction:"column"},i.createElement(l,{className:"dataSourcePanelHeaderContainer",grow:!1,shrink:!1},this.renderHeader()),i.createElement(l,{className:"dataSourcePanelContents",grow:!0,shrink:!0},this.renderPanel()))},r.renderHeader=function(){return i.createElement("div",{className:"dataSourcePanelHeader",ref:this._rootNode},i.createElement(c,{direction:"row",alignItems:"flex-end"},i.createElement(l,{grow:!0,shrink:!0},this.renderTitle()),this.renderButtons().map((function(e,t){return i.createElement(l,{key:t,grow:!1,shrink:!1},e)}))))},r.renderTitle=function(){var e=this.props.previousPages||[],t=[].concat(e,[this.getTitleParams()]).map((function(e){return{id:e.id,defaultName:e.title}}));return i.createElement(a,{className:"dataSourcePanelTitle",ancestors:t,noTrailingSlash:!0,navCallback:function(t){t<e.length&&e[t].onSelect()},hideBackButton:!0,historyCallback:function(){e.length&&e[0].onSelect()}})},r.getTitleParams=function(){},r.renderButtons=function(){var e=this;return this.state.buttons&&this.state.buttons.map((function(t){return i.createElement("div",{className:"dataSourcePanelButton",key:t.name},i.createElement(s,{iconSize:"small",variant:"icon",icon:e._iconHelper.getActionIconId(t.icon),"aria-label":t.label,title:t.label,tooltipAlignment:"start",tooltipPosition:"left",onClick:e._getButtonOnClickHandler(t)}))}))},r._getButtonOnClickHandler=function(e){if(e.actionController)return function(t){t.persist(),e.actionController.execute(t,e)}},r.renderPanel=function(){},n}(i.Component);return u.propTypes={dashboardApi:n.func.isRequired,previousPages:n.arrayOf(n.shape({id:n.string.isRequired,title:n.string.isRequired,onSelect:n.func.isRequired})),buttons:n.array},u})),define("dashboard-analytics/dataSources/views/internal/DataSourcePanelStatic",["react","prop-types","classnames","@ba/ba-ui-carbon-toolkit"],(function(e,t,i,n){var r=n.Button,o=n.FlexLayout,a=n.Label,s=n.EmptyState,l=function(t){function n(){return t.apply(this,arguments)||this}return _inheritsLoose(n,t),n.prototype.render=function(){var t={dataSourcePanelStatic:!0};return this.props.className&&(t[this.props.className]=!0),e.createElement(o,{className:i(t),direction:"column",justifyContent:"center",alignItems:"flex-start"},this.props.iconType?e.createElement(s,{type:this.props.iconType,size:"large"}):null,e.createElement(a,{className:"dataSourcePanelStaticTitle",label:this.props.title}),this.props.caption?e.createElement(a,{className:"dataSourcePanelStaticCaption",label:this.props.caption}):null,this.props.button?e.createElement(r,_extends({className:"dataSourcePanelStaticButton"},this.props.button)):null)},n}(e.Component);return l.propTypes={className:t.string,iconType:t.string,iconId:t.string,title:t.string.isRequired,caption:t.string,button:t.object},l.ICON_TYPES={default:"default",error:"error"},l})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"));else if("function"==typeof define&&define.amd)define("dashboard-analytics/lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/icons-js/add_32",["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"],t);else{var i=t("object"==typeof exports?require("@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"):e["@ba/ba-graphics/dist/icons-js/ba-graphics-icons-commons.js"]);for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}("undefined"!=typeof self?self:this,(function(e){return webpackJsonPBaGraphics([1273],{"0cb7e8aeae71aca8482e":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("6873601dfe1d9459c1a9"),r=(i.n(n),i("df23011b6ab348b86eed"));t.default=r.a},"6873601dfe1d9459c1a9":function(t,i){t.exports=e},df23011b6ab348b86eed:function(e,t,i){"use strict";var n=i("9689a9c94ae38b47fa2c"),r=i.n(n),o=i("9ce58a7deea14f49ef01"),a=i.n(o),s=new r.a({id:"add_32_v7",use:"add_32_v7-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" id="add_32_v7"><path d="M17 15L17 8 15 8 15 15 8 15 8 17 15 17 15 24 17 24 17 17 24 17 24 15z" /></symbol>'});a.a.add(s),t.a=s}},["0cb7e8aeae71aca8482e"])})),define("dashboard-analytics/dataSources/views/internal/pages/DataSourcePanelEmpty",["underscore","../../../nls/StringResources","react","prop-types","./DataSourcePanelPage","../DataSourcePanelStatic","../../../../lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/icons-js/add_32"],(function(e,t,i,n,r,o,a){var s=a.default;return function(e){function n(){return e.apply(this,arguments)||this}_inheritsLoose(n,e);var r=n.prototype;return r.getTitleParams=function(){return{id:"empty",title:t.get("dataPaneLabel")}},r.getButtonCollectionId=function(){return"com.ibm.bi.dashboard.dataSourcePanel.list.buttons"},r.renderPanel=function(){return i.createElement(o,{className:"dataSourcePanelEmpty",iconType:o.ICON_TYPES.default,title:t.get("emptySourcePaneTitle"),caption:t.get("emptySourcePaneCaption"),button:{label:t.get("addDataSource"),icon:s.id,intent:"primary",onClick:this.onAddSourceClick.bind(this)}})},r.onAddSourceClick=function(e){var t=this;return this._buttonsPromise.then((function(){var i=t.state.buttons.find((function(e){return"addSource"===e.name}));i.actionController.execute(e,i)}))},n}(r)})),define("dashboard-analytics/dataSources/glassControllers/MenuActionHelper",["jquery"],(function(e){"use strict";var t=null,i=function(){};return i.prototype.getActionPayload=function(t){return t&&("dataSet2"!==t.type||t.id)&&t.event?this._getCMInfo(t).then((function(i){var n={},r=t.event;return void 0===r.pageX||r.gesture&&(void 0===r.gesture.center||void 0===r.gesture.center.pageX)?n=e(r.target).offset():(n.left=r.pageX||r.gesture.center.pageX,n.top=r.pageY||r.gesture.center.pageY),{position:{pageX:n.left,pageY:n.top},menuId:t.menuId,activeObject:{aSelectedContext:i}}})):Promise.resolve(!0)},i.prototype._getCMInfo=function(e){return"dataSet2"===e.type?e.dashboardApi.getGlassSvc(".Content").then((function(t){return t.getBaseObjectsURL()+"/"+e.id})).then((function(t){return e.dashboardApi.getGlassCoreSvc(".Ajax").ajax({url:t,type:"GET",headers:{"Content-Type":"application/vnd.ibm.bi.platform.execution+json; charset=UTF-8",Accept:"application/json"},datatype:"json",data:{fields:"permissions,defaultName"}})})).then((function(e){var t=e.data;if(t&&t.data)return t.data;throw t})):Promise.resolve({})},function(){return t||(t=new i),t}()})),define("dashboard-analytics/dataSources/views/internal/pages/DataSourcePanelList",["underscore","../../../nls/StringResources","react","prop-types","classnames","@ba/ba-ui-carbon","@ba/ba-ui-carbon-toolkit","./DataSourcePanelPage","../DataSourcePanelIconHelper","../../../glassControllers/MenuActionHelper","../../../../util/DashboardFormatter"],(function(e,t,i,n,r,o,a,s,l,c,u){var d=a.Button,h=a.FlexItem,g=a.FlexLayout,p=a.Label,f=a.List,m=a.ListItem,v=a.SVGIcon,b=o.InlineLoading,y=function(e){function n(t){var i;return(i=e.call(this,t)||this).state.dataSources=[],i.state.loadingPercentages={},i._iconHelper=new l({iconsFeature:i.props.dashboardApi.getFeature("Icons")}),i._dataSourcesSvc=i.props.dashboardApi.getFeature("dataSources.deprecated"),i._buildState(),i}_inheritsLoose(n,e);var o=n.prototype;return o.componentDidUpdate=function(e){this.props.dataSources!==e.dataSources&&this._buildState()},o._registerProgressHandler=function(e){var t=this,i=this.props.dataSources[e],n=i&&i.getId();"loading"!==(i&&i.getState())||this._isMarkedLoading(n)||(this.props.moserDatasources&&this.props.moserDatasources.registerLoadMetadataProgressHandler(n,this._updateLoadPercentage.bind(this,n)),this.state.loadingPercentages[n]=-1,i.getModule().finally((function(){"loading"!==i.getState()&&(t._updateDataSourceState(i),t._updateLoadPercentage(n,{}))})))},o._updateLoadPercentage=function(e,t){var i=_extends({},this.state.loadingPercentages);i[e]=t.percentage,this.setState({loadingPercentages:i})},o._updateDataSourceState=function(e){var t=this;this._initState.then((function(){var i=t.state.dataSources,n=i.findIndex((function(t){return t.id===e.getId()}));if(-1!==n&&i[n]){var r=i.slice();r[n].state=e.getState(),t.setState({dataSources:r})}}))},o._isMarkedLoading=function(e){return this.state.loadingPercentages[e]||0===this.state.loadingPercentages[e]},o._getLoadingPercentage=function(e){var t=this.state.loadingPercentages[e];if(t&&-1!==t)return t+"%"},o._buildState=function(){var e=this;this._initState=Promise.all(this.props.dataSources.map((function(e){return Promise.all([e.exists(),e.getId(),e.getAssetId(),e.getLocalizedName(),e.getModificationTime(),e.getState(),e.getType(),e]).then((function(e){return{exists:e[0],id:e[1],assetId:e[2],name:e[3],lastModified:e[4],state:e[5],type:e[6],api:e[7]}}))}))).then((function(t){return e.setState({dataSources:t})}))},o.getTitleParams=function(){return{id:"sourceList",title:t.get("sourcePaneLabel")}},o.getButtonCollectionId=function(){return"com.ibm.bi.dashboard.dataSourcePanel.list.buttons"},o.renderPanel=function(){var e=this;return i.createElement(f,{className:"dataSourcePanelDataSourceList",length:this.state.dataSources.length,itemRenderer:function(t){return e.renderSourceItem(e.state.dataSources[t],t)},onSelectionChange:this.onSelectionChange.bind(this)})},o.renderSourceItem=function(e,n){var o=this,a=e.id,s=this.state.focusDataSourceId===a,l=this._getDateTimeString(e);return this._registerProgressHandler(n),i.createElement(m,{className:r({dataSourcePanelDataSourceListItem:!0,"dataSourcePanelDataSourceListItem--enabled":this._canSelectDataSource(e)}),selectable:this._canSelectDataSource(e),focus:s,listItemFocus:s},i.createElement("div",{className:"dataSourcePanelDataSourceListItemFocusable",tabIndex:"0","aria-label":e.name,title:e.name,onFocus:function(){return o.setState({focusDataSourceId:a})},onBlur:function(){return o.setState({focusDataSourceId:null})},onContextMenu:function(e){return o._onContextMenu(n,e)},onMouseOver:function(){return o.setState({hoverDataSourceId:a})},onMouseOut:function(){return o.setState({hoverDataSourceId:null})},onKeyPress:function(e){return o._onKeyPress(n,e)}},n>0?i.createElement("div",{className:"dataSourcePanelDivider"}):null,i.createElement(g,{direction:"row",className:"dataSourcePanelDataSourceListItemStructure"},i.createElement(h,{grow:!1,shrink:!1,className:"dataSourcePanelListIcon"},this.renderDataSourceIcon(e)),i.createElement(h,{grow:!0,shrink:!0},i.createElement("div",{className:"dataSourcePanelDataSourceInfo"},i.createElement(g,{direction:"column"},i.createElement(p,{className:"dataSourcePanelDataSourceListItemName",label:e.name,ellipsis:!0}),l&&i.createElement(p,{className:"dataSourcePanelDataSourceListItemDate",label:l,type:"caption",ellipsis:!0})))),this._isMarkedLoading(a)&&i.createElement(h,{grow:!1,shrink:!1},i.createElement(b,{iconDescription:t.get("preparingData"),description:this._getLoadingPercentage(a),className:"datasourcePanelListLoading"})),i.createElement(h,{grow:!1,shrink:!1,className:"dataSourcePanelListActions"},i.createElement(d,{iconSize:"small",variant:"icon",icon:this._iconHelper.getOverflowIcon(),onClick:function(t){return o._onActionIconClick(e,t)},"aria-label":t.get("moreTitle"),title:t.get("moreTitle"),tooltipAlignment:"start",tooltipPosition:"left"})))))},o.renderDataSourceIcon=function(e){var t,n,r;return"error"===e.state?"dataSet2"===e.type&&!0===e.exists?(t=this._iconHelper.getDataSourceWarningIcon(),n="warning"):(t=this._iconHelper.getDataSourceErrorIcon(),n="danger"):(t=this._iconHelper.getDataSourceIcon(e.type),r="is-dataSource"),i.createElement(v,{className:r,iconId:t,intent:n,size:"small"})},o._getDateTimeString=function(e){var t=e.lastModified;if(t){var i=this.props.dashboardApi.getGlassCoreSvc(".UserProfile"),n=i&&i.preferences.timeZoneID||"America/New_York";return[u.format(t,{type:"date",formatLength:"short",timezone:n}),u.format(t,{type:"time",formatLength:"short",timezone:n})].filter((function(e){return!!e})).join(" ")}},o._canSelectDataSource=function(e){return!!e&&("error"!==e.state&&(!!e.exists&&!this._isMarkedLoading(e.id)))},o._onContextMenu=function(e,t){return this._openContextMenu(this.state.dataSources[e],t)},o._onKeyPress=function(e,t){if(t.target.getAttribute("class").indexOf("dataSourcePanelDataSourceListItemFocusable")>=0&&("Enter"===t.key||" "===t.key))return this.onSelectionChange({index:e})},o._onActionIconClick=function(e,t){return t.stopPropagation(),this._openContextMenu(e,t)},o._openContextMenu=function(e,t){return t.persist(),t.pageX||(delete t.pageX,delete t.pageY),c.getActionPayload({dashboardApi:this.props.dashboardApi,id:e.assetId,type:e.type,event:t,menuId:"com.ibm.bi.dashboard.dataSources.dataSourceMenu",position:{pageX:t.pageX,pageY:t.pageY}}).then(function(t){t.activeObject.dataSource=e.api,t.activeObject.dataSourceName=e.name,t.activeObject.dataSourceCollection=this._dataSourcesSvc.getSourcesCollection(),this.props.dashboardApi.showContextMenu(t)}.bind(this))},o.onSelectionChange=function(e){var t=e.index,i=this.state.dataSources[t],n=this.props.dataSources[t];this._canSelectDataSource(i)&&this.props.onDataSourceSelected(n)},n}(s);return y.propTypes={dataSources:n.array.isRequired,moserDatasources:n.object,onDataSourceSelected:n.func.isRequired},y})),define("dashboard-analytics/dataSources/views/internal/DataSourcePanelColumnInsertionHelper",[],(function(){return function(){function e(e){var t=e.dashboardApi;this.dashboardApi=t,this._initialize()}var t=e.prototype;return t._initialize=function(){var e=this;this.dashboardApi.getCanvas().getFeature("filterDock").then((function(t){return e._filterDock=t}))},t.addToCanvas=function(e){e.data&&e.data.utils&&e.data.utils.isValid()&&this.dashboardApi.addContentToCanvas(e)},t._isLocalFilterSupported=function(){return!0},t._isGlobalFilterSupported=function(){return!1!==this._filterDock.isGlobalDockShown},t._getPageContextType=function(e,t){return"fact"===t||"date"===e||"time"===e||"datetime"===e||"timestamp"===e?"range":"tupleset"},t._addToFilter=function(e,t){for(var i,n=e.data.columns,r={scope:t,openViewOnLoad:!(n.length>1)},o=this.dashboardApi.getCanvas(),a=_createForOfIteratorHelperLoose(n);!(i=a()).done;){var s=i.value.metadataColumn;"range"===this._getPageContextType(s.getDataType(),s.getType())?r.condition={}:r.values=[],o.getFilters().addFilter({sourceId:s.getSourceId(),itemId:s.getId()},r)}},t.addToLocalFilter=function(e){if(this._isLocalFilterSupported())return this._addToFilter(e,this._filterDock.currentScope())},t.addToGlobalFilter=function(e){if(this._isGlobalFilterSupported())return this._addToFilter(e,null)},e}()})),define("dashboard-analytics/dataSources/metadata/MetadataColumn",["../../lib/@waca/core-client/js/core-client/ui/core/Class","bi/moser/moser.min","../../lib/@waca/core-client/js/core-client/i18n/V5Formatter"],(function(e,t,i){"use strict";var n={BIGINT:"integer","CHAR(":"string",DATE:"date",DATETIME:"datetime",DECIMAL:"decimal",DOUBLE:"double",FLOAT:"float",INTEGER:"integer",NCHAR:"string","NVARCHAR(":"string",SMALLINT:"integer",TIMESTAMP:"datetime",TIME:"time",TINYINT:"integer",LONG:"integer","VARCHAR(":"string",STRING:"string"},r=e.extend({init:function(e){r.inherited("init",this,arguments),this.moserObject=e.moserObject,this.sourceId=e.sourceId,this.queryService=e.queryService,this.propertyOverride=this.getPropertyOverride(),Object.defineProperty(this,"type",{get:function(){return this.getType()}}),Object.defineProperty(this,"dataType",{get:function(){return this.getDataType()}}),Object.defineProperty(this,"label",{get:function(){return this.getLabel()}}),this._leafMemberCache=[],this._nonLeafMemberCache=[]},getId:function(){return this.moserObject.getIdForExpression()},getLabel:function(){return this.moserObject.getLabel()},setLabel:function(e){this.moserObject.setLabel(e)},isHidden:function(){return this.moserObject.isHidden()},setHidden:function(e){this.moserObject.setHidden(e)},getObjectType:function(){return this.moserObject.getObjectType()},getSourceId:function(){return this.sourceId},getFacetDefinition:function(){return this.moserObject.facetDefinition},isItemHierarchy:function(){return this.moserObject.getObjectType()===t.default.MoserObjectTypes.ITEM_HIERARCHY},isMissing:function(){return this.moserObject.isMissing&&this.moserObject.isMissing()},isHierarchy:function(){return"hierarchy/level"===this.getSourceCategory()||"hierarchy/parent-child"===this.getSourceCategory()},hasMemberTree:function(){return this.isItemHierarchy()||this.isHierarchy()},isSingleRootHierarchy:function(){return!this.moserObject.isHierarchyHasMultipleRoots()},getRootMember:function(){return this.moserObject.getRootMember()},isLevel:function(){return"level"===this.getSourceCategory()},isProperty:function(){return"property"===this.getSourceCategory()},isNamedSet:function(){return"namedSet"===this.getSourceCategory()},getType:function(){return this.moserObject.getUsage?this.moserObject.getUsage()===t.default.UsageType.FACT?"fact":"attribute":null},getSourceCategory:function(){return!this.isMissing()&&this.moserObject.getSourceCategory&&null!==this.moserObject.getSourceCategory()?this.moserObject.getSourceCategory().value():null},getDataType:function(){var e;if(this.moserObject.getHighlevelDatatype){var t=this.moserObject.getHighlevelDatatype();e=t&&t.value()}return e&&e.toUpperCase||(e=this.moserObject.getDatatype?this.moserObject.getDatatype():null),(e=e?e.toUpperCase():null)&&n[e]?n[e]:"fact"===this.getType()?"decimal":"string"},isDateOrTimeType:function(){var e=this.getDataType();return"date"===e||"datetime"===e||"time"===e||"year"===e},getConcepts:function(){var e=this.moserObject.getConcepts?this.moserObject.getConcepts():null;return e?e.slice():null},getTaxonomy:function(){var e=this.moserObject.basicGetTaxonomy?this.moserObject.basicGetTaxonomy():null;return e&&e.length>0&&this.isSupportedTaxonomy(e[0])?e.slice():null},supportsConditionFilters:function(){if(this.isNamedSet())return!1;var e=this.getTaxonomy(),t=!0;return e&&e.forEach((function(e){var i=e.getFamily();"cLatitude"!==i&&"cLongitude"!==i||(t=!1)})),t},isSupportedTaxonomy:function(e){return"cGeoLocation"!==e.getClazz()||"cPosition"!==e.getFamily()},getDefaultAggregation:function(){if(!this._defaultAggregation){var e=this.moserObject.getRegularAggregate&&this.moserObject.getRegularAggregate()?this.moserObject.getRegularAggregate().value():null;this._defaultAggregation=r.AGGREGATION_TYPE_MAP[e]||"unknown",-1===r.SUPPORTED_AGGREGATION_FOR_ATTRIBUTE.indexOf(this._defaultAggregation)&&"attribute"===this.getType()&&(this._defaultAggregation=r.AGGREGATION_TYPE_MAP.countDistinct)}return this._defaultAggregation},getAggregateMode:function(){if(this.moserObject.getAggregateMode){var e=this.moserObject.getAggregateMode();return e?e.value():null}return null},isFilter:function(){return this.moserObject.getObjectType()===t.default.MoserObjectTypes.FILTER},getFormat:function(){return i.getFormatSpec(this.moserObject.getFormat&&this.moserObject.getFormat())},getRefToHierarchy:function(){return this.moserObject.getRefToHierarchy?this.moserObject.getRefToHierarchy():null},isOlapColumn:function(e){void 0===e&&(e=!1);var t=this.getSourceCategory(),i=e&&"Calculation"===this.getObjectType();return this.isNamedSet()||i||t&&"column"!==t&&"QueryItem"===this.getObjectType()},getParent:function(){for(var e=this.moserObject.getParent();e&&e.getObjectType()===t.default.MoserObjectTypes.ITEM_TYPE;)e=e.getParent();return e?new r({moserObject:e,sourceId:this.sourceId}):null},isEditableCalculation:function(){return!this.moserObject.isImported()&&(this.getObjectType()===t.default.MoserObjectTypes.CALCULATION||this.getObjectType()===t.default.MoserObjectTypes.QUERY_ITEM)},getDefaultSortType:function(){var e=this.moserObject.getFacetDefinition?this.moserObject.getFacetDefinition():null;if(!e||!e.enabled||e.enabled&&("false"===e.enabled.enumValue||"automatic"===e.enabled.enumValue))return null;var t=e.getSortList();if(t){var i=t.basicGetSortItem();if(i&&i.length>0){var n=i[0];return"descending"===n.order.enumValue?"desc":"ascending"===n.order.enumValue?"asc":null}}return null},isCachedLeafMember:function(e){return this._leafMemberCache.indexOf(e)>-1},isCachedNonLeafMember:function(e){return this._nonLeafMemberCache.indexOf(e)>-1},cacheMember:function(e,t){t?this._leafMemberCache.push(e):this._nonLeafMemberCache.push(e)},isLeafMember:function(e){var t=this;return this.isCachedLeafMember(e)?Promise.resolve(!0):this.isCachedNonLeafMember(e)?Promise.resolve(!1):this.queryService.getChildren(this.sourceId,[this.getId()],e,[]).then((function(i){var n=0===i.getRowCount();return t.cacheMember(e,n),n}))},getValues:function(){return this.values},setValues:function(e){this.values=e},getTableName:function(){var e=this.getTable();return e?e.getIdentifier():""},getTable:function(){if(!this.table)for(var e=this.moserObject.getParent();e;){if(e.getObjectType()===t.default.MoserObjectTypes.QUERY_SUBJECT){this.table=e;break}e=e.getParent()}return this.table},isNumericDataType:function(){var e=this.getDataType();return-1===["string","attribute","date","time","datetime"].indexOf(e)},isDateTimeDataType:function(){var e=this.getDataType();return-1!==["date","time","datetime"].indexOf(e)},getPropertyOverride:function(){return this.moserObject.getPropertyOverride().filter((function(e){return-1===e.indexOf("property")})).map(function(e){return{property:e,value:this.getProperty(e)}}.bind(this))},getProperty:function(e){if(this.moserObject[e])return this.moserObject[e].value?this.moserObject[e].value():this.moserObject[e];var t=this.moserObject.getProperty().find((function(t){return e===t.getName()}));return t&&t.getValue()},getMoserObject:function(){return this.moserObject},getHierarchyLevelIds:function(){return this.moserObject.getItem().filter((function(e){return e.queryItem})).map((function(e){return e.queryItem.getIdForExpression()}))||[]}});return r.AGGREGATION_TYPE_MAP={none:"none",average:"avg",automatic:"automatic",calculated:"calculated",count:"count",countDistinct:"countdistinct",maximum:"max",median:"median",minimum:"min",standardDeviation:"stddev",total:"sum",variance:"variance"},r.SUPPORTED_AGGREGATION_FOR_ATTRIBUTE=[r.AGGREGATION_TYPE_MAP.none,r.AGGREGATION_TYPE_MAP.count,r.AGGREGATION_TYPE_MAP.countDistinct],r.SUPPORTED_AGGREGATION_FOR_FACT=[r.AGGREGATION_TYPE_MAP.average,r.AGGREGATION_TYPE_MAP.total,r.AGGREGATION_TYPE_MAP.minimum,r.AGGREGATION_TYPE_MAP.maximum,r.AGGREGATION_TYPE_MAP.count,r.AGGREGATION_TYPE_MAP.countDistinct],r})),define("dashboard-analytics/dataSources/utils/ShapingConstants",[],(function(){return{DROP_TARGET_OPTIONS:{NONFILTER:"nonFilter",SLOT:"slot",FILTER:"filter"}}})),define("dashboard-analytics/metadataDND/MetadataDNDMapping",["underscore","../dataSources/metadata/MetadataColumn","bi/moser/moser.min"],(function(e,t,i){var n=[i.default.SourceCategoryType.HIERARCHY_LEVEL,i.default.SourceCategoryType.HIERARCHY_PARENT_CHILD,i.default.SourceCategoryType.LEVEL,i.default.SourceCategoryType.COLUMN],r=[i.default.MoserObjectTypes.QUERY_ITEM];return function(){function t(e,t,i){void 0===i&&(i={}),this.moduleAPI=e,this.dashboard=t,this.dataSource=this.dashboard.getFeature("DataSources").getDataSource(e.getSourceId()),this.moserObjects=i.moserObjects||[],this.dNDResults=[],this._processMetadataMapping()}var o=t.prototype;return o.getMappedResults=function(){return this.dNDResults},o.getUtils=function(){return{getColumnsWithMembers:this.getColumnsWithMembers.bind(this)}},o.getColumnsWithMembers=function(t){void 0===t&&(t=!1);var i={};return e.each(this.dNDResults,(function(e){var n=e.mappedMetadataColumn,r=e.members;n&&(t&&!r.length||(i[n.getId()]=r))})),i},o._processMetadataMapping=function(){var e=this;this.moserObjects.forEach((function(t){var i,r,o={};if(e._isMemberType(t)){var a=e._memberSearchSubject();(r=e._getMappedMoserObject(t,a))?(i=e._getSourceCategory(r),-1!==n.indexOf(i)?(o.members={id:t.getIdForExpression(),memberCaption:t.getMemberCaption(),calculatedMemberType:t.calculatedMemberType&&t.calculatedMemberType.value()},r=e._normalizeMappedMoserObject(r,t,i)):r=t):r=t}else r=t;var s=r.getReferencedObject?r.getReferencedObject():null;s&&(o.referencedObject=e.dataSource.getMetadataColumn(s.getIdForExpression())),o.mappedMetadataColumn=e.dataSource.getMetadataColumn(r.getIdForExpression()),e._addDNDResult(o)}))},o._getSourceCategory=function(e){var t=e.getSourceCategory();return t||e.getObjectType()!==i.default.MoserObjectTypes.QUERY_ITEM||(t=i.default.SourceCategoryType.COLUMN),t},o._getMappedMoserObject=function(e,t){return t?t&&this._isMemberType(t)?i.default.ModuleUtils.getTreeAncestor(t,r):t:i.default.ModuleUtils.getTreeAncestor(e,r)},o._memberSearchSubject=function(){return this.moduleAPI.getShapingHelper().getMemberSearchSubject()},o._isMemberType=function(e){return"MemberType"===e.getObjectType()},o._normalizeMappedMoserObject=function(e,t,n){return n===i.default.SourceCategoryType.LEVEL?this.moduleAPI.getMetadataColumn(t.getLevelUniqueName()).moserObject:e},o._addDNDResult=function(e){void 0===e&&(e={});var t=this.dNDResults.find((function(t){return!(!e.mappedMetadataColumn||!t.mappedMetadataColumn)&&t.mappedMetadataColumn.getId()===e.mappedMetadataColumn.getId()}));t?e.members&&t.members.push(e.members):(e.members=e.members?[e.members]:[],this.dNDResults.push(e))},t}()})),define("dashboard-analytics/dataSources/utils/ShapingUIUtils",["ca-modeller/services","ca-modeller/shaping","../nls/StringResources","underscore","../metadata/MetadataColumn","./ShapingConstants","../../metadataDND/MetadataDNDMapping"],(function(e,t,i,n,r,o,a){var s=["QuerySubject","FolderType","Folder","DrillGroup"],l=1,c=2,u=3,d=4,h=5,g="xCalcWithFormula";return function(){function r(){}return r.renderCalculationDialog=function(e,i,n,r,o){var a=e.getShapingHelper(o);if(!i)return a.openExpressionDialog(a.getModule());var s=[];return i.forEach((function(t){s.push(e.getMoserObject(t))})),n&&"customCalculation"===t.getExpressionType(s[0])?r&&!0===r.forceGlobal?a.openExpressionDialog(s[0],!0,{forceGlobal:!0}):a.openExpressionDialog(s[0],!0):r&&!0===r.forceGlobal?a.openSimpleCalculationDialog(s,n,{forceGlobal:!0}):a.openSimpleCalculationDialog(s,n)},r.renderMemberCalculationDialog=function(e,t,n,r,o){var a;return a=e.getMoserObject(t),e.getShapingHelper(o).openExpressionDialog(a,"modeler-wa-member",i.get("memberCalculationDialogLabels"),null,n,r)},r.renderCustomGroupDialog=function(e,i,n,r,o,a){return e.load().then((function(){o||(o={startView:t.customGroupUtils.getCustomGroupViews().CUSTOM_GROUP_VIEW_NAME});var s=e.getShapingHelper(a),l=e.getMoserObject(i);return s.customGroupAction(l,n,o,r).then((function(n){return function(e){var i=t.customGroupUtils.getCustomGroupMessageIds().CUSTOM_GROUP_INT_MSG_SUCCESS;return e.messages&&1===e.messages.length&&e.messages[0].messageId===i}(n)?(e.addShapingReference(n.data.element.idForExpression,i),n.data):Promise.reject(n)}))}))},r.renderJoinDialog=function(e){return e.getShapingHelper().openJoinDialog()},r.validateCustomGroup=function(e,i,n,r){var o={startView:t.customGroupUtils.getCustomGroupViews().CUSTOM_GROUP_VIEW_NAME},a=e.getMoserObject(i);return t.customGroupUtils.validateCustomGroup(a,n,o,r)},r.createCustomBinning=function(e,i,n,r,o){return e.load().then((function(){var a=e.getShapingHelper(o),s=e.getMoserObject(i);return(n?a.editCustomBin(s,r):a.createCustomBin(s,r)).then((function(n){return function(e){var i=t.customBinUtils.getCustomBinMessageIds().CUSTOM_BIN_MSG_SUCCESS;return e.messages&&1===e.messages.length&&e.messages[0].messageId===i}(n)?(e.addShapingReference(n.data.element.idForExpression,i),n.data):Promise.reject(n)}))}))},r.validateCustomBinning=function(e,i,n){var r={startView:t.customBinUtils.getCustomBinViews().CUSTOM_BIN_VIEW_SILENT},o=e.getMoserObject(i);return t.customBinUtils.validateCustomBin(o,!1,r,n)},r.removeColumnFromModule=function(e,t,i){return e.load().then((function(){var n=e.getShapingHelper(i),r=e.getMoserObject(t);n.removeFromModule([r]),e.removeShapingReference(t)}))},r.getCustomBinning=function(e,t){var i=e.getMoserObject(t),n=i&&i.getProperty&&i.getProperty("_MUI_expr");return n&&1===n.length?JSON.parse(n[0].value):null},r.renderGrid=function(e,i,n,o,a){return e.load().then((function(){var s=e.getShapingHelper(),l={onBeginDrag:function(t){r.onBeginDrag(e,a,t)},onEndDrag:function(){s.clearSelection()},querySubjects:s.getModule().basicGetQuerySubject(),selectedId:o,enableDataQuality:i};s.render(t.ShapingTabGrid,l,n)}))},r.renderDiagram=function(e,i,n){return void 0===n&&(n={}),e.load().then((function(){var r=e.getShapingHelper(),o=n.queryItems||[],a=n.querySubjects||[];r.setSelection([].concat(o,a)),r.render(t.ShapingDiagram,{},i)}))},r.copySelectedTreeItems=function(e){var t=e.getShapingHelper().getSelection();r.selectedTreeItems=t,r.moduleAPI=e},r.clearCopiedTreeItems=function(){r.selectedTreeItems=void 0},r.getCopiedTreeItems=function(e,t){e=e||r.moduleAPI;var i=r.selectedTreeItems;if(!i)return null;var n={data:{items:i},type:"MODEL_ITEM"};return r.onBeginDrag(e,t,n.data),n},r.renderTree=function(e,i,n,o){return e.load().then((function(){var a=!e.isOlapPackage(),s=e.getShapingHelper(),l={onBeginDrag:function(t){r.onBeginDrag(e,i,t)},onKeyDown:function(t,n){r.onKeyDown(o,n,t,e,i)},onEndDrag:function(){s.clearSelection()},showModule:!1,allowReorder:!1,showFullPackage:!0,showNavigationGroups:a,forceGlobalCalcs:!1};s.render(t.ShapingTree,l,n)}))},r.onKeyDown=function(e,t,i,n,o){t.data||(t.data={}),t.data.items=t,r.onBeginDrag(n,o,t.data),t.type="MODEL_ITEM",e(t,i)},r.onBeginDrag=function(e,t,i){var o=r.getMetadataColumnsFromDnDPayload(e,t,i);n.extend(i,o),i.isValid=function(e){return console.warn("isValid is depreacted. Use payload.utils.isValid."),r.isValid(i,e)}},r.getMetadataColumnsFromDnDPayload=function(e,t,i){var o=i.items,l=new a(e,t,{moserObjects:o}),c=l.getMappedResults(),u=[];c.forEach((function(e){var t=e.mappedMetadataColumn,i=e.referencedObject||t,n=i&&i.getObjectType(),r=null;n&&-1===s.indexOf(n)&&(r=i);var o={metadataColumn:r,original:{metadataColumn:t||r,members:e.members}};u.push(o)}));var d={isValid:function(e){return r.isValid(i,e)}},h=l.getUtils();return{sourceId:e.getSourceId(),columns:u,utils:n.extend(d,h)}},r.isValid=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i,r,a=null,l=e.columns;if((a=n.map(l,(function(e){return e.original.metadataColumn})),r=(i=n.map(l,(function(e){return e.metadataColumn}))).length&&e.utils.getColumnsWithMembers(),!n.isEmpty(r))&&n.find(n.flatten(Object.values(r)),(function(e){return e.calculatedMemberType===g})))return!1;if(!a||0===a.length||!i||0===i.length)return!1;var c=!1;(t.fromCanvas||t.fromTemplate)&&(c=!0);for(var u=0,d=0;d<a.length;++d){var h=a[d]&&a[d].getObjectType();if(!h||s.indexOf(h)>=0)return!1;if("Filter"===h){if(t.dropTarget&&t.dropTarget!==o.DROP_TARGET_OPTIONS.FILTER)return!1;u++}}return(!c||u!==a.length)&&!this.isInvalidDragObject(i,null,r)},r.isInvalidDragObject=function(e,t,i,r){var o=this;return!((!t||n.isEmpty(t))&&r)&&(t=t||{},n.some(e,(function(e){return!e||o._canNotDropMetadata(t,e,i,r)})))},r._canNotDropMetadata=function(e,t,i,r){var o,a;i=i||{};var s=function(e){return void 0!==i[e]&&!n.isEmpty(i[e])},g=null;if(t.isHierarchy&&t.isHierarchy())g=s(o=t.getId())?d:l;else{if(t.isMissing()||!(t.isLevel()||t.isProperty()||t.isNamedSet()))return!1;(o=t.getParent().getId())||(o=t.getReferencedHierarchyId()),g=t.isNamedSet()?s(o)?h:u:c}return a=this._isRestrictedMetadata(e,o,g),r||this._addMetadataToMap(e,o,g),a},r._isRestrictedMetadata=function(e,t,i){var r=e[t];if(!r||!r.length)return!1;switch(i){case l:return n.some(r,(function(e){return e!==d}));case d:return n.some(r,(function(e){return e!==l&&e!==d}));case u:return n.some(r,(function(e){return e!==h}));case h:return n.some(r,(function(e){return e!==u&&e===h}));case c:return n.some(r,(function(e){return e!==c}));default:return!1}},r._addMetadataToMap=function(e,t,i){e[t]||(e[t]=[]),-1===e[t].indexOf(i)&&e[t].push(i)},r.migrateCDE=function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(i,n,r){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cdeService.migrateCDE(i,n,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,i,n){return t.apply(this,arguments)}}(),r}()})),define("dashboard-analytics/dataSources/views/internal/pages/DataSourcePanelMetadataTree",["underscore","../../../nls/StringResources","react","prop-types","@ba/ba-ui-carbon","@ba/ba-ui-carbon-toolkit","./DataSourcePanelPage","../DataSourcePanelColumnInsertionHelper","../DataSourcePanelStatic","../../../utils/ShapingUIUtils","../../../../lib/@waca/core-client/js/core-client/ui/KeyCodes"],(function(e,t,i,n,r,o,a,s,l,c,u){var d=r.InlineLoading,h=o.FlexLayout,g=o.Label,p={PENDING:"pending",FULFILLED:"fulfilled",REJECTED:"rejected"},f=function(){function e(){var e=this;this.ref=i.createRef(),this.promise=new Promise((function(t){return e._set=t})),this.promise.then((function(){return e._set=null}))}return e.prototype.update=function(){this._set&&this.ref.current&&this._set(this.ref.current)},e}(),m=function(e){function n(t){var i;return(i=e.call(this,t)||this).state.moduleStatus=p.PENDING,i.treeContainer=new f,i._registerProgressHandler(),i._initShapingTree(),i._initState=Promise.all([i._initialize(),i._setupModuleStatus()]),i}_inheritsLoose(n,e);var r=n.prototype;return r._registerProgressHandler=function(){this.props.moserDatasources&&this.props.moserDatasources.registerLoadMetadataProgressHandler(this.props.dataSource.getId(),this._updateLoadPercentage.bind(this))},r._updateLoadPercentage=function(e){this.setState({loadingPercentage:e.percentage})},r._initShapingTree=function(){var e=this;Promise.all([this.props.dataSource.getModule(),this.treeContainer.promise]).then((function(t){var i=t[0],n=t[1];return e._renderShapingTree(i,n)}))},r._initialize=function(){var e=this;return this._insertionHelper=new s({dashboardApi:this.props.dashboardApi}),this.props.dataSource.getLocalizedName().then((function(t){return e.setState({name:t})}))},r._setupModuleStatus=function(){var e=this;return this.props.dataSource.getModule().then((function(t){"error"===e.props.dataSource.getState()?e.setState({moduleStatus:p.REJECTED}):e.setState({moduleStatus:p.FULFILLED,module:t})}),(function(){e.setState({moduleStatus:p.REJECTED})}))},r.getButtonCollectionId=function(){return"com.ibm.bi.dashboard.dataSourcePanel.metadata.buttons"},r.getButtonConstructorPayload=function(){var t=e.prototype.getButtonConstructorPayload.call(this);return t.dataSource=this.props.dataSource,t},r.componentDidUpdate=function(){this.treeContainer.update()},r.componentDidMount=function(){this.treeContainer.update()},r.getTitleParams=function(){return{id:"source",title:this.state.name}},r.renderPanel=function(){switch(this.state.moduleStatus){case p.PENDING:return this._renderTreeLoading();case p.FULFILLED:return this._renderTreePlaceholder();default:return this._renderTreeError(t.get("errorSourcesTitle"),t.get("errorLoadingDataTree"))}},r._getLoadProgressString=function(){if(this.state.loadingPercentage)return t.get("dataPreparationProgress",{percentage:this.state.loadingPercentage})},r._renderTreeLoading=function(){return i.createElement(h,{alignItems:"center",justifyContent:"center",outerClassName:"datasourcePanelLoading"},i.createElement("div",null,i.createElement(g,{className:"dataSourcePanelStaticTitle",label:t.get("dataPreparationTitle")}),i.createElement(g,{className:"dataSourcePanelStaticCaption",label:t.get("dataPreparationCaption")}),i.createElement(d,{iconDescription:t.get("preparingData"),description:this._getLoadProgressString()})))},r._renderTreeError=function(e,t){return i.createElement(l,{className:"dataSourcePanelMetadataError",iconType:l.ICON_TYPES.error,title:e,caption:t})},r._renderTreePlaceholder=function(){return i.createElement("div",{className:"dataSourcePanelMetadataTreeContainer",ref:this.treeContainer.ref})},r._renderShapingTree=function(e,t){var i=this;return c.renderTree(e,this.props.dashboardApi,t,(function(e,t){return i._onShapingTreeKeyPress(e,t)}))},r._copySelectedTreeItems=function(){return this.props.dataSource.getModule().then((function(e){return c.copySelectedTreeItems(e)}))},r._onShapingTreeKeyPress=function(e,t){return(t.ctrlKey||t.metaKey)&&t.keyCode===u.C?this._copySelectedTreeItems():t.shiftKey&&t.keyCode===u.RIGHT_ARROW?this._insertionHelper.addToCanvas(e):t.shiftKey&&t.altKey&&t.keyCode===u.F?this._insertionHelper.addToGlobalFilter(e):t.shiftKey&&t.keyCode===u.F?this._insertionHelper.addToLocalFilter(e):void 0},n}(a);return m.propTypes={dashboardApi:n.object.isRequired,dataSource:n.object.isRequired,moserDatasources:n.object,onShowDataSourceList:n.func.isRequired},m.MODULE_STATUS=p,m})),define("dashboard-analytics/dataSources/views/internal/DataSourcePanelComponent",["underscore","../../nls/StringResources","react","prop-types","./CachingPageContainer","./TransientStateManager","./pages/DataSourcePanelEmpty","./pages/DataSourcePanelList","./pages/DataSourcePanelMetadataTree"],(function(e,t,i,n,r,o,a,s,l){var c=function(e){function n(){for(var t,i,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];(i=e.call.apply(e,[this].concat(r))||this)._setupEvents(),i.transientStateManager=new o({transientState:i.props.transientState,transientStateKey:"dataSourcePaneState",typeToCreator:(t={},t.noDataSources=function(){return i._createEmptyPage()},t.dataSourceList=function(){return i._createSourceListPage()},t.metadata=function(e){var t=e.dataSourceId;return i._createMetadataPage(t)},t),validatePage:function(e,t){return i._validatePage(e,t)},onStateChange:function(){return i.forceUpdate()}}),i.state={dataSources:i._getDataSources()};var s=i.transientStateManager.getCurrentValue();return s&&i._currentPageIsValid()||i._setupInitialPage(),i}_inheritsLoose(n,e);var c=n.prototype;return c._setupEvents=function(){var e=this;this.registeredEvents=[];var t=this.props.dashboardApi;this.registeredEvents.push(t.on("widget:selected",(function(t){return e.onWidgetSelected(t)}))),this.registeredEvents.push(t.on("dataSourceGrid:dataSourceSelected",(function(t){return e.onDataSourceSelected(t)}))),this.registeredEvents.push(t.on("dataSourcePanel:dataSourceAdded",(function(t){return e.onUserDataSourceAdded(t)})));var i=this._getDataSourcesCollection();this.registeredEvents.push(i.on("change:assetId",(function(){return e.onDataSourceCollectionUpdated()}))),this.registeredEvents.push(i.on("change:state",(function(){return e.onDataSourceCollectionUpdated()}))),this.registeredEvents.push(i.on("add",(function(){return e.onDataSourceAdded()}))),this.registeredEvents.push(i.on("remove",(function(){return e.onDataSourceRemoved()}))),this.registeredEvents.push(i.on("change:version",(function(t){return e.onDataSourceUpdated(t.model.id)})))},c._setupInitialPage=function(){if(this._getDataSources().length){var e=this._getActiveDataSource();e?this.showMetadataPage(e,{resetFocus:!0,triggerEvent:!1}):this.showSourceListPage()}else this.showEmptyPage()},c._validatePage=function(e,t){if("noDataSources"===e)return 0===this._getDataSources().length;if("dataSourceList"===e)return this._getDataSources().length>0;if("metadata"===e){var i=t&&t.dataSourceId,n=this._getActiveDataSource(),r=n&&n.getId()===i,o=i&&this._getDataSource(i);return r&&!!o}return!1},c._currentPageIsValid=function(){var e=this.transientStateManager.getCurrentDescriptor(),t=e.type,i=e.payload;return this._validatePage(t,i)},c._getDataSourcesCollection=function(){var e=this.props.dashboardApi.getFeature("dataSources.deprecated");return e&&e.getSourcesCollection()},c._getDataSources=function(){var e=this._getDataSourcesCollection();return e&&e.getSources()},c._getActiveDataSource=function(){var e=this._getDataSources();if(e&&e.length){if(1!==e.length){var t=this.props.dashboardApi.getActiveDataSourceId();return t&&this._getDataSource(t)}var i=e[0];if("error"!==i.getState())return i}},c._getDataSource=function(e){return this._getDataSources().find((function(t){return t.getId()===e}))},c.componentDidUpdate=function(){this._updateFocus()},c.componentDidMount=function(){this._updateFocus()},c._updateFocus=function(){if(this.state.resetFocus){var e=this.transientStateManager.getCurrentValue();if(e.ref&&e.ref.current)e.ref.current.resetFocus()&&this.setState({resetFocus:!1})}},c.componentWillUnmount=function(){this.registeredEvents.forEach((function(e){return(0,e.remove)()})),this.registeredEvents=[],this.transientStateManager.destroy()},c.render=function(){var e=this.transientStateManager.getValues(),t=this.transientStateManager.getCurrentValue();return i.createElement(r,{className:"datasetPanelPageContainer",pages:e,currentPageId:t&&t.id})},c._createEmptyPage=function(){var e=this;return{id:"noDataSources",component:a,className:"datasetPanelPage",props:function(){return{dashboardApi:e.props.dashboardApi,iconsFeature:e.props.dashboardApi.getFeature("Icons")}}}},c._createSourceListPage=function(){var e=this;return{id:"dataSourceList",component:s,className:"datasetPanelPage",props:function(){return{dashboardApi:e.props.dashboardApi,dataSources:e.state.dataSources,moserDatasources:e.props.dashboardApi.getFeature("DataSources.moser"),onDataSourceSelected:function(t){return e.onDataSourceSelected(t,!0)},iconsFeature:e.props.dashboardApi.getFeature("Icons")}}}},c._createMetadataPage=function(e){var n=this,r=i.createRef();return{id:e,component:l,className:"datasetPanelPage",ref:r,props:function(){return{previousPages:[{id:"dataSourceList",title:t.get("sourcePaneLabel"),onSelect:function(){return n.onShowDataSourceList()}}],dashboardApi:n.props.dashboardApi,dataSource:n._getDataSource(e),moserDatasources:n.props.dashboardApi.getFeature("DataSources.moser"),iconsFeature:n.props.dashboardApi.getFeature("Icons"),ref:r}}}},c.showEmptyPage=function(){this.transientStateManager.setCurrentDescriptor("noDataSources")},c.showSourceListPage=function(){this.transientStateManager.setCurrentDescriptor("dataSourceList")},c.showMetadataPage=function(e,t){var i=void 0===t?{}:t,n=i.resetFocus,r=void 0!==n&&n,o=i.triggerEvent,a=void 0===o||o;this.setState({resetFocus:r}),this.transientStateManager.setCurrentDescriptor("metadata",{dataSourceId:e.getId()}),this.props.dashboardApi.getFeature("DataSources").setActiveDataSourceId(e.getId()),a&&this.props.dashboardApi.triggerDashboardEvent("dataSourcePanel:dataSourceSelected",{sender:e.getId()})},c.getCurrentPage=function(){var e=this.transientStateManager.getCurrentDescriptor();return e&&e.type},c.removeMetadataPage=function(e){this.transientStateManager.removeDescriptor("metadata",{dataSourceId:e})},c.onWidgetSelected=function(e){if(e.sender){var t=this._getDataSourcesCollection(),i=t&&t.usesSource(e.sender),n=i&&t.getSource(i);n&&"error"!==n.getState()&&this.showMetadataPage(n,{triggerEvent:!1})}},c.onDataSourceSelected=function(e,t){void 0===t&&(t=!1),this.showMetadataPage(e,{resetFocus:!0,triggerEvent:t})},c.onUserDataSourceAdded=function(e){var t=this._getDataSource(e.sender);e.sender&&t?this.showMetadataPage(t):this.showSourceListPage()},c._onDataSourceCollectionChange=function(){var e=this._getDataSources();return this.setState({dataSources:e}),e},c.onDataSourceCollectionUpdated=function(){this._onDataSourceCollectionChange()},c.onDataSourceAdded=function(){var e=this._onDataSourceCollectionChange();"noDataSources"===this.getCurrentPage()&&this.showMetadataPage(e[0])},c.onDataSourceRemoved=function(){var e=this._onDataSourceCollectionChange();e&&e.length?this.showSourceListPage():this.showEmptyPage()},c.onDataSourceUpdated=function(e){this.props.dashboardApi.triggerDashboardEvent("dataSourcePanel:dataSourceSelected",{sender:e,refreshDatasetAction:!0}),this.removeMetadataPage(e);var t=this._getDataSource(e);this.showMetadataPage(t,{resetFocus:!0})},c.onShowDataSourceList=function(){this.showSourceListPage()},n}(i.Component);return c.PAGE_TYPES={EMPTY:"noDataSources",SOURCE_LIST:"dataSourceList",METADATA:"metadata"},c.propTypes={dashboardApi:n.object.isRequired,transientState:n.shape({get:n.func.isRequired,set:n.func.isRequired}).isRequired,actionHandlers:n.shape({addDataSource:n.func.isRequired}).isRequired},c})),define("dashboard-analytics/dataSources/views/DataSourcePanel",["underscore","../../lib/@waca/core-client/js/core-client/ui/core/View","react","react-dom","./internal/DataSourcePanelComponent"],(function(e,t,i,n,r){return function(e){function t(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];t=e.call.apply(e,[this].concat(n))||this;var o=n[0];return t.dashboardView=o.glassContext.appController.getCurrentContentView(),t.dashboardView.addReloadableObject(t.viewId,_assertThisInitialized(t)),t.initialize(),t}_inheritsLoose(t,e);var o=t.prototype;return o.initialize=function(){this.dashboardApi=this.dashboardView.getDashboardApi()},o.remove=function(){return this.$el&&n.unmountComponentAtNode(this.$el[0]),e.prototype.remove.call(this)},o.reload=function(){n.unmountComponentAtNode(this.$el[0]),this.initialize(),this.render()},o.render=function(){var e=this;return this.$el.addClass("datasetPanel"),this.reactComponents=n.render(i.createElement(r,{dashboardApi:this.dashboardApi,transientState:{get:function(t){return e.dashboardView.getTransientState(t)},set:function(t,i){return e.dashboardView.setTransientState(t,i)}}}),this.$el[0]),this},t}(t)})),define("text!dashboard-analytics/util/templates/AnalyticsColorSet.html",[],(function(){return"{{~ it.colors : color }}\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetIcons .dataWidgetIcon:not(.complexSvg) svg,\n\t.fill-{{=color.name}}.widget .widgetIcons .dataWidgetIcon:not(.complexSvg) svg {\n\t\tfill: {{=it.dataWidgetFilterColor1UserPaletteColor[color.name]}} !important;\n\t}\n\n\t.fill-{{=color.name}} .fill-transparent.widget .widgetIcons .dataWidgetIcon.complexSvg svg,\n\t.fill-{{=color.name}}.widget .widgetIcons .dataWidgetIcon.complexSvg svg {\n\t\tbackground-color: {{=it.dataWidgetFilterColor1UserPaletteColor[color.name]}} !important;\n\t\t{{? color.hexValue !== 'transparent'}}\n\t\tcolor: {{=color.hexValue}} !important;\n\t\t{{?}}\n\t}\n{{~}}"})),define("dashboard-analytics/util/AnalyticsColorSet",["doT","text!./templates/AnalyticsColorSet.html"],(function(e,t){var i=function(){function e(){}return e.getColorStyles=function(t,i){return t.getForegroundCSSColors("DataWidgetFilterColor1UserPaletteColor",i).then((function(n){return e.dotTemplate({colors:t.getColorSet(i),dataWidgetFilterColor1UserPaletteColor:n})}))},e}();return i.dotTemplate=e.template(t),i})),define("dashboard-analytics/layers",["./dataSources/services/DatasetExecutionService","./drill-through/models/DrillThroughService","./drill-through/models/DrillThroughModel","./dataSources/models/synchronizeData/SynchronizeService","./dataSources/glassControllers/SourceActionHandler","./dataSources/glassControllers/AddSourceActionHandler","./visualizations/LiveVisualizationActionHandler","./filters/dock/FilterContainerView","./filters/dock/FilterContainerCollapseView","./dialogs/CommonViewWrapper","./dataSources/views/DataSourcePanel","./util/AnalyticsColorSet"],(function(){})),define("datasource-signon/data/internal/DataSourceConnection",["../../lib/@waca/core-client/js/core-client/ui/core/Class"],(function(e){"use strict";var t=e.extend({init:function(e){t.inherited("init",this,arguments),e=e||{},this.name=e.datasource,this.connection=e.connection,this.signon=e.signon},addSignon:function(e){this.signon=this.signon||e},getSignon:function(){return this.signon},getConnection:function(){return this.connection},getValue:function(){var e={datasource:this.name,connection:this.connection};return this.signon&&(e.signon=this.signon),e}});return t})),define("datasource-signon/data/internal/DataSourceConnectionCache",["../../lib/@waca/core-client/js/core-client/ui/core/Class","underscore","./DataSourceConnection"],(function(e,t,i){"use strict";var n=e.extend({init:function(){n.inherited("init",this,arguments),this.cache={},this.datasources={}},destroy:function(){this.cache={},this.datasources={}},addDatasourceConnection:function(e,t,i){this._isValid(e,"key"),this._isValid(t,"datasource"),this._isValid(i,"connection");var n=this._addKey(e);return this._addDatasourceConnection(n,t,i),this.getConnections(e)},addSignon:function(e,t,i,n){this._isValid(e,"key"),this._isValid(t,"datasource"),this._isValid(i,"connection"),this._isValid(n,"signon");var r=this._addKey(e);return this._addDatasourceConnection(r,t,i).addSignon(n),this.getConnections(e)},getConnections:function(e){var i,n=this.cache[e];return n&&(i=[],t.each(n,(function(e){i.push(e.getValue())}))),i},clearResolvedConnections:function(e,t){var i=this.cache[e];i&&delete i[t]},isConnectionResolved:function(e,t){var i=this.cache[e];return!!i&&!!i[t]},isSignonResolved:function(e,t){var i=this.cache[e];if(i){var n=i[t];return!!n&&!!n.getSignon()}return!1},getDatasourceConnectionString:function(e,t,i){return this.addDatasourceConnection(e,t,i),this.cache[e][t].getConnection()},_addKey:function(e){return e in this.cache||(this.cache[e]={}),this.cache[e]},_addDatasourceConnection:function(e,t,n){return t in e||(t in this.datasources||(this.datasources[t]=new i({datasource:t,connection:n})),e[t]=this.datasources[t]),e[t]},_isValid:function(e,t){if(!e)switch(t){case"key":throw new Error("key is not provided.");case"datasource":throw new Error("datasource is not provided.");case"connection":throw new Error("connection is not provided.");case"signon":throw new Error("signon is not provided.")}}});return n})),define("datasource-signon/nls/DatasourceSignonResources",{root:!0,cs:!0,da:!0,de:!0,es:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,it:!0,ja:!0,kk:!0,ko:!0,no:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-br":!0,ro:!0,ru:!0,sl:!0,sv:!0,th:!0,tr:!0,zh:!0,"zh-cn":!0,"zh-tw":!0}),define("datasource-signon/nls/root/DatasourceSignonResources",{title_connection:"Select a connection",title_signon:"Select a signon",select_connection:"Select a connection to use for the '%{dataSourceName}' data source:",select_signon:"Select a signon to use for this '%{connection}' connection and '%{dataSourceName}' data source:",button_ok:"OK",button_cancel:"Cancel",connection_option:"Connection option",signon_option:"Signon option",connection_dialog:"Connection dialog",signon_dialog:"Signon dialog"}),define("datasource-signon/nls/StringResources",["i18n!./DatasourceSignonResources","polyglot"],(function(e,t){var i=new t({phrases:e}),n=function(){};return n.prototype.get=function(e,t){return i.t(e,t)},new n})),define("datasource-signon/ui/internal/ConnectionSignonOptions",["underscore","../../nls/StringResources","react","prop-types","@ba/ba-ui-carbon-toolkit"],(function(e,t,i,n,r){var o=r.RadioGroup,a=function(n){function r(e){_classCallCheck(this,r);var t=_possibleConstructorReturn(this,n.call(this,e));return t.state={checked:t.props.selectedValue},t}return _inherits(r,n),r.prototype._selectionOption=function(t){var i=this;this._options=[],e.each(t.values,(function(e){i._options.push({label:e.name,value:e})}))},r.prototype._onClickOption=function(e){this.setState({checked:e}),this.props.onClickOption(e)},r.prototype.render=function(){var e=this;this._selectionOption(this.props.getData());var n="connection"===this.props.type?t.get("connection_option"):t.get("signon_option");return i.createElement("div",{className:"connection-signon-options-section"},i.createElement(o,{align:"left",direction:"vertical",options:this._options,"aria-labelledby":n,onChange:function(t){e._onClickOption(t)},checked:this.state.checked,className:"connection-signon-option"}))},r}(i.Component);return a.propTypes={onClickOption:n.func.isRequired,getData:n.func.isRequired,selectedValue:n.object,type:n.string.isRequired},a})),define("datasource-signon/ui/internal/ConnectionSignonDialogComponents",["../../nls/StringResources","./ConnectionSignonOptions","react","prop-types","@ba/ba-ui-carbon-toolkit"],(function(e,t,i,n,r){"use strict";var o=r.Dialog,a=r.FlexItem,s=r.FlexLayout,l=r.Label,c=r.Container,u=r.VSpacer,d=function(n){function r(t){_classCallCheck(this,r);var i=_possibleConstructorReturn(this,n.call(this,t));i.handlers=t.handlers,i.state={enableOkButton:!1,selectedValue:null};var o="connection"===i.props.type?e.get("connection_dialog"):e.get("signon_dialog");return i.dialogProps={ariaLabel:o,className:"connection-signon-view",size:"large",width:"480px",maxWidth:"680px",maxHeight:"480px",height:"280px",clickaway:!1},i}return _inherits(r,n),r.prototype.render=function(){return this.props.openDialog?i.createElement("div",null,i.createElement(o,_extends({},this.dialogProps,{onClose:this._onCancel.bind(this)}),i.createElement(o.Header,null,this.props.resources.title),i.createElement(o.Body,null,i.createElement(u,{size:1}),i.createElement(a,{className:"connection-signon-sub-title",basis:"0%",grow:1,shrink:1},i.createElement(l,{label:this.props.resources.content_title})),i.createElement(u,{size:2}),i.createElement(s,{direction:"row"},i.createElement(a,{gutter:[0],className:"connection-signon-content"},i.createElement(c,{className:"connection-signon-options-section-container"},i.createElement(a,{basis:"0%",grow:1,shrink:1},i.createElement(t,{getData:this.props.getData.bind(this),onClickOption:this.onClickOption.bind(this),selectedValue:this.state.selectedValue,type:this.props.type})))))),i.createElement(o.Footer,null,i.createElement(o.Button,{primary:!0,id:"open_button",label:e.get("button_ok"),onClick:this._onDone.bind(this),disabled:!this.state.enableOkButton}),i.createElement(o.Button,{label:e.get("button_cancel"),id:"cancle",onClick:this._onCancel.bind(this)})))):null},r.prototype._onDone=function(e){e&&e.stopPropagation(),this.handlers&&this.handlers.onOkCallback&&this.handlers.onOkCallback({type:this.props.type,value:this.state.selectedValue.name}),this.props.onRemove()},r.prototype.onClickOption=function(e){this.setState({enableOkButton:!0,selectedValue:e})},r.prototype._onCancel=function(e){e&&e.stopPropagation(),this.handlers&&this.handlers.onCancelCallback&&this.handlers.onCancelCallback(),this.props.onRemove()},r}(i.Component);return d.propTypes={type:n.string.isRequired,getData:n.func.isRequired,resources:n.object.isRequired,openDialog:n.bool.isRequired,onRemove:n.func.isRequired,handlers:n.shape({onCancelCallback:n.func.isRequired,onOkCallback:n.func.isRequired}).isRequired},d.defaultProps={openDialog:!0},d})),define("datasource-signon/ui/ConnectionSignonDialog",["../lib/@waca/core-client/js/core-client/ui/core/View","./internal/ConnectionSignonDialogComponents","react","react-dom"],(function(e,t,i,n){"use strict";return function(e){function r(){return _classCallCheck(this,r),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(r,e),r.prototype.init=function(){for(var t,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var o=n[0];if((t=e.prototype.init).call.apply(t,[this].concat(n)),this.type=o.type||"connection",this.resources=o.resources,this.parameters=o.parameters||{},this.handlers=o.handlers,!this.handlers)throw new Error("Invalid handlers for connection or signon dialog")},r.prototype.render=function(){n.render(i.createElement(t,{openDialog:!0,getData:this.getData.bind(this),onRemove:this.remove.bind(this),type:this.type,resources:this.resources,handlers:this.handlers}),this.$el[0])},r.prototype.remove=function(){var t;this.$el&&(n.unmountComponentAtNode(this.$el[0]),this.$el.remove()),this.$el=null;for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];(t=e.prototype.remove).call.apply(t,[this].concat(r))},r.prototype.getData=function(){return{values:this.parameters.slice()}},r}(e)})),define("datasource-signon/data/StringResourcesFileLoader",["require"],(function(e){return{load:function(){return new Promise((function(t,i){try{e(["../nls/StringResources"],t,i)}catch(e){i(e)}}))}}})),define("datasource-signon/data/DataConnectionResolver",["../lib/@waca/core-client/js/core-client/ui/core/Class","../lib/@waca/core-client/js/core-client/utils/UniqueId","underscore","../lib/@waca/core-client/js/core-client/utils/Deferred","./internal/DataSourceConnectionCache","../ui/ConnectionSignonDialog","./StringResourcesFileLoader"],(function(e,t,i,n,r,o,a){"use strict";var s={},l=[],c=!1,u=e.extend({init:function(){u.inherited("init",this,arguments),this.datasourceConnectionCache=new r},destroy:function(){this.connectionDialog&&(this.connectionDialog.remove(),this.connectionDialog=null),this.datasourceConnectionCache.destroy()},getResolvedConnections:function(e){return this.datasourceConnectionCache.getConnections(e)},clearResolvedConnections:function(e,t){this.datasourceConnectionCache.clearResolvedConnections(e,t)},execute:function(e,r){if(!i.isFunction(e))return Promise.reject(new Error("callback is not provided."));if(!r)return Promise.reject(new Error("key is not provided."));var o=new n,a=t.get("ProcessRequest");return s[a]={id:a,callback:e,key:r,deferred:o,resolver:this},this._doInternalExecute(a,e,r,o),o.promise},_doInternalExecute:function(e,t,i,n){var r=this.datasourceConnectionCache.getConnections(i);this._internalExecute(e,t,i,r).then(function(t){delete s[e],n.resolve(t)}.bind(this)).catch(function(t){delete s[e],n.reject(t)}.bind(this))},_internalExecute:function(e,t,i,n){try{return t(n).fail(function(n){return this._handleFailure(e,n).then(function(n){return this._internalExecute(e,t,i,n)}.bind(this)).fail((function(e){return Promise.reject(e)}))}.bind(this))}catch(e){return Promise.reject(e)}},_makeErrorFromResponse:function(e){return e&&e.response&&e.response.entity},isAmbiguousError:function(e){if("ERROR"===e.state){var t=this._makeErrorFromResponse(e);return this._canHandleError(t)}return!1},_handleFailure:function(e,t){if(!this._canHandleError(t))return Promise.reject(t);var i=s[e];return i.showDlgDfd=new n,i.error=t,l.push(i),this._takeRequestFromFaultQueue(),i.showDlgDfd.promise},displayDialog:function(e,t){var i=this._makeErrorFromResponse(t),r={};return r.showDlgDfd=new n,r.error=i,r.key=e,r.resolver=this,l.push(r),this._takeRequestFromFaultQueue(),r.showDlgDfd.promise},_canHandleError:function(e){var t=this._getErrorContext(e)||{};return"CQE-801"===t.code||"CQE-802"===t.code},_takeRequestFromFaultQueue:function(){if(!c&&l.length>0){var e=l.shift();e.resolver._showDialog(e)}},_showDialog:function(e){c=!0;var t=(e=e||{}).error,i=e.key,n=this._getErrorContext(e.error),r="CQE-801"===n.code,o=!r,a=n.parameters;if(r&&this.datasourceConnectionCache.isConnectionResolved(i,a.dataSourceName)||o&&this.datasourceConnectionCache.isSignonResolved(i,a.dataSourceName)){var s=this.datasourceConnectionCache.getConnections(i);if(s)return c=!1,this._takeRequestFromFaultQueue(),e.showDlgDfd.resolve(s)}var l=function(n){var o;if(this.connectionDialog&&(this.connectionDialog.remove(),this.connectionDialog=null),(n=n||{}).value){if(r)o=this.datasourceConnectionCache.addDatasourceConnection(i,a.dataSourceName,n.value);else{var s=this.datasourceConnectionCache.getDatasourceConnectionString(i,a.dataSourceName,a.dataSourceConnectionName);o=this.datasourceConnectionCache.addSignon(i,a.dataSourceName,s,n.value)}c=!1,e.showDlgDfd.resolve(o),this._takeRequestFromFaultQueue()}else(t=t||{}).reason="cancel",c=!1,e.showDlgDfd.reject(t),this._takeRequestFromFaultQueue()}.bind(this),u={type:r?"connection":"signon",dataSourceName:a.dataSourceName,connection:a.dataSourceConnectionName,parameters:r?n.parameters.connections:n.parameters.signons,handlers:{onOkCallback:l.bind(this),onCancelCallback:l.bind(this)}};return this._showConnectionSignonDialog(u,e.showDlgDfd)},_showConnectionSignonDialog:function(e,t){return e=e||{},this._getDialogStrings(e).then(function(t){e.resources=t,this._createAndShowDialog(e)}.bind(this)),t.promise},_getDialogStrings:function(e){return a.load().then((function(t){var i="connection"===e.type;return{button_ok_text:t.get("button_ok"),title:i?t.get("title_connection"):t.get("title_signon"),content_title:i?t.get("select_connection",{dataSourceName:e.dataSourceName}):t.get("select_signon",{connection:e.connection,dataSourceName:e.dataSourceName})}}))},_createAndShowDialog:function(e){this.connectionDialog=new o(e),this.connectionDialog.render()},_getErrorContext:function(e){var t=(e=(e=e||{}).data||e).errors||e.error||[],i=t.length>0?t[0]:null;if(i){var n=i.parameters;if(n&&0!==n.length)switch(i.code){case"CQE-801":case"CQE-802":return{code:i.code,parameters:i.parameters[0]}}}}});return u})),define("datasource-signon/DataConnectionServiceFactory",["require","./lib/@waca/core-client/js/core-client/utils/LoadCSSPromise","./data/DataConnectionResolver"],(function(e,t,i){var n=!1,r=function(){};return r.prototype.getDataConnectionResolver=function(){return function(){if(n)return Promise.resolve();var i=e.toUrl("../../css/connectionSignon.css");return t.load(i).then((function(){n=!0}))}().then((function(){return Promise.resolve(new i)}))},r})),define("dashboard-analytics/entryBundle",(function(){}));