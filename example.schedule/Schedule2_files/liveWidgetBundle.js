/**
 * IBM Confidential OCO Source Materials IBM Business Platform: Dashboard
 * (C) Copyright IBM Corp. 2016, 2021
 *
 * The source code for this program is not published or otherwise divested of
 * its trade secrets, irrespective of what has been deposited with the U.S.
 * Copyright Office
 */

function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e}).apply(this,arguments)}define("dashboard-analytics/lib/@waca/dashboard-common/dist/api/Error",[],(function(){return function(){function e(t,i){_classCallCheck(this,e),this._message=t.msg,this._params=t.params,this._type=i&&"warning"===i.type?"warning":"error"}return e.prototype.getMessage=function(){return this._message},e.prototype.getParams=function(){return this._params},e.prototype.getType=function(){return this._type},e.prototype.toJson=function(){return{message:this.getMessage(),params:this.getParams(),type:this.getType()}},e}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/utils/HtmlXSSUtils",[],(function(){var e=["body","embed","script","object","applet","meta","style","link"];return{cleanseContentElements:function(e,t,i){if(!e)return null;var o=(((t=t||[])+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");if(i){e=e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"")}return e.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,(function(e,t){return o.indexOf("<"+t.toLowerCase()+">")>-1?e:""}))},isValidHtmlContent:function(e){return!this.containsTag(e)&&!this.containsBlackListedAttributes(e)&&this.isHtmlSafe(e)},containsTag:function(t){return new RegExp("<("+e.join("|")+")(\\s|\\/|>|$)","i").test(t)},containsBlackListedAttributes:function(e){return new RegExp("<\\w+[^>]*\\bon\\w+\\s*=","i").test(e)},isHtmlSafe:function(e){var t=e.match(/<\s*\w+\b[^>]+\s*>/g);return!t||[!0].concat(t).reduce((function(e,t){return e&&!t.match(/\w+\s*=\s*"?\s*javascript/gi)}))},sanitizeHtml:function(e){return e&&this.isValidHtmlContent(e)?e:""}}})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/DynamicFileLoader",["require"],(function(e){return{_require:e,load:function(e){if(!Array.isArray(e))throw new Error("modules must be an array");e.forEach((function(t,i){-1!==t.indexOf("text!")?e[i]=t.replace("text!","text!./"):e[i]="./"+t}));var t=[],i=[];return e.forEach((function(){var e={},o=new Promise((function(t,i){e.resolve=t,e.reject=i}));i.push(e),t.push(o)})),this._require(e,(function(){for(var e=0;e<arguments.length;e++)i[e].resolve(arguments[e])}),(function(e){i[0].reject(e)})),Promise.all(t)},loadModules:function(e){return this.load(e)}}})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/api/impl/Widget",[],(function(){return function(){function e(t){_classCallCheck(this,e),this.widget=t}return e.prototype.getAPI=function(){return this},e.prototype.getId=function(){return this.widget.getId()},e.prototype.getEventGroupId=function(){return this.widget.getEventGroupId()},e.prototype.getScope=function(){return this.widget.getContainerPageId()},e.prototype.getLayoutAPI=function(){return this.widget.getLayoutAPI()},e.prototype.getType=function(){return this.widget.getType()},e.prototype.getProperties=function(e){return this.widget.getProperties(e)},e.prototype.getProperty=function(e){return this.widget.getProperty(e)},e.prototype.getPropertyLayoutList=function(){return this.widget.getPropertyLayoutList()},e.prototype.getPropertyList=function(){return this.widget.getPropertyList()},e.prototype.getFeature=function(e){return this.widget.getFeature(e)},e.prototype.getContextToolbarItems=function(){return this.widget.getContextToolbarItems()},e.prototype.getError=function(){return this.widget.getError()},e.prototype.getErrorDetails=function(){return this.hasError()?{errorMessage:this.widget.getError()}:null},e.prototype.hasError=function(){return this.widget.hasError()},e.prototype.hasWarning=function(){return this.widget.hasWarning()},e.prototype.clearError=function(){this.widget.clearError()},e.prototype.on=function(e,t,i){return this.widget.on(e,t,i)},e.prototype.off=function(e,t,i){return this.widget.off(e,t,i)},e.prototype.isWidgetMaximized=function(){return this.widget.isWidgetMaximized()},e.prototype.isContextualGridEnabled=function(){return this.widget.isContextualGridEnabled()},e.prototype.setFeatureEnabled=function(e,t){return this.widget.setFeatureEnabled(e,t)},e.prototype.destroy=function(){this.widget=null},e}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/ExpandedController",["jquery"],(function(e){var t=function(e){this.widget=e.widget};return t.prototype.toggle=function(){var t=e('<div class="card">');return this.widget.$el.parent().append(t),this.widget.getExpandViewContent&&this.widget.getExpandViewContent(this.data,t),Promise.resolve()},t})),define("text!dashboard-analytics/lib/@waca/dashboard-common/dist/ui/templates/FocusView.template",[],(function(){return'<div role="button" class="collapseSvg focusMode" tabindex="0" title="{{!it.label}}" aria-label="{{!it.label}}">\n\t<svg class="svgIcon" role="img" focusable="false">\n\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#{{!it.collapseIcon}}"></use>\n\t</svg>\n</div>'})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/FocusView",["../lib/@waca/core-client/js/core-client/ui/AccessibleView","../nls/StringResources","jquery","doT","text!./templates/FocusView.template"],(function(e,t,i,o,r){var n=e.extend({init:function(e){n.inherited("init",this,arguments),this._content=e.content,this._owner=e.owner,this._widgetNode=e.data,this._dashboardState=e.dashboardState,this._iconsFeature=this._owner.dashboardApi.getFeature("Icons")},onKeyPress:function(e){27===e.keyCode&&this.cancel()},onTapBackground:function(){this.cancel()},_onClick:function(){this._owner.layoutAPI.offFocus()},render:function(){var e=this,n=this.containerElement||document.body,a=document.createElement("div");a.classList.add("focusViewContainer"),a.setAttribute("tabindex","-1");var s=i(n[0].appendChild(a));s.addClass("expandedView"),this._$container=s;var l=i('<div class="card gigante widgetFocus" tabindex="-1">');s.append(l);var d=this._owner.getExpandStartingPosition?this._owner.getExpandStartingPosition():this._getCardPosition(this._widgetNode.rowDiv),u=this._content.getFeature("VisExpandMode");if(u){this._setFocusState(!0),u.renderExpandedModeContent(l.get(0));var c=o.template(r)({label:t.get("evCollapse"),collapseIcon:this._iconsFeature.getIcon("minimize").id}),g=i(c);g.on("primaryaction",this._collapse.bind(this)),l.children().first().append(g)}var h={left:0,top:0,height:"100%",width:"100%"};l.css({"min-height":"inherit",top:d.top,left:d.left}).height(d.height).width(d.width),this._returnPosition=d,s.show();var p=new Promise(function(e){l.animate(h,"fast",function(){this.postRenderAnimation&&this.postRenderAnimation({height:l.height()}),e(s);var t=i(".popover");t.length&&t.popover("hide")}.bind(this._owner))}.bind(this));return i("body").on("tap.focusView",".focusViewContainer.expandedView",this.onTapBackground.bind(this)),i("body").on("keydown.pageView",this.onKeyPress.bind(this)),i("body").on("click.widgetContent",".widgetContent",this._onClick.bind(this)),s.on("touch","span.expand",(function(t){t.preventDefault(),t.stopImmediatePropagation(),e._collapse()})).on("tap","div.card",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),p},remove:function(){return this._setFocusState(!1),this._$container&&(this._$container.remove(),this._$container=null),i("body").off("tap.focusView"),i("body").off("keydown.pageView"),i("body").off("click.widgetContent"),n.inherited("remove",this,arguments)},_getCardPosition:function(e){var t=i(e).parents(".cardscroll")[0],o=i(t).scrollTop(),r=this._getPosition(e);return r.y-=o,{top:r.y,left:r.x,height:i(e).height(),width:i(e).width()}},_restoreUI:function(){this._owner.onRestore&&this._owner.onRestore(),this.getLaunchPoint()&&this.getLaunchPoint().focus()},_collapse:function(){this._setFocusState(!1);var e=this._$container.find("div.card");e.css({overflow:"hidden"});var t=this.remove.bind(this);e.animate(this._returnPosition,"fast",function(){this._$container.fadeOut("fast",t)}.bind(this)),this._restoreUI()},cancel:function(){this._setFocusState(!1),this._$container&&(this._$container.fadeOut("fast",this.remove.bind(this)),this._restoreUI())},_getPosition:function(e){for(var t=0,i=0;e;)t+=e.offsetLeft-e.scrollLeft+e.clientLeft,i+=e.offsetTop-e.scrollTop+e.clientTop,e=e.offsetParent;return{x:t,y:i}},_setFocusState:function(e){this._dashboardState.getUiState().focus!=e&&this._dashboardState.updateUiState({stateChange:{focus:e}})}});return n})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/WidgetBase",["../lib/@waca/core-client/js/core-client/ui/core/Events","../lib/@waca/core-client/js/core-client/utils/Deferred","../api/Error","underscore","jquery","../utils/HtmlXSSUtils","../DynamicFileLoader","../api/impl/Widget","../utils/ContentUtil","./ExpandedController","./FocusView"],(function(e,t,i,o,r,n,a,s,l,d,u){var c=300,g=300,h=e.extend({expanded:!1,init:function(e){h.inherited("init",this,arguments),this.dashboardApi=e.dashboardApi;var i=-1!==[void 0,!0,"true"].indexOf(this.dashboardApi.getAppConfig("usePreferredSize")),o=e.initialConfigJSON&&e.initialConfigJSON.usePreferredSize;this.usePreferredSize=!1!==o&&i,this.whenContainerIsReady=new t,this.id=e.id,this.canvas=e.canvas,this.content=e.content,this._stateAPI=this.content.getFeature("state.internal"),this._stateAPI.onChangeError(this.onStateChangeError.bind(this)),this.initialConfigJSON=e.initialConfigJSON,this.el=e.el,this.$el=r(this.el),this.$widgetContainer=r(e.widgetContainer),this.eventRouter=e.eventRouter,this.services=e.services,e.registry&&(this.properties=e.registry.properties);var n=this.dashboardApi.getFeature("internal");n&&(this.eventGroups=n.getBoardModel().eventGroups),this.colorsService=this.dashboardApi.getFeature("Colors"),this.registerEvents(e.eventRouter),this.contributionSpec=e.registry,this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this.errorView=e.errorView,this.propertiesUtil=e.propertiesUtil,e.contentFeatureLoader.registerDeprecatedFeature(this.id,"WidgetAPI.deprecated",{getAPI:this.getAPI.bind(this)},{profiles:["core"]}),this._expandModeContainerSelector=".boardPageView:visible > .pageViewContent > .dashboardFrame > .dashboardFrameCentre"},getDashboardApi:function(){return this.dashboardApi},_extendAPI:function(e){var t=this.getAPI();for(var i in e)"function"==typeof e[i]&&(t[i]=e[i])},getFeature:function(){return null},setFeatureEnabled:function(){},getId:function(){return this.id},getAPI:function(){return this.widgetAPI||(this.widgetAPI=new s(this).getAPI()),this.widgetAPI},registerEvents:function(){this.dashboardApi.on("widget:stopMove",this.onStopMove,this),this.dashboardApi.on("widget:startMove",this.onStartMove,this),this.dashboardApi.on("widget:onDetailErrors",this.addErrorDetailsHandler,this),this.colorsService&&this.colorsService.on("colorSet:changed",this.onDashboardColorSetChanged,this)},unregisterEvents:function(){this.dashboardApi.off("widget:stopMove",this.onStopMove,this),this.dashboardApi.off("widget:startMove",this.onStartMove,this),this.dashboardApi.off("widget:onDetailErrors",this.addErrorDetailsHandler,this),this.colorsService&&this.colorsService.off("colorSet:changed",this.onDashboardColorSetChanged,this)},registerEventGroup:function(e,t){if(this.eventGroups){var i=this.eventGroups.findGroup(this.id);if(!i||i.getPageId()!==this.getContainerPageId()){var r=e||o.uniqueId("_addToDefaultGroup_"),n=t&&t.transactionInfo&&t.transactionInfo.skipUndoRedo;return i=this.eventGroups.getDefaultGroup(this.getContainerPageId(),{payloadData:{undoRedoTransactionId:r,skipUndoRedo:!0===n}}),this.eventGroups.addToGroup(i.id,[this.id],{payloadData:{undoRedoTransactionId:r,skipUndoRedo:!0===n}}),!0}}return!1},registerWidgetChromeEvents:function(e){e&&(e.on("widget:onResize",this.resize,this),e.on("widget:onShow",this.onShow,this),e.on("widget:onHide",this.onHide,this),e.on("widget:onMaximize",this.onMaximize,this),e.on("widget:onRestore",this.onRestore,this),e.on("widget:onTitleChange",this.onTitleChange,this),e.on("widgetchrome:selected",this.onChromeSelected,this),e.on("widgetchrome:deselected",this.onChromeDeselected,this),e.on("widget:onAuthoringMode",this.onAuthoringMode,this),e.on("widget:onConsumeMode",this.onConsumeMode,this),e.on("widget:onEventGroupMode",this.onEventGroupMode,this),e.on("widget:onEnterContainer",this.onEnterContainer,this),e.on("widget:onExitContainer",this.onExitContainer,this),e.on("layout:fillColorChange",this.onPagefillColorChange,this))},unregisterWidgetChromeEvents:function(e){e&&(e.off("widget:onResize",this.resize,this),e.off("widget:onShow",this.onShow,this),e.off("widget:onHide",this.onHide,this),e.off("widget:onMaximize",this.onMaximize,this),e.off("widget:onRestore",this.onRestore,this),e.off("widget:onTitleChange",this.onTitleChange,this),e.off("widgetchrome:selected",this.onChromeSelected,this),e.off("widgetchrome:deselected",this.onChromeDeselected,this),e.off("widget:onAuthoringMode",this.onAuthoringMode,this),e.off("widget:onConsumeMode",this.onConsumeMode,this),e.off("widget:onEventGroupMode",this.onEventGroupMode,this),e.off("widget:onEnterContainer",this.onEnterContainer,this),e.off("widget:onExitContainer",this.onExitContainer,this),e.off("layout:fillColorChange",this.onPagefillColorChange,this))},_registerModelEvents:function(){this.model.on("change",this._onModelChange,this),this.model.on("change:fillColor",this.applyFillColor,this),this.model.on("change:borderColor",this.applyBorderColor,this),this.model.on("change:borderRadius",this.applyBorderRadius,this),this._modelEventsRegistered=!0},_unregisterModelEvents:function(){this._modelEventsRegistered&&(this.model.off("change",this._onModelChange,this),this.model.off("change:fillColor",this.applyFillColor,this),this.model.off("change:borderColor",this.applyBorderColor,this),this.model.off("change:borderRadius",this.applyBorderRadius,this),this._modelEventsRegistered=!1)},onStartMove:function(){},onStopMove:function(){},onPagefillColorChange:function(){},onDashboardColorSetChanged:function(){this.colorsService.makeSureColorIsValidInModel({model:this.model,propertyName:"fillColor"}),this.colorsService.makeSureColorIsValidInModel({model:this.model,propertyName:"borderColor"})},getDefaultValue:function(e){var t=o.find(this.properties,(function(t){return t.id===e}));if(t)return t.defaultValue},onContainerReady:function(e){var t=e.model,i=e.widgetChromeEventRouter,o=e.isAuthoringMode,r=e.additionalWidgetData,n=void 0===r?{}:r,a=e.layoutAPI;this.model=t,this.widgetChromeEventRouter=i,this.isAuthoringMode=o,this.addPayloadData=n.addPayloadData,this.layoutAPI=a,this.model&&(this._registerModelEvents(),this.addWhiteListAttrs("fillColor","borderColor","borderRadius","animationEntrance","animationExit"),this.addColorProperties(["fillColor","borderColor"]),this.model.localizedProps&&this.model.localizedProps.length&&this.dashboardApi.getFeature("TranslationService").registerView({view:this,model:this.model})),this.registerWidgetChromeEvents(this.widgetChromeEventRouter),this.whenContainerIsReady.resolve()},getLayoutAPI:function(){return this.layoutAPI},onAuthoringMode:function(){this.isAuthoringMode=!0,this.isEventGroupMode=!1},onConsumeMode:function(){this.isAuthoringMode=!1,this.isEventGroupMode=!1},onEventGroupMode:function(){this.isAuthoringMode=!0,this.isEventGroupMode=!0,this._setEventGroupOverlayContent(this.eventGroups.findGroup(this.id))},getEventGroupId:function(){return this.eventRouter?this.eventRouter.channelId:void 0},setEventRouter:function(e,t){!e&&this.eventRouter?(this.unregisterEvents(this.eventRouter),this.onRemoveCurrentEventRouter(t),this.unregistered=!0):(this.unregistered||e.channelId!==this.eventRouter.channelId)&&(this.unregistered||(this.unregisterEvents(this.eventRouter),this.onRemoveCurrentEventRouter(t)),this.eventRouter=e,this.eventRouter&&(this.registerEvents(this.eventRouter),this.onNewEventRouter(t),this.unregistered=!1)),this._setEventGroupOverlayContent()},onRemoveCurrentEventRouter:function(){},onNewEventRouter:function(){},_setEventGroupOverlayContent:function(){var e=this.eventGroups.findGroup(this.id),t=this.getWidgetStyleNode().find(".eventGroupOverlayContent");e&&t&&t.text(e.getGroupIndex())},onEnterContainer:function(){},onExitContainer:function(){},_onModelChange:function(e){e&&"UndoRedoController"===e.sender&&this.refreshPropertiesPane()},destroy:function(){this._unregisterModelEvents(),this._expanded&&this._expanded.remove(),this.unregisterEvents(this.eventRouter),this.unregisterWidgetChromeEvents(this.widgetChromeEventRouter),this.model&&(this.model.localizedProps&&this.model.localizedProps.length&&this.dashboardApi.getFeature("TranslationService").deregisterView(this.model.id),this.model.contentReferences=[]),this.widgetAPI&&(this.widgetAPI.destroy(),this.widgetAPI=null),this._expanded=null,this.eventRouter=null},get:function(e){return this.model?this.model[e]:void 0},set:function(e,t){this.model&&e&&(t=t||{},t=o.defaults(t,{sender:this.id}),this.model.set(e,t))},triggerExternalEvent:function(e,t){this.eventRouter&&this.eventRouter.trigger(e,t)},onTitleChange:function(){},onPropertyUpdate:function(e){var t={};t[e.category]=e.item;var i=null;e.transactionId&&(i={undoRedoTransactionId:e.transactionId,transactionToken:e.transactionToken}),"fillColor"!==e.category&&"borderColor"!==e.category||this.colorsService.prepareForColorModelChange(t,e.category),this.set(t,{silent:!1,payloadData:i})},updateDescription:function(e){this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("widget:updateDescription",{value:e})},updateWidgetArialabel:function(e){this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("widget:updateWidgetArialabel",{value:e})},clearWidgetArialabel:function(){this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("widget:clearWidgetArialabel")},setLayoutProperties:function(e){this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("widget:setLayoutProperties",e)},addIcon:function(e,t){if(this.widgetChromeEventRouter){var i=void 0,o=this._isMaximized&&this._expanded&&this._expanded.containerElement&&this._expanded.containerElement.find(".widgetHeader");o&&o.length&&0===(i=o.find(".widgetIcons")).length&&(i=o),this.widgetChromeEventRouter.trigger("widget:addIcon",{widgetIcon:e,name:t,location:i})}},applyCommonProperties:function(){if(this.model){this.applyFillColor({value:this.model.fillColor}),this.applyBorderColor({value:this.model.borderColor}),this.applyBorderRadius({value:this.model.borderRadius});var e=this.model.showTitle;e||(e=this.getDefaultValue("showTitle")),this.showTitle({value:e})}},showTitle:function(e){if(!e.value){var t=this.$el.parent();t.hasClass("widget")&&t.find(".textArea").addClass("hidden")}},changeTitleType:function(e){if("smart"===e.value){var t=this.model.toJSON();t.name="";var i=this.dashboardApi.getDashboardCoreSvc(".SmartNamingSvc").getWidgetName(t);this.$el.parent().find(".textArea").text(i)}},applyFillColor:function(e){this.applyColor(e,"fill")},applyBorderColor:function(e){this.applyColor(e,"border")},applyColor:function(e,t){this.getWidgetStyleNode().each(function(i,o){var r=new RegExp("\\s*\\b"+t+"-[^\\s]*\\b","g"),n=o.getAttribute("class")||"";n=n.replace(r,""),e.value&&(n+=" "+this.getThemeColorClassName(e.value,t)),o.setAttribute("class",n)}.bind(this))},applyBorderRadius:function(e){this.getWidgetStyleNode().each(function(t,i){i.style.borderRadius=e.value+"px"}.bind(this))},getWidgetStyleNode:function(){return this.$el.closest(".widget")},getThemeColorClassName:function(e,t){return t+"-"+e},resize:function(){},onShow:function(){},onHide:function(){},reveal:function(){},onChromeSelected:function(){this.chromeSelected=!0,this.triggerExternalEvent("widget:selected",{sender:this.model.id,payloadData:this})},onChromeDeselected:function(){this.chromeSelected=!1,this.triggerExternalEvent("widget:deselected",{sender:this.model.id}),this.triggerExternalEvent("properties:deregister",{sender:this.model.id})},_updateErrorContainer:function(){},_updateErrorType:function(e,t){return t||"error"},hasError:function(){return this.$el.has(".errorContainer").length>0},hasWarning:function(){return this.$el.has(".warningContainer").length>0},getError:function(){return this.errorMessage},onStateChangeError:function(e){e?this.renderError(e.getMessage(),e.getParams(),e.getType()):this._clearError()},renderError:function(e,t,i){t&&t.errorInfo&&(this._lastErrorInfo=t.errorInfo),i=this._updateErrorType(e,i);var o=this.hasError();if(this.el){var r=this.errorView.renderContainer({id:this.id+"Title",type:i,msg:{str:e,params:t}});if(this._updateErrorContainer(e,r),this.$el.find(".errorContainer").remove(),this.widgetChromeEventRouter&&!o){var n={"min-height":Math.max(g,this.$el.innerHeight()),"min-width":c};this.widgetChromeEventRouter.trigger("widget:showError",n,this)}var a=this.errorView.makeNlsMessage({str:e,params:t});this.errorMessage=a,this.updateWidgetArialabel(a),this.$el.append(r),this.addErrorDetailsHandler(),this.renderComplete&&this.renderComplete()}},showError:function(e,t,o){var r=new i({msg:e,params:t},{type:o});this._stateAPI.setError(r)},addErrorDetailsHandler:function(){!0===window.dashboardErrorDetailsEnabled&&this._lastErrorInfo&&this.$el.has(".errorContainer").length>0&&this.$el.find(".dashboardMessageContainer").onClick(this._showErrorDetails.bind(this))},_showErrorDetails:function(){return this._lastErrorInfo?a.load(["ui/dialogs/MessageDialog"]).then(function(e){var t=e[0],i={httpResponse:{status:this._lastErrorInfo.status,details:this._lastErrorInfo.responseJSON?this._lastErrorInfo.responseJSON:{}},httpRequest:{querySpec:this._lastErrorInfo.querySpec?this._lastErrorInfo.querySpec:{}},widgetSpec:this.model};new t({size:"large",type:"selectableInfo",title:"Error  details",message:JSON.stringify(i,null,4)}).render()}.bind(this)):Promise.resolve()},clearError:function(){this._stateAPI.clearError()},_clearError:function(){if(this._lastQueryErrorInfo=null,this.errorMessage=null,this.hasError()){if(this.widgetChromeEventRouter){this.widgetChromeEventRouter.trigger("widget:clearError",{})}this.$el.find(".errorContainer").remove()}},addWhiteListAttrs:function(){var e=Array.prototype.slice.call(arguments,0);this.model&&e.length>0&&(this.model.whitelistAttrs?this.model.whitelistAttrs=o.uniq(this.model.whitelistAttrs.concat(e)):this.model.whitelistAttrs=e)},addColorProperties:function(e){this.model&&(this.model.colorProperties?this.model.colorProperties=this.model.colorProperties.concat(e):this.model.colorProperties=e)},addContentReferences:function(e){this.model&&(this.model.contentReferences=this.model.contentReferences.concat(e))},removeWhiteListAttrs:function(){if(this.model&&this.model.whitelistAttrs){var e=Array.prototype.slice.call(arguments,0);this.model.whitelistAttrs=o.difference(this.model.whitelistAttrs,e)}},getExpandStartingPosition:function(){var e=r(this._expandModeContainerSelector).offset().top,t=this.$el.offset();return t.top-=e,t.width=this.$el.width(),t.height=this.$el.height(),e=r(this._expandModeContainerSelector).offset().left,t.left-=e,t},getExpandViewContent:function(){return r('<span class="collapseIcon" title="collapse"></span>')},isWidgetMaximized:function(){return!0===this._isMaximized},onMaximize:function(){if(!this._isMaximized&&this.isMaximizeSupported)return this._isMaximized=!0,this.triggerExternalEvent("widget:maximize",{id:this.id}),this._expanded&&this._expanded.remove(),this._restoreToParent=this.$el.parent(),this._expanded=new u({owner:this,content:this.content,data:this.el,containerElement:r(this._expandModeContainerSelector),launchPoint:this.getWidgetStyleNode()[0],dashboardState:this.dashboardApi.getFeature("DashboardState")}),this._expanded.render()},toggleExpanded:function(e){return void 0===e&&(e=!this.expanded),e!==this.expanded?(this.expanded=e,this._getExpandedController().toggle(e)):Promise.resolve()},_getExpandedController:function(){return this._expandedController||(this._expandedController=new d({widget:this})),this._expandedController},whenRenderComplete:function(){return this._stateAPI.setStatus(this._stateAPI.STATUS.RENDERED),Promise.resolve()},onRestore:function(){if(this._isMaximized=!1,this.triggerExternalEvent("widget:restore",{id:this.id}),this._restoreToParent)return this.getVisBounds().then(function(e){this.$el.css({width:e.width,height:e.height}),this._restoreToParent.append(this.$el),this._restoreToParent=null,this.applyCommonProperties(),this.resize()}.bind(this))},getContextToolbarItems:function(){return[]},getContainerPageId:function(){var e=this.dashboardApi.getAppConfig("pageContainerType"),t=l.getPageContent(this.content,e);return t?t.getId():null},resizeToPreferredSize:function(){},setPreferredSize:function(e,t){if(this.usePreferredSize){var i={preferredSize:e,options:t};this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("widget:setPreferredSize",i,this)}},getVisBounds:function(){var e=new t;if(!this.widgetChromeEventRouter||this._isMaximized&&this._expanded)e.resolve({top:0,left:0,width:this.$el.innerWidth(),height:this.$el.innerHeight()});else if(this._isIntentViewMode()){var i=this.$el.parents(".intent-results-preview");e.resolve({top:0,left:0,width:i.innerWidth(),height:i.innerHeight()})}else this.widgetChromeEventRouter.trigger("widget:getSize",{deferred:e},this);return e.promise},_isIntentViewMode:function(){return this.$el.parents(".intent-results-preview").length>0},getType:function(){return this.model.type},_filterActiveAutoBinProperty:function(e){var t=this;return o.filter(e,(function(e){return!["autoBin.toggle","autoBin.count"].includes(e.id)||t.visModelManager.getDefinition().binningConfig&&!0===t.visModelManager.getDefinition().binningConfig.auto}))},onPropertyChange:function(e,t){this.onPropertyUpdate(this.propertiesUtil.buildPropChangePayload(e,t))},refreshPropertiesPane:function(e){this.model&&this.triggerExternalEvent("properties:refreshPane",o.extend({sender:this.model.id},e))},isValidHtmlContent:function(e){return n.isValidHtmlContent(e)},doesVisPropertyMatchExpected:function(e,t){if(this._currVis&&this._currVis.doesVisPropertyMatchExpected)return this._currVis.doesVisPropertyMatchExpected(e,t)},isContextualGridEnabled:function(){return Promise.resolve(!1)},_invokeLifeCycleHandlers:function(e,t){var i=this;return this.dashboardApi.getDashboardSvc(".LifeCycleManager").then((function(i){return i.invokeLifeCycleHandlers(e,t)})).catch((function(e){i.logger.error(e)}))},render:function(){return this._stateAPI.setStatus(this._stateAPI.STATUS.RENDERING),Promise.resolve(this.$el)}});return h})),define("dashboard-analytics/widgets/AnalyticsBaseWidget",["../lib/@waca/dashboard-common/dist/ui/WidgetBase"],(function(e){"use strict";var t=e.extend({init:function(){t.inherited("init",this,arguments);var e=this.dashboardApi.getFeature("internal");e&&(this.boardModel=e.getBoardModel(),this.boardModel.pageContext&&(this.pageContextAPI=this.boardModel.pageContext.getAPI()))},getDashboardApi:function(){return this.dashboardApi},_updateEventGroupIdInPageContext:function(e,t){this.pageContextAPI&&this.pageContextAPI.updateEventGroupId(this.id,this.getContainerPageId(),e,t)},onRemoveCurrentEventRouter:function(e){this._updateEventGroupIdInPageContext(null,e)},onNewEventRouter:function(e){this._updateEventGroupIdInPageContext(this.eventRouter.channelId,e)}});return t})),define("dashboard-analytics/widgets/livewidget/DeprecateWidgetBase",["../AnalyticsBaseWidget","underscore","jquery","../../lib/@waca/core-client/js/core-client/utils/Deferred"],(function(e,t,i,o){"use strict";var r=e.extend({isMaximizeSupported:!0,customPalettePrefix:"__CM__",init:function(e){r.inherited("init",this,arguments),this.readyDfd=new o,this.visualizationDfd=new o,this._isDashboardActive=!0,this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this._useNewQueryApi=e.useNewQueryApi,this.visModelManager=null,this.dataSet=null,this.transactionApi=this.dashboardApi.getFeature("Transaction"),this.visualizationFeature=this.content.getFeature("Visualization"),this.colorsService.on("palette:deleted",this.onPaletteDeleted,this),this.colorsService.on("palette:updated",this.onPaletteUpdated,this)},destroy:function(){r.inherited("destroy",this,arguments),this.clearRefreshTimer(),this.dataSet=null,this.model&&(this.model.off("change:queryRefresh",this.registerRefreshTimer,this),this.model=null),this._removeShapingModelEvents(),this.readyDfd=null,this.visualizationDfd=null,this.logger=null,this.boardModel=null},reRender:function(e){return this.visAPI.reRender(e)},registerEvents:function(){r.inherited("registerEvents",this,arguments),this.dashboardApi.on("widget:toolbar:show:before",this.onToolbarShowBefore,this),this.dashboardApi.on("widget:toolbar:hide:after",this.onToolbarHideAfter,this),this.dashboardApi.on("dashboard:show",this.onDashboardShow,this),this.dashboardApi.on("dashboard:deactivate",this.onDashboardDeactivate,this)},unregisterEvents:function(){r.inherited("unregisterEvents",this,arguments),this.dashboardApi.off("widget:toolbar:show:before",this.onToolbarShowBefore,this),this.dashboardApi.off("widget:toolbar:show:after",this.onToolbarShowAfter,this),this.dashboardApi.off("widget:toolbar:show:after",this.onToolbarShowAfter,this),this.dashboardApi.off("widget:toolbar:hide:after",this.onToolbarHideAfter,this),this.dashboardApi.off("dashboard:show",this.onDashboardShow,this),this.dashboardApi.off("dashboard:deactivate",this.onDashboardDeactivate,this),this.colorsService.off("palette:deleted",this.onPaletteDeleted,this),this.colorsService.off("palette:updated",this.onPaletteUpdated,this)},getCurrentVis:function(){return this._currVis},onStartMove:function(){this._currVis&&this._currVis.onStartMove&&this._currVis.onStartMove()},onStopMove:function(){this._currVis&&this._currVis.onStopMove&&this._currVis.onStopMove()},onToolbarHideAfter:function(e){if(this._currVis&&this._currVis.getCurrentViewSelector){var t=this._currVis.getCurrentViewSelector();t&&t.setPopoverClosed&&t.setPopoverClosed(e)}},onToolbarShowBefore:function(e){if(this._currVis&&this._currVis.getCurrentViewSelector){var t=this._currVis.getCurrentViewSelector();t&&t.setPopoverOpened&&t.setPopoverOpened(e)}},onDashboardShow:function(){this._isTimerActive=!0,this._isDashboardActive=!0},onDashboardDeactivate:function(){this._isTimerActive=!1,this._isDashboardActive=!1},onContainerReady:function(e){var t=this;console.debug("onContainerReady"),r.inherited("onContainerReady",this,arguments),this.model=e.model,this.model&&this.model.on("change:queryRefresh",this.registerRefreshTimer,this),this.addWhiteListAttrs("titleHtml","name","type","localFilters","visId","showTitle","properties","maintainAxisScales","colorPalette","showItemLabel","titleType","titleMode","responsiveTitle","truncateTitle","hideLegend","hideAxisTitleLabels","legendPosition","lineColor","interpolation","elementColor","symbolShape","symbolFill","heatScalePalette","heatScaleColorOrder","hideRadialTitle","hideRadialValue","archetype","expandOnRender","hideLabel","hideValue","hideTreeMapLeafLabels","pieAsDonut","hideGridLines","hideSymbols","hideDataLines","conditions","queryRefresh","transpose","labelLocation","interpolate","condColorPalette","condColorOrder","hideSummaries","legend.position","donutRadius","labelLocation","lineWithPoints.symbol","itemLabel.display","tiledmap.style","fillDirection","savedPrompts","labels.visible","label.format","defaultPaletteIndex","actions","showInsights","lineWithPoints.symbol");var i=function(e){var i=t.visAPI.getPropertyValue(e);return i&&0===i.indexOf(t.customPalettePrefix)?i.split(t.customPalettePrefix)[1]:null},o=[];["colorPalette","contColorPalette","condColorPalette"].forEach((function(e){o.push({type:"palette",get:function(){return i(e)}})})),this.addContentReferences(o),this.registerRefreshTimer()},resizeToPreferredSize:function(){this.setPreferredSize(this.visAPI.getPreferredSize())},placeAt:function(e,t){t||(t=this.el),this._currVis&&this._currVis.remove(!1),this._currVis=e,this._currVis.predictData=this.predictData,this.visualizationDfd.resolve(e),this.setLayoutProperties({pannable:this._currVis.isPannable,mobilePannable:this._currVis.isMobilePannable,noRotate:this._currVis.noRotate,maximizable:this._currVis.isMaximizable}),i(t).children(".dataview").detach(),e.placeAt?e.placeAt(t,0):i(e.el).appendTo(t)},getDataSet:function(){return this.dataSet},_refreshWidgets:function(e){var t=this.getId();if(e.sender.widget!==this&&this.visAPI&&(!e.sender.refreshedWidgetIds||-1===e.sender.refreshedWidgetIds.indexOf(t))){if(e.dataItemId&&!this.visAPI.isDataItemMapped(e.dataItemId))return;var i=e.sender;i||(i={}),i.refreshedWidgetIds||(i.refreshedWidgetIds=[]),i.refreshedWidgetIds.push(t),this.reRender({sender:i}),this.visExpandMode&&this.visExpandMode.renderSlotsView()}},onMenuAction:function(){},_applyingExternalFilter:{},_createEventTransactionToken:function(e){var t;return e&&e.data?e.data.transactionToken&&this.transactionApi.isValidTransaction(e.data.transactionToken)?t=this.transactionApi.startTransaction(e.data.transactionToken):(t=e.data.undoRedoTransactionId?this.transactionApi.startTransactionById(e.data.undoRedoTransactionId):this.transactionApi.startTransaction(),e.data.transactionToken=t):(t=this.transactionApi.startTransaction(),e.data={transactionToken:t}),t},_onModelChange:function(e){var t=arguments,i=this;if(!(e.data&&e.data.saveOnly||-1!==["properties","localFilters","searchFilters","visId"].indexOf(e.name))){var o=this._createEventTransactionToken(e);this.visAPI&&this.visAPI.clearModelInvalid(),this.readyDfd.promise.then((function(){r.inherited("_onModelChange",i,t)})).finally((function(){i.trigger("dwChange:"+e.name,e,i),i.transactionApi.endTransaction(o)})),r.inherited("_onModelChange",this,arguments)}},getUnavailableLocalFilter:function(){return this.visModelManager.filterSupport.getUnavailableLocalFilter()},updateMissingFilters:function(){this.visModelManager.filterSupport.updateMissingFilters()},resize:function(e){this.visAPI&&this.el&&this.visAPI.resize(this.$el.innerWidth(),this.$el.innerHeight(),e)},isAnOverridableVisProperty:function(e){return-1!==["fillDirection","legendPosition","lineColor","maintainAxisScales","showItemLabel","colorPalette","symbolShape","symbolFill","hideLegend","elementColor","interpolation","shortNumbers","hideAxisTitleLabels","heatScalePalette","contColorPalette","hideRadialTitle","hideRadialValue","valueColor","hideLabel","hideValue","hideTreeMapLeafLabels","pieAsDonut","hideGridLines","hideSymbols","hideDataLines","transpose","rangeSlider","labelLocation","condColorPalette","condColorOrder","hideSummaries","legend.position","donutRadius","labelLocation","lineWithPoints.symbol","itemLabel.display","tiledmap.style","labels.visible","label.format"].indexOf(e)},getConditionalPalette:function(e){return this.colorsService.getPalette({paletteId:e,type:"ConditionalPalette",defaultIfNotFound:!0})},_reverseColorPointAt:function(e){var i=t.map(e,t.clone),o=i.length;return t.each(i,(function(t,i){var r=e[o-i-1].at;t.at=r})),i},onHeatScalePaletteChanged:function(e){this.onPropertyUpdate(e)},onPaletteDeleted:function(e){var t=e.paletteId;this.onCustomPaletteChanged(t,"delete")},onPaletteUpdated:function(e){var t=e.paletteId;this.onCustomPaletteChanged(t,"update")},onCustomPaletteChanged:function(){},onColorPaletteChanged:function(e){this.onPropertyUpdate(e)},_reMapBundle:function(e,t){var i=t.find((function(t){return t.id===e.id}));return i||(i=t.find((function(t){return t.id===e.minimalVisId}))),i},updateVisProperties:function(e,i){void 0===i&&(i={});var o=t.extend({},i,this.boardModel.getLanguageModelOptions(!0));this.model.properties.set(e,t.extend({merge:!0,remove:!1},o))},_getInteractionConfig:function(){return this.dashboardApi.getAppConfig("interactions")||{}},_isInteractionEnabled:function(e){var t=this._getInteractionConfig();return!t.hasOwnProperty(e)||-1===[!1,"false"].indexOf(t[e])},doesWidgetSupportContextualGrid:function(){var e=this._currVis;return!!e&&(!e.doesVisPropertyMatchExpected("isMultilayersWidget",!0)&&!e.doesVisPropertyMatchExpected("noDataQuery",!0))},suppressAnimations:function(e){this.visModelManager&&this.visModelManager.setSuppressViewAnimations(e)},_getRefreshValueInUnits:function(e,t){var i=this._getMaxRefreshValuesForUnits(t);return Math.min(i,e)},onPropertyUpdate:function(e){if(r.inherited("onPropertyUpdate",this,arguments),"queryRefresh"===e.category&&e.item){var t=e.item.value?this._getRefreshValueInUnits(e.item.value,e.item.unit):null;this.model.set({queryRefresh:i.extend(e.item,{value:t})})}},validateInput:function(e){var t=e.value,o=t&&i.isNumeric(t);return o&&(t=Math.ceil(t),o=this._getTimeIntervalInSeconds(t,e.unit)>=5),o},_getMaxRefreshValuesForUnits:function(e){var t,i,o=(Math.pow(2,31)-1)/1e3;switch(e){case"minutes":t=o/60,i=Math.ceil(t-1);break;case"hours":t=o/3600,i=Math.ceil(t-1);break;default:i=Math.ceil(o-1)}return i},_getTimeIntervalInSeconds:function(e,t){var o=null;if(i.isNumeric(e)){var r=this._getMaxRefreshValuesForUnits(t);switch(t){case"minutes":o=Math.min(r,e*=60);break;case"hours":o=Math.min(r,e*=3600);break;default:o=Math.min(r,e)}}return o},registerRefreshTimer:function(){this.clearRefreshTimer();var e=this.get("queryRefresh");e&&(this._startRefreshTimer(e),this.trigger("dwChange:refreshTimerIndicator",{autoRefresh:e.autoRefresh}))},_startRefreshTimer:function(e){e&&e.autoRefresh&&e.value&&(this.visibilityHandler=function(){!0===this._isDashboardActive&&(document.hidden||!document.visibilityState?this._isTimerActive=!1:this._isTimerActive=!0)}.bind(this),this._isTimerActive=!0,this._queryRefreshFinished=!0,this._setLastRefreshedTime(),this._refreshTimer=setInterval(function(){this._isTimerActive&&this._queryRefreshFinished&&(i(document).on("visibilitychange",this.visibilityHandler),this._autoRefresh())}.bind(this),1e3*this._getTimeIntervalInSeconds(e.value,e.unit)))},_autoRefresh:function(){if(this.visAPI)return this._queryRefreshFinished=!1,this._currVis&&(this._currVis.animationType=this._currVis.ANIMATION_TYPES.TRANSITION),this.reRender({sender:"realtimeRefresh",queryRefresh:this.model.queryRefresh}).then(function(){this._queryRefreshFinished=!0,this._setLastRefreshedTime()}.bind(this),function(e){throw window.dashboardErrorDetailsEnabled||(this._queryRefreshFinished=!0),e}.bind(this))},_setLastRefreshedTime:function(){this.model.set({queryRefresh:i.extend(this.get("queryRefresh"),{lastRefreshed:(new Date).getTime()})},{silent:!0})},clearRefreshTimer:function(){this._refreshTimer&&(clearInterval(this._refreshTimer),this._refreshTimer=null,this.visibilityHandler&&(i(document).off("visibilitychange",this.visibilityHandler),this.visibilityHandler=null))},_rebuildVis:function(){},getSavedPrompts:function(){return this.get("savedPrompts")||{}},_updateFilterIndicator:function(){this._currVis&&this._currVis.filterIndicator&&this._currVis.filterIndicator.update()}});return r})),define("dashboard-analytics/widgets/livewidget/visapi/VisAPI",["../../../lib/@waca/core-client/js/core-client/ui/core/Class","dashboard-analytics/util/DashboardFormatter"],(function(e,t){"use strict";var i=e.extend({init:function(e){i.inherited("init",this,arguments),this._intialize(e),this.flag="VisAPI"},destroy:function(){this._clear(),this.visModelManager&&(this.visModelManager.remove(),this.visModelManager=null),i.inherited("destroy",this,arguments)},reIntialize:function(e){this._clear(),this.visRenderSupport&&(this.visRenderSupport.clear(),this.visRenderSupport=null),this._intialize(e)},_clear:function(){this.visFilterSupport&&(this.visFilterSupport=null),this.visPropertySupport&&(this.visPropertySupport.remove(),this.visPropertySupport=null),this.visModelManagerLEFTOVER&&(this.visModelManagerLEFTOVER=null)},_intialize:function(e){var i=this.visModelManager=e.visModelManager,o=this.visRenderSupport=e.visRenderSupport,r=this.visFilterSupport=e.visFilterSupport,n=this.visPropertySupport=e.visPropertySupport,a=e.ownerWidget,s=this.visModelManagerLEFTOVER=e.visModelManagerLEFTOVER;this.getVisId=i.getVisId.bind(i),this.getSuppressViewAnimations=i.getSuppressViewAnimations.bind(i),this.getModule=i.getModule.bind(i),this.getMetadataColumn=i.getMetadataColumn.bind(i),this.getMetadataManager=i.getMetadataManager.bind(i),this.getUsedMetadataColumns=i.getUsedMetadataColumns.bind(i),this.getInvalidReason=i.getInvalidReason.bind(i),this.setInvalidReason=i.setInvalidReason.bind(i),this.clearModelInvalid=i.clearModelInvalid.bind(i),this.getDefinition=i.getDefinition.bind(i),this.getTitle=i.getTitle.bind(i),this.setTitle=i.setTitle.bind(i),this.isFilterEditable=i.isFilterEditable.bind(i),this.getShowTitle=i.getShowTitle.bind(i),this.supportsSortAction=i.supportsSortAction.bind(i),this.supportsFormatAction=i.supportsFormatAction.bind(i),this.supportsCustomGroupAction=i.supportsCustomGroupAction.bind(i),this.supportsMaintainAxisScale=i.supportsMaintainAxisScale.bind(i),this.getListenForPropChangesFromDefinition=i.getListenForPropChangesFromDefinition.bind(i),this.getFormatter=function(){return t},this.getInteractivitySettings=a.getInteractivitySettings.bind(a),this.isOptimizeForSize=a.isOptimizeForSize.bind(a),this.swapSlots=i.swapSlots.bind(i),this.getDataSlots=i.getDataSlots.bind(i),this.getLayers=i.getLayers&&i.getLayers.bind(i),this.getDefaultLayer=i.getDefaultLayer&&i.getDefaultLayer.bind(i),this.getDataSlotById=i.getDataSlotById.bind(i),this.getDataItemSlotAndIndex=i.getDataItemSlotAndIndex.bind(i),this.filterSlotDataItems=i.filterSlotDataItems.bind(i),this.isMappingEmpty=i.isMappingEmpty.bind(i),this.isDataItemMapped=i.isDataItemMapped.bind(i),this.hasBinnedDataItems=i.hasBinnedDataItems.bind(i),this.isIgnoreDefaultSlotSort=i.isIgnoreDefaultSlotSort.bind(i),this.getQueryAPI=function(){return null},this.getAnnotations=i.getAnnotations.bind(i),this.setAnnotations=i.setAnnotations.bind(i),this.getPossibleKeyDrivers=i.getPossibleKeyDrivers.bind(i),this.setPossibleKeyDrivers=i.setPossibleKeyDrivers.bind(i),this.getRenderer=o.getRenderer.bind(o),this.getRenderSequence=o.getRenderSequence.bind(o),this.getPreferredSize=o.getPreferredSize.bind(o),this.renderComplete=o.renderComplete.bind(o),this.renderCompleteBeforeAnimation=o.renderCompleteBeforeAnimation.bind(o),this.resize=o.resize.bind(o),this.reRender=o.reRender.bind(o),this.mapVizRenderForPrint=o.mapVizRenderForPrint.bind(o),this.selectData=r.select.bind(r),this.supportsFilterOnColumn=r.supportsFilterOnColumn.bind(r),this.getPendingFilters=r.getPendingFilters.bind(r),this.getActiveFilters=r.getActiveFilters.bind(r),this.getPageContextAPI=r.getPageContextAPI.bind(r),this.getFilterInfo=r.getFilterInfo.bind(r),this.setSynchronizeDataFilters=r.setSynchronizeDataFilters.bind(r),this.setPendingFilters=r.setPendingFilters.bind(r),this.getLocalFiltersList=r.getLocalFiltersList.bind(r),this.validateFilters=r.validateFilters.bind(r),this.cleanUpMissingFilters=r.cleanUpMissingFilters.bind(r),this.getAllFiltersAsLocalFiltersForPinning=r.getAllFiltersAsLocalFiltersForPinning.bind(r),this.getLocalFilterAndTopBottomInfo=r.getLocalFilterAndTopBottomInfo.bind(r),this.clearSelectionsByDataItemIds=r.clearSelectionsByDataItemIds.bind(r),this.getSelectionAsLocalFilters=r.getSelectionAsLocalFilters.bind(r),this.clearSelectionsUsedForShowBy=r.clearSelectionsUsedForShowBy.bind(r),this.getDrillInfo=r.getDrillInfo.bind(r),this.getTopBottomInfo=r.getTopBottomInfo.bind(r),this.getPropertyValue=n.getPropertyValue.bind(n),this.getPropertyById=n.getPropertyById.bind(n),this.getProperties=n.getProperties.bind(n),this.getMetaDataValue=i.getMetaDataValue.bind(i),this.getLocalFilters=i.getLocalFilters.bind(i),this.onChangeTheme=o.onChangeTheme.bind(o),this.clearError=a.clearError.bind(a),this.getScope=a.getScope.bind(a),this.getEventGroupId=a.getEventGroupId.bind(a),this.getWidgetId=a.getId.bind(a),this.getDecoratorAPI=a.getDecoratorAPI.bind(a),this.getDecoratorAPIs=a.getDecoratorAPIs.bind(a),this.on=i.on.bind(i),this.off=i.off.bind(i),this.getCustomDataDecoration=s.getCustomDataDecoration.bind(s),this.setCustomDataDecoration=s.setCustomDataDecoration.bind(s),this.getDecoratedCustomData=s.getDecoratedCustomData.bind(s),this.getCustomData=s.getCustomData.bind(s),this.getFredIsRed=a.getFredIsRed.bind(a),this.generateThumbnail=a.generateThumbnail.bind(a)},setDataMembersTEMPORARILY:function(e){this.ownerWidget=e.ownerWidget,this.pendingFilters=e.pendingFilters,this.localFilters=e.localFilters},renderComplete:function(){throw new Error("VisAPI:renderComplete needs to be implemented")}});return i})),define("dashboard-analytics/data/models/VisProperty",["../../lib/@waca/dashboard-common/dist/core/Model"],(function(e){"use strict";var t=null;return t=e.extend({whitelistAttrs:["id","value"],init:function(e,i){void 0===i&&(i={}),this.collection=i.collection,e&&this.collection&&this.collection.localizedPropIds&&-1!==this.collection.localizedPropIds.indexOf(e.id)&&(this.localizedProps=["value"]),"colorClass"===e.type&&(this.colorClass=!0),t.inherited("init",this,arguments)},setValue:function(e){this.isOfType("Boolean")?this.set({value:e.toString()}):this.set({value:e})},isDefault:function(){return void 0===this.value},isOfType:function(e){return this.propertyType===e},getType:function(){return this.propertyType},isPublic:function(){return!0===this.public},_getWidgetModelValue:function(){return this.get("value")},getValue:function(){var e=this._getWidgetModelValue();return void 0!==e&&this.isOfType("Boolean")&&(e="true"===e||!0===e),e},isResolveColor:function(){return!this.colorClass},getPredefinedValue:function(){return this.predefinedValue},getDefaultValue:function(){return this.isOfType("Boolean")?"true"===this.defaultValue||!0===this.defaultValue:this.defaultValue}})})),define("dashboard-analytics/data/models/VisPropertyCollection",["../../lib/@waca/dashboard-common/dist/core/Collection","./VisProperty","underscore"],(function(e,t,i){"use strict";var o=null;return o=e.extend({modelClass:t,localizedPropIds:["itemAxis.title","valueAxis.title","valueAxis.column.title","color.title","series.title","categories.title","values.title","size.title","locationColor.title","pointSize.title","pointColor.title","pointcolor.title","latlongSize.title","latlongColor.title","valueAxis.line.title","baseValueLabel","targetValueLabel","totalColumn.label","inner.label.title","columnColor.title","lineColor.title"],init:function(e,t){this.modelConstructorOptions={collection:this},t=t||{},this.visModel=t.visModel,o.inherited("init",this,arguments)},applyDefaults:function(e,t){void 0===t&&(t={});var o=this.toJSON();this.reset(e,i.extend(t,{silent:!0})),this.set(o,i.extend(t,{remove:!1,merge:!0,silent:!0}))},_getDataPropertiesAndValues:function(e){var t={},o=i.find(e,(function(e){return"maintainAxisScales"===e.id}));return t.maintainAxisScales=o,t},toJSON:function(){var e=this.filter((function(e){return void 0!==e.value}));return e=e.map((function(e){return e.toJSON?e.toJSON():e}))},getMultilingualAttribute:function(e){if(-1===this.localizedPropIds.indexOf(e))return null;var t=this.get(e);return t?t.getMultilingualAttribute("value"):null},getMultilingualAttributes:function(){var e=this,t=[];return this.localizedPropIds.forEach((function(i){var o=e.getMultilingualAttribute(i);o&&t.push(o)})),t},_refreshDataNeeded:function(e){return"maintainAxisScales"===e},_onModelEvent:function(e){e.dataRefresh=this._refreshDataNeeded(e.model.id),o.inherited("_onModelEvent",this,arguments)}})})),define("dashboard-analytics/widgets/livewidget/visapi/support/VisRenderSupport",["jquery","../../../../data/models/VisPropertyCollection","../../../../lib/@waca/core-client/js/core-client/ui/core/Events"],(function(e,t,i){var o=i.extend({init:function(e){if(o.inherited("init",this,arguments),this.content=e.content,this.visModelManager=e.visModelManager,this.ownerWidget=e.ownerWidget,this.pageContext=e.pageContext,this.dashboardApi=e.dashboardApi,this.transactionApi=this.dashboardApi.getFeature("Transaction"),this._registeredActions={},this.content.on("change:state:status",this._onChangeStatus,this),this.content.on("change:state:error",this._onChangeError,this),this.ownerWidget)for(var t in this.ownerWidgetEvents={"dwChange:refreshTimerIndicator":this.onChangeRefreshTimerIndicator,"dwChange:annotations":this.onChangeAnnotations,"dwChange:showTitle":this.onShowTitle,"dwChange:titleMode":this.onShowTitle,"dwChange:customData":this.onChangeCustomData},this.ownerWidgetEvents)this.ownerWidget.on(t,this.ownerWidgetEvents[t],this)},getRenderSequence:function(){var e=this.content.getFeature("InteractivityController.deprecated");return e?e.getRenderSequence():null},getDefinition:function(){return this.visModelManager.getDefinition()},resize:function(e,t,i){if(void 0===i&&(i={}),e<=0||t<=0)return Promise.resolve();var o=this.getRenderSequence().getLastSizeRendered()||{},r=!o.width||Math.abs(o.width-e)>=1,n=!o.height||Math.abs(o.height-t)>=3,a=i&&!0===i.reRender,s=this.ownerWidget._currVis&&this.ownerWidget._currVis.alwaysRenderOnResize;if((a||s||n||r)&&i.modelId!==this.ownerWidget.id){var l=i&&i.data&&i.data.transactionToken||{};return this.transactionApi.registerTransactionHandler(l,this.ownerWidget.id,function(){return this.getRenderSequence().reRender(_extends({resizing:!0},i))}.bind(this),i)}return Promise.resolve()},_onChangeError:function(){this.ownerWidget.removeLoadingAnimation()},_getQueryRefresh:function(){if(void 0===this.queryRefreshProp){var e=this.content.getPropertyValue("queryRefresh");this.queryRefreshProp=e&&e.autoRefresh}return this.queryRefreshProp},setQueryRefresh:function(e){this.queryRefreshProp=e},_onChangeStatus:function(e){this._getQueryRefresh()||("rendering"===e.info.value?this.ownerWidget.showLoadingAnimation():this.ownerWidget.removeLoadingAnimation())},reRender:function(e){return this.getRenderSequence().reRender({refresh:{data:!0},extraInfo:e})},mapVizRenderForPrint:function(){return this.getRenderSequence().reRender({extraInfo:{preserveDrawingBuffer:!0}})},initialize:function(){this.properties?this.properties.visModel=this:this.properties=new t([],{visModel:this}),this._suppressViewAnimations=!1},getVisId:function(){return this.getDefinition()?this.getDefinition().id:null},getPreferredSize:function(){return this.getDefinition().preferredSize},remove:function(){this.clear()},clear:function(){this._cleanUpEventsHandling()},_cleanUpEventsHandling:function(){var e=this;for(var t in this.content.off("change:state:status",this._onChangeStatus,this),this.content.off("change:state:error",this._onChangeError,this),this.ownerWidgetEvents)this.ownerWidget.off(t,this.ownerWidgetEvents[t],this);Object.keys(this._registeredActions).forEach((function(t){delete e._registeredActions[t]}))},getSpecification:function(){return this.getDefinition()?this.getDefinition().specification:null},getRenderer:function(){return this.getDefinition()?this.getDefinition().renderer:null},renderComplete:function(e){this.ownerWidget&&(this.ownerWidget._firstRenderComplete=!0,this.ownerWidget.renderComplete(e))},renderCompleteBeforeAnimation:function(){this.ownerWidget.removeLoadingAnimation()},getCanvas:function(){return this.canvas?this.canvas:{dataSet:this.dataSet,getDataSource:function(){return this.dataSet}}},_notifyViews:function(e,t){this.visModelManager.trigger(e,t)},onChangeDataSlot:function(e){var t=this,i=this.visModelManager.getMetadataAPI();return i&&!i.getModule()?this.ownerWidget.loadMetadata().finally((function(){t._notifyViews("change:dataSlot",{eventName:e.eventName,name:"dataSlot",value:e.sender,sender:t,changeEvent:e})})):(this._notifyViews("change:dataSlot",{eventName:e.eventName,name:"dataSlot",value:e.sender,sender:this,changeEvent:e}),Promise.resolve())},onChangeAnnotations:function(e){this._notifyViews("change:annotations",{eventName:e.eventName,value:e.sender,sender:this,changeEvent:e})},onShowTitle:function(e){this._notifyViews("change:titleMode",{name:"change:titleMode",sender:this,value:e.value,eventName:"change:theme"})},onChangeCustomData:function(e){this._notifyViews("change:customData",{name:"change:customData",sender:this,value:e.value,prevValue:e.prevValue,eventName:"change:customData"})},onChangeTheme:function(){this._notifyViews("change:theme",{name:"change:theme",sender:this,eventName:"change:theme"})},getContextToolbarItems:function(){var e=[];return this.actions.forEach((function(t){e=e.concat(t().getAvailableActions())})),e},setSuppressViewAnimations:function(e){this._suppressViewAnimations=e},getSuppressViewAnimations:function(){return this._suppressViewAnimations},onChangeRefreshTimerIndicator:function(e){this._notifyViews("change:refreshTimer",e)},doLocalSort:function(){return this.getDefinition()&&this.getDefinition().clientSort}});return o})),define("dashboard-analytics/visualizations/renderer/VisActionSupportBase",["jquery","underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class"],(function(e,t,i){"use strict";return i.extend({init:function(e){this.visAPI=e.visModel,this.pageContext=e.pageContext,this.ownerWidget=e.ownerWidget,this.logger=this.ownerWidget.logger,this.dashboard=e.ownerWidget.getDashboardApi()},_getFunction:function(e,t){var i=e+t;return this[i]?this[i].bind(this):null},_isWidgetOfType:function(e){return this.visAPI.getDefinition().id===e}})})),define("dashboard-analytics/visualizations/renderer/VisActionSlotSupport",["jquery","underscore","./VisActionSupportBase"],(function(e,t,i){"use strict";var o=i.extend({getInterface:function(e){var i="string"==typeof e?e:t.invert(o.SLOT_ACTIONS)[e];return{isSupported:this._getFunction(o.PREXFIX_SUPPORT,i),get:this._getFunction(o.PREXFIX_GET,i)}},__canSupport_DrillAction:function(e){return e.selectionObj&&e.singleSlot&&e.singleSlot.isSlotSortable()&&!e.isMultiMeasure}});o.PREXFIX_SUPPORT="__canSupport_",o.PREXFIX_GET="__get_";return o.SLOT_ACTIONS=t.reduce([],(function(e,t,i){return e[t]=i,e}),{}),o})),define("dashboard-analytics/visualizations/vipr/VIPRData",["jquery","underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class","../../apiHelpers/SlotAPIHelper","../../widgets/livewidget/nls/StringResources","../../util/DashboardFormatter","com/ibm/vida/vizbundles/extensions/decorations"],(function(e,t,i,o,r,n,a){"use strict";var s=i.extend({init:function(e,t){this.context=t,this.indexes=t&&t.index&&{dataitem:t.index.dataitem,tuple:t.index.tuple,tupleitem:t.index.tupleitem}||{},this.object=e,this._initDecoratations()},_initDecoratations:function(){this.decorations=this.object&&this.object.deco&&JSON.parse(JSON.stringify(this.object.deco))||{}},hasDecoration:function(e){return void 0!==this.decorations[e]},getDecoration:function(e){return this.decorations[e]},decorate:function(e,t){var i=t;return"lines"===e&&(i=this._createLinesDecoration(e,t)),e in this.decorations&&this.decorations[e]===i||(this.decorations[e]=i,this.context.version++),i},clearDecorations:function(){var e=this,i=!1;t.each(t.keys(this.decorations),(function(t){delete e.decorations[t],i=!0})),i&&this.context.version++},resetDecorations:function(){this._initDecoratations(),this.context.version++},_createLinesDecoration:function(e,i){var o,r,n,s=this.getDecoration(e),l=[];t.each(s,(function(e){e instanceof a.BaseLine?o=e:e instanceof a.Grabber?r=e:e instanceof a.Vane&&(n=e)}));var d=Array.isArray(i);return d?l=i:i&&!d&&(i.baseLine&&(o=o||this._createBaseline("baseLine"),void 0!==i.baseLine.position&&o.setPosition(i.baseLine.position),i.baseLine.color&&o.setColor(i.baseLine.color),o.setShowInLegend(i.baseLine.setShowInLegend),l.push(o)),i.grabber&&o&&((r=r||this._createGrabber("grabber")).setPositionType(i.grabber.positionType),o.setGrabber(r),l.push(r)),i.vane&&o&&((n=n||this._createVane("vane")).setCaption(i.vane.caption),o.setVane(n),l.push(n))),l},_createBaseline:function(e){return void 0===e&&(e=t.uniqueId("baseLine")),new a.BaseLine(e)},_createGrabber:function(e){return void 0===e&&(e=t.uniqueId("grabber")),new a.Grabber(e)},_createVane:function(e){return void 0===e&&(e=t.uniqueId("vane")),new a.Vane(e)}}),l=i.extend({init:function(e,t,i){this.slot=i.dataset.slotAPIs[e],this.dataItemIndex=t,this._format=this.slot.getDataItemList()[t].getFormat()},format:function(e){return n.format(e,this._format)}}),d=s.extend({init:function(e,t){d.inherited("init",this,[e,t]),this.itemClass=e,this.context=t},getUniqueName:function(){return this.itemClass.u},getCaption:function(){var e;this.context.hideAggTypeInAxisLabels||(e=this.itemClass.aggregate&&"none"!==this.itemClass.aggregate?" ("+r.get(this.itemClass.aggregate)+")":null);var t=this.itemClass.d?this.itemClass.d:this.itemClass.u;return e?t+e:t},getSubCaption:function(){return null}}),u=s.extend({init:function(e,t,i,o){u.inherited("init",this,[e,i,o]),this.item=e,this.context=i,this.index=i.index.tupleitem,this.content=o,this.datapoints=t.datapoints,this.recalculateFormattedValue()},recalculateFormattedValue:function(){var e=new l(this.context.index.dataitem,this.context.index.tupleitem,this.context);if(void 0===this.item.d||null===this.item.d)this.formattedValue=e.format(null),this.unformattedValue=this.formattedValue;else if(this.item.aggregate){!(this.content&&!this.content.getPropertyValue("widget.legend.aggregateTypeVisible"))?(this.formattedValue=e.format(r.get("multiMeasureLabel",{measureName:this.item.d.toString(),aggregate:r.get(this.item.aggregate.toString())})),this.unformattedValue=this.item.d+this.item.aggregate):(this.formattedValue=e.format(r.get("measureLabel",{measureName:this.item.d.toString()})),this.unformattedValue=this.item.d+this.item.aggregate)}else this.formattedValue=e.format(this.item.d.toString()),this.unformattedValue=this.item.d},getUniqueName:function(){return void 0===this.item.u||null===this.item.u?this.item.u:this.item.u.toString()},getCaption:function(){if(this.item.aggregate){var e=!this.content||this.content.getPropertyValue("widget.legend.aggregateTypeVisible");e!=this.aggregationPropertyValue&&(this.recalculateFormattedValue(),this.aggregationPropertyValue=e)}return this.formattedValue||this.recalculateFormattedValue(),this.formattedValue},getParent:function(){return this.item.p},decorate:function(e,i){this.datapoints.length>0&&(this.context.version++,t.each(this.datapoints,(function(t){t.decorate(e,i)})))}}),c=u.extend({getUniqueName:function(){return this.getCaption()}}),g=s.extend({init:function(e,t){g.inherited("init",this,[e,t]),this.header=e,this.context=t,this.itemClasses=[]},getItemClassCount:function(){return this.header.length},getItemClass:function(e){return void 0===this.itemClasses[e]&&(this.itemClasses[e]=new d(this.header[e],this.context)),this.itemClasses[e]}}),h=s.extend({init:function(e,t,i){h.inherited("init",this,[e,t,i]),this.tuple=e,this.context=t,this.datapoints=[],this.items=[],this.dataset=t.dataset,this.dataItemIndex=this.context.index.dataitem,this.itemClassSetIndex=this.context.index.itemClassSet,this.content=i},getUniqueName:function(){return this.getItem(0).getUniqueName()},getReference:function(){return this.getItem(0).getUniqueName()},getCaption:function(){return this.getItem(0).getCaption()},getParent:function(){return this.getItem(0).getParent()},getItemClassSetIndex:function(){return this.itemClassSetIndex},getItem:function(e){if(void 0===this.items[e]){this.context.index.tupleitem=e,this.context.dataset=this.dataset;var t=!1,i=this.context.index.dataitem;if(i>=0){var o=this.context.dataset.slotAPIs[i];t=o.isCaptionAsUniqueName&&o.isCaptionAsUniqueName()}var r=t?c:u;this.items[e]=new r(this.tuple[e],this,this.context,this.content)}return this.items[e]},getItemCount:function(){return this.tuple?this.tuple.length:0},addDataPoint:function(e){-1===this.datapoints.indexOf(e)&&this.datapoints.push(e)},decorate:function(e,i){h.inherited("decorate",this,[e,i]),this.datapoints.length>0&&(this.context.version++,t.each(this.datapoints,(function(t){t.decorate(e,i)})))}}),p=s.extend({init:function(e,i,o){p.inherited("init",this,[e._dataItem,i]),this.dataItem=e,this.context=i,this.index=this.context.index.dataitem,this.dataset=this.context.dataset,this.tuples=[],this.itemClassSets=[],this.content=o,t.each(this.dataItem.getTupleHeaders(),function(e){this.itemClassSets.push(new g(e,this.context))}.bind(this))},getUniqueName:function(){},postProcessing:function(){},getCaption:function(){},getType:function(){return"cat"},getTupleCount:function(){return this.dataItem?this.dataItem.getTupleCount():0},getTuple:function(e){return void 0===this.tuples[e]&&(this.context.dataset=this.dataset,this.context.index={dataitem:this.index,tuple:e,itemClassSet:this.dataItem.getTupleItemClassSetIndex(e)},this.tuples[e]=new h(this.dataItem.getTuple(e),this.context,this.content)),this.tuples[e]},getDataWindowStart:function(){return 0},getDataWindowEnd:function(){return this.getTupleCount()},getItemClassSetCount:function(){return this.itemClassSets.length},getItemClassSet:function(e){return this.itemClassSets[e||0]}}),f=p.extend({init:function(){f.inherited("init",this,arguments),this.formatter=new l(this.context.index.dataitem,0,this.context),this.postProcessing()},getType:function(){return"cont"},getFormatter:function(){return this.formatter},postProcessing:function(){var e=this.context.index.dataitem,i=this.dataset.slotAPIs[e].getSubType();(i&&"latitude"===i||"longitude"===i)&&t.each(this.dataItem._dataItem.items,(function(e){e.t[0].hasOwnProperty("d")&&e.t[0].hasOwnProperty("u")&&e.t[0].d!==e.t[0].u&&(e.t[0].u=e.t[0].d)}))},getItemClass:function(){return null},getDomain:function(){return null}}),m=s.extend({init:function(e,t){m.inherited("init",this,[e._dataItem,t]),this.dataItem=e,this.context=t,this.queryResult=t&&t.queryResult,this.formatter=new l(this.context.index.dataitem,0,this.context),this.itemClass=new d(this.dataItem.getTupleHeaders()[0][0],this.context),this.domain=this._createDomain()},_createMultiMeasureDomain:function(){var e,i,o=null,r=this.queryResult&&this.queryResult.getTopBottomMappings(),n=t.keys(r);return n.length&&(n.forEach((function(t){var o=r[t].bottomResult.useValue,n=r[t].topResult.useValue;e=e?Math.min(e,o):o,i=i?Math.max(i,n):n})),o={min:e,max:i}),o},_createNonMultiMeasureDomain:function(){var e=null,t=this.queryResult&&this.queryResult.getTopBottomMappings(),i=this.itemClass.itemClass.u+this.itemClass.itemClass.aggregate;if(i&&t){var o=t[i];o&&(e={min:o.bottomResult.useValue,max:o.topResult.useValue})}return e},_createDomain:function(){var e=null;return this.itemClass&&this.itemClass.itemClass&&(e="_multiMeasuresValue"===this.itemClass.itemClass.u?this._createMultiMeasureDomain():this._createNonMultiMeasureDomain()),e},getUniqueName:function(){return this.itemClass.getUniqueName()},getCaption:function(){return this.itemClass.getCaption()},getType:function(){return"cont"},getDomain:function(){return this._createDomain()},getFormatter:function(){return this.formatter},getItemClass:function(){return this.itemClass}});function v(e,i,o){if(void 0===e.context){e.dataset=i,e.getTupleIndex=function(e){var t=this.pt[e];return this.dataset.getDataItem(e).getTuple(t).addDataPoint(this),t}.bind(e),e.getDataPointKey=function(){return this.pt?t.filter(this.pt,(function(e){return"number"==typeof e})).toString():""}.bind(e);var r="function"==typeof e.getValue?e.getValue:void 0;e.getValue=function(e){var i=r?r(e):this.pt[e];this.dataset.slotAPIs[e].getDefinition().useCategoryAsValue&&(i={v:this.dataset.resultData.getResultDataItem(e).getTuple(this.pt[e])[0].u});return function(e,i,o){if(t.isNumber(e)&&(e={v:e}),void 0===e.getValue){e.getIndex=function(){return o},e.getValue=function(){return this.v},e.getValueType=function(){return null===this.v?"missing":"numeric"};var r=i.format(e.v);e.getCaption=function(){return r}}return e}(i,this.dataset.getDataItem(e).getFormatter(),e)}.bind(e),e.hasDecoration&&e.getDecoration&&e.decorate||(e._decorations=new s(e,o),e.hasDecoration=e._decorations.hasDecoration.bind(e._decorations),e.getDecoration=e._decorations.getDecoration.bind(e._decorations),e.clearDecorations=e._decorations.clearDecorations.bind(e._decorations),e.resetDecorations=e._decorations.resetDecorations.bind(e._decorations),e.decorate=function(e,t){t=void 0===t||t,this._decorations.decorate(e,t)}.bind(e))}return e}var b=s.extend({init:function(e,t,i,o,r,n){b.inherited("init",this,[]),this.resultData=e,this.slotAPIs=t,this.dataItems=[];var a=this.resultData.getResultDataItems();this.context=o,this.context.queryResult=i,this.context.dataset=this,this.content=r,this.id=n;for(var s=a?a.length:0,l=0;l<s;l++){var d=a[l];if(this.slotAPIs[l]){var u="attribute"===this.slotAPIs[l].getDataItemList()[0].getType()?p:m;-1===this.slotAPIs[l].getId().indexOf("latlongLocations.lat")&&-1===this.slotAPIs[l].getId().indexOf("latlongLocations.long")||(u=f),this.context.index={dataitem:l},this.dataItems[l]=new u(d,this.context,r)}}},getDataItem:function(e){return e<this.dataItems.length?this.dataItems[e]:null},getDataItemCount:function(){return this.resultData.getResultDataItemCount()},getDataPointCount:function(){return this.resultData.getDatapointCount()},getDataPoint:function(e){return e<this.getDataPointCount()?v(this.resultData.getDatapoints()[e],this,this.context):null}}),y=s.extend({init:function(e,i,r,n){y.inherited("init",this,[]),this.content=n,this.context={version:0,VIPRData:this,hideAggTypeInAxisLabels:r},this._aVIPRDataSets=[];var a=i.getDefinition().getDatasetList();t.each(a,function(r){var n=t.find(e,(function(e){return e.getDataViewId()===r.id}));n?this._aVIPRDataSets.push(new b(n.getFacetData(),o.getMappedSlotListByDataset(i,n.getDataViewId()),n,this.context,this.content,r.id)):this._aVIPRDataSets.push(null)}.bind(this))},getDataSetAt:function(e){return this._aVIPRDataSets[e]},getDataSetCount:function(){return this._aVIPRDataSets.length},getDecorationsVersion:function(){return this.context.version}});return y})),define("dashboard-analytics/visualizations/vipr/data/VIPRDecoratable",["com/ibm/vida/vizbundles/extensions/decorations","underscore"],(function(e,t){"use strict";var i="text",o={r:229,g:229,b:229,a:1},r=null;return function(){function n(e,t){this.context=t,this.indexes=t&&t.index&&{dataitem:t.index.dataitem,tuple:t.index.tuple,tupleitem:t.index.tupleitem}||{},this.object=e,this._initDecoratations()}var a=n.prototype;return a._initDecoratations=function(){var e=this.object&&this.object.getDecorationsCallback&&this.object.getDecorationsCallback()||{};this.decorations=JSON.parse(JSON.stringify(e))||{},this._handleDeprecatedDecorations()},a._handleDeprecatedDecorations=function(){var e=this,t={marker:function(){var t=e._createBaseline();t.setPosition(e.decorations.marker),t.setCaption(e.decorations.markerCaption),t.setShowInLegend(!1),e.decorations.baseLines=[t],delete e.decorations.marker,delete e.decorations.markerCaption}};Object.keys(this.decorations).forEach((function(e){return t[e]&&t[e]()}))},a.hasDecoration=function(e){return void 0!==this.decorations[e]},a.getDecoration=function(e){return this.decorations[e]},a.decorate=function(e,t){var o=t;return"baseLines"===e&&(o=this._updateLinesDecorations(e,t)),e===i&&(o=this._decorateText(e,t)),e in this.decorations&&this.decorations[e]===t||(this.decorations[e]=o,this.context.version++),o},a.clearDecorations=function(){var e=this,i=!1;t.each(t.keys(this.decorations),(function(t){e.clearDecoration(t),i=!0})),i&&this.context.version++},a.clearDecoration=function(e){delete this.decorations[e]},a.resetDecorations=function(){this._initDecoratations(),this.context.version++},a._decorateText=function(e,t){if(!1===t)return this.clearDecoration(e),null;var i=this.getDecoration(e)||this._createTextDecoration(),n=o,a=r;return i.setBackground(n),i.setFont(a),i},a._createTextDecoration=function(){return new e.Text},a._updateLinesDecorations=function(e,t){var i=this.getDecoration(e)||[],o=i.reduce((function(e,i){return(t||i._id&&!i._id.startsWith("compareLine"))&&(e[i._id]=i),e}),{}),r=o.compareLine;if(Array.isArray(t))return[].concat(i,t.filter((function(e){return e._id&&e._id.startsWith("compareLine")})));if(t){if(t.baseLine&&(r=r||this._createBaseline("compareLine"),void 0!==t.baseLine.position&&r.setPosition(t.baseLine.position),t.baseLine.color&&r.setColor(t.baseLine.color),r.setShowInLegend(t.baseLine.setShowInLegend),o[r._id]=r),t.grabber&&r){r.showGrabber(!0);var n=r.getGrabber();n.setPositionType(t.grabber.positionType),o[n._id]=n}if(t.vane&&r){r.showVane(!0);var a=r.getVane();a.setCaption(t.vane.caption);a.setStrokeColor({r:0,g:0,b:0,a:0}),o[a._id]=a}}return Object.values(o)},a._createBaseline=function(i){var o=i||t.uniqueId("baseLine");return new e.BaseLine(o)},n}()})),define("dashboard-analytics/visualizations/vipr/data/VIPRValue",["underscore"],(function(e){return function(){function t(t,i,o){this.rawValue=t,this.value=t&&!e.isNumber(t)&&void 0!==t.v?t.v:t,this.formatter=i,this.index=o}var i=t.prototype;return i.destroy=function(){this.formatter=null},i.getIndex=function(){return this.index},i.getValue=function(){return this.value},i.getValueType=function(){return null===this.value?"missing":"numeric"},i.getCaption=function(){return this.rawValue&&this.rawValue.label?this.rawValue.label:this.formatter?this.formatter.format(this.value):this.value},i.getRawValue=function(){return this.rawValue},t}()})),define("dashboard-analytics/visualizations/vipr/data/VIPRDataPoint",["underscore","./VIPRDecoratable","./VIPRValue"],(function(e,t,i){return function(e){function t(t,i,o,r){var n;return(n=e.call(this,{getDecorationsCallback:i.queryResult.getPointDecorations.bind(i.queryResult,t)},r)||this).index=t,n.dataset=i,n.dataItemInfo=o,n.context=r,n.queryResult=i.queryResult,n.viprValues={},n}_inheritsLoose(t,e);var o=t.prototype;return o.destroy=function(){for(var e in this.viprValues)this.viprValues[e].destroy(),delete this.viprValues[e];this.dataset=null,this.viprValues=null,this.context=null},o.getTupleIndex=function(e){var t=this.queryResult.getValueIndex(this.index,e),i=this.dataset.getDataItem&&this.dataset.getDataItem(e);return i&&i.getTuple(t).addDataPoint(this),t},o.getValue=function(e){if(void 0===this.viprValues[e]){var t=this.queryResult.getValue(this.index,e);this.dataItemInfo.isLatLong[e]&&(t="number"==typeof t[0].value?t[0].value:parseFloat(t[0].label)),this.viprValues[e]=new i(t,this.dataItemInfo.formatter[e],e)}return this.viprValues[e]},o.decorate=function(t,i){i=void 0===i||i,e.prototype.decorate.call(this,t,i)},o.getTupleItems=function(){var e=this,t=[];return this.dataset.dataItems.forEach((function(i,o){if("cat"===i.getType()||e.dataItemInfo.isLatLong[o]){var r=e.queryResult.getValue(e.index,o);Array.isArray(r)&&t.push.apply(t,r)}})),t},o.getDataPointKey=function(){var e=this,t=[];return this.dataset.dataItems.forEach((function(i,o){("cat"===i.getType()||e.dataItemInfo.isLatLong[o])&&t.push(e.queryResult.getValueIndex(e.index,o))})),t.toString()},t}(t)})),define("dashboard-analytics/visualizations/vipr/data/VIPRItemClass",["./VIPRDecoratable","../../../widgets/livewidget/nls/StringResources","../../../apiHelpers/SlotAPIHelper"],(function(e,t,i){return function(e){function o(t,i){var o;return(o=e.apply(this,arguments)||this).dataItem=t,o.context=i,o}_inheritsLoose(o,e);var r=o.prototype;return r.destroy=function(){this.context=null},r.getUniqueName=function(){return this.dataItem.getColumnId()},r.getCaption=function(){var e;if(!this.context.hideAggTypeInAxisLabels){var o=this.dataItem.getAggregation()||"none";e="none"!==o?" ("+t.get(o)+")":null}var r=this.dataItem.getLabel();return this.getUniqueName()===i.MULTI_MEASURES_SERIES&&(r=t.get("MeasuresCaption")),e?r+e:r},r.getSubCaption=function(){return null},o}(e)})),define("dashboard-analytics/visualizations/vipr/data/VIPRItemClassSet",["./VIPRDecoratable","./VIPRItemClass"],(function(e,t){return function(e){function i(t,i){var o;return(o=e.apply(this,arguments)||this).dataItems=t,o.context=i,o.itemClasses=[],o}_inheritsLoose(i,e);var o=i.prototype;return o.destroy=function(){var e=this;this.itemClasses.forEach((function(t,i){t.destroy(),delete e.itemClasses[i]})),this.itemClasses=null,this.context=null},o.getItemClassCount=function(){return this.dataItems.length},o.getItemClass=function(e){return e<this.getItemClassCount()&&void 0===this.itemClasses[e]&&(this.itemClasses[e]=new t(this.dataItems[e],this.context)),this.itemClasses[e]},i}(e)})),define("dashboard-analytics/visualizations/vipr/data/VIPRFormatter",[],(function(){return function(){function e(e,t,i){var o=i.formatter,r=i.dataItemFormats,n=i.dataset;if(this._formatter=o,void 0!==r)this._format=r[t];else{var a=n.slots[e].getDataItemList()[t];this._format=a.getFormat()}}var t=e.prototype;return t.getFormat=function(){return this._format},t.format=function(e){return this._formatter?this._formatter.format(e,this._format):e},e}()})),define("dashboard-analytics/visualizations/vipr/data/VIPRItem",["underscore","./VIPRDecoratable","./VIPRFormatter","../../../widgets/livewidget/nls/StringResources"],(function(e,t,i,o){return function(e){function t(t,i,o){var r;return(r=e.call(this,t,i)||this).item=t,r.content=o,r.context=i,r.formatter=i.formatter,r._tuples=[],r.dataset=i.dataset,r._applyFormatFromContext(),r}_inheritsLoose(t,e);var r=t.prototype;return r.destroy=function(){this.context=null,this.dataset=null,this._datapoints=null,this._tuples=null},r._applyFormatFromContext=function(){var e=new i(this.context.index.dataitem,this.context.index.tupleitem,{formatter:this.formatter,dataset:this.dataset,dataItemFormats:this.context.index.dataItemFormats});return this._calculateformattedValue(e)},r._recalculatedFormattedValue=function(){var e=this.indexes.dataitem,t=this.dataset.dataItems[e],o=new i(this.indexes.dataitem,this.indexes.tupleitem,{formatter:this.formatter,dataset:this.dataset,dataItemFormats:t&&t.dataItemFormats});return this._calculateformattedValue(o)},r._calculateformattedValue=function(e){if(void 0===this.item.value||null===this.item.label)this.formattedValue=e.format(null),this.unformattedValue=this.formattedValue;else if(this.item.aggregate){!!this.content.getPropertyValue("widget.legend.aggregateTypeVisible")?(this.formattedValue=e.format(o.get("multiMeasureLabel",{measureName:this.item.label.toString(),aggregate:o.get(this.item.aggregate.toString())})),this.unformattedValue=this.item.label+this.item.aggregate):(this.formattedValue=e.format(o.get("measureLabel",{measureName:this.item.label.toString()})),this.unformattedValue=this.item.label+this.item.aggregate)}else this.formattedValue=e.format(this.item.label.toString()),this.unformattedValue=this.item.label},r.addTuple=function(e){this._tuples.push(e),this._datapoints=null},r.getUniqueName=function(){return void 0===this.item.value||null===this.item.value?this.item.value:this.item.value.toString()},r.getCaption=function(){if(this.item.aggregate){var e=this.content.getPropertyValue("widget.legend.aggregateTypeVisible");e!=this.aggregationPropertyValue&&(this._recalculatedFormattedValue(),this.aggregationPropertyValue=e)}return this.formattedValue||this._recalculatedFormattedValue(),this.formattedValue},r.getParent=function(){return this.item.p},r.decorate=function(t,i){e.prototype.decorate.apply(this,arguments);var o=this.datapoints;if(o.length>0){this.context.version++;for(var r=0;r<o.length;r++)o[r].decorate(t,i)}},_createClass(t,[{key:"datapoints",get:function(){if(!this._datapoints){this._datapoints=[];for(var e=0;e<this._tuples.length;e++)for(var t=this._tuples[e],i=0;i<t.datapoints.length;i++)this._datapoints.push(t.datapoints[i])}return this._datapoints}}]),t}(t)})),define("dashboard-analytics/visualizations/vipr/data/VIPRTuple",["underscore","./VIPRDecoratable","./VIPRItem"],(function(e,t,i){return function(t){function o(e,i,o,r,n){var a;return(a=t.call(this,Object.assign({getDecorationsCallback:function(){return n}},e),i)||this).tuple=e,a.content=o,a.context=i,a.datapoints=[],a.items=[],a.dataset=i.dataset,a.dataItemIndex=a.context.index.dataitem,a.dataItemFormats=a.context.index.dataItemFormats,a.itemClassSetIndex=a.context.index.itemClassSet,a._viprItemCache=r,a}_inheritsLoose(o,t);var r=o.prototype;return r.destroy=function(){for(var e in this._viprItemCache)this._viprItemCache[e].destroy(),delete this._viprItemCache[e];this._viprItemCache=null,this.datapoints=null,this.dataset=null,this.context=null,this.items=null},r.getUniqueName=function(){return this.getItem(0).getUniqueName()},r.getCaption=function(){return this.getItem(0).getCaption()},r.getParent=function(){return this.getItem(0).getParent()},r.getItemClassSetIndex=function(){return this.itemClassSetIndex},r._createVIPRItem=function(e,t,o){var r,n=t.context,a=t.tuple[e];return r=a.d?a.d+"->"+a.u:a.label+"->"+a.value,this._viprItemCache[r]||(this._viprItemCache[r]=new i(this.tuple[e],n,o)),this._viprItemCache[r].addTuple(t),this._viprItemCache[r]},r.getItem=function(e){return e<this.getItemCount()&&void 0===this.items[e]&&(this.context.index.tupleitem=e,this.context.index.dataitem=this.dataItemIndex,this.context.index.dataItemFormats=this.dataItemFormats,this.context.dataset=this.dataset,this.items[e]=this._createVIPRItem(e,this,this.content)),this.items[e]},r.getItemCount=function(){return this.tuple?this.tuple.length:0},r.addDataPoint=function(e){-1===this.datapoints.indexOf(e)&&this.datapoints.push(e)},r.decorate=function(i,o){t.prototype.decorate.apply(this,arguments),this.datapoints.length>0&&e.each(this.datapoints,(function(e){e.decorate(i,o)}))},o}(t)})),define("dashboard-analytics/visualizations/vipr/data/VIPRCatDataItem",["./VIPRDecoratable","./VIPRItemClassSet","./VIPRTuple"],(function(e,t,i){return function(e){function o(i,o,r){var n;(n=e.call(this,{getDecorationsCallback:i.getDecorations.bind(i)},o)||this).resultItem=i,n.context=o,n.content=r,n.dataItemIndex=n.context.index.dataitem,n.dataset=n.context.dataset;var a=n.dataset.slots[n.dataItemIndex];return n.dataItemFormats=[],a.getDataItemList().forEach((function(e){n.dataItemFormats.push(e.getFormat())})),n.tuples=[],n.itemClassSets=[new t(n.resultItem.getDataItemList(),n.context)],n.viprItemCache={},n}_inheritsLoose(o,e);var r=o.prototype;return r.destroy=function(){var e=this;for(var t in this.itemClassSets.forEach((function(t,i){t.destroy(),delete e.itemClassSets[i]})),this.tuples.forEach((function(t,i){t.destroy(),delete e.tuples[i]})),this.viprItemCache)this.viprItemCache[t].destroy(),delete this.viprItemCache[t];this.tuples=null,this.context=null,this.itemClassSets=null,this.viprItemCache=null,this.dataset=null},r.getUniqueName=function(){},r.postProcessing=function(){},r.getCaption=function(){},r.getType=function(){return"cat"},r.getTupleCount=function(){return this.resultItem?this.resultItem.getRowCount():0},r.getTuple=function(e){if(e<this.getTupleCount()&&void 0===this.tuples[e]){this.context.dataset=this.dataset;var t=this.resultItem.getValue(e);this.context.index={dataitem:this.dataItemIndex,dataItemFormats:this.dataItemFormats,tuple:e,itemClassSet:0};var o=this.resultItem.getValueDecorations(e);this.tuples[e]=new i(t,this.context,this.content,this.viprItemCache,o)}return this.tuples[e]},r.getDataWindowStart=function(){return 0},r.getDataWindowEnd=function(){return this.getTupleCount()},r.getItemClassSetCount=function(){return this.itemClassSets.length},r.getItemClassSet=function(e){return this.itemClassSets[e||0]},o}(e)})),define("dashboard-analytics/visualizations/vipr/data/VIPRContDataItem",["underscore","./VIPRDecoratable","./VIPRItemClass","./VIPRFormatter"],(function(e,t,i,o){return function(e){function t(t,r,n){var a;return(a=e.call(this,{getDecorationsCallback:t.getDecorations.bind(t)},r)||this).context=r,a.queryResult=r&&r.queryResult,a.content=n,a.formatter=new o(a.context.index.dataitem,0,a.context),a.itemClass=new i(t.getDataItemList()[0],a.context),a.domain=a._createDomain(),a}_inheritsLoose(t,e);var r=t.prototype;return r.destroy=function(){this.itemClass.destroy(),this.itemClass=null,this.context=null,this.formatter=null},r._getMinMaxData=function(e){for(var t=e.getResultItemList(),i=[],o=0;o+1<t.length;o+=2){var r=t[o].getDataItemList()[0],n=e.getValue(0,o).value,a=e.getValue(0,o+1).value;i.push({min:n,max:a,columnId:r.getColumnId(),aggregation:r.getAggregation(),explicit:this._explicitMinMax(n,a)})}return i},r._explicitMinMax=function(e,t){var i=this.content&&this.content.getFeature("Visualization");return i&&"Tiledmap"===i.getType()&&null!=e&&null!=t},r._createMultiMeasureDomain=function(e){var t,i,o;return this._getMinMaxData(e).forEach((function(e){var r=e.min,n=e.max,a=e.explicit;t=void 0!==t?Math.min(t,r):r,i=void 0!==i?Math.max(i,n):n,o=a})),{min:t,max:i,explicit:o}},r._createNonMultiMeasureDomain=function(e){var t=this._getMinMaxData(e),i=this.itemClass.dataItem.getColumnId(),o=this.itemClass.dataItem.getAggregation(),r=t.find((function(e){return e.columnId===i&&e.aggregation===o}));return r?{min:r.min,max:r.max,explicit:r.explicit}:null},r._createDomain=function(){var e=null,t=this.context.minmaxResult;return t&&(e="_multiMeasuresValue"===this.itemClass.getUniqueName()?this._createMultiMeasureDomain(t):this._createNonMultiMeasureDomain(t)),e},r.getUniqueName=function(){return this.itemClass.getUniqueName()},r.getCaption=function(){return this.itemClass.getCaption()},r.getType=function(){return"cont"},r.getDomain=function(){return this.domain},r.getFormatter=function(){return this.formatter},r.getItemClass=function(){return this.itemClass},t}(t)})),define("dashboard-analytics/visualizations/vipr/data/VIPRCatContDataItem",["underscore","./VIPRCatDataItem","./VIPRFormatter"],(function(e,t,i){return function(e){function t(t,o){var r;return(r=e.call(this,t,o)||this).formatter=new i(r.context.index.dataitem,0,r.context),r.postProcessing(),r}_inheritsLoose(t,e);var o=t.prototype;return o.destroy=function(){this.formatter=null,e.prototype.destroy.call(this)},o.getType=function(){return"cont"},o.getFormatter=function(){return this.formatter},o.postProcessing=function(){var e=this.context.index.dataitem,t=this.dataset.slots[e].getDefinition().getSubType();if(t&&"latitude"===t||"longitude"===t)for(var i=0;i<this.resultItem.getRowCount();i++){var o=this.resultItem.getValue(i);o[0].hasOwnProperty("label")&&o[0].hasOwnProperty("value")&&o[0].label!==o[0].value&&(o[0].value=o[0].label)}},o.getItemClass=function(){return null},o.getDomain=function(){return null},t}(t)})),define("dashboard-analytics/visualizations/vipr/data/VIPRDataSet",["./VIPRDecoratable","./VIPRDataPoint","./VIPRCatDataItem","./VIPRContDataItem","./VIPRCatContDataItem","../../../apiHelpers/SlotAPIHelper"],(function(e,t,i,o,r,n){return function(e){function a(t,n,a,s,l){var d;(d=e.call(this)||this).id=t,d.queryResult=n,d.slots=a,d.context=s,d.context.queryResult=n,d.context.dataset=_assertThisInitialized(d),d.viprDataPoints={},d.dataItems=[];for(var u=n.getResultItemList(),c=u?u.length:0,g=0;g<c;g++){var h=u[g],p=d._getSlot(h)||d.slots[g],f=p&&p.getDefinition(),m=p&&p.getDataItemList();if(m&&m.length){var v="attribute"===m[0].getType()?i:o;["latitude","longitude"].indexOf(f.getSubType())>-1&&(v=r),d.context.index={dataitem:d.slots.indexOf(p)},d.dataItems[g]=new v(h,d.context,l)}}return d.dataItemInfo=d._getDataItemInfo(),d}_inheritsLoose(a,e);var s=a.prototype;return s.destroy=function(){var e=this;for(var t in this.dataItems.forEach((function(t,i){t.destroy(),delete e.dataItems[i]})),this.viprDataPoints)this.viprDataPoints[t].destroy(),delete this.viprDataPoints[t];this.dataItems=null,this.viprDataPoints=null,this.context=null},s._getSlot=function(e){return this.slots.find((function(t){return!(!n.isMultiMeasuresValueSlot(t)||e.getDataItemList()[0].getId()!==n.MULTI_MEASURES_VALUE)||t.getDataItemList().find((function(t){return t.getId()===e.getDataItemList()[0].getId()}))}))},s.getId=function(){return this.id},s.getDataItem=function(e){return e<this.dataItems.length?this.dataItems[e]:null},s.getDataItemCount=function(){return this.dataItems.length},s.getDataPointCount=function(){return this.queryResult.getRowCount()},s.getDataPoint=function(e){if(e<this.queryResult.getRowCount()){var i=this.viprDataPoints[e];return i||(i=new t(e,this,this.dataItemInfo,this.context),this.viprDataPoints[e]=i),i}return null},s._getDataItemInfo=function(){var e=this,t={isLatLong:{},formatter:{}};return this.dataItems.forEach((function(i,o){var r=e.slots[o]&&e.slots[o].getDefinition(),n=r&&r.getSubType();"longitude"!==n&&"latitude"!==n||(t.isLatLong[o]=!0),i.getFormatter&&(t.formatter[o]=i.getFormatter&&i.getFormatter())})),t},a}(e)})),define("dashboard-analytics/visualizations/vipr/data/VIPRData",["underscore","./VIPRDecoratable","./VIPRDataSet"],(function(e,t,i){return function(t){function o(o,r,n,a,s){var l;(l=t.call(this)||this).context={version:0,VIPRData:_assertThisInitialized(l),hideAggTypeInAxisLabels:n,formatter:s},l._aVIPRDataSets=[];var d=r.getSlots().getMappedSlotList(),u=r.getDefinition().getDatasetList().map((function(e){return e.id}));return e.each(u,function(t){var r=e.filter(d,(function(e){return-1!==e.getDefinition().getDatasetIdList().indexOf(t)})),n=o.getResult(t);if(n){var s=o.getResult(t,o.QUERY_RESULT_TYPE.MINMAX);s&&(this.context.minmaxResult=s),this._aVIPRDataSets.push(new i(t,n,r,this.context,a))}else this._aVIPRDataSets.push(null)}.bind(_assertThisInitialized(l))),l}_inheritsLoose(o,t);var r=o.prototype;return r.destroy=function(){var e=this;this._aVIPRDataSets.forEach((function(t,i){t&&(t.destroy(),delete e._aVIPRDataSets[i])})),this._aVIPRDataSets=null,this.context=null},r.getDataSetAt=function(e){return this._aVIPRDataSets[e]},r.getDataSetCount=function(){return this._aVIPRDataSets.length},r.getDecorationsVersion=function(){return this.context.version},o}(t)})),define("dashboard-analytics/visualizations/vipr/VIPRSlotMapping",["underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class","../../apiHelpers/SlotAPIHelper"],(function(e,t,i){var o=t.extend({init:function(e,t){this.slotAPIs=e,this.datasetId=t},getDataItemsFor:function(t){var o=[],r=0;return e.each(this.slotAPIs,(function(n){var a=n.getId();n.isStacked()||i.isMultiMeasuresSeriesSlot(n)||i.isMultiMeasuresValueSlot(n)?(a===t.name&&o.push(r),r++):e.each(n.getDataItemList(),(function(){a===t.name&&o.push(r),r++}))})),o}});return t.extend({init:function(t){this._aVIPRSlotMapping=[];var r=t.getDefinition().getDatasetList();e.each(r,function(e){var r=i.getMappedSlotListByDataset(t,e.id);r&&0!==r.length?this._aVIPRSlotMapping.push(new o(r,e.id)):this._aVIPRSlotMapping.push(null)}.bind(this))},getDataSetMapping:function(e){return this._aVIPRSlotMapping[e]}})})),define("dashboard-analytics/visualizations/vipr/extendedVis/SchematicVis",["underscore","dashboard-analytics/lib/@waca/core-client/js/core-client/utils/ClassFactory"],(function(e,t){return function(){function e(){this.schematicPromises={}}var i=e.prototype;return i.destroy=function(){this.schematicPromises={},this.ajaxSvc=null},i.getSchematicContent=function(e,t){if(void 0===e&&(e={}),"edit"===e.method)return this._openSchematicEditor(e,t);if("publish"===e.method);else if("get"===e.method)return this._getSchematicContent(e,t)},i._openSchematicEditor=function(e,i){return void 0===e&&(e={}),t.loadModule("dashboard-analytics/visualizations/vipr/extendedVis/SchematicEditorUI").then((function(t){return t.openSchematicEditor(e.metadata,i)}))},i._getSchematicContent=function(e,t){void 0===e&&(e={});var i=e.type&&"meta"===e.type?e.type:e.name;if(!this.schematicPromises[i]){var o=this._getUrlParm(e),r=this._getAjaxSvc(t);this.schematicPromises[i]=r.ajax(o).then((function(e){return e.jqXHR.responseText}))}return this.schematicPromises[i]},i._getUrlParm=function(t){return void 0===t&&(t={}),{url:e.getVisualizationEndPoint()+t.library+(t.type&&"meta"===t.type?"/content/meta.json":"/content/"+e.cleanseFilename(t.name)),type:t.method,headers:{"Content-Type":"application/xml; charset=utf-8",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*; charset=utf-8"}}},i._getAjaxSvc=function(e){return this.ajaxSvc||(this.ajaxSvc=e.getGlassCoreSvc(".Ajax")),this.ajaxSvc},e.cleanseFilename=function(e){var t=e.split("\\");return e=t.join("/")},e.getVisualizationEndPoint=function(){return"v1/visualizations/"},e}()})),define("dashboard-analytics/visualizations/vipr/config/Custom",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{customVis:{isCustomVis:!0,isRecommendable:!1,aggregateAndSortOnClient:!0,queryHints:{multiEdgeSort:!0},includeAllProperties:!0,ignoreElementColor:!0,listenForPropChanges:[],slots:{color:{sort:"asc",icon:"colorBy"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"colors.series":{defaultValue:!1}},bundleInclude:[],config:{include:["widget.data.truncate","widget.iterator"]}}}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Schematic",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{customVis:{isSchematic:!0,disablePan:!0,isRecommendable:!1,doesNotSupportCustomGroupAction:!0,renderWithoutCompletingMapping:!0,cursor:["grab","-moz-grab","-webkit-grab"],thumbnail:{enabled:!1,type:"img"},listenForPropChanges:["schematic","views.hidden","showPreview","region.visible","point.visible"],dataRowLimit:3e4,dataRowLimitIE:3e3,slots:{locations:{subtype:"location",icon:"location"},locationColor:{icon:"heat_map"},pointLocations:{icon:"location",subtype:"location"},pointSize:{icon:"size_by",multiMeasure:!0},pointColor:{icon:"point_heat",tags:["ca.dashboard.repeatHere=true"]}},propertiesToSetBeforeData:["widget.data.truncate"],groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},propertyPrefixes:{locationColor:"widget.legend",pointColor:"widget.legend",pointSize:"widget.legend"},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"debug.mode":{active:!1,defaultValue:!1},schematicLibrary:{active:!1},backgroundColor:{active:!1},showPreview:{active:!1},"region.visible":{active:!1},"point.visible":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0}},supportsLayers:!0,layerDescriptions:[{id:"data.region",colorRelatedProps:{transparencyProp:"region.transparency",defaultPaletteValue:"colorPalette0",sectionNameId:"sectionName_regionLayer"},visibleLayerProps:["region.visible","region.transparency"]},{id:"data.point",colorRelatedProps:{transparencyProp:"point.transparency",defaultPaletteValue:"colorPalette1",sectionNameId:"sectionName_pointLayer"},visibleLayerProps:["point.visible","point.transparency"]}],supportsMaintainAxisScale:!0,ignoreElementColor:!0,isMultilayersWidget:!0,config:{include:["widget.data.truncate","widget.iterator","debug.mode","point.visible","region.visible","showPreview","optimizeSize","backgroundColor","widget.legend.backgroundColor","schematicLibrary","schematic","zoomView","zoomData","viewTransparency","enableViewControl","enableLayerControl","region.transparency","point.transparency","point.defaultSize","point.sizeScaling","point.minSize","point.maxSize","point.staticZeroValueSize","point.autoScaleFactor","widget.legend.display","widget.legend.position","widget.legend.size","locationColor.title","pointColor.title","pointSize.title","widget.legend.titleVisible","widget.legend.titleColor","widget.legend.font","widget.legend.color","widget.legend.swatch.symbol.default","colors.location.cat","colors.location.cont","colors.point.cat","colors.point.cont","widget.legend.splitter","widget.legend.titleFont","widget.legend.fontSize","views.hidden","pagination.control.visible"]}}}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2heat",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"Heatmap",propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{sort:"asc",icon:"row_heading",tags:["badge"],mldTitleProperty:"itemAxis.title"},series:{sort:"asc",icon:"column_heading",tags:["badge"],mldTitleProperty:"valueAxis.title"},points:{icon:"points"},color:{icon:"heat_map",mldTitleProperty:"color.title",tags:["canUseToColor"]},size:{icon:"size_by",mldTitleProperty:"size.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",categories:"valueAxis.title",series:"itemAxis.title",color:"widget.legend",size:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"color.title":{multilingual:!0},"size.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"border.width":{active:!1},"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"itemAxis.gridLines.color":{colorClass:!0,addButton:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","gridLines.visible","itemAxis.title.visible","valueAxis.title.visible","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","itemAxis.title.font","itemAxis.title.color","valueAxis.title.font","valueAxis.title.color","itemAxis.title","valueAxis.title","itemAxis.labels.layoutMode","itemAxis.alignment","gridlineColor","itemAxis.ticks.color","valueAxis.ticks.color","labelColor","backgroundColor","widget.legend.backgroundColor","optimizeSize","border.width","widget.legend.color","widget.legend.splitter","widget.legend.titleColor","widget.legend.font","widget.legend.titleFont","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","colors.color","widget.legend.size","widget.legend.titleVisible","color.title","size.title","itemAxis.gridLines.color","valueAxis.gridLines.color","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle"],exclude:[]},usages:["Relationships","Comparison"],supportsMaintainAxisScale:!0}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/constants",[],(function(){"use strict";var e=function(e){return!(isNaN(e)||isNaN(Number.parseFloat(e)))||null===e};return{SHORT_EFFECT_DURATION:100,LONG_EFFECT_DURATION:100,validateNumIsFloatOrNull:e,minMaxValidationOptions:{checkForValidValue:e,supportsValidationChecks:!0,validationInfo:{supportsFloats:!0,messageId:"customRangeErrorMessage"}}}})),define("dashboard-analytics/visualizations/vipr/config/LineAndAreaBaseConfig",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{aggregateAndSortOnClient:!0,thumbnail:{properties:{"itemAxis.line.visible":!0,"valueAxis.line.visible":!0,"itemAxis.gridLines.visible":!0,"valueAxis.gridLines.visible":!0}},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{series:{sort:"asc",tags:["ca.dashboard.repeatHere=true","canUseToColor"],icon:"colorBy",mldTitleProperty:"series.title"},categories:{optional:!1,sort:"asc",icon:"xAxis",tags:["badge"],mldTitleProperty:"itemAxis.title"},values:{sortable:!0,multiMeasure:!0,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["series"],groupOnColumnId:"categories"},icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",values:"valueAxis.title",categories:"itemAxis.title",series:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"series.title":{multilingual:!0},"lines.visible":{defaultValue:!0,active:!1,isReadOnly:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"area.opacity":{percentage:!0,step:.1},"area.opacity.fill":{percentage:!0,step:.1},"area.borderColor":{colorClass:!0,addButton:!0},"areas.visible":{active:!1},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"widget.legend.size":{active:!1},"colors.series":{defaultValue:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"contrast.label.color":{defaultValue:!0},"itemAxis.gridLines.color":{colorClass:!0,addButton:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueLabels.color":{colorClass:!0,addButton:!0},lineColor:{active:!1},nullValuesHandling:{defaultValue:"Interpolate"}},queryHints:{multiEdgeSort:!0},config:{include:["optimizeSize","data.handling","transpose","nullValuesHandling","widget.data.truncate","widget.iterator","widget.repeatHorizontal.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.color","widget.repeatVertical.labels.font","widget.legend.display","widget.legend.position","widget.legend.splitter","widget.legend.color","widget.legend.font","widget.legend.titleVisible","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","widget.legend.size","widget.legend.backgroundColor","backgroundColor","lineColor","itemAxis.title","itemAxis.title.visible","itemAxis.title.font","itemAxis.title.color","itemAxis.ticks.visible","itemAxis.ticks.color","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","itemAxis.ticks.labels.visible","itemAxis.ticks.labels.rotateAngle","itemAxis.line.visible","itemAxis.line.color","itemAxis.gridLines.color","itemAxis.labels.layoutMode","itemAxis.gridLines.visible","valueAxis.minValue","valueAxis.maxValue","valueAxis.zeroOrigin","valueAxis.logarithmic","valueAxis.title","valueAxis.title.visible","valueAxis.title.font","valueAxis.title.color","valueAxis.line.visible","valueAxis.line.color","valueAxis.gridLines.color","valueAxis.tickInterval","valueAxis.ticks.visible","valueAxis.ticks.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","valueAxis.ticks.labels.visible","valueAxis.gridLines.visible","lines.visible","line.width","lineWithPoints.symbol","markers.visible","interpolate","area.borderColor","area.borderWidth","area.opacity","area.opacity.fill","areas.visible","chart.gradient","valueLabels.visible","valueLabels.format","valueLabels.font","valueLabels.color","labelColor","label.shadow","contrast.label.color","colors.series","series.title","zoom.bar.enable"],exclude:[]},usages:["Trend"],supportsMaintainAxisScale:!0}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlearea",["../constants","./LineAndAreaBaseConfig"],(function(e,t){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;return t.type="Area",t.slots.series.useInTopBottomQueries=!1,t.slots.series.stackValuesOnAxis=!0,t.slots.categories.selectable=!1,t.shouldMultiPointSelectionSummarize=!0,t.properties["lineWithPoints.symbol"]={active:!1},t.properties["markers.visible"]={active:!1,defaultValue:!1,isReadOnly:!0},t}}]),t}(t)})),define("dashboard-analytics/visualizations/vipr/config/Rave2comet",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"DriverAnalysis",isRecommendable:!1,noDataQuery:!0,doesNotSupportSortAction:!0,doesNotSupportTopBottomAction:!1,doesNotSupportFormatAction:!0,doesNotSupportCustomGroupAction:!0,useFPDAsInsightsInput:!0,ignoreElementColor:!0,doesNotSupportOLAP:!0,supportsPossibleKeyDrivers:!0,hideAggTypeInAxisLabels:!0,doesNotSupportAnnotations:!0,enableCustomDataSelection:!1,thumbnail:{properties:{"valueAxis.line.visible":!0,"valueAxis.ticks.visible":!0}},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{values:{icon:"target",actions:["TopKeyDriversAction","PossibleKeyDriverAction"],coachMark:{titleResource:"coachMarkTitleSpiralTarget",contentResource:"coachMarkContentSpiralTarget",mappedOnly:!0,showPopover:!0}}},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},optimizeSize:{defaultValue:!0},"widget.legend.font":{active:!0},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},config:{include:["widget.data.truncate","widget.iterator","contrast.axes.color","contrast.text.color","axis.title.visible","axis.indicators.visible","axis.labels.visible","target.title.visible","valueAxis.zeroOrigin","target.title.color","axis.color","axis.label.color","oneWay.color","twoWay.color","combination.color","optimizeSize","target.stroke.color","backgroundColor","widget.legend.backgroundColor","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.size","widget.legend.swatch.symbol.default","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","valueAxis.title.font","valueAxis.title.color"],exclude:[]},usages:["Advanced"],supportsMaintainAxisScale:!1}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Spiral",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"Spiral",isRecommendable:!1,noDataQuery:!0,supportsPossibleKeyDrivers:!0,doesNotSupportAnnotations:!0,doesNotSupportSortAction:!0,doesNotSupportTopBottomAction:!1,doesNotSupportFormatAction:!0,doesNotSupportOLAP:!0,doesNotSupportCustomGroupAction:!0,enableCustomDataSelection:!0,useFPDAsInsightsInput:!0,ignoreElementColor:!0,hideAggTypeInAxisLabels:!0,propertiesToSetBeforeData:["widget.data.truncate"],slots:{values:{icon:"target",actions:["TopKeyDriversAction","PossibleKeyDriverAction"],coachMark:{titleResource:"coachMarkTitleSpiralTarget",contentResource:"coachMarkContentSpiralTarget",mappedOnly:!0,showPopover:!0},mldTitleProperty:"valueAxis.title"}},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"valueAxis.title":{multilingual:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},optimizeSize:{defaultValue:!0},"effect.duration":{active:!1}},config:{include:["widget.data.truncate","widget.iterator","targetVisibility","effect.duration","backgroundColor","widget.legend.backgroundColor","tableAreaBackground","tableContentBackground","ring4Color","ring3Color","ring2Color","ring1Color","ring0Color","bullseyeColor","contrastText","valueAxis.title","optimizeSize"],exclude:[]},usages:["Advanced"],supportsMaintainAxisScale:!1}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Sunburst",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"Sunburst",isRecommendable:!1,noDataQuery:!0,supportsPossibleKeyDrivers:!0,useFPDAsInsightsInput:!0,ignoreElementColor:!0,doesNotSupportSortAction:!0,doesNotSupportTopBottomAction:!0,doesNotSupportFormatAction:!0,doesNotSupportAnnotations:!0,doesNotSupportOLAP:!0,doesNotSupportCustomGroupAction:!0,enableCustomDataSelection:!0,shouldLogFPDInsightMessages:!0,hideAggTypeInAxisLabels:!0,propertiesToSetBeforeData:["widget.data.truncate"],groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},slots:{values:{icon:"target",actions:["PossibleKeyDriverAction","text"],coachMark:{titleResource:"coachMarkTitleSpiralTarget",contentResource:"coachMarkContentSpiralTarget",mappedOnly:!0,showPopover:!0},mldTitleProperty:"values.title"}},propertyPrefixes:{legend:"widget.legend"},listenForPropChanges:["treeMode","topBottomTargetValue","widget.legend.size"],properties:{"values.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1},topBottomN:{active:!1},topBottomTargetValue:{active:!1},actions:{active:!1,defaultValue:"showSunburst"},showInsights:{active:!1},treeMode:{active:!1},showMinimap:{active:!1},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0}},tabs:{default:"showSunburst",entries:[{id:"showSunburst",resource:"decisionSunburst"},{id:"showTree",resource:"decisionTree"},{id:"showRules",resource:"decisionRules"}]},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","showMinimap","actions","showInsights","treeMode","topBottomN","topBottomTargetValue","effect.duration","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","custom_cont","custom_cat","widget.legend.size","widget.legend.titleVisible","values.title","optimizeSize","valueLabels.font","valueLabels.color","labels.contrast.color"],exclude:[]},usages:["Advanced"],supportsMaintainAxisScale:!1}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Decisiontree",["./Sunburst"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;return t.type="DecisionTree",t.useFPDAsInsightsInput=!0,t.tabs.default="showTree",t.properties.actions.defaultValue="showTree",["legend.display","legendPosition","showMinimap"].forEach((function(e){return delete t.properties[e]})),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundletreemap",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Treemap",propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{icon:"level",recommendMulti:!0,sort:"asc"},size:{icon:"size_by",sortable:!1,mldTitleProperty:"size.title"},color:{icon:"heat_map",supportsMaintainAxisScale:!0,mldTitleProperty:"color.title",tags:["canUseToColor"]},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"labels",categories:"labels",size:"widget.legend",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"color.title":{multilingual:!0},"size.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1,defaultValue:e.LONG_EFFECT_DURATION},"widget.legend.size":{active:!1},"labels.color":{colorClass:!0,addButton:!0,displayPos:8},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"contrast.label.color":{defaultValue:!0},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","intermediate.labels.visible","leaf.labels.visible","labels.format","labels.color","labels.font","contrast.label.color","label.shadow","effect.duration","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","colors.categories","colors.color","widget.legend.size","widget.legend.titleVisible","color.title","color.title.visible","size.title","optimizeSize","renderingMode"],exclude:[]},usages:["PartsToWhole"],supportsMaintainAxisScale:!1}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlepie",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Pie",disablePan:!0,isRecommendable:!1,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{icon:"pie_category_slice",mldTitleProperty:"categories.title"},values:{sort:"asc",icon:"values"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"labels",values:"labels",categories:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"categories.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1,defaultValue:e.LONG_EFFECT_DURATION},"border.width":{active:!1},"widget.legend.size":{active:!1},"labels.color":{colorClass:!0,addButton:!0,displayPos:8},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,addButton:!0,active:!0},"contrast.label.color":{defaultValue:!0},"donut.hole.radius":{percentage:!0,step:.01},"inner.label.title":{multilingual:!0},"inner.label.value.color":{addButton:!0,colorClass:!0},"inner.label.title.color":{addButton:!0,colorClass:!0},"label.percentage":{defaultValue:!1},labelLocation:{defaultValue:"inside"},startAngle:{percentage:!1},endAngle:{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","donut.hole.radius","label.percentage","labels.visible","inner.label.visible","inner.label.title","inner.label.value.color","inner.label.value.font","inner.label.title.color","inner.label.title.font","backgroundColor","widget.legend.backgroundColor","labelLocation","effect.duration","labels.color","labels.font","labels.format","contrast.label.color","label.shadow","border.width","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","widget.legend.swatch.symbol.default","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","colors.categories","widget.legend.size","widget.legend.titleVisible","categories.title","optimizeSize","startAngle","endAngle"],exclude:["sort"]},usages:["PartsToWhole"],supportsMaintainAxisScale:!1}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Ravebubble",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Bubble",propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],thumbnail:{properties:{"itemAxis.line.visible":!0,"valueAxis.line.visible":!0,"itemAxis.gridLines.visible":!0,"valueAxis.gridLines.visible":!0}},slots:{color:{optional:!0,sort:"asc",icon:"colorBy",supportsMaintainAxisScale:!0,mldTitleProperty:"color.title",tags:["canUseToColor"]},x:{optional:!1,icon:"xAxis",tags:["badge"],mldTitleProperty:"itemAxis.title",supportsMaintainAxisScale:!0,supportSortActionForMeasures:!1},y:{optional:!1,icon:"yAxis",tags:["badge"],mldTitleProperty:"valueAxis.title",supportsMaintainAxisScale:!0,supportSortActionForMeasures:!1},size:{optional:!1,icon:"size_by",mldTitleProperty:"size.title"},categories:{optional:!0,icon:"bubbles"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",x:"itemAxis.title",y:"valueAxis.title",size:"widget.legend",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","labels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","labels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"color.title":{multilingual:!0},"size.title":{multilingual:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1,defaultValue:e.LONG_EFFECT_DURATION},"border.width":{active:!1},"bubble.value.smallest.size":{active:!1},"bubble.value.biggest.size":{active:!1},"bubble.size":{active:!1},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"itemAxis.minValue":e.minMaxValidationOptions,"itemAxis.maxValue":e.minMaxValidationOptions,"bubble.size.minValue":e.minMaxValidationOptions,"bubble.size.maxValue":e.minMaxValidationOptions,"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"labels.color":{colorClass:!0,addButton:!0,displayPos:8},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"contrast.label.color":{defaultValue:!0},"itemAxis.gridLines.color":{colorClass:!0,addButton:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["valueAxis.minValue","valueAxis.maxValue","itemAxis.minValue","itemAxis.maxValue","widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","itemAxis.gridLines.visible","valueAxis.gridLines.visible","labels.visible","itemAxis.title.visible","valueAxis.title.visible","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","itemAxis.title.font","itemAxis.title.color","valueAxis.title.font","valueAxis.title.color","valueAxis.logarithmic","itemAxis.title","valueAxis.title","itemAxis.ticks.color","valueAxis.ticks.color","itemAxis.labels.layoutMode","labelColor","contrast.label.color","border.width","border.color","bubble.size","bubble.size.minValue","bubble.size.maxValue","bubble.value.smallest.size","bubble.value.biggest.size","label.shadow","backgroundColor","widget.legend.backgroundColor","symbolShape","effect.duration","optimizeSize","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","labels.font","labels.color","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","colors.categories","colors.color","widget.legend.size","widget.legend.titleVisible","color.title","size.title","valueAxis.tickInterval","itemAxis.tickInterval","itemAxis.gridLines.color","valueAxis.gridLines.color","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle","zoom.bar.enable"],exclude:[]},usages:["Relationships"],supportsMaintainAxisScale:!0}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2marimekko",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Marimekko",doesNotSupportAnnotations:!0,aggregateAndSortOnClient:!0,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],thumbnail:{properties:{"itemAxis.gridLines.visible":!0,"valueAxis.gridLines.visible":!0}},slots:{color:{optional:!0,sort:"asc",icon:"colorBy",tags:["ca.dashboard.repeatHere=true","canUseToColor"],supportsMaintainAxisScale:!0,mldTitleProperty:"color.title"},categories:{optional:!1,sort:"asc",icon:"x-axis_bars",mldTitleProperty:"itemAxis.title"},values:{sortable:!0,optional:!1,multiMeasure:!0,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["color"],groupOnColumnId:"categories"},icon:"yAxis",tags:["badge"],mldTitleProperty:"valueAxis.title"},width:{sortable:!0,optional:!0,icon:"width",tags:["badge"]},repeatHorizontal:{icon:"multiplier_h",limit:20,sort:"asc"},repeatVertical:{icon:"multiplier_v",limit:20,sort:"asc"}},propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",width:"itemAxis.title",values:"valueAxis.title",categories:"itemAxis.title",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color","barLabels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font","barLabels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"color.title":{multilingual:!0},"effect.duration":{active:!1},"column.border.width":{active:!1},"column.border.color":{active:!1},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"contrast.label.color":{defaultValue:!0},"itemAxis.gridLines.color":{colorClass:!0,addButton:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueLabels.color":{colorClass:!0,addButton:!0}},queryHints:{multiEdgeSort:!0},config:{include:["valueAxis.minValue","valueAxis.maxValue","widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","stacked.percent","itemAxis.title.visible","valueAxis.title.visible","valueAxis.zeroOrigin","valueAxis.logarithmic","itemAxis.gridLines.visible","valueAxis.gridLines.visible","itemAxis.title","valueAxis.title","gridlineColor","itemAxis.ticks.color","valueAxis.ticks.color","backgroundColor","widget.legend.backgroundColor","column.border.width","column.border.color","valueLabels.visible","labelColor","contrast.label.color","label.shadow","effect.duration","optimizeSize","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","itemAxis.title.font","itemAxis.title.color","valueAxis.title.font","valueAxis.title.color","valueLabels.font","valueLabels.color","barLabels.font","barLabels.color","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","colors.color.cat","colors.color.cont","widget.legend.size","widget.legend.titleVisible","color.title","valueAxis.tickInterval","itemAxis.gridLines.color","valueAxis.gridLines.color","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle"],exclude:[]},usages:["Comparison"],supportsMaintainAxisScale:!1}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlebullet",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Bullet",thumbnail:{properties:{"valueAxis.ticks.labels.visible":!1}},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],doesNotSupportAnnotations:!0,doesNotSupportCustomGroupAction:!0,doesNotSupportTooltipSlot:!0,slots:{actual:{optional:!1,icon:"y-axis_columns",actions:["formatAction","text"],tags:["canUseToColor"]},goal:{optional:!0,icon:"target",actions:["formatAction"],tags:["canUseToColor"]},min:{optional:!0,icon:"values",actions:["formatAction"]},mid:{optional:!0,icon:"values",actions:["formatAction"]},max:{optional:!0,icon:"values",actions:["formatAction"]},repeatHorizontal:{icon:"multiplier_h",sort:"asc",actions:["sortAction","formatAction","topBottomAction","filter"]},repeatVertical:{icon:"multiplier_v",actions:["sortAction","formatAction","topBottomAction","filter"]}},propertyPrefixes:{legend:"widget.legend"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"chart.title.color":{active:!1},"chart.title.auto.areawidth":{active:!1},"chart.title.areawidth":{active:!1},"chart.title.visible":{active:!1,defaultValue:!1,isReadOnly:!0},itemAxisSubtitle:{active:!1},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"color.min":{colorClass:!0,addButton:!0},"color.mid":{colorClass:!0,addButton:!0},"color.max":{colorClass:!0,addButton:!0},"color.title":{multilingual:!0},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},config:{include:["valueAxis.minValue","valueAxis.maxValue","widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","chart.title.color","chart.title.visible","chart.title.areawidth","backgroundColor","widget.legend.backgroundColor","actions","color.min","color.mid","color.max","color.actual","color.goal","color.title","itemAxis.title","valueAxisTitleColor","itemAxis.title","itemAxisSubtitle","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","valueAxis.logarithmic","color.actual","color.goal","widget.legend.size","valueAxis.tickInterval","optimizeSize","valueAxis.line.color","valueAxis.line.visible","transpose","itemAxis.ticks.labels.rotateAngle","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color"],exclude:["subtitle.visible"]},usages:["Comparison"],supportsMaintainAxisScale:!1,colorPalettes:{single:{"color.actual":{id:"defaultPaletteIndex",labelId:"propBarColor",defaultColorIndex:0},"color.goal":{id:"goal_color",labelId:"propGoalColor",defaultColorIndex:1}}}}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Ravescatter",["./Ravebubble"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;t.type="Scatter",delete t.slots.color.supportsMaintainAxisScale,t.slots.x.treatOrdinalAsCategory=!0,delete t.slots.x.supportsMaintainAxisScale,t.slots.y.treatOrdinalAsCategory=!0,delete t.slots.y.supportsMaintainAxisScale,t.slots.size={hidden:!0,icon:"size_by"},t.slots.categories.icon="points",t.slots.repeatHorizontal.actions=["formatAction","sortAction","topBottomAction"],t.slots.repeatVertical.actions=["formatAction","sortAction","topBottomAction"],t.groupedProperty["itemAxis.ticks.labels.color"][1]="valueLabels.color",t.groupedProperty["itemAxis.ticks.labels.font"][1]="valueLabels.font",delete t.propertyPrefixes.size,delete t.properties["size.title"],t.properties["valueLabels.color"]={colorClass:!0,addButton:!0},t.properties["bubble.size"]={active:!0},t.properties["bubble.size.minValue"]={active:!1},t.properties["bubble.size.maxValue"]={active:!1};var i=["labels.font","labels.color","size.title"];return t.config.include=t.config.include.filter((function(e){return-1===i.indexOf(e)})),t.config.include.push("valueLabels.font","valueLabels.color"),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlepackedbubble",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"PackedBubble",disablePan:!0,thumbnail:{type:"img"},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{optional:!1,icon:"bubbles"},color:{optional:!0,sort:"asc",icon:"colorBy",supportsMaintainAxisScale:!0,mldTitleProperty:"color.title",tags:["canUseToColor"]},size:{optional:!0,icon:"size_by",mldTitleProperty:"size.title",sortable:!1},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"labels",categories:"labels",size:"widget.legend",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"color.title":{multilingual:!0},"size.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},pack:{active:!1,defaultValue:"BubbleLayout",isReadOnly:!0},dataHandling:{active:!1,defaultValue:"tabular",isReadOnly:!0},"effect.duration":{active:!1,defaultValue:e.LONG_EFFECT_DURATION},"widget.legend.size":{active:!1},"labels.color":{colorClass:!0,addButton:!0,displayPos:8},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"contrast.label.color":{defaultValue:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","labels.visible","labels.format","backgroundColor","widget.legend.backgroundColor","effect.duration","labels.color","labels.font","contrast.label.color","label.shadow","pack","dataHandling","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","colors.categories","colors.color","widget.legend.size","widget.legend.titleVisible","color.title","size.title","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle"],exclude:[]},usages:["PartsToWhole"],supportsMaintainAxisScale:!1}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlehierarchicalpackedbubble",["./Rave2bundlepackedbubble"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;return t.type="HierarchicalPackedBubble",delete t.thumbnail,t.properties.dataHandling.defaultValue="hierarchical",t.config.include.push("optimizeSize"),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2line",["../constants","./LineAndAreaBaseConfig"],(function(e,t){"use strict";return function(t){function i(){return t.call(this)||this}_inheritsLoose(i,t);var o=i.prototype;return o._setAreaPropsToInactive=function(e){e.properties["areas.visible"]={active:!1,defaultValue:!1},e.properties["chart.gradient"]={active:!1},e.properties["area.borderColor"]={active:!1},e.properties["area.borderWidth"]={active:!1},e.properties["area.opacity"]={active:!1},e.properties["area.opacity.fill"]={active:!1}},o._addEffectProperties=function(t){t.config.include.push("effect.duration","effect.entry.line.type","effect.entry.line.delay","effect.entry.line.stagger","effect.entry.line.duration"),t.entryDurationProperty="effect.entry.line.duration",t.properties["effect.duration"]={defaultValue:e.LONG_EFFECT_DURATION,active:!1},t.properties["effect.entry.line.type"]={public:!1},t.properties["effect.entry.line.delay"]={active:!1,defaultValue:0},t.properties["effect.entry.line.stagger"]={public:!1},t.properties["effect.entry.line.duration"]={displayMultiplier:.001,public:!1,defaultValue:e.SHORT_EFFECT_DURATION}},_createClass(i,[{key:"config",get:function(){var e=t.prototype.config;return e.type="Line",e.supportsForecasts=!0,e.thumbnail.properties["markers.visible"]=!0,e.properties["markers.shape"]={active:!1},e.properties["data.handling"]={active:!1,defaultValue:"Simple"},this._setAreaPropsToInactive(e),this._addEffectProperties(e),e}}]),i}(t)})),define("dashboard-analytics/visualizations/vipr/config/Rave2point",["./Rave2line"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;t.type="Point",t.slots.values.optional=!1,t.slots.values.clientSideAggregatedAndSortInfo.groupOnColumnId="x",t.slots.values.icon="yAxis",t.slots.values.supportsMaintainAxisScale=!0,t.properties["lines.visible"].defaultValue=!1,t.properties["markers.visible"]={active:!1,defaultValue:!0,isReadOnly:!0},delete t.entryDurationProperty,delete t.properties["effect.duration"].defaultValue,["effect.entry.line.delay","effect.entry.line.duration","effect.entry.line.stagger","effect.entry.line.type"].forEach((function(e){return delete t.properties[e]}));var i=["line.width","nullValuesHandling","interpolate","effect.entry.line.type","effect.entry.line.delay","effect.entry.line.stagger","effect.entry.line.duration"];return t.config.include=t.config.include.filter((function(e){return-1===i.indexOf(e)})),t.config.exclude.push("itemAxis.labels.vertical","interpolate"),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlewordcloud",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Wordle",disablePan:!0,isRecommendable:!1,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{optional:!1,sort:"asc",icon:"word"},size:{icon:"size_by",mldTitleProperty:"size.title"},color:{icon:"colorBy",sort:"asc",supportsMaintainAxisScale:!0,mldTitleProperty:"color.title",tags:["canUseToColor"]},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{size:"widget.legend",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"color.title":{multilingual:!0},"size.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1,defaultValue:e.LONG_EFFECT_DURATION},"font.padding":{active:!1},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","word.orientation","backgroundColor","widget.legend.backgroundColor","effect.duration","font.padding","font.minSize","font.maxSize","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","colors.color.cat","colors.color.cont","widget.legend.size","widget.legend.titleVisible","color.title","size.title","optimizeSize","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","valueLabels.font"],exclude:[]},usages:["Comparison"],supportsMaintainAxisScale:!1,queryHints:{multiEdgeSort:!0}}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/List",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"List",properties:{"format.compact":{active:!1}},usages:["TablesAndSummary"]}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundleradialbar",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Dial",disablePan:!0,isRecommendable:!1,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{sort:"asc",icon:"radialbar_category"},values:{icon:"values"},maxValue:{icon:"values"},color:{icon:"colorBy",sort:"asc",mldTitleProperty:"color.title",tags:["canUseToColor"]},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"valueLabels",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"color.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1,defaultValue:e.LONG_EFFECT_DURATION},"dial.startAngle":{active:!1},"dial.maxValue":{active:!1},"dial.border.width":{active:!1},"dial.padding":{active:!1},"dial.width":{active:!1},"center.background.radius":{active:!1},"center.padding.radius":{active:!1},"center.padding":{active:!1},"dial.minFontSize":{active:!1},"center.radius":{active:!1},"valueLabels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueLabelsTitle.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","backgroundColor","widget.legend.backgroundColor","effect.duration","valueLabels.format","valueLabels.font","valueLabels.color","valueLabelsTitle.font","valueLabelsTitle.color","valueLabels.contrast.color","backRing.color","dial.border.color","dial.border.width","dial.padding","dial.padding.color","dial.width","dial.roundedEnds","dial.startAngle","dial.maxValue","center.background.radius","center.padding.radius","center.color","center.radius","dial.minFontSize","dial.propotionalwidths","dial.showAsPercentage","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","colors.color.cat","colors.color.cont","widget.legend.size","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","widget.legend.titleVisible","color.title","optimizeSize","labels.contrast.color"],exclude:[]},usages:["Comparison","Trend"],supportsMaintainAxisScale:!0}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/MultipleDialCategoryLabel",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{disablePan:!0,isRecommendable:!1,slots:{category:{optional:!1},label:{optional:!0}},properties:{"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1}},supportsMaintainAxisScale:!0}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlebar",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Bar",supportsForecasts:!0,thumbnail:{properties:{"valueAxis.gridLines.visible":!0}},aggregateAndSortOnClient:!0,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{sort:"asc",icon:"y-axis_columns",tags:["badge"],mldTitleProperty:"itemAxis.title"},values:{weightedRepeats:!0,sortable:!0,multiMeasure:!0,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["color"],groupOnColumnId:"categories"},icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.title"},target:{sortable:!0,optional:!0,icon:"target",clientSideAggregatedAndSortInfo:{mappedSlotCondition:["color"],groupOnColumnId:"categories"}},color:{sort:"asc",tags:["ca.dashboard.repeatHere=true","canUseToColor"],icon:"colorBy",mldTitleProperty:"color.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},entryDurationProperty:"effect.entry.bar.duration",propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",values:"valueAxis.title",categories:"itemAxis.title",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"color.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"bar.direction.vertical":{defaultValue:!1,active:!1,isReadOnly:!0},"bar.relativePadding":{percentage:!0,minValue:0,maxValue:.99,step:.01,defaultValue:.1},stacked:{defaultValue:!1,active:!1,isReadOnly:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{defaultValue:e.SHORT_EFFECT_DURATION,active:!1},"effect.entry.bar.type":{public:!1},"effect.entry.bar.delay":{active:!1,defaultValue:0},"effect.entry.bar.stagger":{public:!1},"effect.entry.bar.duration":{displayMultiplier:.001,public:!1,defaultValue:e.SHORT_EFFECT_DURATION},"column.border.width":{active:!1},"column.border.color":{active:!1},"values.null.color":{active:!1},"itemAxis.labels.layoutMode":{active:!1},"target.marker.color":{predefinedValue:"customColor1D2473",addButton:!0,colorClass:!0},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,addButton:!0,active:!0},"contrast.label.color":{defaultValue:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"valueLabels.color":{colorClass:!0,addButton:!0}},queryHints:{multiEdgeSort:!0},config:{include:["valueLabels.location","valueLabels.orientation","widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","bar.relativePadding","bar.direction.vertical","stacked","stacked.percent","itemAxis.title.visible","valueAxis.title.visible","valueAxis.zeroOrigin","valueAxis.logarithmic","itemAxis.gridLines.visible","valueAxis.gridLines.visible","itemAxis.gridLines.color","valueAxis.gridLines.color","itemAxis.labels.layoutMode","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","itemAxis.title.font","itemAxis.title.color","valueAxis.title.font","valueAxis.title.color","itemAxis.title","valueAxis.title","itemAxis.ticks.color","valueAxis.ticks.color","backgroundColor","widget.legend.backgroundColor","column.border.width","column.border.color","values.null.color","valueLabels.visible","valueLabels.format","labelColor","contrast.label.color","label.shadow","effect.duration","effect.entry.bar.type","effect.entry.bar.delay","effect.entry.bar.stagger","effect.entry.bar.duration","optimizeSize","valueLabels.font","valueLabels.color","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","target.marker.thickness","target.marker.color","colors.categories","colors.color","widget.legend.size","widget.legend.titleVisible","color.title","valueAxis.tickInterval","valueAxis.minValue","valueAxis.maxValue","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle","zoom.bar.enable"],exclude:[]},usages:["Comparison"],supportsMaintainAxisScale:!0,isItemAxisYAxis:!0}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlecolumn",["./Rave2bundlebar"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;return t.type="Column",t.slots.categories.icon="x-axis_bars",t.properties["bar.direction.vertical"].defaultValue=!0,delete t.isItemAxisYAxis,delete t.properties["itemAxis.labels.layoutMode"],t.config.include.push("color.title.visible"),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlestackedcolumn",["./Rave2bundlecolumn"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;t.type="StackedColumn",t.slotConfig={exclude:["yStart"]},delete t.supportsForecasts,t.properties.stacked.defaultValue=!0,delete t.properties["target.marker.color"],t.slots.target={hidden:!0},t.slots.color.stackValuesOnAxis=!0,t.slots.color.useInTopBottomQueries=!1;var i=["color.title.visible","target.marker.color","target.marker.thickness"];return t.config.include=t.config.include.filter((function(e){return-1===i.indexOf(e)})),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlestackedbar",["./Rave2bundlebar"],(function(e){"use strict";return function(e){function t(){return e.call(this)||this}return _inheritsLoose(t,e),_createClass(t,[{key:"config",get:function(){var t=e.prototype.config;t.type="StackedBar",t.slotConfig={exclude:["yStart"]},delete t.supportsForecasts,t.properties.stacked.defaultValue=!0,delete t.properties["target.marker.color"],t.slots.target={hidden:!0},t.slots.color.stackValuesOnAxis=!0,t.slots.color.useInTopBottomQueries=!1;var i=["target.marker.color","target.marker.thickness"];return t.config.include=t.config.include.filter((function(e){return-1===i.indexOf(e)})),t}}]),t}(e)})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlecomposite",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"DualAxis",aggregateAndSortOnClient:!0,thumbnail:{properties:{"itemAxis.gridLines.visible":!0,"valueAxis.gridLines.visible":!0}},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],dataSetConfig:{column:{tooltipSlotCaption:"tooltipSlotCompositeColumnCaption"},line:{tooltipSlotCaption:"tooltipSlotCompositeLineCaption"}},slots:{categories:{sort:"asc",icon:"xAxis",tags:["badge"],mldTitleProperty:"itemAxis.title"},columnValue:{sortable:!0,icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.column.title",multiMeasure:!0,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["columnColor"],groupOnColumnId:"categories"}},columnColor:{sort:"asc",tags:["ca.dashboard.repeatHere=true","canUseToColor"],icon:"colorBy",mldTitleProperty:"columnColor.title"},target:{sortable:!0,optional:!0,icon:"target",clientSideAggregatedAndSortInfo:{mappedSlotCondition:["columnColor"],groupOnColumnId:"categories"}},lineValue:{sortable:!0,icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.line.title",multiMeasure:!0},lineColor:{sort:"asc",icon:"colorBy",tags:["ca.dashboard.repeatHere=true","canUseToColor"],mldTitleProperty:"lineColor.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},slotConfig:{exclude:["yStart","target"]},propertyPrefixes:{legend:"widget.legend",dataPoint:"itemAxis.ticks.labels",columnValue:"valueAxis.column.title",categories:"itemAxis.title",lineValue:"valueAxis.line.title",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["column.valueLabels.color","lineWithPoints.valueLabels.color","valueAxis.column.ticks.labels.color","valueAxis.line.ticks.labels.color"],"itemAxis.ticks.labels.font":["column.valueLabels.font","lineWithPoints.valueLabels.font","valueAxis.column.ticks.labels.font","valueAxis.line.ticks.labels.font"],"valueAxis.column.ticks.labels.color":["valueAxis.line.ticks.labels.color"],"valueAxis.column.ticks.labels.font":["valueAxis.line.ticks.labels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.column.ticks.labels","valueAxis.line.ticks.labels"],["itemAxis.title","valueAxis.column.title","valueAxis.line.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"columnColor.title":{multilingual:!0},"lineColor.title":{multilingual:!0},"itemAxis.title":{multilingual:!0},"valueAxis.column.title":{multilingual:!0},"valueAxis.line.title":{multilingual:!0},"format.compact":{active:!1},"markers.shape":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1},"lineWithPoints.size.min":{active:!1},"lineWithPoints.size.max":{active:!1},"column.border.color":{active:!1},"column.border.width":{active:!1},"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"column.valueLabels.color":{colorClass:!0,addButton:!0,displayPos:45},"lineWithPoints.valueLabels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"valueAxis.line.ticks.labels.color":{public:!1},"valueAxis.column.title.color":{colorClass:!0,addButton:!0,displayPos:4},"valueAxis.line.title.color":{colorClass:!0,addButton:!0,displayPos:8},"valueAxis.column.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:13,caption:"conditionalFormattingTextColor"},"bar.relativePadding":{percentage:!0,minValue:0,maxValue:.99,step:.01,defaultValue:.1},"valueAxis.line.minValue":e.minMaxValidationOptions,"valueAxis.line.maxValue":e.minMaxValidationOptions,"valueAxis.column.minValue":e.minMaxValidationOptions,"valueAxis.column.maxValue":e.minMaxValidationOptions,"itemAxis.gridLines.color":{colorClass:!0,addButton:!0},"valueAxis.column.gridLines.color":{colorClass:!0,addButton:!0},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.column.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","bar.direction.vertical","lineWithPoints.interpolate","itemAxis.labels.layoutMode","valueAxis.gridLines.visible","itemAxis.gridLines.visible","lineWithPoints.display","lineWithPoints.symbol","backgroundColor","widget.legend.backgroundColor","itemAxis.title.visible","valueAxis.column.title.visible","valueAxis.line.title.visible","valueAxis.column.zeroOrigin","valueAxis.line.zeroOrigin","valueAxis.line.minValue","valueAxis.line.maxValue","valueAxis.column.minValue","valueAxis.column.maxValue","valueAxis.line.logarithmic","valueAxis.column.logarithmic","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","itemAxis.title.font","itemAxis.title.color","valueAxis.column.ticks.labels.color","valueAxis.line.ticks.labels.color","valueAxis.column.ticks.labels.font","valueAxis.line.ticks.labels.font","valueAxis.line.title.font","valueAxis.line.title.color","valueAxis.column.title.font","valueAxis.column.title.color","itemAxis.title","valueAxis.column.title","valueAxis.line.title","columnColor.title","lineColor.title","gridlineColor","itemAxis.ticks.color","valueAxis.column.ticks.color","valueAxis.line.ticks.color","column.valueLabels.visible","column.valueLabels.location","column.valueLabels.orientation","column.valueLabels.format","lineWithPoints.valueLabels.visible","labelColor","column.valueLabels.color","lineWithPoints.valueLabels.color","lineWithPoints.valueLabels.format","column.valueLabels.font","lineWithPoints.valueLabels.font","effect.duration","optimizeSize","useSingleAxis","syncAxes","swapLineColumn","alignZero","column.border.color","column.border.width","lineWithPoints.size.min","lineWithPoints.size.max","widget.legend.color","widget.legend.titleFont","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleVisible","widget.legend.swatch.symbol.default","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","valueAxis.column.ticks.labels.visible","valueAxis.column.ticks.visible","valueAxis.line.ticks.labels.visible","valueAxis.line.ticks.visible","color.column.cat","color.column.cont","color.line","stacked","widget.legend.size","bar.relativePadding","itemAxis.gridLines.color","valueAxis.column.gridLines.color","itemAxis.line.color","valueAxis.column.line.color","valueAxis.line.line.color","itemAxis.line.visible","valueAxis.column.line.visible","valueAxis.line.line.visible","itemAxis.ticks.labels.rotateAngle","contrast.label.color","label.shadow","zoom.bar.enable","lineWithPoints.nullValuesHandling","lineWithPoints.width"],exclude:["sortX"]},usages:["Comparison","Trend"],supportsMaintainAxisScale:!0,ignoreElementColor:!0,isMultilayersWidget:!0,supportsLayers:!0,layerDescriptions:[{id:"column",colorRelatedProps:{defaultPaletteValue:"colorPalette0",sectionNameId:"sectionName_colorPalette",labelId:"propColumnPalette",contLabelId:"propColumnHeatPalette",defaultColorIndex:{labelId:"propColumnColor",defaultValue:0}}},{id:"line",colorRelatedProps:{defaultPaletteValue:"colorPalette0",sectionNameId:"sectionName_colorPalette",labelId:"propLineAndSymbolPalette",defaultColorIndex:{labelId:"propLineAndSymbolColor",defaultValue:1}}}]}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlecomposite_legacy",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"DualAxis.legacy",recommendWeight:.9,thumbnail:{properties:{"itemAxis.gridLines.visible":!0,"valueAxis.gridLines.visible":!0}},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{sort:"asc",icon:"xAxis",tags:["badge"],mldTitleProperty:"itemAxis.title"},columnValue:{sortable:!0,icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.column.title"},lineValue:{sortable:!0,icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.line.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{legend:"widget.legend",dataPoint:"itemAxis.ticks.labels",columnValue:"valueAxis.column.title",categories:"itemAxis.title",lineValue:"valueAxis.line.title",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color","valueAxis.column.ticks.labels.color","valueAxis.line.ticks.labels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font","valueAxis.column.ticks.labels.font","valueAxis.line.ticks.labels.font"],"valueAxis.column.ticks.labels.color":["valueAxis.line.ticks.labels.color"],"valueAxis.column.ticks.labels.font":["valueAxis.line.ticks.labels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"color.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.column.title":{multilingual:!0},"valueAxis.line.title":{multilingual:!0},"format.compact":{active:!1},"markers.shape":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},optimizeSize:{active:!1},"effect.duration":{active:!1},"lineWithPoints.size":{active:!1},"column.borderWidth":{active:!1},"valueAxis.zeroOrigin":{active:!1,defaultValue:!0,isReadOnly:!0},"widget.legend.titleVisible":{active:!1,defaultValue:!1,isReadOnly:!0},"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"valueAxis.line.ticks.labels.color":{public:!1},"valueAxis.column.title.color":{colorClass:!0,addButton:!0,displayPos:4},"valueAxis.line.title.color":{colorClass:!0,addButton:!0,displayPos:8},"valueAxis.column.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:13,caption:"conditionalFormattingTextColor"},"contrast.label.color":{defaultValue:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1}},queryHints:{multiEdgeSort:!0},config:{include:["widget.data.truncate","widget.legend.display","widget.legend.position","bar.direction.vertical","lines.smooth","itemAxis.labels.layoutMode","gridLines.visible","markers.visible","lineWithPoints.symbol","backgroundColor","widget.legend.backgroundColor","itemAxis.title.visible","valueAxis.title.visible","valueAxis.zeroOrigin","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","itemAxis.title.font","itemAxis.title.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","valueAxis.column.ticks.labels.color","valueAxis.line.ticks.labels.color","valueAxis.column.ticks.labels.font","valueAxis.line.ticks.labels.font","valueAxis.line.title.font","valueAxis.line.title.color","valueAxis.column.title.font","valueAxis.column.title.color","itemAxis.title","valueAxis.column.title","valueAxis.line.title","gridlineColor","itemAxis.ticks.color","valueAxis.ticks.color","valueLabels.visible","labelColor","contrast.label.color","label.shadow","effect.duration","optimizeSize","alignAxes","column.borderColor","column.borderWidth","lineWithPoints.size","swapLineColumn","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.titleVisible","widget.legend.swatch.symbol.default","valueLabels.font","valueLabels.color","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","color.column","color.line","widget.legend.size","widget.legend.titleVisible","color.title","itemAxis.ticks.labels.rotateAngle"],exclude:["sortX","lineWithPoints.display"]},usages:["Comparison","Trend"],supportsMaintainAxisScale:!0,colorPalettes:{single:{"color.column":{id:"defaultPaletteIndex",labelId:"propColumnColor",defaultColorIndex:0},"color.line":{id:"compositeLineColor",labelId:"propLineAndSymbolColor",defaultColorIndex:1}}}}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlenetwork",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"RelationshipGraph",isRecommendable:!1}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2network",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"Network",doesNotSupportAnnotations:!0,doesNotSupportCustomGroupAction:!0,supportsMaintainAxisScale:!1,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{icon:"from"},series:{icon:"to"},values:{icon:"lineweight"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{dataPoint:"labels",categories:"widget.legend",series:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},isRecommendable:!1,properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"effect.duration":{active:!1},"network.nodes.size.min":{active:!1},"network.nodes.size.max":{active:!1},"widget.legend.size":{active:!1},"labels.color":{colorClass:!0,addButton:!0,displayPos:8},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","labels.visible","effect.duration","optimizeSize","network.nodes.size.min","network.nodes.size.max","network.links.color","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","labels.font","labels.color","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","color.from","color.to","widget.legend.size","widget.legend.titleVisible"],exclude:[]},usages:["Relationships"],colorPalettes:{single:{"color.to":{id:"defaultPaletteIndex",labelId:"propToColor",defaultColorIndex:0},"color.from":{id:"fromColor",labelId:"propFromColor",defaultColorIndex:1}}}}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundletiledmap",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"Tiledmap",doesNotSupportCustomGroupAction:!0,cursor:["grab","-moz-grab","-webkit-grab"],renderWithoutCompletingMapping:!0,geo:!0,supportsLayers:!0,thumbnail:{enabled:!1,type:"img"},listenForPropChanges:["region.visible","point.visible","latLong.visible","widget.legend.size"],propertiesToSetBeforeData:["widget.data.truncate","point.custom.mapId","point.custom.layerName","point.custom.propertyName","region.custom.mapId","region.custom.layerName","region.custom.propertyName"],layerDescriptions:[{id:"data.region",colorRelatedProps:{transparencyProp:"region.transparency",defaultPaletteValue:"colorPalette0",sectionNameId:"sectionName_regionLayer"},visibleLayerProps:["region.grouping.mode","region.grouping.heat.weight","region.custom.mapId","region.custom.layerName","region.custom.propertyName"]},{id:"data.point",colorRelatedProps:{transparencyProp:"point.transparency",defaultPaletteValue:"colorPalette1",sectionNameId:"sectionName_pointLayer"},visibleLayerProps:["point.grouping.mode","point.grouping.heat.weight","point.custom.mapId","point.custom.layerName","point.custom.propertyName"]},{id:"data.latlong",colorRelatedProps:{transparencyProp:"latLong.transparency",defaultPaletteValue:"colorPalette2",sectionNameId:"sectionName_latLongLayer"},visibleLayerProps:["latLong.grouping.mode","latLong.grouping.heat.weight"]}],dataRowLimit:3e4,dataRowLimitIE:3e3,slots:{locations:{subtype:"location",icon:"location"},locationColor:{icon:"heat_map",mldTitleProperty:"locationColor.title",tags:["canUseToColor"]},pointLocations:{icon:"location",subtype:"location"},pointSize:{icon:"size_by",mldTitleProperty:"pointSize.title"},pointColor:{icon:"point_heat",mldTitleProperty:"pointColor.title",tags:["canUseToColor"]},"latlongLocations.latitude":{subtype:"latitude",useCategoryAsValue:!0,icon:"location"},"latlongLocations.longitude":{subtype:"longitude",useCategoryAsValue:!0,icon:"location"},"latlongLocations.caption":{icon:"text"},latlongSize:{icon:"size_by",mldTitleProperty:"latlongSize.title"},latlongColor:{icon:"point_heat",mldTitleProperty:"latlongColor.title",tags:["canUseToColor"]}},propertyPrefixes:{locationColor:"widget.legend",pointColor:"widget.legend",latlongColor:"widget.legend",pointSize:"widget.legend"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"locationColor.title":{multilingual:!0},"pointSize.title":{multilingual:!0},"pointColor.title":{multilingual:!0},"latlongSize.title":{multilingual:!0},"latlongColor.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"region.visible":{active:!1},"point.visible":{active:!1},"latLong.visible":{active:!1},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"latLong.defaultSize":{active:!1,defaultValue:8,isReadOnly:!0},"point.defaultSize":{active:!1,defaultValue:8,isReadOnly:!0},preserveDrawingBuffer:{defaultValue:!0},maxZoom:{active:!1},"region.transparency":{active:!1},"point.minSize":{active:!1},"point.maxSize":{active:!1},"point.transparency":{active:!1},"point.staticZeroValueSize":{active:!1},"point.grouping.transition":{active:!1},"point.grouping.cluster.radius":{active:!1},"point.grouping.cluster.groups":{active:!1},"latLong.minSize":{active:!1},"latLong.maxSize":{active:!1},"latLong.transparency":{active:!1},"latLong.staticZeroValueSize":{active:!1},"latLong.grouping.transition":{active:!1},"latLong.grouping.cluster.radius":{active:!1},"latLong.grouping.cluster.groups":{active:!1},"Mapbox.accountName":{active:!1},"Mapbox.token":{active:!1},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"region.minHeight":{percentage:!1},"region.maxHeight":{percentage:!1},"point.grouping.hexbin.minExtrudeHeight":{percentage:!1},"point.grouping.hexbin.maxExtrudeHeight":{percentage:!1},"point.grouping.hexbin.radius":{percentage:!1},"latLong.grouping.hexbin.minExtrudeHeight":{percentage:!1},"latLong.grouping.hexbin.maxExtrudeHeight":{percentage:!1},"latLong.grouping.hexbin.radius":{percentage:!1}},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","map.style.2","map.style.url","Mapbox.worldView","autoZoom","maxZoom","values.null.color","enableLayerControl","enableFeatureSearchControl","region.visible","region.transparency","region.minHeight","region.maxHeight","region.custom.mapId","region.custom.layerName","region.custom.propertyName","point.visible","point.defaultSize","point.minSize","point.maxSize","point.transparency","point.staticZeroValueSize","point.custom.mapId","point.custom.layerName","point.custom.propertyName","point.grouping.mode","point.grouping.transition","point.grouping.heat.weight","point.grouping.cluster.radius","point.grouping.cluster.groups","point.grouping.hexbin.radius","point.grouping.hexbin.minExtrudeHeight","point.grouping.hexbin.maxExtrudeHeight","latLong.defaultSize","latLong.visible","latLong.minSize","latLong.maxSize","latLong.transparency","latLong.staticZeroValueSize","latLong.grouping.mode","latLong.grouping.transition","latLong.grouping.heat.weight","latLong.grouping.cluster.radius","latLong.grouping.cluster.groups","latLong.grouping.hexbin.radius","latLong.grouping.hexbin.minExtrudeHeight","latLong.grouping.hexbin.maxExtrudeHeight","Mapbox.accountName","Mapbox.token","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleColor","widget.legend.titleFont","widget.legend.swatch.symbol.default","interactivityState","locationColor","locationColorCat","pointColor","pointColorCat","latlongColor","latlongColorCat","widget.legend.size","widget.legend.titleVisible","locationColor.title","pointSize.title","pointColor.title","latlongSize.title","latlongColor.title","optimizeSize","mapLabels.localLanguage"],exclude:[]},usages:["Geospatial"],supportsMaintainAxisScale:!0,ignoreElementColor:!0,isMultilayersWidget:!0,requiredConfig:["Mapbox.accountName","Mapbox.token"]}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2polygonmap",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"Polygonmap",doesNotSupportAnnotations:!0,doesNotSupportCustomGroupAction:!0,geo:!0,thumbnail:{type:"img"},propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{subtype:"location",icon:"location",recommendMulti:!0},values:{icon:"heat_map"},size:{icon:"size_by"},pointcolor:{icon:"point_heat",mldTitleProperty:"pointcolor.title",tags:["canUseToColor"]},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},propertyPrefixes:{legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},properties:{"pointcolor.title":{multilingual:!0},"widget.data.truncate":{active:!1,defaultValue:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{active:!1},"widget.legend.size":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},config:{include:["widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","labels.visible","values.null.color","effect.duration","optimizeSize","autoZoom","interactivityState","colors.categories","colors.values","colors.pointcolor","widget.legend.size","widget.legend.titleVisible","pointcolor.title","size.title","values.title","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font"],exclude:[]},usages:["Geospatial"],supportsMaintainAxisScale:!0}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundleradar",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Radar",supportsForecasts:!0,ignoreElementColor:!1,isRecommendable:!1,thumbnail:{properties:{"valueAxis.gridLines.visible":!0}},aggregateAndSortOnClient:!0,propertiesToSetBeforeData:["widget.data.truncate"],listenForPropChanges:["widget.legend.size"],slots:{categories:{sort:"asc",icon:"y-axis_columns",tags:["badge"],mldTitleProperty:"itemAxis.title"},series:{sort:"asc",tags:["ca.dashboard.repeatHere=true","canUseToColor"],icon:"colorBy",mldTitleProperty:"color.title"},values:{weightedRepeats:!0,sortable:!0,multiMeasure:!1,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["color"],groupOnColumnId:"categories"},icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},entryDurationProperty:"effect.entry.bar.duration",propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",values:"valueAxis.title",categories:"itemAxis.title",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"color.title":{multilingual:!0},"colors.series":{defaultValue:!1},"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"format.compact":{active:!1},legendPosition:{active:!1},"legend.display":{active:!1},"effect.duration":{defaultValue:e.SHORT_EFFECT_DURATION,active:!1},"column.border.color":{active:!1},"valueAxis.minValue":{checkForValidValue:e.validateNumIsFloatOrNull,supportsValidationChecks:!0,validationInfo:{messageId:"customRangeErrorMessage"}},"valueAxis.maxValue":{checkForValidValue:e.validateNumIsFloatOrNull,supportsValidationChecks:!0,validationInfo:{messageId:"customRangeErrorMessage"}},"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["optimizeSize","colors.series","widget.data.truncate","widget.iterator","widget.legend.display","widget.legend.position","widget.legend.titleVisible","widget.legend.titleFont","widget.legend.titleColor","widget.legend.font","widget.legend.titleFont","widget.legend.color","widget.legend.splitter","widget.legend.titleColor","widget.legend.size","widget.legend.swatch.symbol.default","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","itemAxis.ticks.color","itemAxis.ticks.labels.font","itemAxis.ticks.labels.color","itemAxis.line.visible","itemAxis.line.color","itemAxis.gridLines.visible","itemAxis.gridLines.color","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","valueAxis.ticks.color","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","valueAxis.line.visible","valueAxis.line.color","valueAxis.gridLines.visible","valueAxis.minValue","valueAxis.maxValue","valueAxis.zeroOrigin","valueAxis.logarithmic","lineWithPoints.symbol","lineWithPoints.display","lineWithPoints.size","polygons.filled","backgroundColor","widget.legend.backgroundColor","effect.duration","effect.entry.bar.type","effect.entry.bar.delay","effect.entry.bar.stagger","effect.entry.bar.duration","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","valueAxis.gridLines.color","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle"],exclude:[]},usages:["Comparison"],supportsMaintainAxisScale:!0}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundlewaterfall",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"Waterfall",isRecommendable:!1,ignoreElementColor:!0,doesNotSupportCategoricalPalette:!0,thumbnail:{properties:{"valueAxis.gridLines.visible":!0}},listenForPropChanges:["widget.legend.size"],propertiesToSetBeforeData:["widget.data.truncate"],aggregateAndSortOnClient:!0,slots:{categories:{sort:"asc",icon:"x-axis_bars",tags:["badge"],mldTitleProperty:"itemAxis.title"},subcategories:{tags:["ca.dashboard.repeatHere=true"]},values:{weightedRepeats:!0,sortable:!0,multiMeasure:!0,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["color"],groupOnColumnId:"categories"},icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.title"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},entryDurationProperty:"effect.entry.bar.duration",propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",values:"valueAxis.title",categories:"itemAxis.title",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"bar.direction.vertical":{defaultValue:!0,active:!1,isReadOnly:!0},stacked:{defaultValue:!1,active:!1,isReadOnly:!0},"format.compact":{active:!1},"valueAxis.zeroOrigin":{defaultValue:!0},"effect.duration":{defaultValue:e.SHORT_EFFECT_DURATION,active:!1},"effect.entry.bar.type":{public:!1},"effect.entry.bar.delay":{active:!1,defaultValue:0},"effect.entry.bar.stagger":{public:!1},"effect.entry.bar.duration":{displayMultiplier:.001,public:!1,defaultValue:e.SHORT_EFFECT_DURATION},"values.null.color":{active:!1},"column.border.width":{active:!1},"column.border.color":{active:!1},"totalColumn.positive.color":{addButton:!0,colorClass:!0},"totalColumn.negative.color":{addButton:!0,colorClass:!0},"firstColumn.positive.color":{predefinedValue:"null",addButton:!0,colorClass:!0},"firstColumn.negative.color":{predefinedValue:"null",addButton:!0,colorClass:!0},"column.positive.color":{addButton:!0,colorClass:!0},"column.negative.color":{addButton:!0,colorClass:!0},"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"totalColumn.label":{multilingual:!0},"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["backgroundColor","widget.legend.backgroundColor","optimizeSize","widget.data.truncate","widget.iterator","itemAxis.title.visible","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","itemAxis.labels.layoutMode","itemAxis.ticks.labels.font","itemAxis.ticks.color","itemAxis.ticks.labels.color","itemAxis.line.visible","itemAxis.gridLines.visible","itemAxis.title","itemAxis.title.font","itemAxis.title.color","valueAxis.title.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","valueAxis.ticks.color","valueAxis.line.visible","valueAxis.gridLines.visible","valueAxis.zeroOrigin","valueAxis.title","valueAxis.title.font","valueAxis.title.color","valueAxis.ticks.labels.font","valueAxis.minValue","valueAxis.maxValue","valueAxis.ticks.labels.color","valueLabels.visible","valueLabels.location","valueLabels.orientation","totalColumn.visible","totalColumn.label","column.border.width","column.border.color","transpose","effect.duration","widget.legend.display","widget.legend.position","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","totalColumn.legend.label.positive","totalColumn.legend.label.negative","firstColumn.positive.label","firstColumn.negative.label","value.positive.label","value.negative.label","totalColumn.positive.color","totalColumn.negative.color","firstColumn.positive.color","firstColumn.negative.color","column.positive.color","column.negative.color","widget.legend.size","widget.legend.titleVisible","valueAxis.tickInterval","subcategory.totals","subcategory.values","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle","valueLabels.font","valueLabels.color","contrast.label.color","label.shadow"],exclude:[]},usages:["Trend"],supportsMaintainAxisScale:!1}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/Rave2bundleboxplot",["../constants"],(function(e){"use strict";return function(){function t(){}return _createClass(t,[{key:"config",get:function(){return{type:"BoxPlot",isRecommendable:!0,ignoreElementColor:!0,thumbnail:{properties:{"valueAxis.gridLines.visible":!0}},listenForPropChanges:["widget.legend.size"],propertiesToSetBeforeData:["widget.data.truncate"],slots:{categories:{sort:"asc",icon:"x-axis_bars",tags:["badge"],mldTitleProperty:"itemAxis.title"},values:{weightedRepeats:!0,sortable:!0,multiMeasure:!0,clientSideAggregatedAndSortInfo:{mappedSlotCondition:["color"],groupOnColumnId:"categories"},icon:"values",tags:["badge"],mldTitleProperty:"valueAxis.title"},color:{sort:"asc",tags:["ca.dashboard.repeatHere=true","canUseToColor"],icon:"colorBy",mldTitleProperty:"color.title"},key:{sort:"asc",icon:"key"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},entryDurationProperty:"effect.entry.bar.duration",propertyPrefixes:{dataPoint:"itemAxis.ticks.labels",values:"valueAxis.title",categories:"itemAxis.title",color:"widget.legend",legend:"widget.legend",row:"widget.repeatVertical.labels",column:"widget.repeatHorizontal.labels"},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"],"itemAxis.ticks.labels.color":["valueAxis.ticks.labels.color","valueLabels.color"],"itemAxis.ticks.labels.font":["valueAxis.ticks.labels.font","valueLabels.font"]},elementStyle:{groupedAxes:[["itemAxis.ticks.labels","valueAxis.ticks.labels"],["itemAxis.title","valueAxis.title"]]},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"itemAxis.title":{multilingual:!0},"valueAxis.title":{multilingual:!0},"format.compact":{active:!1},"effect.duration":{defaultValue:e.SHORT_EFFECT_DURATION,active:!1},"effect.entry.bar.type":{public:!1},"effect.entry.bar.delay":{active:!1,defaultValue:0},"effect.entry.bar.stagger":{public:!1},"effect.entry.bar.duration":{displayMultiplier:.001,public:!1,defaultValue:e.SHORT_EFFECT_DURATION},"values.null.color":{active:!1},"column.border.width":{active:!1},"column.border.color":{active:!1},"itemAxis.ticks.labels.font":{active:!0},"valueAxis.ticks.labels.font":{active:!0},"itemAxis.title.font":{active:!0},"valueAxis.title.font":{active:!0},"valueLabels.font":{active:!1},"widget.legend.size":{active:!1},"itemAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"values.title.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.title.color":{colorClass:!0,addButton:!0,displayPos:45},"itemAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"valueAxis.ticks.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0},"valueAxis.minValue":e.minMaxValidationOptions,"valueAxis.maxValue":e.minMaxValidationOptions,"valueAxis.gridLines.color":{colorClass:!0,addButton:!0},"itemAxis.line.color":{colorClass:!0,addButton:!0},"valueAxis.line.color":{colorClass:!0,addButton:!0},"itemAxis.ticks.labels.rotateAngle":{percentage:!1},"widget.repeatHorizontal.labels.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.repeatVertical.labels.color":{colorClass:!0,addButton:!0,displayPos:45}},queryHints:{multiEdgeSort:!0},config:{include:["backgroundColor","widget.legend.backgroundColor","optimizeSize","widget.data.truncate","widget.iterator","itemAxis.title.visible","itemAxis.ticks.labels.visible","itemAxis.ticks.visible","itemAxis.labels.layoutMode","itemAxis.ticks.labels.font","itemAxis.ticks.color","itemAxis.ticks.labels.color","itemAxis.line.visible","itemAxis.gridLines.visible","itemAxis.title","itemAxis.title.font","itemAxis.title.color","valueAxis.title","valueAxis.title.font","valueAxis.title.color","valueAxis.title.visible","valueAxis.ticks.labels.visible","valueAxis.ticks.visible","valueAxis.ticks.color","valueAxis.line.visible","valueAxis.gridLines.visible","valueAxis.zeroOrigin","valueAxis.ticks.labels.font","valueAxis.ticks.labels.color","valueAxis.tickInterval","valueAxis.minValue","valueAxis.maxValue","valueLabels.visible","valueLabels.location","valueLabels.orientation","totalColumn.visible","transpose","effect.duration","widget.legend.color","widget.legend.splitter","widget.legend.font","widget.legend.titleFont","widget.legend.titleColor","widget.legend.swatch.symbol.default","widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.color","widget.repeatHorizontal.labels.font","widget.repeatVertical.labels.font","widget.legend.size","widget.legend.titleVisible","colors.color","valueAxis.logarithmic","data.handling","widget.legend.display","widget.legend.position","valueAxis.gridLines.color","itemAxis.line.color","valueAxis.line.color","itemAxis.line.visible","valueAxis.line.visible","itemAxis.ticks.labels.rotateAngle"],exclude:[]},usages:["Trend"],supportsMaintainAxisScale:!1}}}]),t}()})),define("dashboard-analytics/visualizations/vipr/config/SchematicsPreview",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{isSchematic:!0,type:"com.ibm.vis.schematicsPreview",doesNotSupportCustomGroupAction:!0,cursor:["grab","-moz-grab","-webkit-grab"],renderWithoutCompletingMapping:!0,thumbnail:{enabled:!1,type:"img"},listenForPropChanges:["schematic","showPreview","region.visible","point.visible","views.hidden"],dataRowLimit:3e4,dataRowLimitIE:3e3,slots:{locations:{subtype:"location",icon:"location"},locationColor:{icon:"heat_map"},pointLocations:{icon:"location",subtype:"location"},pointSize:{icon:"size_by",multiMeasure:!0},pointColor:{icon:"point_heat",tags:["ca.dashboard.repeatHere=true"]}},groupedProperty:{"widget.legend.color":["widget.legend.titleColor"],"widget.legend.font":["widget.legend.titleFont"]},propertiesToSetBeforeData:["widget.data.truncate"],propertyPrefixes:{locationColor:"widget.legend",pointColor:"widget.legend",pointSize:"widget.legend"},properties:{"widget.data.truncate":{active:!1,defaultValue:!0},"debug.mode":{active:!0,defaultValue:!0},schematicLibrary:{active:!1},schematic:{active:!1},backgroundColor:{active:!1},showPreview:{active:!1},"region.visible":{active:!1},"point.visible":{active:!1},"widget.legend.color":{colorClass:!0,addButton:!0,displayPos:45},"widget.legend.titleColor":{colorClass:!0,active:!0}},supportsLayers:!0,layerDescriptions:[{id:"data.region",colorRelatedProps:{transparencyProp:"region.transparency",defaultPaletteValue:"colorPalette0",sectionNameId:"sectionName_regionLayer"},visibleLayerProps:["region.visible","region.transparency"]},{id:"data.point",colorRelatedProps:{transparencyProp:"point.transparency",defaultPaletteValue:"colorPalette1",sectionNameId:"sectionName_pointLayer"},visibleLayerProps:["point.visible","point.transparency"]}],supportsMaintainAxisScale:!0,ignoreElementColor:!0,isMultilayersWidget:!0,config:{include:["widget.data.truncate","widget.iterator","debug.mode","schematicLibrary","schematic","backgroundColor","widget.legend.backgroundColor","optimizeSize","showPreview","region.visible","point.visible","colors.location.cat","colors.location.cont","colors.point.cat","colors.point.cont","zoomView","zoomData","viewTransparency","enableViewControl","enableLayerControl","region.transparency","point.transparency","point.sizeScaling","point.defaultSize","point.minSize","point.maxSize","point.staticZeroValueSize","point.autoScaleFactor","widget.legend.display","widget.legend.position","widget.legend.size","widget.legend.swatch.symbol.default","widget.legend.splitter","locationColor.title","pointColor.title","pointSize.title","widget.legend.titleVisible","widget.legend.titleColor","widget.legend.titleFont","widget.legend.font","widget.legend.fontSize","widget.legend.color","widget.legend.splitter","schematic.key"]}}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/VisualizationPreview",[],(function(){"use strict";return function(){function e(){}return _createClass(e,[{key:"config",get:function(){return{type:"visualizationPreview",isCustomVis:!0,aggregateAndSortOnClient:!0,queryHints:{multiEdgeSort:!0},includeAllProperties:!0,ignoreElementColor:!0,listenForPropChanges:[],slots:{color:{sort:"asc",icon:"colorBy"},repeatHorizontal:{icon:"multiplier_h",sort:"asc"},repeatVertical:{icon:"multiplier_v",sort:"asc"}},properties:{"widget.data.truncate":{active:!1,defaultValue:!0}},bundleInclude:[],config:{include:["widget.data.truncate","widget.iterator"]}}}}]),e}()})),define("dashboard-analytics/visualizations/vipr/config/configurations",["./Custom","./Schematic","./Rave2heat","./Rave2bundlearea","./Rave2comet","./Spiral","./Decisiontree","./Sunburst","./Rave2bundletreemap","./Rave2bundlepie","./Ravebubble","./Rave2marimekko","./Rave2bundlebullet","./Ravescatter","./Rave2bundlepackedbubble","./Rave2bundlehierarchicalpackedbubble","./Rave2point","./Rave2bundlewordcloud","./List","./Rave2line","./Rave2bundleradialbar","./MultipleDialCategoryLabel","./Rave2bundlecolumn","./Rave2bundlestackedcolumn","./Rave2bundlebar","./Rave2bundlestackedbar","./Rave2bundlecomposite","./Rave2bundlecomposite_legacy","./Rave2bundlenetwork","./Rave2network","./Rave2bundletiledmap","./Rave2polygonmap","./Rave2bundleradar","./Rave2bundlewaterfall","./Rave2bundleboxplot","./SchematicsPreview","./VisualizationPreview"],(function(e,t,i,o,r,n,a,s,l,d,u,c,g,h,p,f,m,v,b,y,C,w,_,P,x,A,S,I,M,V,T,D,E,R,F,L,O){"use strict";return{custom:(new e).config,schematic:(new t).config,"com.ibm.vis.rave2heat":(new i).config,"com.ibm.vis.rave2bundlearea":(new o).config,"com.ibm.vis.rave2comet":(new r).config,"com.ibm.vis.spiral":(new n).config,"com.ibm.vis.decisiontree":(new a).config,"com.ibm.vis.sunburst":(new s).config,"com.ibm.vis.rave2bundletreemap":(new l).config,"com.ibm.vis.rave2bundlepie":(new d).config,"com.ibm.vis.ravebubble":(new u).config,"com.ibm.vis.rave2marimekko":(new c).config,"com.ibm.vis.rave2bundlebullet":(new g).config,"com.ibm.vis.ravescatter":(new h).config,"com.ibm.vis.rave2bundlepackedbubble":(new p).config,"com.ibm.vis.rave2bundlehierarchicalpackedbubble":(new f).config,"com.ibm.vis.rave2point":(new m).config,"com.ibm.vis.rave2bundlewordcloud":(new v).config,list:(new b).config,"com.ibm.vis.rave2line":(new y).config,"com.ibm.vis.rave2bundleradialbar":(new C).config,multipleDialCategoryLabel:(new w).config,"com.ibm.vis.rave2bundlecolumn":(new _).config,"com.ibm.vis.rave2bundlestackedcolumn":(new P).config,"com.ibm.vis.rave2bundlebar":(new x).config,"com.ibm.vis.rave2bundlestackedbar":(new A).config,"com.ibm.vis.rave2bundlecomposite":(new S).config,"com.ibm.vis.rave2bundlecomposite.legacy":(new I).config,"com.ibm.vis.rave2bundlenetwork":(new M).config,"com.ibm.vis.rave2network":(new V).config,"com.ibm.vis.rave2bundletiledmap":(new T).config,"com.ibm.vis.rave2polygonmap":(new D).config,"com.ibm.vis.rave2bundleradar":(new E).config,"com.ibm.vis.rave2bundlewaterfall":(new R).config,"com.ibm.vis.rave2bundleboxplot":(new F).config,"com.ibm.vis.schematicsPreview":(new L).config,visualizationPreview:(new O).config}})),define("dashboard-analytics/visualizations/vipr/VIPRConfig",["underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class","./extendedVis/SchematicVis","./config/configurations","./constants"],(function(e,t,i,o,r){var n={},a={"itemAxis.title.font":"itemAxis.title.color","itemAxis.ticks.labels.font":"itemAxis.ticks.labels.color","valueAxis.title.font":"valueAxis.title.color","valueAxis.ticks.labels.font":"valueAxis.ticks.labels.color","valueAxis.column.title.font":"valueAxis.column.title.color","valueAxis.line.title.font":"valueAxis.line.title.color","valueAxis.column.ticks.labels.font":"valueAxis.column.ticks.labels.color","valueAxis.line.ticks.labels.font":"valueAxis.line.ticks.labels.color","widget.legend.font":"widget.legend.color","widget.legend.titleFont":"widget.legend.titleColor","inner.label.value.font":"inner.label.value.color","inner.label.title.font":"inner.label.title.color","valueLabels.font":"valueLabels.color","valueLabelsTitle.font":"valueLabelsTitle.color","widget.repeatHorizontal.labels.font":"widget.repeatHorizontal.labels.color","widget.repeatVertical.labels.font":"widget.repeatVertical.labels.color"},s=["widget.legend.font","widget.legend.color","valueAxis.column.ticks.labels.color","valueAxis.line.ticks.labels.color","valueAxis.column.ticks.labels.font","valueAxis.line.ticks.labels.font"];return new(t.extend({configurations:o,setAllViprConfigProperties:function(t,i){t.bundleInclude=[],t.config=t.config?t.config:{},t.properties=t.properties?t.properties:{},t.listenForPropChanges=[],t.supportsMaintainAxisScale=!1,t.renderWithoutCompletingMapping=!1,i.dataSets&&0===i.dataSets.length&&(t.renderWithoutCompletingMapping=!0);var o=i.viprProperties?i.viprProperties:[];t.groupedProperty=i.viprGroupProperties?i.viprGroupProperties:{};for(var n=function(){var i=o[a],n={};"maintainAxisScales"===i.name&&i.active?t.supportsMaintainAxisScale=!0:"widget.data.truncate"===i.name&&(t.propertiesToSetBeforeData=["widget.data.truncate"]),"enum"===i.type&&i.dynamic?(o[a]=e.clone(o[a]),delete o[a].defaultValue,delete o[a].possibleValues):"font"===i.type?(o[a]=e.clone(o[a]),o[a].defaultValue=i.defaultValue&&i.defaultValue.toString?i.defaultValue.toString():null):"color"===i.type?(o[a]=e.clone(o[a]),o[a].colorClass=!0):"number"===i.type&&(o[a]=e.clone(o[a]),o[a].checkForValidValue=r.validateNumIsFloatOrNull,void 0===i.supportsValidationChecks&&(o[a].supportsValidationChecks=!0),void 0===i.validationInfo&&(o[a]=e.clone(o[a]),o[a].validationInfo={supportsFloats:!0,messageId:"propNumberValidationErrorMessageId"})),i=o[a],e.forEach(i,(function(e,t){n[t]=e})),t.properties[i.name]||(t.properties[i.name]=n),"excluded"!==i.visibility&&"configuration"!==i.visibility&&-1===t.config.include.indexOf(i.name)&&t.config.include.push(i.name),-1===t.bundleInclude.indexOf(i.name)&&t.bundleInclude.push(i.name)},a=0;a<o.length;a++)n()},getConfig:function(e){return n[e]||this.configurations[e]},extendConfig:function(t){if(t&&t.id&&t.configuration){var i=t.id,o=t.configuration,r=this.configurations[i];if(r){if(o.config){var n,a;if(o.config.include)(n=r.config.include).push.apply(n,o.config.include);if(o.config.exclude)(a=r.config.exclude).push.apply(a,o.config.exclude)}o.properties&&e.extend(r.properties,o.properties)}else this.configurations[i]=o}},addCustomVisConfiguration:function(t){var i="com.ibm.vis.schematicsPreview"===t.id,r="visualizationPreview"===t.id;if(i)this._addCustomVisConfiguration(this.getConfig(t.id),t);else if(t.isSchematic&&!i){var a=JSON.parse(JSON.stringify(o.schematic.customVis));this._setSchematicLib(a,t)}else if(t.isCustomVis&&!r){var s=JSON.parse(JSON.stringify(o.custom.customVis));n[t.id]=e.extend(s,t)}else if(r){var l=JSON.parse(JSON.stringify(this.configurations[t.id]));n[t.id]=e.extend(l,t)}},_setSchematicLib:function(e,t){e.config.override||(e.config.override={}),e.config.override.schematicLibrary={defaultValue:t.id},this._addCustomVisConfiguration(e,t)},_addCustomVisConfiguration:function(t,o){n[o.id]=e.extend(t,o),n[o.id].schematicVis=new i},removeCustomVisConfiguration:function(e){n[e]&&n[e].schematicVis&&n[e].schematicVis.destroy(),delete n[e]},getColorPropertyAssociatedWithFont:function(e){return a[e]},isInFontGroupProperties:function(e){return-1!==Object.keys(a).indexOf(e)||-1!==Object.values(a).indexOf(e)},isFontProperty:function(e){return-1!==Object.keys(a).indexOf(e)},isInAllowedGroups:function(e){return-1!==s.indexOf(e)}}))})),define("dashboard-analytics/visualizations/interactions/BinningActionsUtils",["underscore"],(function(e){return function(){function t(){}return t.getMetadataBinningDefinition=function(e){var t=e&&e.getProperty("_MUI_expr");if(t){var i=JSON.parse(t);if(i&&"customBin"===i.func)return{columnId:e.getId(),label:e.getLabel(),baseColumnId:i.basedOnMoserObjectId.id,bins:i.numberOfBins}}},t.getBinningFilters=function(e,t){var i;return t.getBinning()&&(i=e.getFilterEntries(e.getCategoryFilterKey(t.getColumnId()))),i},t.removeLocalBinnedFilterEntries=function(e,t,i){t&&t.length&&e&&(t.forEach((function(t){e.removeFilterEntry(t)})),e.allFilterModificationComplete(i))},t.removeCompoundFilters=function(t,i,o){if(i&&i.models){var r,n=t.getDataItemList();r=n?e.map(n,(function(e){return e.getColumnId()})):[],i.clearCompoundFilters(r),i.allFilterModificationComplete(o)}},t.getBinningFilterForFormatedItem=function(e,i,o){var r=o.getFormat();r&&r.formatSpec&&(r=r.formatSpec);var n,a=r&&(r.maximumFractionDigits||0===r.maximumFractionDigits)?r.maximumFractionDigits:2;return!e.maximumFractionDigits&&0!==e.maximumFractionDigits||e.maximumFractionDigits===a||(n=t.getBinningFilters(i,o)),n},t.findDataItemIndex=function(t,i){if("number"!=typeof i&&t.getDataItemList().length>0){var o=t.getDataItemList();e.find(o,(function(e,t){if("fact"===e.getMetadataColumn().getType())return i=t,!0}))}return i},t}()})),define("dashboard-analytics/visualizations/vipr/properties/PropertiesHelper",[],(function(){var e=["weight","style"],t={size:"fontSize",family:"font",weight:"bold",style:"italic"};return function(){function i(){}return i.getFontChanges=function(e,t){return"font"===t?e.fontStyle?e.fontStyle:e.font:e[t]},i.buildVidaFontPropertiesFromParts=function(o,r,n){var a={family:[],size:null,style:null,weight:null},s=n;for(var l in"string"==typeof n&&(s=o.parseVidaFontProperty(n)),s=s||a)if(s.hasOwnProperty(l)){var d=t[l];-1!==e.indexOf(l)?i.getFontChanges(r,d)?a[l]=d:void 0===i.getFontChanges(r,d)&&s[l]&&(a[l]=s[l].toString()):Array.isArray(a[l])?(a[l].length=0,i.getFontChanges(r,d)?a[l].push(i.getFontChanges(r,d)):void 0===i.getFontChanges(r,d)&&s[l]&&s[l].length&&a[l].push(s[l][0].toString())):i.getFontChanges(r,d)?a[l]=i.getFontChanges(r,d):void 0===i.getFontChanges(r,d)&&s[l]&&(a[l]=s[l].toString())}var u=Object.keys(a).map((function(e){return a[e]})),c=o.createVidaFontProperty(u),g=c&&c.toString?c.toString():null;return""===g?null:g},i.getVidaFontPropertiesPart=function(t,i,o){var r=o;"string"==typeof o&&(r=t.parseVidaFontProperty(o));var n=r&&r[i]?r[i]:null,a=-1!==e.indexOf(i);return n?!!a||("size"===i&&"object"==typeof n?n.value.toString()+n.unit.toString():n.toString()):!a&&null},i.splitEscapedString=function(e,t,o){var r=e.indexOf(t);if(-1!==r&&r!==e.length&&"\\"!==e[r-1]){var n=e.slice(0,r);e=e.slice(r+1,e.length),o.push(n),i.splitEscapedString(e,t,o)}else o.push(e)},i}()})),define("dashboard-analytics/visualizations/vipr/VIPRUtils",["underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class","./VIPRData","./data/VIPRData","./VIPRSlotMapping","./VIPRConfig","com/ibm/vida/vipr","com/ibm/vida/carbon/vida-carbon","../interactions/BinningActionsUtils","./properties/PropertiesHelper"],(function(e,t,i,o,r,n,a,s,l,d){"use strict";var u={defaultTheme:"carbonG10",darkTheme:"carbonG100",carbonGrey100:"carbonG100",lightTheme:"carbonG10",carbonGrey10:"carbonG10"},c=["$catpalette","$contpalette"],g=["backgroundColor","widget.backgroundColor","widget.legend.backgroundColor","backgroundColor.elements"];return new(t.extend({createDataSlots:function(e){var t=e.vizDef,i=this._getConfiguration(e.id);return this._addToSlots(t.slots,t.dataSets,i)},getPropertyPrefixes:function(e){var t=this._getConfiguration(e.id);return t?t.propertyPrefixes:void 0},getListenForPropChanges:function(e){var t=this._getConfiguration(e.id);return t?t.listenForPropChanges:void 0},getGroupedProperty:function(e){var t=this._getConfiguration(e.id);return t?t.groupedProperty:void 0},getElementStyleProperty:function(e){var t=this._getConfiguration(e.id);return t?t.elementStyle:void 0},includeAllProperties:function(e){var t=this._getConfiguration(e.id);return!(!t||!t.includeAllProperties)&&t.includeAllProperties},_addMultiMeasureAndTagsToSlots:function(e,t){e[0].multiMeasure=!0;var i=t.findIndex((function(e){return-1!==e.name.toLowerCase().indexOf("color")}));-1!==i?t[i].tags=["ca.dashboard.repeatHere=true"]:t[0].tags=["ca.dashboard.repeatHere=true"]},_addMultiMeasureAndTagsToCustomVisDataset:function(t,i){if(i&&i.isCustomVis){var o=e.filter(t.slots,(function(t){return t.segments?e.filter(t.segments,(function(e){return"cont"===e.type})):"cont"===t.type})),r=e.filter(t.slots,(function(t){return t.segments?e.filter(t.segments,(function(e){return"cont"!==e.type&&"geospatial"!==e.subType})):"cont"!==t.type&&"geospatial"!==t.subType}));1==o.length&&r.length>0&&this._addMultiMeasureAndTagsToSlots(o,r)}},_addToSlots:function(t,i,o){void 0===t&&(t=[]);var r,n={};e.isEmpty(i)||e.each(i,function(t){r=t.name,this._addMultiMeasureAndTagsToCustomVisDataset(t,o),e.each(t.slots,function(t){var i;e.isEmpty(t.segments)?n[t.name]?n[t.name].datasetIdList.push(r):n[t.name]=this._buildSlot(t,o,r):e.each(t.segments,function(e){(i=this._buildSlot(e,o,r)).group=t.name,n[e.name]?n[e.name].datasetIdList.push(r):n[e.name]=i}.bind(this))}.bind(this))}.bind(this));var a=[];return t.forEach((function(t){e.isEmpty(t.segments)?a.push(t.name):t.segments.forEach((function(e){a.push(e.name)}))})),a.map((function(e){return n[e]})).filter((function(e){return void 0!==e}))},_buildSlot:function(t,i,o){var r=this._getSlotObject(t,i,o);return i&&i.slots?e.extend(r,i.slots[r.id]):r},_getSlotObject:function(t,i,o){var r=this._getSlotType(t),n={id:t.name,caption:t.caption,type:r,role:t.role,maxStackItems:t.maxLevels,optional:t.optional,multiplier:this._isMultiplier(t),stackItems:"ordinal"!==r,multiItems:t.multiDataItem,coachMark:t.coachMark};return t.useCategoryAsValue&&(n.useCategoryAsValue=t.useCategoryAsValue),o&&(n.datasetIdList=[o]),t.multiMeasure&&(n.multiMeasure=t.multiMeasure),t.tags&&(n.tags=t.tags),i&&i.slots&&i.slots[n.id]?e.extend(n,i.slots[n.id]):n},_getSlotType:function(e){return"cat"===e.type?"category":"cont"===e.type?"ordinal":e.type},_isMultiplier:function(e){return["repeatHorizontal","repeatVertical"].indexOf(e.name)>=0},getSinglePaletteProperties:function(e){var t=this._getConfiguration(e);return t&&t.colorPalettes&&t.colorPalettes.single},getViprWidgetPropertyInstances:function(e,t){var i=[];return t.forEach((function(t){var o=e.get(t);o&&i.push(o)})),i},getSinglePalettes:function(e,t){var i=this._getConfiguration(t),o=i&&i.colorPalettes&&i.colorPalettes.single&&Object.keys(i.colorPalettes.single)||[];return 0===o.length?this.getSinglePalettesFromWidget(e):this.getViprWidgetPropertyInstances(e,o)},getSinglePalettesFromWidget:function(e){var t=[];return e.forEach((function(e){"color"===e.type&&e.tags&&-1!==e.tags.indexOf("palette")&&t.push(e.name)})),this.getViprWidgetPropertyInstances(e,t)},getPalettes:function(e,t){var i=[];return e.forEach((function(e){"palette"===e.type&&i.push(e.name)})),this.getViprWidgetPropertyInstances(e,i).concat(this.getSinglePalettes(e,t))},getDefaultValueForProperty:function(e,t){var i,o=this._getConfiguration(e);return o&&o.properties&&o.properties[t]&&(i=o.properties[t].defaultValue),i},getOverridenDefaultForProperty:function(e,t){var i={defaultValue:null,isActive:!1},o=this._getConfiguration(e);return o&&o.properties&&o.properties[t]&&(i.defaultValue=o.properties[t].defaultValue,i.isActive=o.properties[t].active,i.isReadOnly=o.properties[t].isReadOnly,i.checkForValidValue=o.properties[t].checkForValidValue),i},overrideProperty:function(e,t,i){var o=this._getConfiguration(e);if(o&&o.properties&&o.properties[i]){t=this._clonePropertyInstance(t);for(var r=0,n=Object.entries(o.properties[i]);r<n.length;r++){var a=n[r],s=a[0],l=a[1];Object.defineProperty(t,s,{value:l,writable:!0,enumerable:!0})}Object.defineProperty(t,"overridden",{value:!0,writable:!0})}return t},_clonePropertyInstance:function(e){for(var t={},i=Object.getOwnPropertyNames(e),o=Object.getPrototypeOf(e);o&&"Object"!==o.constructor.name;)i.push.apply(i,Object.getOwnPropertyNames(o)),o=Object.getPrototypeOf(o);return i.forEach((function(i){i in t||Object.defineProperty(t,i,{get:function(){return e[i]},enumerable:!0,configurable:!0})})),t},isRenderWithoutCompletingMapping:function(e){var t=this._getConfiguration(e);return!(!t||!0!==t.renderWithoutCompletingMapping)},isRecommendable:function(e){var t=this._getConfiguration(e);return!(t&&!1===t.isRecommendable)},isPropertyIncluded:function(t,i){var o=this._getConfiguration(t);return o&&e.contains(o.config.include,i)},isPropertyExcluded:function(t,i){var o=this._getConfiguration(t);return e.contains(o.config.exclude,i)},noDataQuery:function(e){var t=this._getConfiguration(e);return!(!t||!0!==t.noDataQuery)},useFPDAsInsightsInput:function(e){var t=this._getConfiguration(e);return!(!t||!0!==t.useFPDAsInsightsInput)},isDisablePan:function(e){var t=this._getConfiguration(e);return!(!t||!0!==t.disablePan)},aggregateAndSortOnClient:function(e){var t=this._getConfiguration(e);return!(!t||!0!==t.aggregateAndSortOnClient)},getDataRowLimit:function(e){var t=this._getConfiguration(e);return t&&t.dataRowLimit},getDataRowLimitIE:function(e){var t=this._getConfiguration(e);return t&&t.dataRowLimitIE},getVisualizationTabs:function(e){var t=this._getConfiguration(e);return t&&t.tabs},getQueryHints:function(e){var t=this._getConfiguration(e);return t?t.queryHints:null},doesConfigPropertyMatchExpected:function(e,t,i){if(e){var o=this._getConfiguration(e);if(o)return!!o[t]&&o[t]===i}return!1},getBinningConfig:function(e){var t=this._getConfiguration(e);return t&&t.binning?t.binning:{}},_getConfiguration:function(e){return n.getConfig(e)},_getConfigVal:function(e,t){return!(!this._getConfiguration(e)||!this._getConfiguration(e)[t])&&this._getConfiguration(e)[t]},applyRequiredConfiguration:function(t,i,o){var r=this._getConfiguration(t),n=r.config.override;n||(n={},r.config.override=n),e.each(i,(function(e){var t=o[e];n[e]||(n[e]={}),n[e].defaultValue=t}))},_applyPropertyType:function(t,i){return"color"===i.type?(t.type="ColorPicker",t.paletteType="ColorPalette"):"boolean"===i.type?(t.type="CheckBox",t.defaultValue=i.defaultValue):"number"===i.type?t.type="CheckBox":"enum"===i.type&&(t.type="DropDown",t.options=e.map(i.possibleValues,(function(e){return{label:e.caption,value:e.name}}))),t},createData:function(e,t,o){var r=this.doesConfigPropertyMatchExpected(t.getDefinition().getId(),"hideAggTypeInAxisLabels",!0);return new i(e,t,r,o)},createQueryResultData:function(e,t,i,r){var n=this.doesConfigPropertyMatchExpected(t.getDefinition().getId(),"hideAggTypeInAxisLabels",!0);return new o(e,t,n,i,r)},createSlotMapping:function(e){return new r(e)},createMetaDataEntries:function(e){return e.metaDataEntries.slice()},isRequiredConfig:function(e,t){return this.getRequiredConfig(e)&&this.getRequiredConfig(e).indexOf(t.name)>-1},getRequiredConfig:function(e){return this._getConfigVal(e,"requiredConfig")},getCursor:function(e){return this._getConfigVal(e,"cursor")},isGeospatial:function(e){return this._getConfigVal(e,"geo")},supportsSortAction:function(e){return!this._getConfigVal(e,"doesNotSupportSortAction")},supportsAnnotations:function(e){return!this._getConfigVal(e,"doesNotSupportAnnotations")},supportsContextualTopBottomAction:function(e){return!this._getConfigVal(e,"doesNotSupportTopBottomAction")},supportsNonContextualTopBottomAction:function(e){return!this._getConfigVal(e,"doesNotSupportTopBottomAction")},supportsFormatAction:function(e){return!this._getConfigVal(e,"doesNotSupportFormatAction")},supportsCustomGroupAction:function(e){return!this._getConfigVal(e,"doesNotSupportCustomGroupAction")},supportsMaintainAxisScale:function(e){return this._getConfigVal(e,"supportsMaintainAxisScale")},supportsCustomDataSelection:function(e){return this._getConfigVal(e,"enableCustomDataSelection")},createVidaFontProperty:function(e){if(e){var t=e[0]&&a.Font.parseFamily(e[0]),i=e[1]&&a.Length.parse(e[1]),o=e[2]&&a.FontStyle.parse(e[2]),r=e[3]&&a.FontWeight.parse(e[3]);return a.Font.create(t,i,o,r)}},parseVidaFontProperty:function(e){return a.Font.parse(e)},getViprProperiesAndGroups:function(t,i,o){var r=t.vizDef.properties;return e.forEach(t.vizDef.configuration,(function(e){i.push(e)})),this._getViprProperiesAndGroups(r,i,o)},_getViprProperiesAndGroups:function(t,i,o){var r=this;e.forEach(t,(function(t){if("group"===t.type){var n=e.pluck(t.properties,"name");return o[t.name]=n,i.push(t),r._getViprProperiesAndGroups(t.properties,i,o)}return i.push(t)}))},_getPropertiesByNames:function(t,i){var o=[];return e.forEach(i,(function(i){var r=e.find(t,(function(e){return e.name===i}));r&&o.push(r)})),o},_getPropertiesByType:function(t,i){return e.filter(t,(function(e){return e.type===i}))},buildVidaFontPropertiesFromParts:function(e,t){return d.buildVidaFontPropertiesFromParts(this,e,t)},getVidaFontPropertiesPart:function(e,t){return d.getVidaFontPropertiesPart(this,e,t)},getVidaThemeDefinition:function(e){if(void 0===e&&(e="lightTheme"),!this.vidaThemeDefinitions){var t=s.Themes,i=void 0===t?{}:t;this.vidaThemeDefinitions=i,this._filterColorPalettes(this.vidaThemeDefinitions)}return this.vidaThemeDefinitions[u[e]]?this.vidaThemeDefinitions[u[e]].themeDef:null},_filterColorPalettes:function(t){e.forEach(t,(function(e){return c.forEach((function(t){return delete e.themeDef[t]}))}))},getBackGroudColorPropertyIdList:function(){return g},partition:function(e,t){var i=[],o=[];return e.forEach((function(e){t(e)?i.push(e):o.push(e)})),{matchList:i,nonMatchList:o}}}))})),define("dashboard-analytics/visualizations/renderer/VisActionHelper",["jquery","underscore","../../widgets/livewidget/nls/StringResources","../../DynamicFileLoader","./VisActionSlotSupport","../../dataSources/utils/DatasourceUtil","../../apiHelpers/SlotAPIHelper","../vipr/VIPRUtils"],(function(e,t,i,o,r,n,a,s){"use strict";var l=function(){function e(e){this.spec=e}var t=e.prototype;return t.getActionId=function(){return this.spec.ACTION_ID},t.getAvailableActions=function(){return[this.spec]},e}();return function(){function d(e){this._visModel=e.visModel,this.selectionController=e.selectionController,this.pageContext=e.pageContext,this.ownerWidget=e.ownerWidget,this.content=e.content,this.dashboardApi=e.ownerWidget.getDashboardApi(),this._registeredActions={},this.logger=e.ownerWidget.logger,this._visActionSlotSupport=new r(e)}var u=d.prototype;return u.remove=function(){var e=this;this.toolbar&&(this.toolbar.remove(),this.toolbar=null),this._visModel=null,this.selectionController=null,this.pageContext=null,this.ownerWidget=null,this.visualization=null,this.dashboardApi=null,this.logger=null,t.each(t.keys(this._registeredActions),(function(t){delete e._registeredActions[t]}))},u._supportsSortAction=function(){return this._visModel&&this._visModel.supportsSortAction()},u._supportsContextualTopBottomAction=function(){return this.getVisualization().getDefinition().getProperty("supportsContextualTopBottomAction")},u._supportsNonContextualTopBottomAction=function(){return this.getVisualization().getDefinition().getProperty("supportsNonContextualTopBottomAction")},u._supportsFormatAction=function(){return this._visModel&&this._visModel.supportsFormatAction()},u.showDataPointActions=function(e,i,o,r,n,a,l){var d=this,u={includeApplyFilter:o,noFilters:r,drillOnly:n,noDrillthrough:a,selections:e,isHovering:(l=l||{}).isHover,area:l.area,isAreaSelected:l.isAreaSelected},c=[],g=function(e){c=c.concat(e.getAvailableActions())};return this._getExtraDatapointActions(l).then((function(o){t.each(o,g);var r=d.selectionController.getToolbarLabelsForSelections(e),n=d.selectionController.getToolbarTitleForSelections(e);if(!l.isHover){var a,h,p,f=l.items||[];p=s.partition(f,(function(e){return("customdata"===e.type||"visualitem"===e.type)&&(e&&e.values&&e.values.find((function(e){return"visualItem"===e.customType})))})).matchList,(a=c).push.apply(a,d.content.getFeature("ElementStyleActions").getElementStyleActionList(p,l)),(h=c).push.apply(h,d._getDataPointActionList(e,u,l))}if(r.length>0||n.length>0){var m={targetNode:i?i.targetNode:null,targetBounds:i?i.bounds:null,actions:c,labels:l.bRightClick?null:r,title:l.bRightClick?null:n,options:l,tooltipContext:{content:d.content,context:d._convertOldSelectionToNewSpec(e)},toolbarOptions:{iconOnly:!1,textOnly:!0,reactToolbar:!0,preferredVertical:!0,alignment:"end",itemsArea:"visualization",flyoutClass:"popover actionToolbarPopover text"}};1===c.length&&(m.toolbarOptions.isTextEditorOnly=!0),d.dashboardApi.triggerDashboardEvent("widget:availableActions",m)}}))},u._getDataPointActionList=function(e,t,i){var o=this._getBrushingAndPendingSelections(e,this.content,i);return this.content.getFeature("DataPointActions").getDataPointActionList(o,t)},u._convertOldSelectionToNewSpec=function(e){var i=this,o=[],r=e&&e.getCategorySelections()||[],n={},a=[];r.forEach((function(e){a.push(i._toPayLoadValue(e.value,e.slotDataItem.getColumnId(),e.slotDataItem.getId()))}));var s=e&&e.getOrdinalSelections()||[],l=t.map(s,(function(e){return{dataItemId:e.slotDataItem.getId(),columnId:e.slotDataItem.getColumnId(),value:e.value instanceof Object?e.value.value:e.value}}));return a.length&&(n.categories=a),l.length&&(n.facts=l),o.push(n),{dataPoints:o}},u._getBrushingAndPendingSelections=function(e,i,o){var r=this,n=[],a=e&&e._aCategorySelections||[],s={},l=[];a.forEach((function(e){e.isEdgeSelection||l.push(r._toPayLoadValue(e.value,e.slotDataItem.getColumnId(),e.slotDataItem.getId()))}));var d=e&&e._aOrdinalSelections||[],u=t.map(d,(function(e){return{dataItemId:e.slotDataItem.getId(),columnId:e.slotDataItem.getColumnId(),value:e.value}}));l.length&&(s.categories=l),u.length&&(s.facts=u),n.push(s);var c=e._aCategorySelections?e._aCategorySelections.map((function(e){return e.slotDataItem})):[],g=i.getFeature("DataPointSelections").getSelections(c),h=i.getFeature("DataPointSelections.pending").getSelections(c),p=!1,f=t.pluck(l,"columnId").join();return g.forEach((function(e){var i=t.pluck(e.categories,"columnId").join();(f===i||""===f&&r._compareCategorySelections(a,e.categories))&&(g=g.concat(h),p=!0)})),p||(g=h),n=n.concat(g),n=this._uniqueValues(n),{area:o&&o.area,dataPoints:n}},u._compareCategorySelections=function(e,i){var o=t.pluck(e,"value"),r=t.pluck(i,"value"),n=!0;return o.forEach((function(e){-1===r.indexOf(e.u)&&(n=!1)})),o&&r&&n},u._toPayLoadValue=function(e,t,i){var o={dataItemId:i,columnId:t,value:e.u,label:e.d};return(e.pu||e.p)&&(o.parentId=e.pu||e.p.u),o},u._uniqueValues=function(e){void 0===e&&(e=[]);var i=[],o={};return e.forEach((function(e){var r=t.pluck(e.categories,"value").join();o[r]||(o[r]=1,i.push(e))})),i},u._getExtraDatapointActions=function(e){var t;return e&&e.slots&&void 0!==e.mapIndex?(e.actions&&e.actions.actionOptions&&(e.actions.actionOptions.JumpToAction={area:e.area}),t=this.getActionsForSlots(e.slots,e.mapIndex,null,e.actions)):t=Promise.resolve([]),t},u.hideToolbarActions=function(){this.dashboardApi.triggerDashboardEvent("widget:hideToolbar")},u.getNewFilterActionForSlot=function(e,t,i){return new e({visualization:this.getVisualization(),slot:t,index:i,dashboard:this.ownerWidget.getDashboardApi(),content:this.content,logger:this.logger})},u.getNewFilterActionForContextColumn=function(e,t,i){return void 0===i&&(i=null),new e({visualization:this.getVisualization(),metadataColumn:t,dashboard:this.ownerWidget.getDashboardApi(),content:this.content,aggregationType:i,logger:this.logger})},u.getActionsForLocalFilter=function(e,t){var i=this,r=[];return o.load(["dashboard-analytics/visualizations/interactions/FilterDropAction","dashboard-analytics/visualizations/interactions/DeleteFilterAction"]).then((function(o){var n=o[0],a=o[1],s=t&&i._visModel.localFilters.getFilterEntry({id:t});return s&&i._visModel.isFilterEditable(s)&&r.push(i.getNewFilterActionForContextColumn(n,e)),r.push(new a(i._visModel,e,t)),r}))},u._getSingleSlot=function(e,t){return 1!==e.length||t&&Array.isArray(t)&&t.length>1?null:e[0]},u._getActionInfoForSlots=function(e,i,o,r){var n=this._getSingleSlot(e,i),s=!r||null==r.focusMode||r.focusMode,l=r&&r.itemsArea?r.itemsArea:void 0,d=!(!n||null!=i)&&(a.isMultiMeasuresSeriesSlot(n)||a.isMultiMeasuresValueSlot(n)),u={selectionObj:o,slots:e,singleSlot:n,dataItems:[],mapIndex:i,isAuthoringMode:this._visModel.ownerWidget.isAuthoringMode,isCalculationEnabled:!1,isMultiMeasure:d,isEditCalculation:!1,isMappedToUnavailableSourceColumn:!1,isFocusMode:s,supportsSortAction:this._supportsSortAction(),supportsContextualTopBottomAction:this._supportsContextualTopBottomAction(),supportsNonContextualTopBottomAction:this._supportsNonContextualTopBottomAction(),supportsFormatAction:this._supportsFormatAction(),area:l};if(null==i&&(i=0),i&&Array.isArray(i)?t.each(i,(function(t){u.dataItems.push(e[0].getDataItemList()[t])})):u.dataItems.push(e[0].getDataItemList()[i]),u.isMappedToUnavailableSourceColumn=t.every(u.dataItems,(function(e){return e.isColumnUnavailable()})),!u.isMappedToUnavailableSourceColumn){var c,g=e[0],h=g.getDataItemList();i&&Array.isArray(i)?u.isCalculationEnabled="fact"===h[i[0]].getType():u.isCalculationEnabled="fact"===h[i].getType(),n&&(c=h[i].getMetadataColumn(),u.isEditCalculation=!!c&&c.isEditableCalculation()),!u.isCalculationEnabled&&"any"===g.getDefinition().getType()&&i&&i.length<3&&(u.isCalculationEnabled=t.every(i,(function(e){return"fact"===h[e].getType()})))}return{state:u,actions:this._enableSupportedSlotActions(u)}},u._enableSupportedSlotActions=function(e){var i=this,o={},n=e.singleSlot?e.singleSlot.getDefinition().getProperty("actions"):null;return t.each(t.keys(r.SLOT_ACTIONS),(function(e){o[e]=!n||n.indexOf(e)>=0})),t.each(t.keys(r.SLOT_ACTIONS),(function(t){if(o[t]){var r=i._visActionSlotSupport.getInterface(t);o[t]=!r.isSupported||r.isSupported(e)}})),o},u._getActionModules=function(e){var i=[],o=e.state.singleSlot;if(e.state.isMappedToUnavailableSourceColumn||t.each(e.actions,(function(e,t){var o=r.SLOT_ACTIONS[t];i[o]=e?t:""})),1==this.getVisualization().getSlots().getSlotList().length){var a=o.getDefinition().getProperty("disallowedActions"),s=1===e.state.dataItems.length&&e.state.dataItems[0];n.isOrdinalAttribute(o,s)&&(a||(a=[]),a=a.concat(["FilterAction"])),a&&t.each(i,(function(e,t,i){a.indexOf(e)>-1&&(i[t]="")}))}return i.map((function(e){return e?"dashboard-analytics/visualizations/interactions/"+e:""}))},u._loadActionModules=function(e,i,r,n){var a=this,s=r.state,d=n||{};return o.load(i).then((function(e){var i=[];t.each(e,(function(e,t){if(e){var o,r=a._visActionSlotSupport.getInterface(t);r.get&&(o=r.get(e,s,a.dashboardApi)),o&&i.push(o)}}));var o=s.singleSlot?s.singleSlot.getId():s.slots[0].getId(),r=s.singleSlot?s.singleSlot.getDefinition().getProperty("actions"):null;d.actionsToKeep&&d.actionsToKeep.length>0&&r&&r.length>0?d.actionsToKeep=t.intersection(d.actionsToKeep,r):r&&r.length>0&&(d.actionsToKeep=r);var n=a.content.getFeature("SlotActions").getSlotActionList(o,s.mapIndex,d);return t.each(n,(function(e){e.text=e.label,i.push(new l(e))})),i}))},u.getActionsForSlots=function(e,t,i,o){var r=this._getActionInfoForSlots(e,t,i,o),n=this._getActionModules(r),a=o&&o.actions||o;return a&&a.actionsToKeep&&a.actionsToKeep.length&&(n=[]),this._loadActionModules(e,n,r,a)},u.getActionsForElementStyles=function(e,i){var o=this;return Promise.resolve().then((function(){var r=[],n=o.content.getFeature("ElementStyleActions").getElementStyleActionList(i,e);return t.each(n,(function(e){e.text=e.label,r.push(new l(e))})),r}))},u.showElementStyleActions=function(e,i,o){var r=this;if(o&&0!==o.length){var n=[],a=function(e){n=n.concat(e.getAvailableActions()),r._registeredActions[e.getActionId()]=e};return this.getActionsForElementStyles(i,o).then((function(o){t.each(o,a),r._constructToolbar(n,e,null,i)}))}return Promise.resolve()},u.showTitleOrElementStyleActions=function(e,i,o,r,n,a,s){var l=this,d={iconOnly:!1,textOnly:!0,reactToolbar:!0,preferredVertical:!0,flyoutClass:"popover actionToolbarPopover text",itemsArea:n,actions:a},u=[],c=function(e){u=u.concat(e.getAvailableActions()),l._registeredActions[e.getActionId()]=e};if(!e||0===e.length)return this.showElementStyleActions(i,d,s);if(1===e.length&&r&&1===r.length){var g=Array.isArray(r)?r[0]:r;d.toolbarName=e[0].getDataItemList()[g].getLabel()}return this.getActionsForElementStyles(d,s).then((function(n){return t.each(n,c),l.getActionsForSlots(e,r,o,d).then((function(o){t.each(o,c),e=1===e.length?e[0]:null,l._constructToolbar(u,i,e,d)}))}))},u._constructToolbar=function(e,t,i,o){if(0!==e.length){var r=t||{},n=i&&i.mapping,a=n?this._visModel.getLabelByMapping(n):o.toolbarName?o.toolbarName:void 0;if(r.bounds){var s=this._visModel.ownerWidget.el.getBoundingClientRect(),l=s.left+s.width/2;r.bounds.left+r.bounds.width/2>l&&(r.placement="right")}var d={targetNode:r.targetNode||null,targetBounds:r.bounds||null,placement:r.placement||"left",actions:e,toolbarName:a};o&&(d.toolbarOptions=o),this.dashboardApi.triggerDashboardEvent("widget:availableActions",d)}},u.editLocalFilter=function(e,i){var r=this,n=this.getVisualization(),a=t.find(n.getLocalFilters().getFilterList(),(function(t){return t.id===e})),s=t.find(n.getLocalFilters().getFiltersDesc(),(function(t){return t.dataId===e}));if(!i||!s||!s.editEnabled)return Promise.resolve();var l=null;a&&(l=t.find(n.getSlots().getMappingInfoList(),(function(e){var t=e.dataItem.getColumnId()===a.columnId;return t&&a.aggregationType&&(t=e.dataItem.getAggregation()===a.aggregationType),t})));var d=l?"dashboard-analytics/visualizations/interactions/FilterAction":"dashboard-analytics/visualizations/interactions/FilterDropAction";return o.load([d]).then((function(e){var t=e[0],o=l?r.getNewFilterActionForSlot(t,l.slot,l.indexInSlot):r.getNewFilterActionForContextColumn(t,n.getDataSource().getMetadataColumn(a.columnId),a.aggregationType);return r.renderFilterDialog(o.getEditorModuleName(),o.getViewOptions(),i)}))},u.renderFilterDialog=function(e,t,r,n,a){var s=this;return o.load([e]).then((function(e){var o=new(0,e[0])(t),l=o.preload?o.preload():Promise.resolve(),d=t.title||i.get("toolbarActionFilter");return l.then(s._createContext.bind(s,o,r,d,n,a)).then(o.renderCallBack.bind(o))}))},u.resetActionState=function(e,t,i){var o=this._getSlotActionByNameOrGroup(t,e,i);o&&o.actions&&o.actions.reset&&o.actions.reset(t.getId(),i)},u.showAction=function(e,t,r,n){var a=this,s=this._getSlotActionByNameOrGroup(t,e,n);if(s){var l=s.view&&s.view.module;return o.load([l]).then((function(e){var t=new(0,e[0])({state:s.view.state,actions:s.actions});return a._createContext(t,r,i.get(s.text))}))}return Promise.resolve()},u._getSlotActionByNameOrGroup=function(e,t,i){return this.content.getFeature("SlotActions").getSlotActionList(e.getId(),i).find((function(e){return e.name===t||e.group===t}))},u._createContext=function(e,t,i,o,r){var n=[{responsive:!1,editable:!1,changedAction:null,subView:e,type:"SubView"}];return this._setToolbarForEditor(n,t,i,o,r)},u._setToolbarForEditor=function(t,i,r,n,a){var s=this;return o.load(["dashboard-analytics/lib/@waca/dashboard-common/dist/ui/AuthoringToolbar"]).then((function(o){var l=o[0];return s.toolbar&&s.toolbar.remove(),s.toolbar=new l({container:e("body"),placement:n&&n.getPlacement?n.getPlacement():"right",calculateBoundingRect:!0,launchView:n,backButtonCallback:a}),r&&s.toolbar.setName(r),s.toolbar.addItems(t),s.toolbar.setSelectionContext([i]),s.toolbar.show(),s.toolbar}))},u.getVisualization=function(){return this.visualization||(this.visualization=this.content.getFeature("Visualization")),this.visualization},d}()})),define("dashboard-analytics/visualizations/renderer/VisRenderState",["underscore"],(function(e){return function(){function t(){this._currentContext={},this._renderContextPool={},this.firstRenderComplete=!1,this.lastSizeRendered=null,this._steps=[],this._properties={}}var i=t.prototype;return i.remove=function(){this.resetRenderState()},i.initCurrentContext=function(e){this._currentContext.hasOwnProperty(this._stepToStepContext(e))||(this._steps.push(e),this._currentContext[this._stepToStepContext(e)]=null)},i.getCurrentContext=function(e){return this._currentContext[this._stepToStepContext(e)]},i.getCurrentContextData=function(e){return this._currentContext[this._stepToStepContext(e)]?this._currentContext[this._stepToStepContext(e)][e]:null},i.addRenderContext=function(t){if(e.isUndefined(t)||e.isUndefined(t.renderId))throw new Error("cannot define a render context: missing renderId");var i={id:t.renderId};return e.each(this._steps,(function(e){i[e]=null})),e.keys(t).length>1&&(i.extraInfo=t.extraInfo,this._currentContext.dataContext&&t.extraInfo&&"realtimeRefresh"===t.extraInfo.sender&&(i.previousData=this._currentContext.dataContext.data)),i.resizing=!(!t||!t.resizing),this._renderContextPool[i.id]=i,e.keys(t).length>1&&(t.refresh&&t.refresh.data&&!this.readyToLoadData()&&(t.refreshAll=!0),t.refresh?t.refresh.render=!0:t.refresh={render:!0},i.refresh=t.refresh,i.refreshAll=t.refreshAll,t.refreshAll?(this.reloadAllRenderSteps(),e.each(e.keys(this._currentContext),function(e){this._currentContext[e]=i}.bind(this))):t.refresh&&(e.each(e.keys(t.refresh),function(e){if(t.isExecuting){var o=this._currentContext[this._stepToStepContext(e)];o&&this._mergeRenderContexts(i,o)}this._currentContext[this._stepToStepContext(e)]=i}.bind(this)),this._currentContext.visViewContext||(this._currentContext.visViewContext=i))),i},i._mergeRenderContexts=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];i.forEach((function(t){t.refresh&&(e.refresh=e.refresh||{},Object.keys(t.refresh).forEach((function(i){return e.refresh[i]=e.refresh[i]||t.refresh[i]})))}))},i.readyToLoadData=function(){return!!this.getCurrentContextData("visView")},i.readyToRender=function(){return!(!this.getCurrentContextData("visView")||!this.getCurrentContextData("data"))},i.resetRenderState=function(){this.lastSizeRendered=null,this._clearCurrentContext(),this.cleanRenderContextPool(!0)},i._renderContextUnused=function(t){return!e.find(e.keys(this._currentContext),function(e){return this._currentContext[e]===t}.bind(this))&&!!t.renderComplete},i.cleanRenderContextPool=function(t){e.each(e.keys(this._renderContextPool),function(e){var i=this._renderContextPool[e];(t||this._renderContextUnused(i))&&delete this._renderContextPool[e]}.bind(this))},i._clearCurrentContext=function(){this.getCurrentContextData("visView")&&this.getCurrentContextData("visView").remove(),e.each(e.keys(this._currentContext),function(e){this._currentContext[e]=null}.bind(this))},i.reloadAllRenderSteps=function(){e.each(e.keys(this._currentContext),function(e){var t=this._stepContextToStep(e);this._currentContext[e]&&this._currentContext[e][t]&&(this._currentContext[e][t]=null)}.bind(this))},i.getFullRenderContext=function(){var e={};for(var t in this._currentContext){var i=this._stepContextToStep(t);e[i]=this._currentContext[t]&&this._currentContext[t][i]||null}return e},i._stepToStepContext=function(e){return e+"Context"},i._stepContextToStep=function(e){return e.substring(0,e.length-7)},i.setPropertyValue=function(e,t){this._properties[e]=t},i.getPropertyValue=function(e){return this._properties[e]},t}()})),define("dashboard-analytics/visualizations/renderer/VisRenderTrace",["underscore"],(function(e){"use strict";return function(){function t(e){this._enabledTrace=!1,this._trace={},this._renderState=e}var i=t.prototype;return i.enable=function(e){return void 0===e&&(e=!0),this._enabledTrace=e},i.clear=function(){return this._trace={}},i.getTrace=function(){return this._trace},i.startRender=function(t,i,o){var r=this;if(this._enabledTrace){var n=i.id;void 0===this._trace[n]&&(this._trace[n]={options:o,steps:[]}),e.each(t,(function(e){r._trace[n].steps.push({step:e.id})}))}},i.startTask=function(e,t){if(this._enabledTrace){var i=this._getRenderTaskTrace(t.id,e.id);i&&(i.start=(new Date).toISOString())}},i.taskDependency=function(e,t,i){if(this._enabledTrace){var o=this._getRenderTaskTrace(t.id,e.id);o&&(void 0===o.dependencies&&(o.dependencies=[]),o.dependencies.push(i))}},i.endTask=function(t,i,o,r){if(this._enabledTrace){var n=this._getRenderTaskTrace(i.id,t.id);if(n){n.end=(new Date).toISOString(),n.status=o,n.currentContext=e.clone(this._renderState._currentContext),r&&(n.error=r);var a=this._getRenderTrace(i.id);a&&(a.elapsed=new Date(n.end).getTime()-new Date(a.steps[0].start).getTime())}}},i._getRenderTrace=function(e){return this._trace[e]},i._getRenderTaskTrace=function(t,i){var o=this._getRenderTrace(t);if(o)return e.find(o.steps,(function(e){return e.step===i}))},t}()})),define("dashboard-analytics/util/VidaSdkUtil",["jquery","underscore"],(function(e,t){var i=requirejs,o=function(){delete i.s.contexts["Dashboard.VidaSdkUtil"],e('[data-requirecontext="Dashboard.VidaSdkUtil"]').remove()};return function(){function e(){}return e.isSDKActive=function(e){var r=e.getFeature("VisDefinitions"),n=r.getById("visualizationPreview");return(n&&!n.getState().getError()?new Promise((function(e,r){require(["com/ibm/vida/controls/vida-controls"],(function(n){var a=JSON.parse(JSON.stringify(i.s.contexts._.config)),s={context:"Dashboard.VidaSdkUtil",baseUrl:a.baseUrl,urlArgs:"v="+Date.now(),paths:t.pick(a.paths,"text",n.sdk.bundleLocation)};require.config(s)(["text!"+n.sdk.bundleLocation+"/manifest.xml"],(function(){o(),e()}),(function(e){o(),r(e)}))}),r)})):Promise.race([r.loadById("visualizationPreview"),new Promise((function(e,t){setTimeout((function(){t(new Error("Failed to load test visualization"))}),15e3)}))])).then((function(){return!0})).catch((function(){return!1}))},e}()})),define("dashboard-analytics/visualizations/vipr/VIPRLibraries",["com/ibm/vida/controls/vida-controls"],(function(e){var t=function(){function t(e){this.dashboardApi=e.dashboardApi}return t.prototype.setVIPRLibraries=function(){var t=this;return Promise.all([this.dashboardApi.getCollectionExtension("com.ibm.bi.dashboard.vipr.visLibrary"),this.dashboardApi.getCollectionExtension("com.ibm.bi.dashboard.vipr.visLibrary.custom")]).then((function(i){var o={system:JSON.parse(JSON.stringify(i[0])),custom:JSON.parse(JSON.stringify(i[1]))},r=t.dashboardApi.getGlassCoreSvc(".FeatureChecker");if(-1!==t.dashboardApi.getGlassCoreSvc(".UserProfile").capabilities.indexOf("canDevelopVisualizations")||r.checkValue("dashboard","canDevelopVisualizations","enabled")){var n=o.custom[0];n.isCustomVis=!0,o.custom[1].isSchematic=!0,n.location=e.sdk.bundleLocation}else o.custom.length=0;for(var a in o)o[a].forEach((function(e){e.visId&&(e.id=e.visId,delete e.visId)}));return o}))},t.isSystemLib=function(e,t){return void 0===t&&(t=[]),!!(t.find((function(t){return t===e}))||null)},t}();return t.LIB_TYPE_ALL="all_libs",t.LIB_TYPE_SYSTEM="system_libs",t.LIB_TYPE_CUSTOM="custom_libs",t.LOAD_DEFINITION_ERROR="loadDefinitionError",t})),define("dashboard-analytics/visualizations/vipr/VIPRBundleHelper",["./VIPRConfig","../../DynamicFileLoader","../../widgets/livewidget/nls/StringResources","underscore"],(function(e,t,i,o){var r,n="v1/visualizations",a=function(e,t){e.getGlassCoreSvc(".Logger").error(t)};return(r=function(){function r(){}return r._loadVIPRLibrariesClass=function(){return t.load(["dashboard-analytics/visualizations/vipr/VIPRLibraries"]).then((function(e){return e[0]})).catch((function(e){console.log(e)}))},r._getVIPRLibraries=function(e){return r._loadVIPRLibrariesClass().then((function(t){return new t({dashboardApi:e.dashboardApi}).setVIPRLibraries()})).catch((function(t){a(e.dashboardApi,t)}))},r._getOnlyEnabledSystemVisualizations=function(e,t){return e.filter((function(e){if(e.featureFlag){var i=e.featureFlag?e.featureFlag.id:"",o=e.featureFlag?e.featureFlag.enabledVal:"enabled";return t.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard",i,o)}return!0}))},r.getALLVIPRLibraries=function(e){void 0===e&&(e={});var t=[],i=[r._getVIPRLibraries(e)];return e.enableCustomVisualizations&&i.push(r.getCustomBundleVisualizations(e)),Promise.all(i).then((function(i){var o=i[0],n=i[1],a=r._getOnlyEnabledSystemVisualizations(o.system,e);return t.push.apply(t,a),r._extendVIPRConfig(a),o.custom.length>0&&(r._buildCustomLibVIPRConfig(o.custom||[]),t.push.apply(t,o.custom)),n&&n.length>0&&t.push.apply(t,n),t})).catch((function(t){throw a(e.dashboardApi,t),new Error(t)}))},r._extendVIPRConfig=function(t){t.forEach((function(t){t.configuration&&e.extendConfig(t)}))},r.getCustomBundleVisualizations=function(e){return r._getCustomVisBundle(e).then((function(t){return r._buildCustomBundleVisualizationsLib(e.ajax,t)})).catch((function(t){return a(e.dashboardApi,t),Promise.resolve([])}))},r._getCustomVisBundle=function(e){var t=n+"/custom",i=e.ajax,o=null;if(!e.refresh){var r=e.preFetch;(o=r&&r.get(t))&&r.clear(t)}return o||i.ajax({url:t,type:"GET",contentType:"application/json"})},r._buildCustomBundleVisualizationsLib=function(e,t){void 0===t&&(t={});var i,n=[],a=t.data||[];return 0===a.length?i=Promise.resolve(n):(o.forEach(a,(function(e){n.push({id:e.id,location:"schematic"===e.type?"vizbundles/rave2schematics":"v1/visualizations/"+e.id+"/content/",assetId:e.storeId,icon:e.icon||null,placeholderIcon:"v1/visualizations/"+e.id+"/content/",modificationTime:e.modificationTime,name:e.name,type:e.id,isSchematic:"schematic"===e.type,isCustomVis:"schematic"!==e.type})})),i=r._loadIcon(e,n)),i.then(r._buildCustomLibVIPRConfig)},r._loadIcon=function(e,t){void 0===t&&(t=[]);var i=[];return t.forEach((function(t){if(t.icon||t.isSchematic)i.push(Promise.resolve(null));else{var o=n+"/id/"+t.id;i.push(e.ajax({url:o,type:"GET",contentType:"application/json"}))}})),Promise.all(i).then((function(e){return void 0===e&&(e=[]),e.forEach((function(e,i){if(e){var o=(e.data||[]).find((function(e){var t=(e=e||{}).file?e.file.toLowerCase():"";return r.isValidIconFileExt(t)}));if(o){var n=o.file.split("\\");t[i].icon=n.join("/")}}})),t}))},r._buildCustomLibVIPRConfig=function(t){return void 0===t&&(t=[]),t.forEach((function(t){e.removeCustomVisConfiguration(t.id),e.addCustomVisConfiguration(t)})),t},r.loadCustomBundleVisualization=function(e){return r.submitAjaxAddOrUpdate(e,"POST",n+"?maskResponses=true&updateAction=FAIL")},r.updateCustomBundleVisualization=function(e){return void 0===e&&(e={}),r.submitAjaxAddOrUpdate(e,"PUT",n+"/id/"+e.bundleId)},r.deleteCustomBundleVisulization=function(t){void 0===t&&(t={});var o=t.dashboardApi.getGlassCoreSvc(".Ajax");return-1!==t.dashboardApi.getGlassCoreSvc(".UserProfile").capabilities.indexOf("canManageVisualizations")?o.ajax({url:"v1/objects/"+encodeURIComponent(t.assetId),type:"DELETE"}).then((function(){e.removeCustomVisConfiguration(t.id)})):Promise.reject(new Error(i.get("noPermissionToManage")))},r.submitAjaxAddOrUpdate=function(e,t,o){return void 0===e&&(e={}),-1!==e.dashboardApi.getGlassCoreSvc(".UserProfile").capabilities.indexOf("canManageVisualizations")?e.dashboardApi.getGlassCoreSvc(".Ajax").ajax({url:o,type:t,data:e.data,enctype:"multipart/form-data",processData:!1,contentType:!1}).then((function(e){var t=JSON.parse(e.data);return 200===t.Status||201===t.Status?t:e.jqXHR&&e.jqXHR.responseJSON?Promise.reject(new Error(e.jqXHR.responseJSON.msg)):e.jqXHR&&e.jqXHR.responseText?Promise.reject(new Error(e.jqXHR.responseText)):Promise.reject(new Error(t.Description))})):Promise.reject(new Error(i.get("noPermissionToManage")))},r}()).isValidIconFileExt=function(e){return e&&!![".png",".svg"].find((function(t){return-1!==e.indexOf(t)}))},r})),define("dashboard-analytics/visualizations/vipr/VIPR",["underscore","../../lib/@waca/core-client/js/core-client/ui/core/Class","com/ibm/vida/controls/vida-controls","com/ibm/vida/vipr","./VIPRConfig","./VIPRLibraries","./VIPRUtils","./VIPRBundleHelper"],(function(e,t,i,o,r,n,a,s){"use strict";var l=o.VIPR,d=["visualizationPreview","com.ibm.vis.schematicsPreview"];return new(t.extend({_vipr:null,_vidaLocation:null,applyUserConfig:function(){var e;return(e=this._vipr).applyUserConfig.apply(e,arguments)},createExtendedProperties:function(){var e;return(e=this._vipr).createExtendedProperties.apply(e,arguments)},addAppender:function(){var e;return(e=this._vipr).addAppender.apply(e,arguments)},removeAppender:function(){var e;return(e=this._vipr).removeAppender.apply(e,arguments)},getLogger:function(){var e;return(e=this._vipr).getLogger.apply(e,arguments)},load:function(){var e;return(e=this._vipr).load.apply(e,arguments)},loadAll:function(){var e;return(e=this._vipr).loadAll.apply(e,arguments)},unload:function(){var e;return(e=this._vipr).unload.apply(e,arguments)},register:function(){var e;return(e=this._vipr).register.apply(e,arguments)},isRegistered:function(){var e;return(e=this._vipr).isRegistered.apply(e,arguments)},unregister:function(){var e;return(e=this._vipr).unregister.apply(e,arguments)},newViz:function(){var e;return(e=this._vipr).newViz.apply(e,arguments)},init:function(){this._setInitialStates(),this._vidaLocation=require.toUrl("com/ibm/vida").split("?")[0],this._vidaCss(),i.config({vidaLocation:this._vidaLocation})},_setInitialStates:function(){this._libs=void 0,this._customLibs=void 0,this.libraries?this.libraries.custom=[]:this.libraries={system:[],custom:[]}},initialize:function(e){var t=this;if(void 0===e&&(e={}),this.dashboardApi=e.dashboardApi,e.refresh&&this._setInitialStates(),!this._libs){var i=e,o=i.dashboardApi,n=i.refresh,a=i.ajax,l=i.preFetch,d=i.enableCustomVisualizations;return a=a||o.getFeature("Ajax"),s.getALLVIPRLibraries({dashboardApi:o,refresh:n,ajax:a,preFetch:l,enableCustomVisualizations:d}).then((function(i){var o=t._getLibsBundleToCreate(i,e.refresh);return t._setRequiredConfigurationDefaults(o).then((function(i){void 0===i&&(i=[]),i.forEach((function(e){var i=r.getConfig(e.id);if(e.config={},i)if(i.isCustomVis&&i.bundleInclude)e.config.properties=i.bundleInclude;else if(i.isCustomVis&&!i.bundleInclude){t.dashboardApi.getGlassCoreSvc(".Logger").error("`Failed to set lib.config.properties")}else!i.isCustomVis&&i.config&&(e.config.properties=i.config);i&&i.slotConfig&&(e.config.slots=i.slotConfig)})),t._createLibs(i,e.refresh),t._setLibraries(i)}))}))}return Promise.resolve()},_vidaCss:function(){var e=document.createElement("link");e.rel="stylesheet",e.href=this._vidaLocation+"/controls/vida-controls.css",document.head.appendChild(e)},updateCustomLibrary:function(e){var t=this._customLibs[e];t&&this._updateLibrary(t)},getLibraries:function(){if(!this._libs){var t=_extends({},this._systemLibs,this._customLibs);this._libs=e.indexBy(t,"id")}return this._libs},getSystemLibIds:function(){return this.libraries?this.libraries.system.map((function(e){return e.id})):[]},getCustomLibIds:function(){return this.libraries?this.libraries.custom.map((function(e){return e.id})):[]},getBundleIds:function(e){void 0===e&&(e=n.LIB_TYPE_ALL);var t=[];return e!==n.LIB_TYPE_ALL&&e!==n.LIB_TYPE_SYSTEM||t.push.apply(t,this.getSystemLibIds()),e!==n.LIB_TYPE_ALL&&e!==n.LIB_TYPE_CUSTOM||t.push.apply(t,this.getCustomLibIds()),t},_setLibraries:function(e){var t=this;void 0===e&&(e=[]),this._customLibs||(this._customLibs={}),this._systemLibs||(this._systemLibs={}),e.forEach((function(e){e.isSchematic||e.isCustomVis||-1!==d.indexOf(e.id)?(t._customLibs[e.id]=e,t.libraries.custom.push(e)):(t._systemLibs[e.id]=e,t.libraries.system.push(e))}))},_getLibsBundleToCreate:function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=!1),!t)return e;var i=[];return e.forEach((function(e){(e.isSchematic||e.isCustomVis||-1!==d.indexOf(e.id))&&i.push(e)})),i},_createLibs:function(e,t){var i=this;void 0===e&&(e=[]),void 0===t&&(t=!1),t?e.forEach((function(e){i._updateLibrary(e)})):(this._vipr=l.create({bundles:e}),this._vipr.getBundleIds=this.getBundleIds)},_updateLibrary:function(e){var t=e||{},i=t.isSchematic;t.id&&!i&&this.unregister(t.id),t.id&&(i&&!this.isRegistered(t.id)||!i)&&this.register(t.id,t.location,t.config,t.fileName,t)},_fetchAndApplyRequiredConfigurationDefaults:function(e){var t=this,i=e.viprDefinitionId,o=e.requiredConfig;return Promise.reduce(o,(function(e,i){return t.dashboardApi.getGlassCoreSvc(".Config").getConfigValue(i).then((function(t){return e[i]=t,e}))}),{}).then((function(e){return-1===Object.values(e).indexOf("default")?(a.applyRequiredConfiguration(i,o,e),null):i})).catch((function(){return i}))},_setRequiredConfigurationDefaults:function(t){var i=this,o=t.map((function(e){return{viprDefinitionId:e.id,requiredConfig:a.getRequiredConfig(e.id)}})).filter((function(e){return!!e.requiredConfig}));return Promise.map(o,(function(e){return i._fetchAndApplyRequiredConfigurationDefaults(e)})).filter((function(e){return!!e})).then((function(i){return t.filter((function(t){return!e.contains(i,t.id)}))}))},createWidget:function(e,t){var o=new i.SmallMultipleGrid({vipr:this,hostAPI:t},e);if(t&&t.dashboardApi){var r=t.dashboardApi.getFeature("Zoom");if(r){var n=r.getZoomLevel;o.setZoomFactor(n)}}return o},unloadBundle:function(e){this.unload(e)},loadBundle:function(e){var t=this;return this.load(e).then((function(e){return i.SmallMultipleGrid.extendVizBundle(e)})).catch((function(i){var o=t.dashboardApi.getGlassCoreSvc(".Logger");"visualizationPreview"!==e&&o.error(i)}))}}))})),define("dashboard-analytics/widgets/livewidget/util/VisUtil",["dashboard-analytics/widgets/livewidget/nls/StringResources","../../../util/VidaSdkUtil","../../../visualizations/vipr/VIPRLibraries","../../../visualizations/vipr/VIPR","../../../lib/@waca/dashboard-common/dist/api/Error"],(function(e,t,i,o,r){return function(){function n(){}return n.validateVisDefinition=function(e,r,a){void 0===a&&(a={});var s=e.getFeature("Visualization").getDefinition(),l=s?s.getId():a.visId;if(s&&i.isSystemLib(s.getId(),o.getSystemLibIds()))return Promise.resolve(!0);var d=e.getFeature("state.internal");if(d){var u=d.getError();if(u&&u.getParams){var c=u.getParams()||{};c.errorInfo&&c.errorInfo.errorCode===i.LOAD_DEFINITION_ERROR&&d.clearError()}}if("visualizationPreview"===l)return t.isSDKActive(r).then((function(e){return e||n._setError(d,l),e}));var g=s.getState().getError();return g?(n._setError(d,l,g),Promise.resolve(!1)):Promise.resolve(!0)},n._setError=function(e,t,i){if(e){var o=i instanceof r?i:n.createVisDefinitionLoadingError(t);e.setError(o)}},n.createVisDefinitionLoadingError=function(t){var o=e.get("loadVisDefinitionError",{id:t});return new r({msg:o,params:{errorInfo:{id:t,errorCode:i.LOAD_DEFINITION_ERROR,errorMessage:o}}})},n}()})),define("dashboard-analytics/visualizations/renderer/VisRenderSequence",["underscore","./VisRenderState","./VisRenderTrace","../../DynamicFileLoader","../../widgets/livewidget/util/VisUtil","../../visualizations/vipr/VIPRLibraries","../../lib/@waca/core-client/js/core-client/ui/core/Events","../../lib/@waca/dashboard-common/dist/api/Error"],(function(e,t,i,o,r,n,a,s){"use strict";var l=[{id:"visView",dependencies:[],throwOnError:!0,modulePath:"./sequence/VisViewTask"},{id:"visSpec",dependencies:["visView"],throwOnError:!0,modulePath:"./sequence/VisSpecTask"},{id:"data",dependencies:["visSpec"],throwOnError:!0,modulePath:"./sequence/DataTask"},{id:"resultsdatareader",dependencies:["data"],throwOnError:!0,modulePath:"./sequence/ResultsDataReaderTask"},{id:"highlighter",dependencies:["resultsdatareader"],throwOnError:!0,modulePath:"./sequence/HighlighterTask"},{id:"setData",dependencies:["resultsdatareader"],throwOnError:!0,modulePath:"./sequence/SetDataTask"},{id:"render",dependencies:["highlighter"],throwOnError:!0,modulePath:"./sequence/RenderTask"}],d=a.extend({init:function(e){d.inherited("init",this,[e]),this.logger=e.ownerWidget.logger,this.ownerWidget=e.ownerWidget,this.dashboardApi=e.ownerWidget.getDashboardApi(),this.content=this.ownerWidget.content,this.visAPI=e.visModel,this._renderState=new t,this._sequence=null,this._trace=new i(this._renderState),this.widgetExtraStepsIdentifier="",this._renderId=-1},remove:function(){this._getRenderState().remove(),this._renderState=null},isActive:function(){return!!this._renderState},render:function(e){return this.logger&&this.logger.debug("Data widget render start",this.visAPI),e=e||{refreshAll:!0,initial:!0},this.reRender(e)},_getRenderState:function(){if(this._renderState)return this._renderState;throw new Error("widget render aborted")},_isRenderSequenceAPIReady:function(){var e=void 0!==this._renderAPI;return!1===e&&(this._renderAPI=this.content.getFeature("RenderSequence.internal"),(e=void 0!==this._renderAPI)&&this._renderAPI.registerRenderEngine(this)),e},_getTaskProcessor:function(){var e={};return!0===this._isRenderSequenceAPIReady()?(e.startTaskExecution=function(e,t){return this._renderAPI.startTaskExecution({task:e||{},renderContext:t})}.bind(this),e.resolveTaskExecution=function(e,t,i){this._renderAPI.resolveTaskExecution({taskExecution:e,task:t||{},renderContext:i})}.bind(this),e.rejectTaskExecution=function(e,t,i,o){this._renderAPI.rejectTaskExecution({taskExecution:e,task:i||{},renderContext:o,error:t})}.bind(this)):(e.startTaskExecution=function(e,t){return e&&e.instance.process(t)}.bind(this),e.resolveTaskExecution=function(e,t){t&&e.resolve()}.bind(this),e.rejectTaskExecution=function(e,t,i){i&&e.reject(t)}.bind(this)),e},reRender:function(e){var t=arguments,i=this;return r.validateVisDefinition(this.content,this.dashboardApi,{visId:this.ownerWidget.model.visId}).then((function(o){if(o||e&&e.initial){var r=++i._renderId;return(e=e||{refresh:{}}).renderId=r,i._render(e).then((function(t){return(e.refreshAll||e.refresh&&e.refresh.data)&&i.dashboardApi.triggerDashboardEvent("widget:rerendered",{sender:i.ownerWidget.id,refreshAll:e.refreshAll}),i._getRenderState().cleanRenderContextPool(),t})).catch((function(e){if(i.isActive()){var o=e&&(e.message||e.msg)||"dwErrorRenderingVisualization",a=i.content.getFeature("state").getError(),s=i.visAPI&&i.visAPI.getModule()&&i.visAPI.getModule().getSourceName();s||(s="dwErrorMissingDataset"===o?a&&a._params&&a._params.datasetName:" ");var l=i.isLastRun({id:r}),d=["widget render aborted","dwErrorStaleRequest","unSupportedPromptType","cancelPromptDialog"];if(["promptingIsDisabled"].indexOf(o)>-1)throw e;if(-1===d.indexOf(o)){var u;if(e&&e.errorInfo)u=e.errorInfo;else if(a&&a.getParams){var c=a.getParams();u=c?c.errorInfo:null}l&&i.showError(o,{datasetName:s,errorInfo:u}),u&&u.errorCode===n.LOAD_DEFINITION_ERROR||i.logger.error("An error occurred while re-rendering test",t,i.visAPI,e)}else i.logger.warn(o,{datasetName:s})}else i.logger.debug("An error occurred while re-rendering",t,i.visAPI)}))}}))},onChangeRenderer:function(e){var t=e&&e.sender;if(this._getRenderState().lastSizeRendered=null,this._getRenderState().reloadAllRenderSteps(),"UndoRedoController"!==t){var i={undoRedoTransactionId:e&&e.data&&e.data.undoRedoTransactionId,transactionToken:e&&e.data&&e.data.transactionToken};this.ownerWidget.setPreferredSize(this.visAPI.getDefinition().preferredSize,i)}return this.render({refreshAll:!0,initial:!1})},getLastSizeRendered:function(){return this._renderState?this._renderState.lastSizeRendered:null},firstRenderComplete:function(){return this._getRenderState().firstRenderComplete},_render:function(e){var t=this.content&&this.content.getFeature("state").getError();if(t&&"dwErrorMissingDataset"===t.getMessage()||!e.refresh&&!e.refreshAll){var i=this.ownerWidget&&this.ownerWidget.getAPI().getVisApi().getInvalidReason(),o=this.content&&this.content.getFeature("state").getError();if(i||o)return Promise.reject(new Error(i&&i.msg||o&&o.getMessage()))}return this.ownerWidget.renderStart(e),this._isRenderSequenceAPIReady()?this._renderAPI.triggerRenderSequence(e):this.process(e)},_initializeStep:function(e){this._getRenderState().initCurrentContext(e)},_isStepComplete:function(e,t){var i=e===this._getRenderState().getCurrentContext(t);return!i||i&&e[t]},_completeStep:function(e,t,i){e[t]=i;var o=this._renderState?this._renderState.getCurrentContext(t):null,r=o&&o.id===e.id;return e.taskRefreshed[t]=!0,!!o&&r},getVisSpec:function(){return this._getRenderState().getCurrentContextData("visSpec")},createRenderSequence:function(e){var t=this;return void 0===e&&(e=[]),this._sequence=l.concat([]),(Array.isArray(e)?e:[e]).forEach((function(e){var i=t._sequence.findIndex((function(t){return t.id===e.id}));-1===i?t._sequence.push(e):t._sequence[i]=e})),this._createDependenciesFromBlockers(),this._sequence.forEach((function(e){t._validateDependencies(e.id)})),this._sequence},_createDependenciesFromBlockers:function(){var e=this;this._sequence.forEach((function(t){t.blocks&&(t.blocks.forEach((function(i){var o=e._getSequenceTask(i);if(o){var r=o.dependencies||[];-1===r.indexOf(t.id)&&r.push(t.id)}})),delete t.blocks)}))},_getSequenceTask:function(e){return this._sequence.find((function(t){return t.id===e}))},_validateDependencies:function(e,t){var i=this,o=t||[];if(-1!==o.indexOf(e))throw new Error('The task with id "'+e+'" has a a circular dependency: '+t);o.push(e);var r=this._getSequenceTask(e);r.dependencies&&r.dependencies.forEach((function(t){if(!i._getSequenceTask(t))throw new Error('The task with id "'+e+'" has a missing dependency "'+t+'"');var r=o.concat([]);i._validateDependencies(t,r)}))},_createExecutionState:function(e){var t=this,i=null;this._isExecuting&&(i=this.executionStateMap),this.executionStateMap={},this._sequence.forEach((function(i){var o={renderId:e.id,id:i.id};t.executionStateMap[i.id]=o,o.whenStepIsComplete=new Promise((function(e,t){o.resolve=e,o.reject=t})),o.whenStepIsComplete.catch((function(e){}))})),this._sequence.forEach((function(o){var r=[];o.dependencies&&o.dependencies.forEach((function(n){r.push(t.executionStateMap[n].whenStepIsComplete),t._trace.taskDependency(o,e,n);var a=i&&i[n];a&&!t._isPartOfTheCurrentRun(e,n)&&(r.push(a.whenStepIsComplete),t._trace.taskDependency(o,e,{renderId:a.renderId,id:n}))})),t.executionStateMap[o.id].whenDepsAreComplete=Promise.all(r)}))},getTaskExecutionState:function(e){return this.executionStateMap[e]},isLastRun:function(e){return e.id===this._renderId},_isPartOfTheCurrentRun:function(e,t){var i=this._getRenderState().getCurrentContext(t);return i&&i.id===e.id},_getAllDependencies:function(t,i){var o=this,r={};return e.each(i,(function(n){n.dependencies&&n.dependencies.indexOf(t)>-1&&(r[n.id]=n,e.extend(r,o._getAllDependencies(n.id,i)))})),r},_applyRefreshDependencies:function(t,i){var o=this;return i.refresh&&e.each(i.refresh,(function(r,n){r&&e.each(o._getAllDependencies(n,t),(function(e){i.refresh[e.id]=!0}))})),i},_getWidgetStepsIdentifier:function(e){return e.map((function(e){return e.id})).toString()},_ensureSequenceUpToDate:function(){var e=this.ownerWidget.getExtraRenderSequenceSteps();this._isRenderSequenceAPIReady()&&(e=e.concat(this._renderAPI.getProvidersRenderStepList())),this.widgetExtraStepsIdentifier!==this._getWidgetStepsIdentifier(e)&&(this._sequence=null),this._sequence||(this.createRenderSequence(e),this.widgetExtraStepsIdentifier=this._getWidgetStepsIdentifier(e))},process:function(e){var t=this;return this._ensureSequenceUpToDate(),this._loadTasks(this._sequence).then((function(i){return t._preProcessDataOptions(e).then((function(e){e=t._applyRefreshDependencies(t._sequence,e);var o=t._renderState.addRenderContext(_extends({isExecuting:t._isExecuting},e));return t._logRenderContext("_render",o),t._trace.startRender(i,o,e),t._processTasks(i,o)}))}))},_preProcessDataOptions:function(e){return e&&e.refresh&&e.refresh.dataIfQueryChanged?(delete e.refresh.dataIfQueryChanged,this._queryChanged().then((function(t){return t.isRenderNeeded?e.refresh.data=!0:delete e.refresh.data,e}))):Promise.resolve(e)},_queryChanged:function(){return this.content.getFeature("DataQueryExecution.internal").queryChanged().then((function(e){return{isRenderNeeded:e}}))},_processTasks:function(e,t){var i=this;this._isExecuting=!0,t.taskRefreshed||(t.taskRefreshed={}),this._createExecutionState(t);var o=this._getTaskProcessor(),r=[];return o.startTaskExecution(null,t),e.forEach((function(e){var n=i.getTaskExecutionState(e.id);r.push(n.whenDepsAreComplete.then((function(){return t.taskRefreshed[e.id]=!1,i._trace.startTask(e,t),o.startTaskExecution(e,t).then((function(){i._trace.endTask(e,t,"SUCCEEDED"),o.resolveTaskExecution(n,e,t)})).catch((function(r){if(i._trace.endTask(e,t,"FAILED",r),e.throwOnError)throw o.rejectTaskExecution(n,r,e,t),r;o.resolveTaskExecution(n,e,t)}))}),(function(o){throw i._trace.endTask(e,t,"DEPENDENCY_FAILED",o),n.reject(o),o})))})),Promise.all(r).then((function(){return o.resolveTaskExecution(null,null,t),i._isExecuting=!1,t}),(function(e){throw o.rejectTaskExecution(null,e,null,t),e}))},_resolvePath:function(e){if(!e||0===e.length)return null;var t=e,i=e.indexOf("./");return i>-1&&(t="dashboard-analytics/visualizations/renderer/"+e.substr(i+2)),t},_getSequenceModulePaths:function(t){var i=this;return e.chain(t).map((function(e){var t=e.modulePath;return i._resolvePath(t)})).value()},_loadTasks:function(t){var i=this,r=this._getSequenceModulePaths(t);return o.load(r).then((function(o){return e.map(t,(function(e,t){return{instance:new(e.module||o[t])({id:e.id,owner:i,ownerWidget:i.ownerWidget,logger:i.logger,visAPI:i.visAPI,dashboardApi:i.dashboardApi,content:i.content},e.moduleOptions),id:e.id,throwOnError:e.throwOnError}}))}))},_logRenderContext:function(t,i){var o="render sequence stage:"+t+" {rendering "+this.visAPI.id+":";e.each(e.keys(i),function(e){if("id"!==e){var t=this._getRenderState().getCurrentContext(e);o+=e+"("+(t?t.id:"<NULL>")+")"}}.bind(this));var r=this.ownerWidget.model?this.ownerWidget.model.toJSON():"NULL";this.logger.debug(o+", id="+i.id+"}",r)},showError:function(e,t,i){var o=this.content.getFeature("state.internal");if(o){var r=new s({msg:e,params:t},{type:i});o.setError(r)}},enableTrace:function(e){return void 0===e&&(e=!0),this._trace.enable(e)},clearTrace:function(){return this._trace.clear()},getTrace:function(){return this._trace.getTrace()},getCurrentContextData:function(e){return this._getRenderState().getCurrentContextData(e)},setPropertyValue:function(e,t){this._getRenderState().setPropertyValue(e,t)},getPropertyValue:function(e){return this._getRenderState().getPropertyValue(e)}});return d})),define("dashboard-analytics/visualizations/renderer/VisController",["underscore","./VisActionHelper","./VisRenderSequence","../../lib/@waca/core-client/js/core-client/ui/core/Events"],(function(e,t,i,o){"use strict";var r=null;return r=o.extend({init:function(o){r.inherited("init",this,[o]),this._visModel=o.visModel,this._visAPI=o.visAPI,this._ownerWidget=o.ownerWidget,this._visRenderSequence=new i(o),this._visSelectionController=o.selectionController,this._visActionHelper=new t(e.extend(o,{selectionController:this._visSelectionController,content:this._ownerWidget.content})),o.cbGetActionsForFilter=this._visActionHelper.getActionsForLocalFilter.bind(this._visActionHelper),o.getNewFilterActionForContextColumn=this._visActionHelper.getNewFilterActionForContextColumn;var n=this._visSelectionController;this.select=n.select.bind(n),this.getItemKeys=n.getItemKeys.bind(n),this.isItemSelected=n.isItemSelected.bind(n),this.isValueSelected=n.isValueSelected.bind(n),this.getSelectedValues=n.getSelectedValues.bind(n),this.getSelectedTuples=n.getSelectedTuples.bind(n)},getAPI:function(){return this},destroy:function(){this._visSelectionController&&(this._visSelectionController.remove(),this._visSelectionController=null),this._visActionHelper&&(this._visActionHelper.remove(),delete this._visActionHelper),this._visRenderSequence&&(this._visRenderSequence.remove(),delete this._visRenderSequence)},getActionHelper:function(){return this._visActionHelper},getRenderSequence:function(){return this._visRenderSequence}})})),define("dashboard-analytics/util/EventUtils",["underscore"],(function(e){var t=function(){function t(){}return t.toDeprecatedPayload=function(e){if(!e)return e;var t=void 0!==e.value?e.value:e,i=void 0!==e.label?e.label:t,o={u:t,d:i,value:t,label:i};return void 0!==e.p&&null!==e.p&&(o.p=e.p),o},t.getDataPointKey=function(i){var o="",r=e.clone(i).sort(t.compareDataPointKey);return e.each(r,(function(i){var r=i;e.isObject(r)&&(void 0!==r.value?r=r.value:void 0!==r.u&&(r=r.u)),o+=r+t.SEPARATOR})),o.slice(0,-1)},t.compareDataPointKey=function(e,t){return e.u<t.u||e.value<t.value?-1:e.u>t.u||e.value>t.value?1:0},t.getItemKey=function(e){return Array.isArray(e)?t.getDataPointKey(e):e.u||e.value||e},t}();return t.SEPARATOR="×",t})),define("dashboard-analytics/visualizations/renderer/Vis2SelectionController",["underscore","../../widgets/livewidget/nls/StringResources","../../util/DashboardFormatter","../../lib/@waca/core-client/js/core-client/utils/UniqueId","../../util/EventUtils"],(function(e,t,i,o,r){"use strict";return function(){function n(e){this._visAPI=e.visAPI||e.visModel,this._ownerWidget=e.visModel.ownerWidget,this.visualization=this._ownerWidget.content.getFeature("Visualization"),this._pageContextAPI=e.pageContext,this.dashboardApi=this._ownerWidget.getDashboardApi(),this.transaction=this.dashboardApi.getFeature("Transaction")}var a=n.prototype;return a.getAPI=function(){return this},a.remove=function(){},a.getToolbarTitleForSelections=function(o,r){var n=this._getCustomTitleSelections(o),a=o.getCategorySetSize()+n.length,s=this.getSelectedCount();if(r&&r.isRightClick&&s&&(a=s+n.length),(a=a||1)>1)return t.get("multiselectMsg",{count:a});var l="",d=o.getCategorySelections().concat(n);return e.each(d,function(e){var t=e.slotDataItem;if(e&&e.value){var o=e.value.hasOwnProperty("d")?e.value.d:e.value;""!==l&&(l+=" | "),l+=t?i.format(o,t.getFormat()):o}}.bind(this)),l},a.getSelectedCount=function(){var e=0,t=this._visAPI.getFilterInfo({type:"selections"});if(t&&t[0]){var i=t[0].values||t[0].valueSummary;e=i?i.length:e}return e},a._getSelectionValue=function(e){var t={value:e.value,disableFormatting:!1};return e.value.hasOwnProperty("d")?t.value=e.value.d:e.value.hasOwnProperty("label")?(t.value=e.value.label,t.disableFormatting=!0):e.value.hasOwnProperty("v")?t.value=e.value.v:e.value.hasOwnProperty("value")&&(t.value=e.value.value),t},a.getToolbarLabelsForSelections=function(o){var r=[],n=o.getOrdinalSelections(),a={};return e.each(n,function(e){var t,i=e.slotDataItem,o=i.getId(),r=a[o]||{value:null,count:0},n=this._getOrdinalLabel(e.slot,i);if(e&&e.value||0===e.value){var s=this._getSelectionValue(e),l=s.value;s.disableFormatting?r.value=l:isNaN(l)||null===l?"string"==typeof l&&(r.value=l):(t=Number(l),null!==r.value?r.value+=t:r.value=t,r.formatSpec=i.getFormat()),r.count++}r.name=n,r.dataType=i.getMetadataColumn().getDataType(),r.aggregate=i.getAggregation(),a[o]=r}.bind(this)),e.each(a,(function(e){var o=e.value;(e.count>1&&"sum"!==e.aggregate||"N/A"===o)&&(o=t.get("value_is_not_available")),null!=o&&""!==o||(o=e.formatSpec?i.format(e.value,e.formatSpec):t.get("value_is_not_available")),r.push({name:e.name,dataType:e.dataType,formatSpec:e.formatSpec,value:o})})),(r=e.uniq(r,(function(e){return e.name+e.value}))).push.apply(r,this._getCustomLabelSelections(o)),r},a._getOrdinalLabel=function(e,i){var o=i.getAggregation();return"sum"===o?i.getLabel():t.get("aggregatedColumnLabel",{aggregationTypeLabel:t.get(o),column:i.getLabel()})},a.select=function(e,t){(e=e||{}).brushingSpec=this.getBrushingItemSpec(e.itemIds),this._visAPI.setPendingFilters(!!e.pending);var i={payloadData:{undoRedoTransactionId:t&&t.transactionId||e.undoRedoTransactionId||o.get("select"),silent:!1,transactionToken:t},multiTuple:e.multiTuple,skipFilterFocus:!0};this._select(e,i)},a._getPendingPageContext=function(e){return void 0===e&&(e={}),e.pending?this._visAPI.setPendingFilters(!0):this._pageContextAPI},a._getPageContext=function(e){return e&&e.pageContext?e.pageContext:this._pageContextAPI},a._updateEdgeSelection=function(e,t,i,o){var r=this.getBrushingItemSpec(e,!1,i);this._getPageContext(o).updateFilterContext(r,{command:i.command,values:this._getBrushingValueSpec(t,o)},o)},a._updateEdgeOrPointSelection=function(e,t,i,o){var r=this.getBrushingItemSpec(e,!1,i);return this._getPageContext(o).updateFilterContext(r,{command:i.command,values:this._getBrushingValueSpec(t,o)},o)},a.isItemSelected=function(e){var t=this._getBrushingItem(e);return!!(t&&t.getValueCount()>0)},a.isValueSelected=function(e,t){var i=this._getBrushingItem(e);if(i){var o=i.getValueIds();return o&&-1!==o.indexOf(t.u?t.u:t)}return!1},a._getBrushingItem=function(e){return this._pageContextAPI.getPageContextItem({itemId:e,origin:"visualization",scope:this._visAPI.getScope(),eventGroupId:this._visAPI.getEventGroupId()})},a.getSelectedValues=function(e){var t=this._getBrushingItem(e);return t?t.getValueIds():[]},a.getSelectedTuples=function(e){var t=this.getBrushingItemSpec(e),i=this._pageContextAPI.getPageContextItem(t);return i&&i.getValueCount()?i.getValues():[]},a.getItemKeys=function(t){return e.map(t,(function(e){return r.getItemKey(e)}))},a._select=function(t,i){var o=this;(i=i||{}).pageContext=this._getPendingPageContext(t);var r=Array.isArray(t.itemIds)?t.itemIds:[t.itemIds],n=Array.isArray(t.tuple)?t.tuple:[t.tuple],a=!(this._newSelectionIsEmpty(n)||this._isClearingAllSlots(t.command,t.slotsToClear));i.silent=a,this._clearSlotSelections(t.slotsToClear,i),a&&(t.edgeSelect?(i.payloadData=i.payloadData||{},r.forEach((function(a,s){var l=e.flatten(n);i.payloadData.ignorePageContextChanged=s!==l.length-1,i.silent=i.payloadData.ignorePageContextChanged,i.selectionInfo=t.selectionInfo,o._updateEdgeSelection(r[s],l[s],t,i)}))):(i.silent=!1,i.selectionInfo=t.selectionInfo,this._updateEdgeOrPointSelection(r,n,t,i)))},a._isClearingAllSlots=function(e,t){var i=this.visualization.getSlots().getMappedSlotList();return"remove"===e&&t&&t.length===i.length&&t.every((function(e){return-1!==i.indexOf(e)}))},a._clearSlotSelections=function(t,i){var o=[];e.each(t,function(t){var i=t.getDataItemList();e.each(i,function(e){o.push(e.getColumnId())}.bind(this))}.bind(this));var r=this.getBrushingItemSpec(o,!0);return r.hierarchiesContain=o,this._getPageContext(i).deletePageContextItems(r,i)},a.getBrushingItemSpec=function(t,i,o){t=Array.isArray(t)?t:[t];var r=e.map(t,(function(e){return{hierarchyUniqueName:e}})),n=this.visualization.getDataSource(),a={origin:"visualization",eventSourceId:this._ownerWidget.getId(),sourceId:n&&n.getId(),scope:this._visAPI.getScope(),eventGroupId:this._visAPI.getEventGroupId(),hierarchies:r,hierarchyUniqueNames:t},s=this._visAPI.getEventGroupId();return s&&!i&&(a.eventGroupId=s),o&&(o.synchDataId&&(a.synchDataId=o.synchDataId),o.isSynchronizedEntry&&(a.isSynchronizedEntry=o.isSynchronizedEntry)),a},a._getBrushingValueSpec=function(t,i){var o=!Array.isArray(t)||1===t.length,r=[];return t=Array.isArray(t)?t:[t],e.each(t,function(t){if(Array.isArray(t)){var i=[];e.each(t,function(e){i.push(this._getTuplePartValue(e))}.bind(this)),r.push(i)}else r.push(this._getTuplePartValue(t))}.bind(this)),o||i.multiTuple?r:[r]},a._getTuplePartValue=function(e){var t={};return e&&void 0!==e.u?(t.u=e.u,t.d=void 0!==e.d?e.d:e.u,(e.p||e.pu)&&(t.p=e.p||e.pu)):(t.u=e,t.d=e),t},a._getCustomTitleSelections=function(e){return"function"==typeof e.getCustomTitleSelections?e.getCustomTitleSelections():[]},a._getCustomLabelSelections=function(e){return"function"==typeof e.getCustomLabelSelections?e.getCustomLabelSelections():[]},a._newSelectionIsEmpty=function(t){return!t||!e.flatten(t).length},n}()})),define("dashboard-analytics/widgets/livewidget/modelapis/modelmanagers/VisModelManagerLeftover",["underscore","../../../../lib/@waca/core-client/js/core-client/ui/core/Events"],(function(e,t){"use strict";var i=null;return i=t.extend({init:function(e){i.inherited("init",this,arguments),this.content=e.content,this.widgetModel=e.widgetModel,this.ownerWidget=e.ownerWidget,this.dashboardApi=e.dashboardApi},_isCustomDataSelectionEnabled:function(){return this.dashboardApi.getAppConfig("enableCustomDataSelection")||this.supportsCustomDataSelection()},supportsCustomDataSelection:function(){return this.content.getFeature("Visualization").getDefinition().getProperty("supportsCustomDataSelection")},getCustomDataDecoration:function(e){var t=[];if(this._isCustomDataSelectionEnabled()){var i=this.widgetModel.get("customData");i&&i[e]&&i[e].forEach((function(e){t.push({id:e.id,value:e.value})}))}return t},setCustomDataDecoration:function(e,t,i){if(this._isCustomDataSelectionEnabled()&&this._isCustomDataUpdateNeeded(t)){var o=t.map((function(e){return{id:e.id,value:e.value}})),r={};r[e]=o,this.widgetModel.set({customData:r},i)}},getDecoratedCustomData:function(e){var t=this.getCustomDataDecoration(e).map((function(e){return e.id}));return this.getCustomData(t)},getCustomData:function(e){var t=this.ownerWidget.getCustomData()||[];return e&&(t=t.filter((function(t){return e.find((function(e){return e===t.id}))}))),t},_isCustomDataUpdateNeeded:function(e){var t=this.widgetModel.get("customData");return t&&t.selected&&t.selected.length||e&&e.length}})})),define("dashboard-analytics/widgets/livewidget/VisualizationCreator",["./visapi/VisAPI","./visapi/support/VisRenderSupport","../../visualizations/renderer/VisController","../../visualizations/renderer/Vis2SelectionController","../../lib/@waca/core-client/js/core-client/ui/core/Class","../../lib/@waca/dashboard-common/dist/api/Error","./nls/StringResources","underscore","./modelapis/modelmanagers/VisModelManagerLeftover"],(function(e,t,i,o,r,n,a,s,l){"use strict";var d=r.extend({init:function(e){d.inherited("init",this,arguments),this.ownerWidget=e.ownerWidget,this.widgetModel=e.widgetModel,this.dashboardApi=e.dashboardAPI,this.logger=e.logger,this.isPreview=!!e.initialConfigJSON.isPreview&&e.initialConfigJSON.isPreview,this.content=e.content,this.visModelManager=e.legacyManagers.visModelManager,this.dataModel=e.legacyManagers.dataModel,this.visFilterSupport=e.legacyManagers.visFilterSupport,this.visPropertySupport=e.legacyManagers.visPropertySupport,this.displayTypeManager=e.legacyManagers.visDisplayTypeManager,this.recommender=e.legacyManagers.recommender,this.pageContext=null,this.synchronizeData=null,this.visDefinitions=this.dashboardApi.getFeature("VisDefinitions.internal"),this.visualizationFeature=this.content.getFeature("Visualization"),this.contentFeatureLoader=e.contentFeatureLoader},destroy:function(){if(this.visAPI)try{this.visAPI.destroy()}catch(e){}finally{this.visAPI=null}this.visModelManager=null,this.visFilterSupport=null,this.visPropertySupport=null,this.displayTypeManager=null,this.recommender=null,this.visDefinitions=null,this.visualizationFeature=null,this.contentFeatureLoader=null,this.pageContext=null,this.synchronizeData=null,this.content=null,this.ownerWidget=null,this.widgetModel=null,this.dashboardApi=null,this.logger=null,this.visRenderSupport&&(this.visRenderSupport.remove(),this.visRenderSupport=null),d.inherited("destroy",this,arguments)},setPageContext:function(e){this.pageContext=e},setSynchronizeData:function(e){this.synchronizeData=e},_validateVisDefinition:function(e){var t=this.visDefinitions.getById(e);return t.getState().getError()?t.refresh():Promise.resolve()},createVisualization:function(){var e=this;return this.visualizationFeature.getDataSource()?this._validateVisDefinition(this.widgetModel.visId).then((function(){e._initializeModelManagers(),e.dashboardApi.getCanvasWhenReady().then((function(){return e.synchronizeData.loadBrushedContext(e.pageContext,e.visualizationFeature,e.visAPI).then((function(){e.ownerWidget.readyDfd.resolve()}))}))})).catch((function(t){throw e._showLoadingVisualizationNotFound(e.widgetModel.visId,t),t})):(this.createEmptyVis(),this.ownerWidget.readyDfd.promise)},_showLoadingVisualizationNotFound:function(e,t){var i=t instanceof n&&t.getParams(),o=i?t.getParams().errorInfo.errorMessage:a.get("dwErrorLoadingVisualizationNotFound"),r={errorInfo:{id:e||a.get("emptyVisualization"),errorCode:i?t.getParams().errorInfo.errorCode:null,errorMessage:o}};this.showError(o,r)},createVisAPI:function(t){return this.visAPI?this.visAPI.reIntialize(t):this.visAPI=new e(t),this.visAPI},createEmptyVis:function(){try{this._initializeModelManagers(),this.ownerWidget.readyDfd.resolve()}catch(e){this._showLoadingVisualizationNotFound(this.widgetModel&&this.widgetModel.visId,e)}},_initializeModelManagers:function(){this.visRenderSupport=new t({content:this.content,visModelManager:this.visModelManager,ownerWidget:this.ownerWidget,pageContext:this.pageContext,dashboardApi:this.dashboardApi}),this.visModelManagerLEFTOVER=new l({content:this.content,widgetModel:this.widgetModel,ownerWidget:this.ownerWidget,dashboardApi:this.dashboardApi}),this.visAPI=this.createVisAPI({visModelManager:this.visModelManager,visRenderSupport:this.visRenderSupport,visFilterSupport:this.visFilterSupport,visPropertySupport:this.visPropertySupport,ownerWidget:this.ownerWidget,visModelManagerLEFTOVER:this.visModelManagerLEFTOVER}),this.ownerWidget.setVisModelManager(this.visModelManager,this.visAPI),this.visAPI.setDataMembersTEMPORARILY({ownerWidget:this.ownerWidget,pendingFilters:this.visModelManager.pendingFilters,localFilters:this.visModelManager.localFilters}),this.createVisInteractivityControllerDeprecatedFeature(),this.visRenderSupport.initialize()},showError:function(e,t,i){var o=this.content.getFeature("state.internal");if(o){var r=new n({msg:e,params:t},{type:i});o.setError(r)}},recreateVisualization:function(){return this.createVisualization()},getDisplayTypeManager:function(){return this.displayTypeManager},getModule:function(){return this.visModelManager.getModule()},_handleGetDataSetError:function(e,t){this.showError("dwErrorMissingDataset",{datasetName:e.sourceInfo?e.sourceInfo.name:t})},getVisModelManager:function(){return this.visModelManager},createVisInteractivityControllerDeprecatedFeature:function(){this.visSelectionController||(this.visSelectionController=new o({visAPI:this.visAPI,visModel:this.visAPI,ownerWidget:this.ownerWidget,pageContext:this.pageContext,dashboardApi:this.dashboardApi}),this.contentFeatureLoader.registerDeprecatedFeature(this.content.getId(),"SelectionController.deprecated",this.visSelectionController)),this.visInteractivityController||(this.visInteractivityController=new i({visAPI:this.visAPI,visModel:this.visAPI,ownerWidget:this.ownerWidget,pageContext:this.pageContext,dashboardApi:this.dashboardApi,selectionController:this.visSelectionController}),this.contentFeatureLoader.registerDeprecatedFeature(this.content.getId(),"InteractivityController.deprecated",this.visInteractivityController))}});return d})),define("dashboard-analytics/filters/FilterValue",["../lib/@waca/dashboard-common/dist/core/Model"],(function(e){"use strict";var t=null;return t=e.extend({whitelistAttrs:["value"],init:function(e,i){var o={};(e=void 0===e?{}:e)&&e.d?o.value={d:e.d,u:e.u}:o.value="object"!=typeof e?{d:e,u:e}:e;var r=e&&e.u?e.u:e;"object"!=typeof r&&(o.id=r),t.inherited("init",this,[o,i]),null===e&&(this.id=null)}})})),define("dashboard-analytics/filters/FilterValuesCollection",["../lib/@waca/dashboard-common/dist/core/Collection","./FilterValue","underscore"],(function(e,t,i){"use strict";var o=null;return o=e.extend({modelClass:t,init:function(){o.inherited("init",this,arguments)},get:function(e){return this.modelMap[e]||(e&&void 0!==e.id?this.modelMap[e.id]:void 0)},toArray:function(){var e=[];return i.each(this.models,(function(t){e.push(t.value)})),e},toJSON:function(){var e=[];return i.each(this.models,(function(t){t.value&&t.value.toJSON?e.push(t.value.toJSON()):e.push(t.value)})),e}})})),define("dashboard-analytics/filters/FilterSpecHelper",["underscore"],(function(e){"use strict";var t=function(){function t(){}return t.getFilterId=function(e,t,i){return i>0?e+"_"+i:t?e+"_"+t:e},t.containsNumber=function(t){var i=this;return this.isCompound(t)?!!e.find(t.values,(function(e){return i.containsNumber(e)})):!(!t.values||!e.find(t.values,(function(t){var i=e.isObject(t)?t.d:t;return e.isNumber(i)})))},t.isEmpty=function(e){return!e.valueDataItem&&!e.conditions&&e.values&&!e.values.length&&"notin"!==e.operator},t.isOrdinal=function(e){return!!e.aggregationType},t.isCompound=function(e){return["and","or","not"].indexOf(e.operator)>-1},t.isRange=function(e){return t.rangeOps.indexOf(e.operator)>-1},t.isModel=function(e){return!e.operator&&!e.value&&!e.values},t.isAdditional=function(e){return!!e.idSuffix},t.getSelectedCompoundFilterColumnIds=function(t){var i=this,o={};return e.each(t,(function(e){i.isCompound(e)&&i._loadSelectedColumnIdMap(o,e)})),e.keys(o)},t.getSelectedSimpleFilterColumnIds=function(t,i){var o=this,r=[];return e.each(t,(function(e){o.isCompound(e)||void 0===e.columnId||-1!==r.indexOf(e.columnId)||void 0!==i&&void 0===e.visualizationId||r.push(e.columnId)})),r},t._loadSelectedColumnIdMap=function(t,i){var o=this;void 0!==i.columnId&&void 0!==i.visualizationId&&(t[i.columnId]=i.columnId),e.each(i.values,(function(e){o._loadSelectedColumnIdMap(t,e)}))},t}();return t.rangeOps=["between","notbetween","lt","gt","lte","gte"],t})),define("dashboard-analytics/filters/FilterEntry",["../lib/@waca/dashboard-common/dist/core/Model","./FilterValuesCollection","./FilterSpecHelper","underscore"],(function(e,t,i,o){"use strict";var r=null;return r=e.extend({whitelistAttrs:["id","idSuffix","action","columnId","values","valueDataItem","excludedValues","conditions","operator","type","aggregationType","visualizationId","preOrPost","overrideHierarchyDefaultSelection"],FILTERACTION_KEEPEXCLUDE:"keepexclude",determineIdValue:function(e,t,o){return i.getFilterId(e,t,o)},nestedCollections:{values:t,excludedValues:t},init:function(e){this.id=e.id||this.determineIdValue(e.columnId||e.dataPointId,e.aggregationType,e.idSuffix),this.isModelFilter=!e.operator&&!e.value&&!e.values,this.visualizationId=e.visualizationId,r.inherited("init",this,arguments)},isCompound:function(){return i.isCompound(this)},isOrdinalFilter:function(){return i.isOrdinal(this)},getIsModelFilter:function(){return this.isModelFilter},isAdditionalFilter:function(){return i.isAdditional(this)},collectLeafFilterEntries:function(e){this.isCompound()?o.each(this.values.models,function(t){t.value&&t.value.collectLeafFilterEntries(e)}.bind(this)):e.push(this)},compoundFilterMatches:function(e,t){return!(t&&t.length>0&&this.operator!==t[0])&&(this.isCompound()?this._compoundValuesMatches(e,t):this._checkColumnIdAndValues(e))},_compoundValuesMatches:function(e,t){var i=0;return this.values.each((function(r){r.value.compoundFilterMatches(e,t?o.rest(t):null)&&i++})),"or"===this.operator&&i>0||i===this.values.size()},_checkColumnIdAndValues:function(e){if(void 0===e[this.columnId])return!1;if(0===e[this.columnId].length)return!0;for(var t=e[this.columnId],i=0;i<t.length;++i){var o=t[i];if(!this.values.get(o.u))return!1}return!0},getSelectedDataPointArray:function(){var e=[];return this._loadSelectedDataPointArray(e),e},loadSelectedColumnIdMap:function(e){void 0!==this.columnId&&(e[this.columnId]=this.columnId),this.values.each(function(t){t.value&&t.value.loadSelectedColumnIdMap&&t.value.loadSelectedColumnIdMap(e)}.bind(this))},getColumnIds:function(){var e={};return this.loadSelectedColumnIdMap(e),o.keys(e)},removeDataPointFilterTerm:function(e){if(this.isCompound()){if("and"===this.operator&&this.compoundFilterMatches(e))return this;var t=this.values.find((function(t){return null!==t.value.removeDataPointFilterTerm(e)}));"or"===this.operator&&t&&this.values.remove(t)}return null},toQuerySpec:function(e){if(e=e||{},this.isCompound()){var t={};void 0===e.isDataPointExclude&&(e.isDataPointExclude="not"===this.operator);var i=e.isSubExpression?t:{type:this.preOrPost||"pre",expression:t};t[this.operator]=[];var r=this._filterValuesContainNumbers();return this.values.each(function(i){if(i.value&&i.value.toQuerySpec){var n=o.extend(e,{isSubExpression:!0,tupleContainsNumber:r}),a=i.value.toQuerySpec(n);o.isEmpty(a)||(t[this.operator]=t[this.operator].concat(a),"and"!==this.operator||!e.isDataPointExclude||e.nullIncludedInValueList||e.shouldApplyIsNullValueExpression&&!e.shouldApplyIsNullValueExpression(i.value)||(t[this.operator]=t[this.operator].concat(i.value._buildNullValueExpresstionQuerySpec(e))))}}.bind(this)),"not"===this.operator?(e.isSubExpression?t[this.operator]=t[this.operator][0]:i.expression.not=i.expression.not[0],i.expression&&void 0===i.expression.not&&(i.expression={})):t[this.operator]&&!t[this.operator].length&&delete t[this.operator],i}return void 0===e.isEdgeExclude&&(e.isEdgeExclude="notin"===this.operator),this._leafToQuerySpec(e)},_buildNullValueExpresstionQuerySpec:function(e){var t;if(e.isDataPointExclude?t="isnotnull":e.isEdgeExclude&&(t="isnull"),t)return{itemId:this.columnId,operator:t}},_compoundFilterFromJSON:function(){o.each(this.values.models,(function(e){e.value&&e.value.operator&&(e.value=new r(e.value,e),e.value._compoundFilterFromJSON())}))},_loadSelectedDataPointArray:function(e){if(this.isCompound()){var t={};this.values.each((function(i){var o=i.value._loadSelectedDataPointArray&&i.value._loadSelectedDataPointArray(e);o&&(t[o[0]]=o[1])})),o.keys(t).length>0&&e.push(t)}else if(this.columnId)return[this.columnId,this.values.models[0].value]},_filterValuesContainNumbers:function(){return this.isCompound()?this.values.find((function(e){return e.value._filterValuesContainNumbers&&e.value._filterValuesContainNumbers()})):this.values&&this.values.find((function(e){return o.isNumber(e.value.d)}))},isRangeOperator:function(){return i.isRange(this)},_leafToQuerySpec:function(e){if(this.isModelFilter)return{type:"pre",expression:{filterId:this.columnId}};if(this.conditions)return this._buildConditionsQuerySpec(e);var t={operator:this.operator};if(e.associatedDataItemAPI?t.dataItem=e.associatedDataItemAPI.getUniqueId():t.itemId=this.columnId,e.tupleContainsNumber?t.valueType="display":this.type&&(t.valueType=this.type),this.values.models&&this.values.models.length>0){var i=this.values.toArray();t=this._buildNullValuesQuerySpec(t,i,e)}else if(this.valueDataItem)t.valueDataItem=this.valueDataItem;else if("notin"===t.operator){var o=e&&e.addExtraQueryDataItem&&e.addExtraQueryDataItem(this.columnId);o&&(t.operator="in",t.valueDataItem=o.id)}var r=this._buildEdgeNullValueExpresstionQuerySpec(t,e);r&&(t=r);var n=this.isRangeOperator()?"post":"pre",a=this.preOrPost||e.type||n;return e.isSubExpression?t:{type:a,expression:t}},_buildEdgeNullValueExpresstionQuerySpec:function(e,t){if(!e.valueDataItem&&"notin"===this.operator&&t.isEdgeExclude&&!t.nullIncludedInValueList&&(!t||!t.shouldApplyIsNullValueExpression||t.shouldApplyIsNullValueExpression(this))){var i={};return i.or=[this._buildNullValueExpresstionQuerySpec(t),e],i}return null},_buildNullValuesQuerySpec:function(e,t,i){(i=i||{}).nullIncludedInValueList=!1;var r=0!==this.operator.indexOf("not"),n=o.without(t,null,"null");if(n=o.filter(n,(function(e){return null!==e.u&&null!==e.d&&"null"!==e.u&&"null"!==e.d})),n=o.pluck(n,"display"===this.type||i.tupleContainsNumber?"d":"u"),e.values=n,n.length<t.length){i.nullIncludedInValueList=!0;var a={itemId:this.columnId,operator:r?"isnull":"isnotnull"};if(this.type&&(a.valueType=this.type),n.length>0){var s={};s[r?"or":"and"]=[a,e],e=s}else e=a}return e},_buildConditionsQuerySpec:function(e){var t,i;if(this.values&&!this.values.isEmpty()){var r=this.values.toArray(),n=o.pluck(r,"display"===this.type?"d":"u");t={valueType:this.type,operator:"in",itemId:this.columnId,values:n}}if(this.excludedValues&&!this.excludedValues.isEmpty()){var a=this.excludedValues.toArray(),s=o.pluck(a,"display"===this.type?"d":"u");i={valueType:this.type,operator:"notin",itemId:this.columnId,values:s}}var l=t?{or:[this.conditions,t]}:this.conditions,d=i?{and:[l,i]}:l;return"notin"===this.operator&&(d={not:d}),e.isSubExpression?d:{type:e.type||"pre",expression:d}}})})),define("dashboard-analytics/filters/Filters",["jquery","../lib/@waca/dashboard-common/dist/core/Collection","./FilterEntry","../widgets/livewidget/nls/StringResources","underscore"],(function(e,t,i,o,r){"use strict";var n=null;return n=t.extend({modelClass:i,FILTERTYPE_ORDINAL:"ordinal",FILTERTYPE_CATEGORY:"category",FILTERTYPE_BINS:"bins",FILTERTYPE_SEARCH:"search",init:function(){n.inherited("init",this,arguments),this._compoundFiltersFromJSON(),this.updateNeeded=!1},_takeSnapShot:function(e){this.updateNeeded||(this.updateNeeded=!0,this._snapshot=e||this.toJSON())},_filterModificationComplete:function(e){var t=this;if(void 0===e&&(e={}),this.updateNeeded&&!e.silent&&(this.updateNeeded=!1,!e.isApiUndoRedoEvent)){var i={name:"reset",eventName:"reset",collection:this,data:e.payloadData,prevValue:this._snapshot,value:this.toJSON(),sender:e.sender||this};i.senderContext={applyFn:function(e,i,o,r){var n={sender:i};r&&(n.payloadData=r),t.reset(e,n)}},this.trigger("reset",i)}},allFilterModificationComplete:function(e){return void 0===e&&(e={}),this._filterModificationComplete(e),e.filterEntry},getKey:function(e,t,i,o){return null===e?null:"ordinal"===t?this.getOrdinalFilterKey(e,i,o):this.getCategoryFilterKey(e)},getOrdinalFilterKey:function(e,t,o){return{id:i.prototype.determineIdValue(this._columnId(e),t),columnId:this._columnId(e),aggregationType:t,filterType:"ordinal",preOrPost:o||"post"}},getCategoryFilterKey:function(e,t){return{id:t||i.prototype.determineIdValue(this._columnId(e)),columnId:this._columnId(e),filterType:"category"}},getModelFilterKey:function(e){return{id:i.prototype.determineIdValue(this._columnId(e)),columnId:this._columnId(e),filterType:"filter"}},getSearchFilterKey:function(e){return{id:i.prototype.determineIdValue(this._columnId(e)),columnId:this._columnId(e),filterType:"search"}},getDataPointFilterKey:function(e,t){return i.prototype.determineIdValue(JSON.stringify(e),null,t)},getFilterEntry:function(e){return this._checkFilterEntryKey(e),this.get(e.id)},getFilterEntries:function(e){this._checkFilterEntryKey(e);var t=e.id?"id":"columnId",i=[];return e[t]?this.each((function(o){0===o[t].indexOf(e[t])&&i.push(o)})):this.logger&&this.logger.debug("WARNING: getFilterEntries only supports a baseId (id) or columnId"),i},_hasValidFilterType:function(e){return"category"===e.filterType||"ordinal"===e.filterType&&e.aggregationType},_checkFilterEntryKey:function(e){if(e){if(e.id)return;if(void 0!==e.columnId&&null!==e.columnId&&this._hasValidFilterType(e))return}throw"Invalid key used to access filters (_checkFilterEntryKey)"},addDataPointFilter:function(e,t,i){this._takeSnapShot();var o=r.clone(i||{});o.silent=!0;var n=this.getDataPointFilterKey(e),a=[];r.each(t.values,function(i){a.push(this._createOneDataPoint(e,i,t))}.bind(this));var s=this._createRootDataPointFilterEntry(n,a,t);this.get(s.id)&&this.remove(s.id,o);var l=this.add(s,o);return Array.isArray(l)?l[0]:l},_createRootDataPointFilterEntry:function(e,t,i){var o={dataPointId:e,operator:"or",values:t,visualizationId:this.visId},r=this._createNewFilterEntry(i,o);if(i.exclude){var n={dataPointId:e,operator:"not",values:r};r=this._createNewFilterEntry(i,n)}return r},_createOneDataPoint:function(e,t,o){var n=[];r.each(t,function(t,r){var a={columnId:e[r],values:[t],operator:"in",visualizationId:o.visualizationId||this.visId,type:o.type},s=new i(a);n.push(s)}.bind(this));var a={operator:"and",values:n,visualizationId:this.visId};return new i(a)},_createFilterEntrySpec:function(e,t){var i=t.conditionsInfo||{};return t.operator||t.values||t.type?{columnId:e.columnId,values:t.values,valueDataItem:t.valueDataItem,type:t.type,operator:t.operator,visualizationId:this.visId,excludedValues:i.excludedValues,conditions:i.conditions,preOrPost:e.preOrPost,overrideHierarchyDefaultSelection:t.overrideHierarchyDefaultSelection,id:e.id,isMissing:t.isMissing}:{columnId:e.columnId||e.itemId}},updateFilterEntry:function(e,t){this._takeSnapShot();var i=(t=t||{})&&t.conditionsInfo;this._checkFilterEntryKey(e),i=i||{};var o=this.getFilterEntry(e);if(!o||this.actionAllowsAdditionalFiltersPerItem(t.action)){var r=this._createFilterEntrySpec(e,t);e.aggregationType&&(r.aggregationType=e.aggregationType),o=this._createNewFilterEntry(t,r),this.add([o],{silent:!0})}else if(!o.isModelFilter){var n={operator:t.operator,type:t.type,values:t.values,aggregationType:e.aggregationType,conditions:i.conditions,layerId:t.layerId};i.excludedValues&&(n.excludedValues=i.excludedValues),t.valueDataItem&&(n.valueDataItem=t.valueDataItem),t.visualizationId&&(n.visualizationId=t.visualizationId),o.set(n,{silent:!0})}return o},actionAllowsAdditionalFiltersPerItem:function(e){return e===i.prototype.FILTERACTION_KEEPEXCLUDE},_createNewFilterEntry:function(e,t){e.layerId&&(t.layerId=e.layerId),e.visualizationId&&(t.visualizationId=e.visualizationId);var o=new i(t);if(this.actionAllowsAdditionalFiltersPerItem(e.action)){for(var r=0;this.get(i.prototype.determineIdValue(o.id,t.aggregationType,r));)r++;r>0&&(o.idSuffix=r,o.id=i.prototype.determineIdValue(o.id,t.aggregationType,r))}return o},removeFilterEntry:function(e){var t=this.toJSON();return this._checkFilterEntryKey(e),!!this.remove(e,{silent:!0})&&(this._takeSnapShot(t),!0)},clearCompoundFilters:function(e){var t=this,i={};e.forEach(function(e){i[this._columnId(e)]=[]}.bind(this));var o=this.filter((function(e){return e.isCompound()&&e.compoundFilterMatches(i)}));r.each(o,(function(e){t.removeFilterEntry(e)}))},fromJSON:function(e,t){this._takeSnapShot(),this.reset(e,t),this._compoundFiltersFromJSON()},_columnId:function(e){return void 0===e||void 0===e.columnId?e:e.columnId},getSelectedSimpleFilterColumnIds:function(){var e=[];return this.each(function(t){t.isCompound()||void 0===t.columnId||e.push(t.columnId)}.bind(this)),e},getSelectedCompoundFilterColumnIds:function(){var e={};return this.each(function(t){t.isCompound()&&t.loadSelectedColumnIdMap(e)}.bind(this)),r.keys(e)},_compoundFiltersFromJSON:function(){this.each(function(e){e.isCompound()&&e._compoundFilterFromJSON()}.bind(this))},cleanUpMissingFilterEntries:function(e){if(e&&e.getMetadataColumn){var t=[];this.each(function(i){if(i.isCompound()){var o={};i.loadSelectedColumnIdMap(o),r.some(r.keys(o),(function(t){return!e.getMetadataColumn(t)}))&&t.push(i.id)}else i.columnId&&!e.getMetadataColumn(i.columnId)&&t.push(i.id)}.bind(this)),t=r.uniq(t),r.each(t,function(e){this.removeFilterEntry({id:e})}.bind(this))}}})})),define("dashboard-analytics/widgets/livewidget/models/LiveWidgetModel",["../../../lib/@waca/dashboard-common/dist/core/Model","../../../data/models/VisPropertyCollection","../../../filters/Filters","underscore"],(function(e,t,i,o){var r=null;return r=e.extend({nestedModels:{},nestedCollections:{properties:t,localFilters:i,searchFilters:i},localizedProps:["name","titleHtml"],runtimeAttrs:["filters"],init:function(e,t){if(t=t||{},this.dataItemIdsMap={},t.widgetModel=this,e.properties||(e.properties=[]),e.localFilters||(e.localFilters=[]),e.data||(e.data={}),r.inherited("init",this,[e,t]),e)for(var i in this.whitelistAttrs=["type","id","visId","titleHtml","titleMode","responsiveTitle","name","data","visTypeLocked","slotmapping","augmentation","annotations","forecasting","possibleKeyDrivers","customData","thumbnailId","format"],e)e.hasOwnProperty(i)&&this.whitelistAttrs.push(i);this.searchFilters||this.set({searchFilters:[]})},getMultilingualAttribute:function(e){var t=r.inherited("getMultilingualAttribute",this,arguments);return t||(this.properties&&this.properties.getMultilingualAttribute?this.properties.getMultilingualAttribute(e):null)},getMultilingualAttributes:function(){var e=r.inherited("getMultilingualAttributes",this,arguments);return this.properties&&this.properties.getMultilingualAttributes&&(e=e.concat(this.properties.getMultilingualAttributes())),e},getDataItemIdsMap:function(){return this.dataItemIdsMap},set:function(e,t){(e=e||{}).mapping&&delete e.mapping,o.forEach(e,function(e,t){if(this.nestedModels[t],o.isObject(e)&&o.isEmpty(e)){var i=this.nestedModels[t];i&&(this[t]=new i(null,{widgetModel:this}))}}.bind(this)),t&&(t.widgetModel=this),r.inherited("set",this,arguments)},cloneWidget:function(e){var t=new r(this.toJSON());return t.replaceIds(e),t},toJSON:function(){var e=r.inherited("toJSON",this,arguments);return e.localFilters&&0===e.localFilters.length&&delete e.localFilters,e.properties&&0===e.properties.length&&delete e.properties,e}})})),define("dashboard-analytics/widgets/livewidget/features/InlineFeatures",[],(function(){"use strict";return[]})),define("dashboard-analytics/widgets/livewidget/features/FeatureLoader",["../../../DynamicFileLoader","./InlineFeatures","underscore"],(function(e,t,i){"use strict";return function(){function o(e,t){this.widgetApi=e,this.dashboardApi=t,this.features={},this.disabledFeatures={}}var r=o.prototype;return r.loadFeatures=function(i){var o=this;return this.dashboardApi.findGlassCollection("com.ibm.bi.dashboard.live-features").then((function(r){var n=[];return r&&(r=r.concat(t)).forEach((function(t){var r=t.name||t.id;i&&-1===i.indexOf(r)||n.push(e.load([t.class]).then((function(e){o.features[r]=new e[0](o.widgetApi,o.dashboardApi)})))})),Promise.all(n)}))},r.setFeatureEnabled=function(e,t){t?delete this.disabledFeatures[e]:this.disabledFeatures[e]=!0},r.unloadFeatures=function(){var e=this;i.each(i.keys(this.features),(function(t){e.features[t].destroy&&e.features[t].destroy(),delete e.features[t]})),this.features={}},r.setFeature=function(e,t){this.features[e]=t},r.getFeature=function(e){var t;return this.features[e]&&this.isFeatureEnabled(e)&&this.features[e].getAPI&&(t=this.features[e].getAPI()),t},r.isFeatureEnabled=function(e){return!this.disabledFeatures[e]&&(!this.features[e].isEnabled||this.features[e].isEnabled())},r.getMatchingFeatures=function(e){var t=this,o=[];return i.each(i.keys(this.features),(function(i){var r=t.features[i];if(r&&t.isFeatureEnabled(i)&&r.getFeatureTags&&r.getFeatureTags().indexOf(e)>=0){var n=t.getFeature(i);n&&o.push(n)}})),o},r.setMatchingFeaturesEnabled=function(e,t){var o=this;i.each(i.keys(this.features),(function(i){var r=o.features[i];r&&r.getFeatureTags&&r.getFeatureTags().indexOf(e)>=0&&o.setFeatureEnabled(i,t)}))},r.getExtraRenderSequenceSteps=function(){var e=[];for(var t in this.features)if(this.isFeatureEnabled(t)&&this.features[t].getExtraRenderSequenceSteps){var i=this.features[t].getExtraRenderSequenceSteps();i&&e.push.apply(e,Array.isArray(i)?i:[i])}return e},r.getMatchingFeatureStepIds=function(e,t){void 0===t&&(t=!1);var i=[];for(var o in this.features)if(!t||this.isFeatureEnabled(o)){var r=this.features[o];if(r&&r.getFeatureTags&&r.getExtraRenderSequenceSteps&&r.getFeatureTags().indexOf(e)>=0){var n=this.features[o].getExtraRenderSequenceSteps();n&&(n=Array.isArray(n)?n:[n],i.push.apply(i,n.map((function(e){return e.id}))))}}return i},o}()})),define("dashboard-analytics/visualizations/renderer/topbottom/TopBottomLabel",["../../../widgets/livewidget/nls/StringResources","../../../lib/@waca/core-client/js/core-client/ui/core/Class"],(function(e,t){"use strict";var i=function(t){var i={};return i.columnLabel=t.limit.factColumnLabel,i.operator="top"===t.limit.op?e.get("topOperator"):e.get("bottomOperator"),i.value=t.limit.val,i.percent=t.limit.percent?"%":"",i},o={fact:{template:"topBottomFact",params:function(e){return i(e)}},dimension:{template:"topBottomDimension",params:function(e){return i(e)}}};return t.extend({getTopBottomLabel:function(t){var i=t.limit&&t.limit.fact?o.fact:o.dimension;return e.get(i.template,i.params(t))}})})),define("dashboard-analytics/visualizations/renderer/filter/FilterLabel",["underscore","../../../widgets/livewidget/nls/StringResources","../../../util/DashboardFormatter"],(function(e,t,i){var o=function(o,r,n,a){var s=a||o.values;s.toJSON&&(s=s.toJSON());var l=null;"string"!==r.getDataType()&&"attribute"!==r.getType()&&(l={type:r.getDataType()}),s=e.map(e.pluck(s,"d"),(function(e){return i.format(e,l)}));var d={};return d[n]=s.join(t.get("listSeparator")+" "),d},r=function(t,o,r,n,a){var s=t.values;s.toJSON&&(s=s.toJSON()),s=e.pluck(s,"d");var l={type:o.getDataType()},d=o.getFormat();d&&d.maximumFractionDigits&&(l.maximumFractionDigits=d.maximumFractionDigits);var u={};if(r&&(u.lowerBound=i.format(s[0],l)),n){var c=a||r?1:0;u.upperBound=i.format(s[c],l)}return u},n={in:{template:"dimFilterIn",params:function(e,t,i){return o(e,t,"in",i)}},isnull:{template:"dimFilterIn",params:function(e,t){return o(e,t,"in")}},notin:{template:"dimFilterNotIn",params:function(e,t,i){return o(e,t,"out",i)}},between:{template:"measureFilterBetween",params:function(e,t){return r(e,t,1,1)}},notbetween:{template:"measureFilterNotBetween",params:function(e,t){return r(e,t,1,1)}},gt:{template:"gtFilter",params:function(e,t){return r(e,t,1,0)}},gte:{template:"gteFilter",params:function(e,t){return r(e,t,1,0)}},lt:{template:"ltFilter",params:function(e,t){return r(e,t,0,1)}},lte:{template:"lteFilter",params:function(e,t){return r(e,t,0,1)}},before:{template:"beforeFilter",params:function(e,t){return r(e,t,0,1,!0)}},after:{template:"afterFilter",params:function(e,t){return r(e,t,1,0,!0)}}};return function(){function i(){}var o=i.prototype;return o.getFilterLabel=function(e,i){var o=e.toJSON?e.toJSON():e,r=o.values&&o.values.length>0;if(o.operator){if(o.valueDataItem&&!r)return t.get("filter_allMembersOfSet");if("notin"===o.operator&&!r&&!o.conditions)return t.get("filterAll");var a=n[o.operator],s=[];if(o.conditions&&s.push(t.get("filterConditionLabel")),r&&s.push(t.get(a.template,a.params(o,i))),o.excludedValues&&o.excludedValues.length){var l="in"===o.operator?"notin":"notin"===o.operator?"in":null;if(l){var d=n[l];s.push(t.get(d.template,d.params(o,i,o.excludedValues)))}}return s.join(t.get("listSeparator")+" ")}return Array.isArray(o.values)&&0===o.values.length?t.get("filter_includesAll"):t.get("modelFilter")},o.getDataPointFilterSummary=function(i){var o=[];return Array.isArray(i)&&Array.isArray(i[0])?e.each(i,(function(i){var r=[];e.each(i,(function(e){r.push(e.d)})),o.push(r.join(t.get("pointSeparator")))})):e.each(i,(function(i){var r=[];e.each(e.keys(i),(function(e){r.push(i[e].d)})),o.push(r.join(t.get("pointSeparator")))})),o.join(t.get("listSeparator")+" ")},i}()})),define("dashboard-analytics/visualizations/renderer/filter/FilterLabelHelper",["underscore","../../../widgets/livewidget/nls/StringResources","../../../util/DashboardFormatter","../../../lib/@waca/core-client/js/core-client/ui/core/Class","../topbottom/TopBottomLabel","./FilterLabel"],(function(e,t,i,o,r,n){var a=null;return a=o.extend([n,r],{init:function(e){a.inherited("init",this,arguments),this.dataSource=e.dataSource,this.visAPI=e.visAPI,this.timelineFilter=e.timelineFilter,this.filterLineEnabled=e.filterLineEnabled,this.filterLineDeleteEnabled=e.filterLineDeleteEnabled,this.iconsFeature=e.dashboardApi?e.dashboardApi.getFeature("Icons"):this.visAPI.ownerWidget.dashboardApi.getFeature("Icons")},generateTopBottomListItems:function(i){var o=[];return e.each(i,function(e){var i={},r=this._getTopBottomDescription(e);if(void 0!==e.columnId||void 0!==e.columnLabel){if(!r)return;i={title:e.columnLabel,description:r,toolTip:r}}if(e.id){i.deleteEnabled=e.deleteEnabled,i.editEnabled=e.editEnabled,i.dataId=e.id,e.limit.percent?(i.deleteLabel=t.get("deleteTopBottomPercent"),i.editLabel=t.get("editTopBottomPercent"),i.ariaDeleteLabel=t.get("ariaDeleteTopBottomPercentLabel"),i.ariaEditLabel=t.get("ariaEditTopBottomPercentLabel")):(i.deleteLabel=t.get("deleteTopBottomCount"),i.editLabel=t.get("editTopBottomCount"),i.ariaDeleteLabel=t.get("ariaDeleteTopBottomCountLabel"),i.ariaEditLabel=t.get("ariaEditTopBottomCountLabel"));var n=this.iconsFeature.getIcon("dashboard-topbottom");i.svgHref="#"+n.id}i.type="topBottom",o.push(i)}.bind(this)),o},generateFilterListItems:function(i){var o=[];return e.each(i,function(e){var i={},r=this.getFilterDescription(e);if(void 0!==e.columnId||void 0!==e.columnLabel){if(!r)return;i={title:e.columnLabel,description:r,toolTip:r}}else i={title:t.get("dataPointFilterTitle"),description:r,toolTip:e.valueSummary?this.getDataPointFilterSummary(e.valueSummary):r};if(e.id){var n=this.iconsFeature.getIcon("common-filter");i.dataId=e.id,i.deleteLabel=t.get("deleteFilter"),i.editLabel=t.get("editFilter"),i.ariaDeleteLabel=t.get("ariaDeleteFilterLabel"),i.ariaEditLabel=t.get("ariaEditFilterLabel"),i.svgHref="#"+n.id,i.deleteEnabled=this._isFilterLineDeleteEnabled(e),i.editEnabled=this._isFilterLineEnabled(e)}i.type=this._getFilterLineType(),o.push(i)}.bind(this)),o},_getTopBottomDescription:function(e){if(void 0!==e.columnId){var t=this.getColumnMetadataNameFromColumnId(e.columnId);if(!t)return null;if(e.columnLabel=t.getLabel(),e.limit&&e.limit.fact){var i=this.getColumnMetadataNameFromColumnId(e.limit.fact);i&&(e.limit.factColumnLabel=i.getLabel())}return this.getTopBottomLabel(e)}},getFilterDescription:function(e){if(e.description)return e.description;if(void 0!==e.columnId){var i=this.dataSource.getMetadataColumn(e.columnId);return i?this.getFilterLabel(e,i):null}return e.columnMetadata?this.getFilterLabel(e,e.columnMetadata):"not"===e.operator?t.get("dataPointFilterExcludeSummary",{valueCount:e.valueCount}):t.get("dataPointFilterIncludeSummary",{valueCount:e.valueCount})},_isFilterLineDeleteEnabled:function(e){return!this.filterLineDeleteEnabled||this.filterLineDeleteEnabled(e)},_isFilterLineEnabled:function(e){return this.filterLineEnabled?this.filterLineEnabled():e.columnId&&e.deleteEnabled&&!1!==e.editEnabled},_getFilterLineType:function(){return this.timelineFilter?"timelineFilter":"filter"},getColumnMetadataNameFromColumnId:function(e){if(e)return this.dataSource.getMetadataColumn(e)},getPromptLabel:function(o){var r,n,a=[],s=o.values&&o.values.length&&void 0!==o.values[0].d?"d":"label",l=e.pluck(o.values,s);switch(o.dataType){case"xsdDate":case"xsdDateTime":case"xsdTime":r="xsdDate"===o.dataType?"date":"xsdDateTime"===o.dataType?"datetime":"time",l.forEach((function(e){a.push(i.format(e,{type:r,formatLength:"medium"}))}));break;case"xsdInt":case"xsdLong":case"xsdShort":case"xsdFloat":case"xsdDecimal":case"xsdDouble":if(o.modelFilterItem)try{n="attribute"===this.getColumnMetadataNameFromColumnId(o.modelFilterItem).getType()}catch(e){n=!0}if(n)return l.join(t.get("listSeparator")+" ");l.forEach((function(e){a.push(i.format(e,{type:"number"}))}));break;default:return l.join(t.get("listSeparator")+" ")}return o.capabilities&&!o.capabilities.discreteValue?this.getRangePromptLabel(a):a.join(t.get("listSeparator")+" ")},getRangePromptLabel:function(e){return t.get("measureFilterBetween",{lowerBound:e[0],upperBound:e[1]})}})})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"));else if("function"==typeof define&&define.amd)define("dashboard-analytics/lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/illustrations-js/disconnect_64",["@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"],t);else{var i=t("object"==typeof exports?require("@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"):e["@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"]);for(var o in i)("object"==typeof exports?exports:e)[o]=i[o]}}("undefined"!=typeof self?self:this,(function(e){return webpackJsonPBaGraphics([120],{"148b2840bf9e56670c8f":function(e,t,i){"use strict";var o=i("9689a9c94ae38b47fa2c"),r=i.n(o),n=i("9ce58a7deea14f49ef01"),a=i.n(n),s=new r.a({id:"disconnect_64_v7",use:"disconnect_64_v7-usage",viewBox:"0 0 64 64",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" id="disconnect_64_v7"><defs><style></style></defs><g id="disconnect_64_v7_disconnect"><g id="disconnect_64_v7_background"><path class="ba-graphics-cls-1" d="M26,43v5a3,3,0,0,0,3,3h6a3,3,0,0,0,3-3V43h1V39H25v4Z" /><path class="ba-graphics-cls-1" d="M38,21V16a3,3,0,0,0-3-3H29a3,3,0,0,0-3,3v5H25v4H39V21Z" /><path class="ba-graphics-cls-2" d="M23,27H41V19H40V16a5,5,0,0,0-4-4.9V9H33V8A6,6,0,0,0,21,8v3a4,4,0,0,1-8,0V1H11V11a6,6,0,0,0,12,0V8a4,4,0,0,1,8,0V9H28v2.1A5,5,0,0,0,24,16v3H23Zm3-11a3,3,0,0,1,3-3h6a3,3,0,0,1,3,3v3H26Zm-1,9V21H39v4Z" /><path class="ba-graphics-cls-2" d="M41,37H23v8h1v3a5,5,0,0,0,4,4.9V55h3v1a6,6,0,0,0,12,0V53a4,4,0,1,1,8,0V63h2V53a6,6,0,1,0-12,0v3a4,4,0,0,1-8,0V55h3V52.9A5,5,0,0,0,40,48V45h1ZM38,48a3,3,0,0,1-3,3H29a3,3,0,0,1-3-3V45H38Zm1-9v4H25V39Z" /><path class="ba-graphics-cls-2" transform="rotate(45 47.995 36.49)" d="M44.8 35.49H51.19V37.49H44.8z" /><path class="ba-graphics-cls-2" transform="rotate(-45 47.986 27.513)" d="M44.8 26.51H51.19V28.51H44.8z" /><path class="ba-graphics-cls-2" transform="rotate(-135 16.01 27.508)" d="M12.81 26.51H19.2V28.51H12.81z" /><path class="ba-graphics-cls-2" transform="rotate(135 16.009 36.489)" d="M12.81 35.49H19.2V37.49H12.81z" /></g><path id="disconnect_64_v7_highlight" class="ba-graphics-cls-3" d="M30,37H28V32h2Zm6-5H34v5h2Z" /></g></symbol>'});a.a.add(s),t.a=s},"6873601dfe1d9459c1a9":function(t,i){t.exports=e},"97cf9fe0b34fba61532d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("6873601dfe1d9459c1a9"),r=(i.n(o),i("148b2840bf9e56670c8f"));t.default=r.a}},["97cf9fe0b34fba61532d"])})),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"));else if("function"==typeof define&&define.amd)define("dashboard-analytics/lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/illustrations-js/unknown-warning_128",["@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"],t);else{var i=t("object"==typeof exports?require("@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"):e["@ba/ba-graphics/dist/illustrations-js/ba-graphics-icons-commons.js"]);for(var o in i)("object"==typeof exports?exports:e)[o]=i[o]}}("undefined"!=typeof self?self:this,(function(e){return webpackJsonPBaGraphics([12],{"6873601dfe1d9459c1a9":function(t,i){t.exports=e},"6986996ff9f096db46c3":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("6873601dfe1d9459c1a9"),r=(i.n(o),i("fb78783289a5366a88ff"));t.default=r.a},fb78783289a5366a88ff:function(e,t,i){"use strict";var o=i("9689a9c94ae38b47fa2c"),r=i.n(o),n=i("9ce58a7deea14f49ef01"),a=i.n(n),s=new r.a({id:"unknown-warning_128_v7",use:"unknown-warning_128_v7-usage",viewBox:"0 0 128 128",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" id="unknown-warning_128_v7"><circle class="ba-graphics-gray1" cx="55" cy="75.1" r="36" /><path class="ba-graphics-gray1" d="M104.7 50.6L77.8 57.8 76.6 53 90.9 49.2 82.3 17.1 94.8 13.9 91.6 34.5z" /><path class="ba-graphics-gray1" d="M88 47.7L35.3 61.8 25.4 25.1 78.2 11z" /><path class="ba-graphics-gray20" d="M58.5,22.3c-7.8-1-14.9,4.6-15.9,12.4S47.2,49.6,55,50.6S69.9,46,70.9,38.2l0,0l0,0 C71.8,30.4,66.3,23.3,58.5,22.3z" /><path class="ba-graphics-white" d="M58.9 40.4L57.6 31.1 56.4 26.9 52.2 28 53.3 32.2 56.8 41z" /><path class="ba-graphics-white" d="M58.3,42.2c-1.2,0.3-1.8,1.5-1.5,2.7s1.5,1.8,2.7,1.5s1.8-1.5,1.5-2.7 C60.7,42.6,59.5,41.9,58.3,42.2L58.3,42.2L58.3,42.2z" /><path class="ba-graphics-gray20" d="M76.1,60.7l32.7-8.8L94.1,33.7l3.6-23.1l-16,4.3L79.8,8l-55,14.8L23,16l-3.4,0.9l27.6,103.2l3.4-0.9 L35.9,64.1l38.4-10.3L76.1,60.7z M94.8,13.9l-3.1,19.5l-0.2,1l0.7,0.8l12.4,15.3l-26.8,7.2L76.6,53l14.3-3.8l-8.6-32.1L94.8,13.9z M35.3,61.8l-9.9-36.7L78.2,11L88,47.7L35.3,61.8z" /></symbol>'});a.a.add(s),t.a=s}},["6986996ff9f096db46c3"])})),define("dashboard-analytics/widgets/livewidget/SdkShowError",["jquery","react","react-dom","@ba/ba-ui-carbon-toolkit","prop-types","jquery","../../lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/illustrations-js/disconnect_64","../../lib/@waca/dashboard-common/dist/lib/@ba/ba-graphics/dist/illustrations-js/unknown-warning_128"],(function(e,t,i,o,r,n,a,s){var l=o.Container,d=o.FlexLayout,u=o.FlexItem,c=o.VSpacer,g=o.SVGIcon,h=o.Label,p=function(e){function i(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.call.apply(e,[this].concat(i))||this}return _inheritsLoose(i,e),i.prototype.render=function(){return t.createElement(l,{className:"vis-sdk-error-container"},t.createElement(d,{fullHeight:!0,direction:"column","flex-wrap":"wrap",justifyContent:"center",alignItems:"center"},t.createElement(u,null,t.createElement(g,{iconId:this.props.context.default.id,height:128,width:128})),t.createElement(c,{size:3}),t.createElement(d,{fullHeight:!0,direction:"column","flex-wrap":"wrap",justifyContent:"center"},t.createElement(u,null,t.createElement(h,{className:"vis-sdk-error-header",label:this.props.title}))),t.createElement(c,null),t.createElement(d,{fullHeight:!0,direction:"column","flex-wrap":"wrap",justifyContent:"center"},t.createElement(u,null,t.createElement(h,{className:"vis-sdk-error-msgContent",label:this.props.msgContent}))),t.createElement(c,null)))},i}(t.Component);return p.propTypes={title:r.object.isRequired,msgContent:r.object.isRequired,context:r.object.isRequired},function(){function e(e,t,i,o){this.title=t,this.msgContent=i,this.el=e,this.context="disconnect"===o?a:s}var o=e.prototype;return o.showError=function(){this.$errorContainerWrapper=n('<div class="vis-sdk-error-container-wrapper errorContainer"></div>'),this.el.append(this.$errorContainerWrapper[0]),i.render(t.createElement(p,{title:this.title,msgContent:this.msgContent,context:this.context}),this.$errorContainerWrapper[0])},o.destroy=function(){this.$errorContainerWrapper&&i.unmountComponentAtNode(this.$errorContainerWrapper[0])},e}()})),define("dashboard-analytics/widgets/livewidget/TableJoinError",["jquery","react","react-dom","@ba/ba-ui-carbon-toolkit","prop-types","./nls/StringResources"],(function(e,t,i,o,r,n){var a=o.FlexLayout,s=o.FlexItem,l=o.SVGIcon,d=o.Label,u=o.Button,c=function(e){function i(){return e.apply(this,arguments)||this}return _inheritsLoose(i,e),i.prototype.render=function(){return t.createElement(a,{className:"tableJoin-error-container",fullHeight:!0,direction:"column",justifyContent:"space-between",alignItems:"flex-start"},t.createElement(s,null,t.createElement(l,{className:"tableJoin-error-icon",iconId:this.props.iconId,size:"small"}),t.createElement(d,{className:"tableJoin-error-message",label:this.props.message})),t.createElement(s,null,t.createElement(u,{kind:"ghost",className:"tableJoin-error-fix-edit",disabled:this.props.readOnly,onClick:this.props.onClick},n.get("fixTableJoin_edit"))))},i}(t.Component);return c.propTypes={iconId:r.object.isRequired,message:r.object.isRequired,readOnly:r.bool.isRequired,onClick:r.function},function(){function e(e,t){this.el=e,this.dashboard=t,this.icons=t.getFeature("Icons"),this.errorContainerWrapper=document.createElement("div"),this.errorContainerWrapper.classList.add("tableJoin-error-container-wrapper","errorContainer"),this.el.append(this.errorContainerWrapper)}var o=e.prototype;return o.showError=function(e){i.render(t.createElement(c,{iconId:this.icons.getIcon("critical").id,message:e||n.get("tablesNotJoined"),readOnly:this.dashboard.getMode()!==this.dashboard.MODES.EDIT,onClick:this.onClickFixTableJoin.bind(this)}),this.errorContainerWrapper)},o.destroy=function(){this.errorContainerWrapper&&(i.unmountComponentAtNode(this.errorContainerWrapper),this.errorContainerWrapper.remove())},o.onClickFixTableJoin=function(){var e=this.dashboard.getDashboardCoreSvc(".CanvasExtensions");if(e){var t=e.splitPaneView.getSplitter(),i="story"===this.dashboard.getApplicationName()?1:0;t.toggleItemWithIndexAndBroadcast(i,!0,{sender:"relationships"})}},e}()})),define("dashboard-analytics/view/features/content/LiveWidgetInternal/api/LiveWidgetInternalAPI",[],(function(){return function(){function e(){}var t=e.prototype;return t.getWidget=function(){},t.getVisView=function(){},e}()})),define("dashboard-analytics/view/features/content/LiveWidgetInternal/LiveWidgetInternal",["../../../../lib/@waca/dashboard-common/dist/core/APIFactory","./api/LiveWidgetInternalAPI"],(function(e,t){return function(){function i(e){this.widget=e.widget}var o=i.prototype;return o.getAPI=function(){return this.api||(this.api=e.createAPI(this,[t])),this.api},o.getWidget=function(){return this.widget},o.getVisView=function(){return this.widget.getCurrentVis()},o.getPropertySupport=function(){return this.widget.visModelManager.propertySupport},i}()})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/utils/SkeletonPlaceholder",["react","prop-types"],(function(e,t){var i,o;return o=i=function(t){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(i,t),i.prototype.remove=function(){this.props.shown=!1},i.prototype.render=function(){if(this.props.shown){if(this.props.placeholderImage){var t=this.props.placeholderImage;return e.createElement("div",{className:"skeletonPlaceholder"},e.createElement("div",{className:"shimmer"},e.createElement("img",{src:t,alt:this.props.alt})))}return this.props.placeholderSVG?e.createElement("div",{className:"skeletonPlaceholder"},e.createElement("div",{className:"shimmer"},e.createElement("svg",{className:"shimmer",x:"0px",y:"0px",width:"256px",height:"256px",viewBox:"0 0 256 256"},e.createElement("use",{xlinkHref:this.props.placeholderSVG})))):e.createElement("div",{className:"skeletonPlaceholder noimage"})}return null},i}(e.Component),i.propTypes={placeholderImage:t.img,placeholderSVG:t.svg,alt:t.string,shown:t.bool},o})),define("dashboard-analytics/widgets/livewidget/LiveWidget",["./DeprecateWidgetBase","../../widgets/livewidget/nls/StringResources","jquery","../../lib/@waca/core-client/js/core-client/utils/Deferred","underscore","./VisualizationCreator","./models/LiveWidgetModel","./features/FeatureLoader","../../visualizations/renderer/filter/FilterLabelHelper","../../visualizations/vipr/VIPR","../../visualizations/vipr/VIPRLibraries","./SdkShowError","./TableJoinError","./util/VisUtil","./nls/StringResources","../../view/features/content/LiveWidgetInternal/LiveWidgetInternal","../../lib/@waca/dashboard-common/dist/utils/MemUtil","react","react-dom","../../lib/@waca/dashboard-common/dist/utils/SkeletonPlaceholder"],(function(e,t,i,o,r,n,a,s,l,d,u,c,g,h,p,f,m,v,b,y){"use strict";var C=e.extend({ajaxSvc:null,palettePropertyToTypeMap:{condColorPalette:"ConditionalPalette",contColorPalette:"HeatPalette",colorPalette:"ColorPalette"},init:function(e){var t=this;C.inherited("init",this,arguments),this.contentFeatureLoader=e.contentFeatureLoader,this.visualization=this.content.getFeature("Visualization.internal"),this.predictData=e.predictData,this.interactivitySettings=e.interactivitySettings||{},this.forceDisabledThumbnail=e.forceDisabledThumbnail,this.isFocusModeDisabled=!!e.focusModeDisabled,this._managesOwnQueries=e.managesOwnQueries||!1,this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this.ajaxSvc=this.dashboardApi.getGlassCoreSvc(".Ajax"),this.transaction=this.dashboardApi.getFeature("Transaction"),this.featureSet=e.featureSet,e.widgetModel?this.model=e.widgetModel:e.widgetSpec?this.model=new a(e.widgetSpec):this.logger.error("LiveWidget expects its widgetModel in the constructor."),this.renderCompleteDeferred=new o,this._isCurrentlyRendering=!0,this._renderCount=0,this.rerenderOnShow=null,this.updateDecorationsOnShow=!1,this._dropTargets=[],this.initialConfigJSON&&(this.bOpeningBoard=!!this.initialConfigJSON.visId,this.options=e,this.createFeatureLoaderAndVisualizationPromise=this.createFeatureLoaderAndVisualizationAPI()),this.api={getId:this.getId.bind(this),changeVisType:this.onPropertyUpdate.bind(this),aggregate:this.changeAggregation.bind(this),getDOM:this.getDOM.bind(this),myClass:"LiveWidget - api"},this._extendAPI({getVisualization:this.getVisualizationApi.bind(this)}),this._extendAPI({getWidgetLocalFilters:this.getWidgetLocalFilters.bind(this),getWidgetGlobalFilters:this.getWidgetGlobalFilters.bind(this),getWidgetTopBottom:this.getWidgetTopBottom.bind(this),getDataGridHelpers:this.getDataGridHelpers.bind(this),getMatchingFeatures:this.getMatchingFeatures.bind(this),getVisApi:function(){return t.visAPI},getVisId:this.getVisId.bind(this),render:this.render.bind(this),whenRenderStart:this.whenRenderStart.bind(this),whenRenderComplete:this.whenRenderComplete.bind(this),updateTitle:this.updateTitle.bind(this),allowShowTabs:this.allowShowTabs.bind(this)}),this._setupDND(e.widgetContainer),this.colorsService=this.dashboardApi.getFeature("Colors")},getWidgetTopBottom:function(){var e=[],t=[];if(this.visAPI){var i=new l({dataSource:this.visualization.getDataSource(),visAPI:this.visAPI});(e=this.visAPI.getTopBottomInfo()).length>0&&(t=i.generateTopBottomListItems(e))}return t},_prepareAsyncCallback:function(e){return function(){return this._destroyed?Promise.reject("The live widget object was destroyed"):e.apply(void 0,arguments)}.bind(this)},registerLiveWidgetInternal:function(){this.contentFeatureLoader.registerFeature(this.id,"livewidget.internal",new f({widget:this}))},initialize:function(){var e=this;return this.registerLiveWidgetInternal(),this.createFeatureLoaderAndVisualizationPromise.then(this._prepareAsyncCallback((function(){return e._ondataSourceChange||(e._ondataSourceChange=e.visualization.on("change:dataSource",(function(){e.registerShapingModelEvents()}))),e.registerShapingModelEvents(),e.createVisualization(e.content.getFeature("Visualization.legacy").getLegacyManagers())})))},registerShapingModelEvents:function(){var e=this;this._removeShapingModelEvents();var t=this.visualization.getDataSource();if(t){var i=this.dashboardApi.getFeature("dataSources.deprecated");i&&i.getModule(t.getId()).then(this._prepareAsyncCallback((function(t){e.shapingEventHandler=t.on("shapingmodel:changed",e._onShapingModelChange.bind(e))})))}},_onShapingModelChange:function(e){this.visAPI&&(this.visAPI.clearModelInvalid(),this.visAPI.validateFilters()),e.noRefresh||this._refreshWidgets(e),this.trigger("shapingmodel:changed",e)},_removeShapingModelEvents:function(){this.shapingEventHandler&&(this.shapingEventHandler.remove(),this.shapingEventHandler=null)},createFeatureLoaderAndVisualizationAPI:function(){return this.featureLoader=new s(this.getAPI(),this.dashboardApi),this.featureLoader.loadFeatures(this.featureSet)},getVisualizationApi:function(){return this.visualization},setFeatureEnabled:function(e,t){this.featureLoader.setFeatureEnabled(e,t)},getFeature:function(e){return this.featureLoader.getFeature(e)},getMatchingFeatures:function(e){return this.featureLoader.getMatchingFeatures(e)},getExtraRenderSequenceSteps:function(){return this.featureLoader.getExtraRenderSequenceSteps()},isOptimizeForSize:function(){return this.optimizeForSize},getInteractivitySettings:function(){return this.interactivitySettings},getDataGridHelpers:function(){var e=this;return{getData:function(){return e.get("data")},getPageContextApi:function(){return e.pageContextAPI},getVisApi:function(){return e.visAPI}}},getDecoratorAPI:function(e){return e=e||0,this._callVisFunction("getDecoratorAPI",e)},getDecoratorAPIs:function(){return this._callVisFunction("getDecoratorAPIs")},getCustomData:function(){return this._currVis&&this._currVis.predictHandler&&this._currVis.predictHandler.getCustomData&&this._currVis.predictHandler.getCustomData()},generateThumbnail:function(e){return this._callVisFunction("generateThumbnail",e,Promise.resolve(void 0))},_initializeAppSettings:function(){this._hostApplicationName=this.dashboardApi.getAppConfig("hostApplicationName"),this._thumbnailConfig=this.dashboardApi.getAppConfig("thumbnail"),-1!==[!1,"false"].indexOf(this._thumbnailConfig)&&(this._thumbnailConfig=!1)},getFredIsRed:function(){if(this.boardModel&&this.boardModel.properties&&this.boardModel.properties.fredIsRed)return this._fredIsRed},createVisualization:function(e){var t;if(this._visualizationCreator||(this._visualizationCreator=new n({legacyManagers:e,ownerWidget:this,widgetModel:this.model,dashboardAPI:this.dashboardApi,logger:this.logger,initialConfigJSON:this.options.initialConfigJSON,content:this.content,contentFeatureLoader:this.contentFeatureLoader})),this.dashboardApi){var i=this.dashboardApi.getFeature("SynchronizeDataService"),o=this.boardModel;this._fredIsRed=this.dashboardApi.getFeature("FredIsRed");var r=o.get("pageContext");this._visualizationCreator&&(this._visualizationCreator.setPageContext(r&&r.getAPI()),this._visualizationCreator.setSynchronizeData(i),t=this._visualizationCreator.createVisualization())}else t=this._visualizationCreator.createVisualization();return t},_rebuildVis:function(e){var t=this;return this.setNotRendered(),this.clearCurrentVisualization(),this._visualizationCreator.recreateVisualization(e).then(this._prepareAsyncCallback((function(){return t.render()})))},setVisModelManager:function(e,t){this.visModelManager=e,this.visAPI=t,this.visualization.on("change:slots",this._onChangeSlots,this)},setReRenderOnShow:function(e){this.rerenderOnShow=e},allowShowTabs:function(){return this.getDashboardApi().getAppConfig("showTabs")||!1?!this.visualization.isPreview():this.isInFocusMode&&this.isInFocusMode()},_onChangeSlots:function(e){this.updateTitle(),this.visualization.getSlots().isMappingComplete()||this._currVis&&this._currVis.eventHandler&&this._currVis.eventHandler.clearCustomDataSelection({payloadData:{transactionToken:e&&e.transactionToken}})},updateTitle:function(){var e=this,t=this.content.getFeature("SmartTitle");if(!0===(t&&t.shouldUseGeneratedTitle())){var i={payloadData:{runtimeOnly:!0}};return this.visualization.getSlots().isMappingComplete()?this.content.getFeature("Visualization.SmartsRecommender.deprecated").getRecommendedTitle().then(this._prepareAsyncCallback((function(o){if(t&&t.shouldSetTitle(o)){var r=t&&t.getTitleHtmlWithPreviousFormat(o);e._setTitle(o,r,i)}}))).catch(this._prepareAsyncCallback((function(t){e.logger.error("Could not get title for vis"),e.logger.error(t),e._setTitle(null,null,i)}))):(i.silent=!0,this._setTitle(null,null,i),Promise.resolve())}return Promise.resolve()},_setTitle:function(e,t,i){this.visModelManager&&this.visModelManager.setTitle(e,t,i)},getTitle:function(){return this.visModelManager.getTitle()},isAnOverridableVisProperty:function(e){return!{fillColor:!0,borderColor:!0,transparency:!0,showTitle:!0,titleMode:!0,responsiveTitle:!0,saveTitle:!0,queryRefresh:!0}[e]},_onRetry:function(){this.visAPI.clearModelInvalid(),this.visAPI.getRenderSequence().reRender({refreshAll:!0})},_updateErrorType:function(e){return e&&"dwPromptSignonCancelWarning"===e?"warning":C.inherited("_updateErrorType",this,arguments)},_updateErrorContainer:function(e,o){if("dwPromptSignonCancelWarning"===e){var r=i('<div class="retry">'+t.get("retry")+"</div>");r.on("primaryaction",this._onRetry.bind(this)),o.append(r)}},destroy:function(){this._ondataSourceChange&&this._ondataSourceChange.remove(),this.visualization&&this.visualization.off("change:slots",this._onChangeSlots,this),this._currVis&&this._currVis.remove(!0),this.visModelManager&&this.dashboardApi.getDashboardCoreSvc("TranslationService").deregisterView(this.visModelManager.id),this.featureLoader&&this.featureLoader.unloadFeatures(),this._dropTargets&&this._dropTargets.forEach((function(e){return e.remove()})),this.visExpandMode&&this.visExpandMode.destroy(),this._visualizationCreator&&this._visualizationCreator.destroy(),this._destroyCustomErrors(),C.inherited("destroy",this,arguments),m.destroy(this)},_destroyCustomErrors:function(){this.sdkShowError&&(this.sdkShowError.destroy(),this.sdkShowError=null),this.tableJoinError&&(this.tableJoinError.destroy(),this.tableJoinError=null)},setEventRouter:function(){C.inherited("setEventRouter",this,arguments)},getScope:function(){for(var e,t=this.content;t;)(t=t.getContainer())&&"page"===t.getType()&&(e=t);return e&&e.getId()||this.getContainerPageId()},getWidgetModelForPinning:function(){var e=i.extend(!0,{},this.model);delete e.containerPageId;var t=this.visAPI.getAllFiltersAsLocalFiltersForPinning();return t?(e.localFilters=t,delete e.filters,e):e},setNotRendered:function(e){e&&(this.isRendered=!1)},removeLoadingAnimation:function(){clearTimeout(this.showLoadingAnimationTimer),this.$loadingIndicatorEl&&(this.$loadingIndicatorEl.remove(),this.$loadingIndicatorEl=null)},showLoadingAnimation:function(){var e=this;this.showLoadingAnimationTimer&&clearTimeout(this.showLoadingAnimationTimer),this.showLoadingAnimationTimer=setTimeout((function(){if(!m.isDestroyed(e)&&!e.$loadingIndicatorEl){e.$loadingIndicatorEl=i('<div class="skeletonPlaceholderContainer"></div>'),e.$el.append(e.$loadingIndicatorEl);var t=e._getPlaceholder()||"dashboard-analytics/images/placeholders/autoviz.svg";e._firstRenderComplete&&(t=null),e.skeletonPlaceholder=b.render(v.createElement(y,{shown:!0,placeholderImage:t}),e.$loadingIndicatorEl[0])}}),1e3)},renderError:function(e,t){void 0===t&&(t={}),this._destroyCustomErrors(),this._handleCustomVisError(e,t)||this._handleTableJoinError(e,t)||C.inherited("renderError",this,arguments)},_handleCustomVisError:function(e,t){var i=this._getCustomVisErrorContext(t.errorInfo);if(i){var o=null;return this.hasError()||(o=this.$el.children()).detach(),this.el&&(this.$el.find(".errorContainer").remove(),this.errorMessage=e,this.updateWidgetArialabel(e),this.sdkShowError=new c(this.$el[0],i.msgTitle,i.msgBody,i.msgIcon),this.sdkShowError.showError(),this.addErrorDetailsHandler(),this.renderComplete&&this.renderComplete(),o&&(this._$originalContentBeforeError=o)),!0}return!1},_getCustomVisErrorContext:function(e){var t;if(void 0===e&&(e={}),e&&e.errorCode===u.LOAD_DEFINITION_ERROR){var i,o="visualizationPreview"===e.id;o||(i=!u.isSystemLib(e.id,d.getSystemLibIds())),(i||o)&&(e.isRendered=!0,t={msgTitle:i?p.get("extPermissionTitle"):p.get("extVisNoSDKConnection"),msgBody:i?p.get("extPermissionBody"):p.get("extVisNoSDKPreviewMsg"),msgIcon:i?"permission":"disconnect"})}return t},_handleTableJoinError:function(e,t){if((this.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard","RelationshipsView","enabled")||this.dashboardApi.getConfiguration("showRelationships"))&&t.errorInfo&&t.errorInfo.data){var i=["XQE-MSR-0008","XQE-PLN-0091"];if(t.errorInfo.data.errors.find((function(e){return i.indexOf(e.code)>-1})))return this.tableJoinError=new g(this.$el[0],this.dashboardApi),this.tableJoinError.showError(null),this.renderComplete(),!0}return!1},clearCurrentVisualization:function(){this._currVis&&(this._currVis=null)},_getShapableSlotAPI:function(e){e=e||{};var t=this.visualization.getSlots().getMappedSlotList();if(!t||0===t.length)return null;var i=e.dropNode;return i&&i.dataset&&i.dataset.slotId?this.content.getFeature("Visualization").getSlots().getSlot(i.dataset.slotId):r.find(t,(function(e){return!0===e.getDefinition().getProperty("shapable")}))},onHeatScalePaletteChanged:function(){C.inherited("onHeatScalePaletteChanged",this,arguments),Promise.resolve()},onCustomPaletteChanged:function(e,t){var i=this;C.inherited("onCustomPaletteChanged",this,arguments);var o=!1,r=!1;for(var n in this.palettePropertyToTypeMap)this.visAPI.getPropertyValue(n)===e&&(o=!0,"condColorPalette"===n&&(r=!0),"delete"===t&&this.updateVisProperties({id:n,value:this.colorsService.getDefaultPaletteName(this.palettePropertyToTypeMap[n])},{payloadData:{skipUndoRedo:!0}}));var a=r?this.visAPI.updateConditionalPalette():Promise.resolve();return a.then(this._prepareAsyncCallback((function(){if(o)return i.visAPI.getRenderSequence().reRender()})))},onPagefillColorChange:function(){e.inherited("onPagefillColorChange",this,arguments),this._reRenderVisibleVis()},onDashboardColorSetChanged:function(){C.inherited("onDashboardColorSetChanged",this,arguments),this._reRenderVisibleVis()},_reRenderVisibleVis:function(){return this.isVisible()?this.visAPI.getRenderSequence().reRender():(this.setReRenderOnShow({resizing:!0}),Promise.resolve({isVisible:!1}))},onColorPaletteChanged:function(){C.inherited("onColorPaletteChanged",this,arguments)},onFredIsRedChanged:function(){if(this.isVisible())return this.visAPI.getRenderSequence().reRender();this.setReRenderOnShow({resizing:!0})},registerEvents:function(){C.inherited("registerEvents",this,arguments),this.dashboardApi.on("pagecontext:filterContextUpdated",this.onPageContextChanged,this),this.dashboardApi.on("pagecontext:brushingContextUpdated",this.onPageContextChanged,this),this.dashboardApi.on("synchronize:pageContextFilters",this._setSynchronizePageContextFilters,this),this.dashboardApi.on("ambiguousConnection:resolved",this.onAmbiguousConnectionResolved,this);var e=this.dashboardApi.getFeature("internal");e&&e.getBoardModel().properties.on("change:fredIsRed",this.onFredIsRedChanged,this)},unregisterEvents:function(){C.inherited("unregisterEvents",this,arguments),this.dashboardApi.off("pagecontext:filterContextUpdated",this.onPageContextChanged,this),this.dashboardApi.off("pagecontext:brushingContextUpdated",this.onPageContextChanged,this),this.dashboardApi.off("synchronize:pageContextFilters",this._setSynchronizePageContextFilters,this),this.dashboardApi.off("ambiguousConnection:resolved",this.onAmbiguousConnectionResolved,this),this.boardModel&&this.boardModel.properties.off("change:fredIsRed",this.onFredIsRedChanged,this)},isVisible:function(){return i(this.el).parent().is(":visible")},reRender:function(e){return this.isVisible()?this.visAPI.reRender(e):(this.setReRenderOnShow({refresh:{data:!0},extraInfo:e}),Promise.resolve({isVisible:!1}))},render:function(e){var t,i=this;return void 0===e&&(e=null),this.isVisible()?(console.debug("waiting to Render..."),this.isRendered=!0,t=Promise.all([this.whenContainerIsReady.promise,this.readyDfd.promise]).then(this._prepareAsyncCallback((function(){console.debug("wait complete...containerIsReady/getRenderSequence and render"),i.visModelManager||(i.visModelManager=i._visualizationCreator.visModelManager);var t={undoRedoTransactionId:i.addPayloadData&&i.addPayloadData.undoRedoTransactionId,transactionToken:i.addPayloadData&&i.addPayloadData.transactionToken};0!==i._renderCount&&(e=e||{refreshAll:!0});var o=i.visualization.getDefinition().getPreferredSize();return o&&i.setPreferredSize(o,t),i.visAPI.getRenderSequence().render(e).then(i._prepareAsyncCallback((function(e){var t=i.dashboardApi.getAppConfig("expandWidget")||!1;return i.toggleExpanded(t).then((function(){return e}))})))})))):(console.debug("Widget Invisible. Skipping render"),t=Promise.resolve({isVisible:!1})),t},_getDnDTargetData:function(){return{el:this.el,type:"widget.live",info:{node:this.el,contentId:this.content.getId()}}},accepts:function(e){var t=this.content.getFeature("VisDnD");return t&&t.accepts(e,this._getDnDTargetData())},onDrop:function(e){var t=this.content.getFeature("VisDnD");t&&t.onDrop(e,this._getDnDTargetData())},_getDnD:function(){return this.dashboardApi.getFeature("DashboardDnd.internal")||this.dashboardApi.getFeature(".DndManager")},_setupDND:function(e){var t=this;this._initializeAppSettings();var o=this._getDnD(),r=function(o){var r=o&&o.info&&o.info.node,n=r;!i(r).is(".widgetFocus *")&&e&&(n=e),t._dropTargetNode=n,i(n).addClass("draggedOn"),t._showVisualizationDropZones()},n=function(e){i(t._dropTargetNode).removeClass("draggedOn"),t._hideVisualizationDropZones(e)};this._dropTargets.push(o.registerDropTarget({el:this.el,type:"widget.live",info:function(e,i){return{dragInfo:{position:{x:i.clientX,y:i.clientY}},node:e,contentId:t.content.getId(),onDragEnter:r,onDragLeave:n}}})),e&&this._dropTargets.push(o.registerDropTarget({el:e,type:"widget.live",info:function(e,i){return{dragInfo:{position:{x:i.clientX,y:i.clientY}},node:e,contentId:t.content.getId(),onDragEnter:r,onDragLeave:n}}}))},_getPlaceholder:function(){var e=this.visualization.getDefinition();return e&&e.getPlaceholderIconUri()},_showVisualizationDropZones:function(){if(this.visualization.getSlots().isMappingComplete()){var e=this._getContent().getFeature("DropZonesOverlayDOM"),t=this._getContent().getFeature("DropZonesOverlayState");t&&(e.isMounted()?t.show():e.render(),e.reassessDropTarget(this._dropTargetNode))}},_hideVisualizationDropZones:function(e){var t=this._getContent().getFeature("DropZonesOverlayState");if(t&&this.visualization.getSlots().isMappingComplete()){var i=e&&e.info,o=!i||!i.node||!i.contentId||i.contentId!==this.content.getId(),r=this._currVis&&this._currVis.containsSubContent&&this._currVis.containsSubContent(i&&i.contentId);o&&!r&&t.hide()}},postRenderAnimation:function(){setTimeout((function(){i(".dialogBlocker .card").addClass("doneAnim")}),500),setTimeout(this.resize.bind(this),50)},getWidgetLocalFilters:function(){var e=[];if(this.visAPI){var t=this.visAPI.getFilterInfo();if(t&&t.localFilters&&t.localFilters.length>0)e=new l({dataSource:this.visualization.getDataSource(),dashboardApi:this.dashboardApi}).generateFilterListItems(t.localFilters)}return e},getWidgetGlobalFilters:function(){var e,t=[],i=new l({dataSource:this.visualization.getDataSource(),dashboardApi:this.dashboardApi});return(e=this.visAPI.getFilterInfo()).filters.length>0&&(t=i.generateFilterListItems(e.filters)),t},getVisId:function(){return this.model.visId},onShow:function(e){var t;if(!this.isRendered||this.rerenderOnShow){var i=!(e&&e.isBackgroundRun);this.featureLoader.setMatchingFeaturesEnabled("interactive-only",i);var o=this.isRendered&&this.rerenderOnShow?this.rerenderOnShow:null;i&&this.isVisible()?this.rerenderOnShow=null:this._addInteractiveStepsToRerenderOnShow(),t=this.render(o,i)}else this._callVisFunction("onVisible"),t=Promise.resolve();if(this.updateDecorationsOnShow){var r=this.getDecoratorAPI();r&&r.updateDecorations(),this.updateDecorationsOnShow=!1}return t},_addInteractiveStepsToRerenderOnShow:function(){var e=this,t=this.featureLoader.getMatchingFeatureStepIds("interactive-only");t.length&&(this.rerenderOnShow=this.rerenderOnShow||{},this.rerenderOnShow.refresh=this.rerenderOnShow.refresh||{},t.forEach((function(t){e.rerenderOnShow.refresh[t]=!0})))},_completeRenderStart:function(e){this.renderStartDeferred&&(this.renderStartDeferred.resolve(e),this.renderStartDeferred=null)},renderStart:function(e){void 0===e&&(e={hideToolbar:!0});var t=void 0===e.hideToolbar||!!e.hideToolbar,i={renderCount:this._renderCount,isInitial:!!e.initial,isResizing:!!e.resizing};(e.refreshAll||e.refresh&&e.refresh.visView)&&(this._firstRenderComplete=!1),i.isResizing&&t&&this.dashboardApi.triggerDashboardEvent("widget:hideToolbar"),this._triggerTitlePreparation(),this.trigger("renderStart",i);var r=this._getContent();if(r){var n=r.getFeature("state.internal");n.setStatus(n.STATUS.RENDERING)}return e.initial||this._isCurrentlyRendering?(this._isCurrentlyRendering=!0,this._completeRenderStart(i),!1):(this._isCurrentlyRendering=!0,this.renderCompleteDeferred=new o,this._completeRenderStart(i),!0)},renderComplete:function(e){void 0===e&&(e={});var t=!!(e&&e.visView&&e.visView.resizing),i=!!this.content.getFeature("RenderSequence").getStateProperty("newData"),o=t&&!i;this._isCurrentlyRendering=!1,this._renderCount++;var r=this.content.getFeature("state.internal");r.setStatus(r.STATUS.RENDERED),this.$el.attr("renderCount",this._renderCount);var n=this.content.getFeature("Visualization"),a=n&&n.getDefinition()?n.getDefinition().getId():"widget-content";if(this.$el.attr("walkme-data-id",a),this.dashboardApi.triggerDashboardEvent("rendered",this.api),this.trigger("renderComplete",{isResizing:o,renderCount:this._renderCount}),this.get("expandOnRender")&&(this.set({expandOnRender:void 0},{merge:!0,remove:!0,silent:!0}),this._invokeLifeCycleHandlers("pre:widget.maximize",{id:this.id})),this.renderCompleteDeferred.resolve({renderCount:this._renderCount,isResizing:o}),this.updateDescription(this._getVisualizationDefaultLabel()),this.layoutAPI&&this.layoutAPI.updateTitle){var s=this.getDashboardApi().getAppConfig("smartTitle"),l=this.content.getFeature("SmartTitle");(s||l&&l.shouldUseGeneratedTitle())&&this.layoutAPI.updateTitle()}},_callVisFunction:function(e,t,i){return this._currVis&&"function"==typeof this._currVis[e]?this._currVis[e].apply(this._currVis,Array.isArray(t)?t:[t]):i},_getVisualizationDefaultLabel:function(){var e=this._callVisFunction("getDescription",null,t.get("visualizationLabel"));return e=t.get("WidgetLabelWithDescripion",{label:e,description:t.get("f10KeyDescription")})},_triggerTitlePreparation:function(){this._titlePrepDone||this.widgetChromeEventRouter&&(this.widgetChromeEventRouter.trigger("title:containerReady",this),this._titlePrepDone=!0)},addTranslationIcon:function(e){var t=this,i=0,o=!1,r=this.getDecoratorAPI(),n=!1,a=this.dashboardApi.getDashboardCoreSvc("TranslationService");return e.forEach((function(e){var s=e.propertyParentModel,l=e.propertyName;if("titleHtml"!==l&&"name"!==l||o){var d=t._decorateWithTranslationIcon(r,s,"!");n=d>0,i+=d}else{var u=t.$el.parent().find(".widgetHeader");a.hasTranslationIcon(u)||(a.appendTranslationIcon(u),o=!0,i++)}})),n&&(this.isVisible()?r&&r.updateDecorations():this.updateDecorationsOnShow=!0),i},removeTranslationIcon:function(e){var t=this,i=0,o=!1,r=this.getDecoratorAPI(),n=!1,a=this.dashboardApi.getDashboardCoreSvc("TranslationService");return e.forEach((function(e){var s=e.propertyParentModel,l=e.propertyName;if("titleHtml"!==l&&"name"!==l||o){var d=t._decorateWithTranslationIcon(r,s,"");n=d>0,i+=d}else{var u=t.$el.parent().find(".widgetHeader");a.hasTranslationIcon(u)&&(a.removeTranslationIcon(u),o=!0,i++)}})),n&&(this.isVisible()?r&&r.updateDecorations():this.updateDecorationsOnShow=!0),i},_decorateWithTranslationIcon:function(e,t,i){var o=0,r=this.content.getFeature("Visualization").getSlots().getSlotList(),n=this.content.getFeature("Visualization").getSlots().getMappedSlotList().reduce((function(e,t){return e[t.getId()]=!0,e}),{}),a=-1;return r.forEach((function(r){var s=r.getDefinition(),l=n[r.getId()];if(l||s.getProperty("mldIndicatorIfUnmapped")){if(a++,s.getProperty("mldTitleProperty")!==t.id||!t.multilingual)return;if(l)r.getDataItemList().forEach((function(t){"_multiMeasuresSeries"!==t.getColumnId()&&(e&&e.decorateItem(a,"attentionBadge",i),o++)}));else s.getProperty("mldIndicatorIfUnmapped")&&(e&&e.decorateItem(a,"attentionBadge",i),o++)}})),o},onAuthoringMode:function(){return C.inherited("onAuthoringMode",this,arguments),this.updateDescriptionWhenDataSourceReady()},onConsumeMode:function(){return C.inherited("onConsumeMode",this,arguments),this.updateDescriptionWhenDataSourceReady()},updateDescriptionWhenDataSourceReady:function(){var e=this,t=this.visualization.getDataSource();return t?t.loadMetadata().then((function(){e.updateDescription(e._getVisualizationDefaultLabel())})):Promise.resolve()},isInFocusMode:function(){return this._isMaximized},isFirstRenderComplete:function(){return this._renderCount>0},whenRenderStart:function(){return this.renderStartDeferred||(this.renderStartDeferred=new o),this.renderStartDeferred.promise},whenRenderComplete:function(){return this.renderCompleteDeferred.promise},onPageContextChanged:function(e){this.visualization&&e&&(e.ignorePageContextChanged&&e.ignorePageContextChanged()||e.noSelfRefresh&&e.noSelfRefresh()&&e.senderMatches&&e.senderMatches(this.id)||e.isInScope(this.getScope())&&(this.visAPI.clearModelInvalid(),this.isVisible()?this._callVisFunction("onChangePageContext",{eventName:"change:pagecontext",changeEvent:e}):this.rerenderOnShow={refresh:{data:!0,annotation:!0}}))},onAmbiguousConnectionResolved:function(e){var t=this.visAPI.getInvalidReason();e&&e.sourceId===this.visAPI.getModule().getSourceId()&&t&&("CQE-801"===t.code||"CQE-802"===t.code)&&this.reRender({refresh:!0})},_sourceIdsMatch:function(e,t){var i=(e=e||{}).getSourceIds?e.getSourceIds():[];return!!t&&r.contains(i,t.getSourceId())},_assetIdsMatch:function(e,t){var i=(e=e||{}).getAssetIds?e.getAssetIds():[];return!!t&&r.contains(i,t.getAssetId())},idsNotInModule:function(e,t){var i=this.visAPI.getModule(),o={getSourceIds:function(){return e},getAssetIds:function(){return t}};return!(!r.isArray(e)||!e.length||this._sourceIdsMatch(o,i))||r.isArray(t)&&!!t.length&&!this._assetIdsMatch(o,i)},changeAggregation:function(e,t,i){this.visModelManager.changeAggregationType(e,t,i)},isContextualGridEnabled:function(){var e=this;return this.visualizationDfd.promise.then(this._prepareAsyncCallback((function(){return e.doesWidgetSupportContextualGrid()})))},onChromeSelected:function(e){C.inherited("onChromeSelected",this,arguments),this.onFocus(),this.isAuthoringMode&&this.widgetChromeEventRouter&&!e&&this.widgetChromeEventRouter.trigger("title:chromeSelected")},onChromeDeselected:function(){C.inherited("onChromeDeselected",this,arguments),this.focusOn=!1,this.isAuthoringMode&&this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("title:chromeDeselected"),this.toggleLassoMode(!1)},onFocus:function(){var e=this;return this.readyDfd.promise.then(this._prepareAsyncCallback((function(){e.refreshPropertiesPane(),e.focusOn=!0})))},onPropertyUpdate:function(e){if(this.isAnOverridableVisProperty(e.category)){var t={id:e.category,value:e.item};this.updateVisProperties(t,{payloadData:{undoRedoTransactionId:e.transactionId||e.undoRedoTransactionId,transactionToken:e.transactionToken},silent:e.silent})}else"saveTitle"===e.category?this.widgetChromeEventRouter&&this.widgetChromeEventRouter.trigger("title:updateModel",e):C.inherited("onPropertyUpdate",this,[e])},getDOM:function(){return this.el},getExpandViewContent:function(e,t){var i=this;return t.addClass("liveWidget"),this.visExpandMode.getExpandModeContent(t).catch((function(e){return i.renderError(e),Promise.reject(e)}))},onExitContainer:function(){this._callVisFunction("onExitContainer")},onEnterContainer:function(){this._callVisFunction("onEnterContainer")},onRestore:function(){this._$focusView&&this._$focusView.find(".focusSidebar").hide();var e=this.dashboardApi.getCanvas().getContent(this.getId()).getFeature("VisExpandMode");return e.restore(),this._$focusView=null,this.$placeholder&&this.$placeholder.remove(),C.inherited("onRestore",this,arguments),this._triggerRefreshPropertyPaneOnceResized()},onMaximize:function(){return C.inherited("onMaximize",this,arguments),this._triggerRefreshPropertyPaneOnceResized()},_triggerRefreshPropertyPaneOnceResized:function(){var e=this;return this._stateAPI.whenStatusChanges(this._stateAPI.STATUS.RENDERING).then((function(){return e._stateAPI.whenStatusChanges(e._stateAPI.STATUS.RENDERED)})).then((function(){return e.dashboardApi.triggerDashboardEvent("properties:refreshPane")}))},reveal:function(){return this._callVisFunction("reveal",null,Promise.resolve())},getEdgeSelection:function(){return!(!this._currVis||!this._currVis.eventHandler)&&this._currVis.eventHandler.getEdgeSelection()},isLassoSelectActive:function(){return!(!this._currVis||!this._currVis.eventHandler)&&this._currVis.eventHandler.isLassoSelectActive()},toggleLassoMode:function(e){return!(!this._currVis||!this._currVis.eventHandler)&&this._currVis.eventHandler.toggleLassoSelect(e)},mapVizRenderForPrint:function(){return this.visAPI.mapVizRenderForPrint()},_setSynchronizePageContextFilters:function(e){void 0===e&&(e={}),this.synchDataFilterEntries=e.synchDataFilterEntries},getSynchDataFilterEntries:function(){return this.synchDataFilterEntries},getTranslationIconEl:function(){return this.$el.parent().find(".widgetHeader")},onHide:function(){this._isCurrentlyRendering&&this.setReRenderOnShow({resizing:!0})},resize:function(){var e=this,t=arguments,i=this._getContent();if(i)return h.validateVisDefinition(i,this.dashboardApi,{visId:this.model.visId}).then((function(t){return!1===e._previousDefinitionState&&!0===t&&i.getFeature("Visualization").getDefinition().refresh(),e._previousDefinitionState=t,t})).then(this._prepareAsyncCallback((function(){return C.inherited("resize",e,t)})));C.inherited("resize",this,arguments)},_getContent:function(){return this.content||(this.content=this.dashboardApi.getCanvas()&&this.dashboardApi.getCanvas().getContent(this.id)),this.content}});return C.getDefaultSpec=function(e,t){var i=t.visId,o=t.dashboardApi.getFeature("VisDefinitions").getById(i).getPreferredSize();return Promise.resolve({model:{mapping:[],type:"live",visId:i,expandOnRender:!0,avatarHtml:'<div class="staticContent"><img src="'+t.avatarIcon+'" style="width:200px; height:200px"></img></div>'},ignoreMe:e,layoutProperties:{style:{width:o&&o.width?o.width+"px":null,height:o&&o.height?o.height+"px":null}}})},C})),define("dashboard-analytics/lib/@waca/dashboard-common/dist/ui/WidgetAddUIHelper",["require","../lib/@waca/core-client/js/core-client/ui/core/Class","jquery","underscore","../nls/StringResources"],(function(e,t,i,o,r){var n=t.extend({init:function(t){n.inherited("init",this,arguments),this.requireFn=t.requireFn||e,this._dashboard=t.dashboardApi,this.logger=t.dashboardApi.getGlassCoreSvc(".Logger"),this.featureChecker=t.dashboardApi.getGlassCoreSvc(".FeatureChecker"),this.settings=t.dashboardApi.getFeature("DashboardSettings")},fetchWidgetList:function(e){var t=this;return this.panelAttributes.glassContext.getCoreSvc(".Ajax").ajax({url:e,cache:!1}).then((function(e){return t.fetchRequiredWidgetAttributes(e).then((function(){return e}))})).catch((function(){var e=r.get("errorLoadingWidgetList");return Promise.reject(e)}))},fetchWidgetListFromPerspective:function(e){var t=this,i=o.filter(this.settings.get(e),(function(e){return!e.featureFlag||!!t.featureChecker.checkValue("dashboard",e.featureFlag,"enabled")})),n={list:i?JSON.parse(JSON.stringify(i)):i};return this.fetchRequiredWidgetAttributes(n).then((function(){return n})).catch((function(){var e=r.get("errorLoadingWidgetList");return Promise.reject(e)}))},fetchRequiredWidgetAttributes:function(e){var t=this,i=[];return o.each(e.list,(function(e){e.options=e.options||{},e.options.ext=t._hasExtensionTemplate(e),!e.title&&e.name&&(e.title=e.options.ext?e.name:r.get(e.name)),e.name||(e.name=e.title),e.options.templatePath&&!e.options.template?i.push(t._loadTemplate(e)):e.options.imageLink?i.push(t._loadImage(e)):i.push(!0),e.url&&(e.getEntries=t.fetchWidgetList.bind(t,e.url))})),i.length?Promise.all(i).then((function(t){e.list=o.filter(e.list,(function(e,i){return t[i]}))})):Promise.resolve()},_loadImage:function(e){return new Promise((function(t){var i=new Image;i.onload=function(){t(!0)},i.onerror=function(){t(!1)},i.src=e.options.imageLink}))},_loadTemplate:function(e){var t=this,r="",n=this._hasExtensionTemplate(e);return n||(r=this.panelAttributes.cdnUrl||""),new Promise((function(a){t.requireFn(["text!"+r+e.options.templatePath],(function(t){if(n){var r=i.parseXML(t),s=i(r).find("svg");if(s.length>0){if(void 0===e.options.viewBox){var l=s.attr("viewBox");if(l)e.options.viewBox=l,e.options.previewBox=e.options.viewBox;else{var d=parseInt(s.attr("width"),10)||100,u=parseInt(s.attr("height"),10)||100;e.options.viewBox="0 0 "+d+" "+u,e.options.previewBox="-10 -10 "+1.2*d+" "+1.2*u}}t="";var c=s.children();o.each(c,(function(e){t+=(new XMLSerializer).serializeToString(e)}))}}e.options.template=t,a(!0)}),(function(e){t.logger.error("Failed to load widget",e),a(!1)}))}))},_hasExtensionTemplate:function(e){return!(!e||!e.options)&&new RegExp("^v[0-9]+/ext/.+$").test(e.options.templatePath)},_getDefaultSpec:function(e,t){if(e.getDefaultSpec)return e.getDefaultSpec(t.name,t.options);var i=t.defaultSpec?JSON.parse(JSON.stringify(t.defaultSpec)):{};return Promise.resolve(i)},_addFillAndBorderToAvatarIfNeeded:function(e,t,i){e.addFillAndBorderToAvatarIfNeeded&&e.addFillAndBorderToAvatarIfNeeded(t,i)},addWidgetBySelection:function(e,t,i){var o=this,r=this._getDashboardApi(e);i=i||{},t.gesture&&t.gesture.preventDefault();var n=e.widget,a=r.getFeature("DashboardDnd.internal");return new Promise((function(s){var l=r.getCanvas(),d=function(e){e&&l.selectWidget(e,{isTouch:"tap"===t.type,options:i.selectOptions?i.selectOptions:void 0}),a.resetDragging(),s(e)};if(e.fragment){var u=l.addFragment({model:JSON.parse(JSON.stringify(e.fragment))});d(u)}else o.requireFn([n],(function(t){l.hasMaximizedWidget()?s(null):o._getDefaultSpec(t,e).then((function(e){e.model.avatarHtml=void 0,e.model.visTypeLocked=!0;var t={spec:e.model};e.layoutProperties&&(t.layout=e.layoutProperties.style);var i=r.getFeature("Transaction"),o=i.startTransaction();l.addContent(t,o).then((function(e){d(e.getId()),s(e.getId())})).finally(i.endTransaction.bind(i,o))})).catch((function(e){o.logger.error(e),s(null)}))}))}))},addWidgetByDrag:function(e,t){var r=this,n=this._getDashboardApi(e);if(e.fragment||e.widget||e.renderer){t.stopPropagation();var a=n.getFeature("DashboardDnd.internal");return new Promise((function(n,s){var l=function(e,t,o,n,a,s){var l,d,u=i("<div>");if(l=d=o.showAvatarImmediately?0:20,u.addClass("avatar"),u.addClass("widget"),a){if(a.model.avatarHtml)u.html(a.model.avatarHtml),a.model.avatarHtml=void 0;else if(a.model.content)u.html(a.model.content);else{var c=document.createElement("div");c.innerHTML='<svg focusable="false" class="ba-common-svgIcon defaultCustomWidgetAvatar" style="vertical-align: middle;"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#dashboard-custom-widgets"></use></svg>',u.html(c)}u.addClass(a.model.type+"Widget")}n&&r._addFillAndBorderToAvatarIfNeeded(n,u,a);var g=s||a&&a.layoutProperties&&a.layoutProperties.style;return g&&u.css(g),{event:o,type:e,data:t,widgetSpec:a||null,widgetType:a&&a.model.type||null,avatar:u,moveXThreshold:l,moveYThreshold:d,showAvatarImmediately:o.showAvatarImmediately||!1}},d=e.fragment;if(d){var u={operation:"new",pinSpec:{contentType:"boardFragment",content:JSON.parse(JSON.stringify(d))}},c=l("pin",u,t,null,null,d.layout&&d.layout.style);return a.startDrag(c),void n(c)}var g=e.widget||e.renderer&&e.renderer.class;r.requireFn([g],(function(i){r._getDefaultSpec(i,e).then((function(e){e.model||(e.model=e.spec),e.model.visTypeLocked=!0;var r=o.extend(e,{operation:"new"}),s=l("widget",r,t,i,e);a.startDrag(s),n(s)})).catch(s)}))}))}return Promise.reject()},_getDashboardApi:function(e){var t=e&&e.options&&e.options.dashboardApi;if(!t)throw new Error("Unable to find dashboardAPI from widget options");return t}});return n})),define("dashboard-analytics/widgets/livewidget/LiveWidgetUIHelper",["../../lib/@waca/dashboard-common/dist/ui/WidgetAddUIHelper"],(function(e){var t=e.extend({init:function(e){t.inherited("init",this,arguments),this.dashboardApi=e.dashboardApi,this.iconsFeature=this.dashboardApi.getFeature("Icons")},getEntries:function(){var e=this;return this.dashboardApi.getFeature("VisDefinitions").getList().filter((function(e){return!0!==e.getProperty("recommendOnly")})).map((function(t){return{label:t.getLabel(),name:t.getId(),icon:e._getVisualizationIcon(t),type:t.getType(),placeholderIcon:t.getPlaceholderIconUri(),content:{title:t.getId(),iconUrl:t.getIconUri(),name:t.getId(),widget:"dashboard-analytics/widgets/livewidget/LiveWidget",options:{visId:t.getId(),avatarIcon:t.getPlaceholderIconUri()}}}}))},_getVisualizationIcon:function(e){var t=this.iconsFeature.getIcon(e.getIcon());return t=void 0===t?e.getIcon():t.id}});return t})),define("dashboard-analytics/widgets/livewidget/features/SampleFeature",[],(function(){"use strict";return function(){function e(e,t){this.widgetApi=e,this.dashboardApi=t,console.debug("feature created")}return e.prototype.getAPI=function(){var e=this;return{testAPI:function(){console.debug("hello from "+e.widgetApi.getId())}}},e}()})),define("dashboard-analytics/dataSources/models/sources/shaping/ShapingModel",["../../../../lib/@waca/dashboard-common/dist/core/Model","underscore"],(function(e,t){"use strict";var i=e.extend({whitelistAttrs:["shapingId","references","embeddedModuleId","embeddedModuleName","embeddedModuleUpToDate","moserJSON"],init:function(e,o){e&&t.defaults(e,{embeddedModuleUpToDate:!0,references:{}}),i.inherited("init",this,arguments),this.moserJSON&&!this.shapingId&&(this.shapingId="__initialShapingID__"),this.logger=o.logger,this._initialShapingId=this.shapingId,this._currentMoserJSONID=this.shapingId,this._initialEmbeddedModuleUpToData=this.embeddedModuleUpToDate},destroy:function(){this.shapingHelper&&this.shapingModelManager&&(this.shapingModelManager.isTemporaryModule()&&(this.shapingHelper.getModuleId()&&this.shapingHelper.getModuleId().indexOf("_sessionTemp")>0||this.shapingHelper.getModuleURL()&&this.shapingHelper.getModuleURL().indexOf("temp-service")>0)&&this.shapingHelper.deleteSessionModule(),this.shapingModelManager.destroy(),this.shapingHelper=null,this.shapingModelManager=null)},getShapingId:function(){return this.get("shapingId")||null},setShapingHelper:function(e){this.shapingHelper=e},setShapingModelManager:function(e){this.shapingModelManager=e},toJSON:function(){var e=this.get("shapingId");return e?!this.shapingHelper||this._currentMoserJSONID&&this._currentMoserJSONID===e||(this._currentMoserJSONID=e,e===this._initialShapingId?this.setEmbeddedModuleUpToDate(this._initialEmbeddedModuleUpToData):this.setEmbeddedModuleUpToDate(!1),this.updateMoserJSON(this.shapingHelper.toJSON())):(this._currentMoserJSONID=null,this.updateMoserJSON(void 0)),i.inherited("toJSON",this,arguments)},setEmbeddedModuleUpToDate:function(e){this.set({embeddedModuleUpToDate:e},{silent:!0,payloadData:{skipUndoRedo:!0}})},updateMoserJSON:function(e){this.set({moserJSON:e},{silent:!0,payloadData:{skipUndoRedo:!0}})},getDeploymentReference:function(e,t,i,o){if(this.embeddedModuleId&&!t[this.embeddedModuleId]&&!i){var r,n=o||"en-us";t[this.embeddedModuleId]=!0,e.push({objects:[{type:"module",searchPath:'storeID("'+this.embeddedModuleId+'")'}],name:(r={},r[n]=this.embeddedModuleId,r)})}},addShapingReference:function(e,t){this.references[e]||(this.references[e]=t,this.set({references:this.references},{silent:!0,payloadData:{skipUndoRedo:!0}}))},removeShapingReference:function(e){this.references[e]&&(delete this.references[e],this.set({references:this.references},{silent:!0,payloadData:{skipUndoRedo:!0}}))}});return i})),define("dashboard-analytics/dataSources/models/sources/SourceModel",["../../../lib/@waca/dashboard-common/dist/core/Model","./shaping/ShapingModel","underscore"],(function(e,t,i){"use strict";var o=e.extend({nestedModels:{shaping:t},whitelistAttrs:["id","assetId","type","clientId","module","name","pinSourceName","shaping","customGroupColumns"],init:function(e){e&&i.defaults(e,{shaping:{},assetId:this._generateUniqueId("assetId")}),o.inherited("init",this,arguments)},destroy:function(){this.getTempModuleUrl()&&this.ajaxSvc&&this.ajaxSvc.ajax({contentType:"application/json; charset=utf-8",url:this.getTempModuleUrl(),type:"DELETE"}),this.get("shaping").destroy()},setAjaxSvc:function(e){this.ajaxSvc=e},setUserProfileSvc:function(e){this.userProfileSvc=e},getDeploymentReference:function(e,t,i){if("error"!==this.state&&"404"!==this.errorCode){var o,r=this.userProfileSvc&&this.userProfileSvc.preferences,n=r&&r.contentLocale||"en-us";if(!t[this.assetId])t[this.assetId]=!0,e.push({objects:[{type:this.type,searchPath:'storeID("'+this.assetId+'")'}],name:(o={},o[n]=this.assetId,o)});this.shaping&&this.shaping.getDeploymentReference(e,t,i,n)}},getIsOlapPackage:function(){return this.get("isOlapPackage")},hasInlineModule:function(){return void 0!==this.module},setTempModuleUrl:function(e){this._tempModuleUrl=e},getTempModuleUrl:function(){return this._tempModuleUrl}});return o})),define("dashboard-analytics/dataSources/models/sources/SourcesCollection",["../../../lib/@waca/dashboard-common/dist/core/Collection","./SourceModel"],(function(e,t){"use strict";return e.extend({modelClass:t,destroy:function(){this.getModels().forEach((function(e){e.destroy()}))},addSource:function(e,i){var o=!(i&&i.allowDuplicateAssetIds),r=this._getExistingSource(e);if(r&&o)return r.id;e.shaping||(e.shaping={}),e.localizedName=e.name,e.cmObjectExists=!0;var n=new t(e);return this.add(n,i),n.id},_getExistingSource:function(e){for(var t=e&&e.assetId,i=e&&e.clientId,o=this.getModels(),r=0;r<o.length;r++)if(!o[r].get("pinSourceName")){if(t&&o[r].get("assetId")===t)return o[r];if(i&&o[r].get("clientId")===i)return o[r]}return null}})})),define("dashboard-analytics/dataSources/models/DataSourcesModel",["../../lib/@waca/dashboard-common/dist/core/Model","./sources/SourcesCollection","underscore"],(function(e,t,i){"use strict";var o=e.extend({nestedCollections:{sources:t},whitelistAttrs:["version","sources"],init:function(e){e&&i.defaults(e,{sources:[],version:"1.0"}),o.inherited("init",this,arguments)}});return o})),define("dashboard-analytics/dataSources/modelapis/modelmanagers/SourceModelManager",["../../../DynamicFileLoader","underscore"],(function(e,t){"use strict";return function(){function i(e){this.sourceModel=e.sourceModel,this.dashboardApi=e.dashboardApi,this.sourcesCollectionManager=e.sourcesCollectionManager,this.sourceModel&&(this.localizedName=this.sourceModel.get("localizedName")||null,this.cmObjectExists=this.sourceModel.get("cmObjectExists")||void 0,this.modificationTime=this.sourceModel.get("modificationTime")||null,this.sourceModel.setAjaxSvc(this.dashboardApi.getGlassCoreSvc(".Ajax")),this.sourceModel.setUserProfileSvc(this.dashboardApi.getGlassCoreSvc(".UserProfile"))),this._loadMetadataProgressHandlers=[]}var o=i.prototype;return o.destroy=function(){this._moduleAPI=null,this._clearLoadMetadataProgressHandlers()},o.getModule=function(t,i,o){var r=this;return this._moduleAPI?this.isInErrorState()?Promise.reject({sourceInfo:{name:this.localizedName}}):(o&&this._moduleAPI.clearTemporaryModule(),this._moduleAPI.whenTemporaryModuleReady().then((function(){return r._moduleAPI}))):(this.modulePromise||(this.modulePromise=e.load(["dashboard-analytics/dataSources/modelapis/ModuleAPI"]).then(this._loadModuleAPI.bind(this,t,i)).then((function(e){return r.modulePromise=null,r.setState("ready",!0),e})).catch((function(e){throw r.dashboardApi.getGlassCoreSvc(".Logger").error(e),r.setState("error",!0),r.modulePromise=null,e})).finally(this._clearLoadMetadataProgressHandlers.bind(this))),this.modulePromise)},o._loadModuleAPI=function(e,t,i){var o=this,r=new(0,i[0])({sourceModel:this.sourceModel,dashboardApi:this.dashboardApi,sourceModelManager:this});return r.load(e,t).then((function(){return o._moduleAPI=r,o._moduleAPI})).catch((function(e){throw o.dashboardApi.getGlassCoreSvc(".Logger").error(e),o.setState("error",!0),o.setErrorCode(e.code,!0),o._moduleAPI=r,e}))},o.getType=function(){return this.sourceModel.get("type")},o.registerLoadMetadataProgressHandler=function(e){this._loadMetadataProgressHandlers.push(e),this._lastLoadMetadataProgressUpdate&&e(this._lastLoadMetadataProgressUpdate)},o._clearLoadMetadataProgressHandlers=function(){this._loadMetadataProgressHandlers=[],delete this._lastLoadMetadataProgressUpdate},o.onLoadMetadataProgress=function(e){var t=this;void 0===e&&(e={}),100!==e.percentage&&(this._lastLoadMetadataProgressUpdate={percentage:e.percentage},this._loadMetadataProgressHandlers.forEach((function(e){e(t._lastLoadMetadataProgressUpdate)})))},o._queryCMObject=function(){return this.hasQueriedCM?Promise.resolve():(this._queryCMObjectPromise||(this._queryCMObjectPromise=this.dashboardApi.getGlassCoreSvc(".Ajax").ajax({url:"v1/objects/"+this.sourceModel.get("assetId")+"?fields=userInterfaces,defaultName,searchPath",type:"GET",headers:{Accept:"application/json"}}).then(this._handleQueryCMObjectSuccess.bind(this)).catch(this._handleQueryCMObjectError.bind(this))),this._queryCMObjectPromise)},o._handleQueryCMObjectSuccess=function(e){var i=e.data.data;this.hasQueriedCM=!0,i&&i.length>0?(this.localizedName=i[0].defaultName,this.modificationTime=i[0].modificationTime,this.sourceModel.searchPath=i[0].searchPath,"package"===i[0].type&&i[0].userInterfaces&&t.indexOf(i[0].userInterfaces,"analysisStudio")>=0?this.sourceModel.isOlapPackage=!0:this.sourceModel.isOlapPackage=!1,this.cmObjectExists=!0):this._setErrorState(),this.sourceModel.get("pinSourceName")&&(this.localizedName=this.localizedName+" - "+this.sourceModel.get("pinSourceName"))},o._handleQueryCMObjectError=function(){this._setErrorState()},o._setErrorState=function(){this.localizedName=this.sourceModel.get("name"),this.cmObjectExists=!1,this.setState("error",!0)},o._isCMDatasourceType=function(){var e=this.getType();return-1!==["module","dataSet2","uploadedFile","package"].indexOf(e)},o.getLocalizedName=function(){var e=this;return this.localizedName?Promise.resolve(this.localizedName):this._isCMDatasourceType()?this._queryCMObject().then((function(){return e.localizedName})):(this.localizedName=this.sourceModel.get("name"),Promise.resolve(this.localizedName))},o.getSearchPath=function(){var e=this;return this.sourceModel.searchPath?Promise.resolve(this.sourceModel.searchPath):this._isCMDatasourceType()?this._queryCMObject().then((function(){return e.sourceModel.searchPath})):Promise.resolve(this.sourceModel.assetId)},o.exists=function(){var e=this;return this._isCMDatasourceType()?void 0!==this.cmObjectExists?Promise.resolve(this.cmObjectExists):this._queryCMObject().then((function(){return e.cmObjectExists})):Promise.resolve(!0)},o.getModificationTime=function(){var e=this;return this.modificationTime?Promise.resolve(this.modificationTime):this._isCMDatasourceType()?this._queryCMObject().then((function(){return e.modificationTime})):Promise.resolve(null)},o.relink=function(e){var t=this;return delete this.localizedName,delete this.modificationTime,delete this.cmObjectExists,this.hasQueriedCM=!1,this.setState("",!0),this.setErrorCode("",!0),this.sourceModel.set(e,{payloadData:{skipUndoRedo:!0}}),this.getModule(null,null,!0).then((function(e){return e.relink(t.sourceModel)})).then((function(e){return e})).catch(this.generalRequestErrorHandler.bind(this)).finally(this._clearLoadMetadataProgressHandlers.bind(this))},o.reloadMetadata=function(){return this._moduleAPI?this._moduleAPI.reloadMetadata().catch(this.generalRequestErrorHandler.bind(this)):Promise.resolve()},o.generalRequestErrorHandler=function(e){throw this.setState("error"),e},o.getState=function(){return this._state||"loading"},o.setState=function(e,t){void 0===t&&(t=!1),this._state=e,this.sourceModel.set({state:e},t?{silent:!0}:{})},o.setErrorCode=function(e,t){void 0===t&&(t=!1),this.sourceModel.set({errorCode:e},t?{silent:!0}:{})},o.getLastModified=function(){return this._lastModified},o.setLastModified=function(e){this._lastModified=e},o.isInErrorState=function(){return"error"===this._state},i}()})),define("dashboard-analytics/dataSources/modelapis/SourceModelAPI",["./modelmanagers/SourceModelManager"],(function(e){"use strict";return function(t){var i=new e(t),o=t.sourceModel,r=t.sourcesCollectionManager;this.on=o.on.bind(o),this.off=o.off.bind(o),this.getId=o.get.bind(o,"id"),this.getLocalizedName=i.getLocalizedName.bind(i),this.getSearchPath=i.getSearchPath.bind(i),this.getModificationTime=i.getModificationTime.bind(i),this.exists=i.exists.bind(i),this.getType=i.getType.bind(i),this.registerLoadMetadataProgressHandler=i.registerLoadMetadataProgressHandler.bind(i),this.getModule=i.getModule.bind(i),this.getModuleAPI=function(){return i._moduleAPI},this.destroy=i.destroy.bind(i),this.relink=i.relink.bind(i),this.getState=i.getState.bind(i),this.setState=i.setState.bind(i),this.getAssetId=o.get.bind(o,"assetId"),this.reloadMetadata=i.reloadMetadata.bind(i),this.getSourceIdsFromAssetId=r&&r.getSourceIdsFromAssetId.bind(r),this.getDeploymentReference=o.getDeploymentReference.bind(o),this.getIsOlapPackage=o.getIsOlapPackage.bind(o),this.getName=o.get.bind(o,"name"),this.getCustomGroupColumns=o.get.bind(o,"customGroupColumns"),this.setCustomGroupColumns=function(e,t){return o.set({customGroupColumns:e},t)}}})),define("dashboard-analytics/dataSources/utils/DashboardSpecUtil",["underscore"],(function(e){return function(){function t(){}return t.getWidgetModelList=function(e){return t.getWidgetList(e).map((function(e){return e.model}))},t.getWidgetList=function(e){return t._getWidgetList(e).map((function(e){return{model:t._getWidgetModel(e),properties:t._getWidgetProperties(e)}})).filter((function(e){return!!e.model}))},t._getWidgetList=function(i){var o=[];return"widget"===i.type&&o.push(i),i.items&&(o=e.flatten([o,i.items.map((function(e){return t._getWidgetList(e)}))])),o},t._getWidgetModel=function(e){return e&&e.features&&e.features.Models_internal},t._getWidgetProperties=function(e){return e&&e.properties||{}},t}()})),define("dashboard-analytics/dataSources/modelapis/modelmanagers/ShapingModelManager",["ca-modeller/shaping","bi/moser/moser.min","underscore","../../nls/StringResources","../../metadata/MetadataColumn","../../utils/DashboardSpecUtil","../../../lib/@waca/core-client/js/core-client/utils/BrowserUtils","../../../lib/@waca/dashboard-common/dist/ui/dialogs/ConfirmationDialog","../../../apiHelpers/SlotAPIHelper"],(function(e,t,i,o,r,n,a,s,l){"use strict";var d={uploadedFile:t.default.UseSpecType.FILE,package:t.default.UseSpecType.PACKAGE,dataSet2:t.default.UseSpecType.DATASET,module:t.default.UseSpecType.MODULE,url:t.default.UseSpecType.URL,report:t.default.UseSpecType.REPORT,socialMediaProject:t.default.UseSpecType.SOCIAL_MEDIA},u=["package"],c=[t.default.MoserObjectTypes.ITEM_TYPE,t.default.MoserObjectTypes.QUERY_SUBJECT,t.default.MoserObjectTypes.FOLDER,t.default.MoserObjectTypes.DEF_LINK_TYPE],g=[t.default.Features.FILTER,t.default.Features.ITEM,t.default.Features.CALCULATION,t.default.Features.RELATIONSHIP];return function(){function h(e){this.dashboardApi=e.dashboardApi,this.sourceModel=e.sourceModel,this.logger=this.dashboardApi.getGlassCoreSvc(".Logger"),this.queryService=this.dashboardApi.getFeature("QueryService"),this.dashboardApi.on("mode:change",this.onModeChange,this),e.sourceModel&&(this.shapingModel=e.sourceModel.get("shaping"),this.shapingModel.setShapingModelManager(this)),this.sourceModelManager=e.sourceModelManager,this.metadataColumnCache={},this._embeddedModule=!0,this._queryTypeParam="module",this._loadedMetadataColumns={}}var p=h.prototype;return p.destroy=function(){this._shapingHelper.destroy(),this._shapingHelper=null,this.module=null,this.tempModuleLoaded=null},p.isTemporaryModule=function(){return this._embeddedModule},p.onModeChange=function(e){return e&&e.authoring?this.ensureTemporaryModule():Promise.resolve(this.module)},p.ensureTemporaryModule=function(e){var t=this;return void 0===e&&(e={}),this.isTemporaryModule()?this.whenTemporaryModuleReady().then((function(){return t.module})):this._loadModule(void 0,e).then(this._setModule.bind(this)).then(this.whenTemporaryModuleReady.bind(this)).catch(this._handleLoadError.bind(this,!1))},p.addWADerivedAttribute=function(e){if(this._initializeFormulaeConverter(),this.formulaeConverter&&this.attributeProcessor){var i=this.module.getQuerySubject()[0],o=this.formulaeConverter.formulaeToV5Expression(e.formulae,t.default.ExpressionType.CALCULATION),r=t.default.createObjectFactory(),n=r.createQueryItem();n.setFacetDefinition(r.createFacetType()),t.default.ModuleUtils.generateObjectId(i,n);var a=r.createPropertyType();a.setName("wa_attributeUniqueName"),a.setValue(e.uniqueName),n.addProperty(a),n.setLabel(e.caption),n.setExpression(o),this.attributeProcessor.execute(n,e.formulae[0]),this._shapingHelper.expressionAddToModuleWithValidation&&this._shapingHelper.expressionAddToModuleWithValidation(n,i)}return Promise.resolve()},p._initializeFormulaeConverter=function(){!this.formulaeConverter&&this.module&&(t.default.FormulaeV5Converter&&(this.formulaeConverter=new t.default.FormulaeV5Converter,this.formulaeConverter.initWithModule(this.module)),t.default.AttributeProcessor&&(this.attributeProcessor=new t.default.AttributeProcessor,this.attributeProcessor.initWithModule(this.module)))},p._setModule=function(e){return this.module&&(this.clearCache(),this.module.removeListener(this.moduleEventListener.bind(this))),this.module=e,e.addListener(this.moduleEventListener.bind(this)),e},p.load=function(e,t){return this._shapingHelper?Promise.resolve():(this._scheduleLoadProgressToasts(),this._createShapingHelper().then(this._loadModule.bind(this,e)).then(this._setModule.bind(this)).catch(this._handleLoadError.bind(this,t)))},p._createShapingHelper=function(){var t=this;return this.dashboardApi.getGlassSvc(".DataConnectionServiceFactory").then((function(e){return e.getDataConnectionResolver({onAmbiguousConnectionResolved:function(){t.dashboardApi.triggerDashboardEvent("ambiguousConnection:resolved",{sourceId:t.sourceModel.id})}})})).then((function(i){var o=t.dashboardApi.getFeature("DashboardDnd.internal"),r=t.dashboardApi.getFeature("AffinityService"),n=!t.sourceModel.getIsOlapPackage(),s=!t.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard","customGroups","disabled"),l=t.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard","showMembers","enabled"),d=t.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("ca-modeller","whatIf","enabled"),u=t.dashboardApi.getGlassCoreSvc(".FeatureChecker").checkValue("dashboard","RelationshipsView","enabled")||t.dashboardApi.getConfiguration("showRelationships")||!1,c={};t.dashboardApi.prepareGlassOptions(c),t._shapingHelper=new e.Shaping(c.glassContext,{glassDnD:o,undoCallback:t.addToUndoStack.bind(t),confirmations:{removeFromModule:t._removeItemsFromModule.bind(t)},affinityService:r,featureConfig:{filterExpressionCreateAction:!0,filterExpressionEditAction:!0,filterExpressionRemoveAction:!0,calculationAction:!0,calculationEditAction:!0,includeImportedObjects:!1,removeAction:!0,expressionEditorEditAction:!0,expressionEditorAction:!0,filterAction:!0,navigationGroupAction:n,sortAction:!0,filterIndividualValues:!1,showFullPackage:!0,showMembers:l||!!t.dashboardApi.getAppConfig("showMembers"),formatAction:!0,useValidationDialog:!0,scrollableTrees:a.isIPad(),showModuleTreeNode:!1,customGroupCreateAction:s,customGroupReplaceAction:s,whatIfAction:d,relationshipCreateAction:u,relationshipEditAction:u,relationshipViewAction:u,removeRelationshipAction:u,autoLayout:u},connectionResolver:i,payload:{dashboard:{getFeature:t.dashboardApi.getFeature}}}),t._shapingHelper.context.shapingHelper=t._shapingHelper,t.shapingModel.setShapingHelper(t._shapingHelper)})).catch((function(e){t.logger&&t.logger.error(e,t)}))},p._removeItemsFromModule=function(){return new Promise((function(e){new s({title:o.get("delete_confirm"),message:o.get("calculation_navigation_in_use"),confirmCallback:function(){e(!0)},cancelCallback:function(){e(!1)}}).render()}))},p.saveTemporaryModule=function(){var e=this;return this.tempModuleLoaded?this.tempModuleLoaded.then((function(){return e._shapingHelper.saveSessionModule()})):Promise.resolve(this._shapingHelper&&this._shapingHelper.getModuleId())},p.clearTemporaryModule=function(){this.tempModuleLoaded=null},p.whenTemporaryModuleReady=function(){return this.tempModuleLoaded||Promise.resolve()},p._onLoadMetadataProgress=function(e){this.sourceModelManager.onLoadMetadataProgress(e)},p._loadModule=function(e,t){void 0===t&&(t={forceTemporaryModule:!1}),this._embeddedModule=!0,this._queryTypeParam="module";var i="authoring"===this.dashboardApi.getMode(),o=this.getMetadataSubsetIds(),r=t.forceTemporaryModule;if(this.sourceModel.hasInlineModule())return this._shapingHelper.createInlineModule(this.sourceModel.module,this.shapingModel.moserJSON);if(this.shapingModel.moserJSON&&(!i&&r||!this.shapingModel.embeddedModuleUpToDate||i))return this.tempModuleLoaded=this._shapingHelper.loadFromJSON(this.shapingModel.moserJSON,{progressCallback:this._onLoadMetadataProgress.bind(this)}),this.tempModuleLoaded;if(e)return this.shapingModel.set({shapingId:"__initialShapingID__"},{silent:!0}),this._shapingHelper.loadFromModuleId(e,this.sourceModel.type,o);if(!i&&r||i&&!1!==this.sourceModel.useTempModule||!0===this.sourceModel.useTempModule)return this.tempModuleLoaded=this._shapingHelper.addSource({id:this.sourceModel.get("assetId"),href:this.sourceModel.get("searchPath"),type:d[this.sourceModel.get("type")],name:this.sourceModel.get("name")},{progressCallback:this._onLoadMetadataProgress.bind(this)}),this.tempModuleLoaded;if(this._embeddedModule=!1,this.shapingModel.embeddedModuleId)return this._shapingHelper.loadFromModuleId(this.shapingModel.embeddedModuleId,"module",o);var n=d[this.sourceModel.get("type")],a=n&&n.value();return this._queryTypeParam=a,this._shapingHelper.loadFromModuleId(this.sourceModel.assetId,a,o)},p.addToUndoStack=function(e,t){var i=this.shapingModel._generateUniqueId("shaping"),o={undoRedoObj:e,prevValue:this.shapingModel.get("shapingId"),value:i},r={sender:"ShapingModelManager",payloadData:t||{},senderContext:{applyFn:this._onUndoRedoShapingChange.bind(this,o)}};this.shapingTransactionToken&&(r.payloadData.transactionToken=this.shapingTransactionToken,r.payloadData.undoRedoTransactionId=this.shapingTransactionToken.transactionId),this.shapingModel.set({shapingId:i},r)},p._onUndoRedoShapingChange=function(e,t){e.prevValue===t?e.undoRedoObj.undo():e.undoRedoObj.redo(),this.shapingModel.set({shapingId:t},{payloadData:{skipUndoRedo:!0}})},p.getShapingHelper=function(e){return void 0===e&&(e=null),this.shapingTransactionToken=e,this._shapingHelper},p.getLocalizedName=function(){return this.sourceModelManager.getLocalizedName()},p._getLoadMetadataFailedMessage=function(e){var t=o.get("dataPreparationSourceError",{sourceName:e}),i=this._getLoadMetadataFailedReasonMessage();return i?t+" "+i:t},p._getLoadMetadataFailedReasonMessage=function(){if("MSR-CPD-2501"===this.sourceModel.get("errorCode"))return o.get("moserUnsupportedSourceType")},p._handleLoadError=function(e,t){var i=this;return this._embeddedModule=!1,this.sourceModel.set({state:"error",errorCode:t.code}),this.getLocalizedName().then((function(r){var n=i.sourceModelManager.cmObjectExists;return t.sourceInfo={exists:n,name:r},!1!==e&&(i._isMissingDatasetData()?i._showToast(o.get("missingDataSetData"),{type:"warning",preventDuplicates:!0}):i._showToast(i._getLoadMetadataFailedMessage(r))),t})).catch((function(){return t.sourceInfo={exists:!1,name:i.sourceModel.name},!1!==e&&i.sourceModel.name&&i._showToast(i._getLoadMetadataFailedMessage(i.sourceModel.name)),t})).finally((function(){throw t}))},p._isMissingDatasetData=function(){return"MSR-GEN-0091"===this.sourceModel.get("errorCode")||"error"===this.sourceModelManager.getState()&&"dataSet2"===this.sourceModelManager.getType()&&this.sourceModelManager.cmObjectExists},p._scheduleLoadProgressToasts=function(){var e=this;setTimeout((function(){if(e.tempModuleLoaded){var t=!1;e.sourceModelManager.registerLoadMetadataProgressHandler((function(i){if(!t&&i.percentage&&i.percentage<60)return t=!0,e._showToastWithSourceName("dataPreparationStarted",{type:"info"}).then((function(){return e.tempModuleLoaded})).then(e._showToastWithSourceName.bind(e,"dataPreparationComplete",{type:"success"}))}))}}),3e3)},p._showToastWithSourceName=function(e,t){var i=this,r=_extends({},t,{preventDuplicates:!0,timeBeforeDismiss:6e3});return this.getLocalizedName().then((function(t){i._showToast(o.get(e,{sourceName:t}),r)})).catch((function(){var t=i.sourceModel.get("name");i._showToast(o.get(e,{sourceName:t}),r)}))},p._showToast=function(e,t){var i=t||{type:"error",preventDuplicates:!0};this.dashboardApi.getFeature("Glass").showToast(e,i)},p._getDashboardOptions=function(e,t,i){var o={};return o.ajaxOptions={headers:{"x-audit-type":e.type,"x-audit-dashboardId":e.isDirty?null:e.boardId,"x-audit-searchPath":e.isDirty?null:encodeURI(e.searchPath),"x-audit-dataSearchPath":encodeURI(t),"x-senderId":i?i.senderId:null}},i&&(i.lastModified&&(o.ajaxOptions.headers["x-model-last-modified"]=i.lastModified),i.queryUserId&&(o.ajaxOptions.headers["x-queryuserid"]=i.queryUserId),i.ipaMode&&(o.ajaxOptions.headers["x-ca-ipa"]="true"),i.getAdditionalHeaders&&(o.ajaxOptions.getAdditionalHeaders=i.getAdditionalHeaders)),o},p.queryData=function(e,t){return this._queryData(e,this._shapingHelper.getData.bind(this._shapingHelper),t)},p.queryPredictData=function(e,t){return this._queryData(e,this._shapingHelper.getPredictData.bind(this._shapingHelper),t)},p.querySmartsExploreRelationshipData=function(e,t){return this._queryData(e,this._shapingHelper.getExploreRelationshipData.bind(this._shapingHelper),t)},p._queryData=function(e,t,i){var o=this;return void 0===i&&(i={}),this.load().then(this.sourceModelManager.getSearchPath.bind(this.sourceModelManager)).then((function(r){var n=o.dashboardApi.getDashboardInfo();return new Promise((function(a,s){try{t(e,"rawResponse",o._queryTypeParam,o._getDashboardOptions(n,r,i),i.qfb,i.qfbMode).then(a).catch((function(t){if(t.responseJSON=t?t.data:{},"object"==typeof e)t.querySpec=e;else if(e)try{t.querySpec=JSON.parse(e)}catch(e){o.logger.error(e)}s(t)}))}catch(e){s(e)}}))}))},p.moduleEventListener=function(e){if(!this._ignoreMoserEvents)switch(e.getType()){case t.default.Notification.ADD:-1!==g.indexOf(e.getFeatureID())&&(this._hasDebounceNotify||(this._debounceShapingNotification=this._createDebouncedShapingNotification()),this._debounceShapingNotification({notification:e,action:"ADD"}));break;case t.default.Notification.SET:case t.default.Notification.REMOVE:if(this.clearCache(),!this._hasDebounceNotify){var i=e.getFeatureID();if(i===t.default.Features.TYPE||i===t.default.Features.SEARCH_PATH||i===t.default.Features.STORE_ID||this._isMembersFolderExpansionNotification(e))return;this._debounceShapingNotification=this._createDebouncedShapingNotification()}var o=e.getType()===t.default.Notification.SET?"SET":"REMOVE";this._debounceShapingNotification({noRefresh:this._checkNotificationProperties(e,"propertySetByUser_label"),notification:e,action:o})}},p._checkNotificationProperties=function(e,t){var o="function"==typeof e.getNotifier&&e.getNotifier();return o&&o.property?i.some(o.getProperty(),(function(e){return"function"==typeof e.getName&&e.getName()===t})):o&&"function"==typeof o.getName&&o.getName()===t},p._isMembersFolderExpansionNotification=function(e){return!(!e.getNotifier||!e.getNotifier()||"memberHidden"!==e.getNotifier().name||"true"!==e.oldValue||"false"!==e.newValue)},p._createDebouncedShapingNotification=function(){var e=this;return this._hasDebounceNotify=!0,i.debounce((function(t){(t=t||{}).sender={};var i=(new Date).toISOString();if(e.sourceModelManager.modificationTime=i,e.sourceModel.set({modificationTime:i},{silent:!0}),void 0!==t.notification.newValue||void 0!==t.notification.oldValue){t.sourceId=e.sourceModel.id;var o=function(e){if("string"==typeof e)try{return JSON.parse(e.trim())}catch(t){return e}return e};t.newValue=o(t.notification.newValue),t.oldValue=o(t.notification.oldValue)}e.shapingModel.trigger("shapingmodel:changed",t),e._hasDebounceNotify=!1,e._unitTestResolve&&e._unitTestResolve()}),0)},p.getModuleId=function(){return this._shapingHelper.context.store.moduleId},p.getMetadataColumn=function(e,t){if(void 0===t&&(t=!0),!e||0===e.indexOf(l.MULTI_MEASURES_SERIES))return null;if(!this.metadataColumnCache[e]){var i=this.getMoserObject(e);if(!i)return t&&this.logger&&this.logger.error("Could not find moser object with id "+e,this),null;this.metadataColumnCache[e]=new r({moserObject:i,sourceId:this.sourceModel.id,queryService:this.queryService})}return this.metadataColumnCache[e]},p._moserVisitorCallback=function(t,i,o,n){if(n.hidden||n.isHidden&&n.isHidden())return!1;if(-1===c.indexOf(n.getObjectType())){var a=n.getIdForExpression?n.getIdForExpression():null;if(a){var s=this.metadataColumnCache[a]||new r({moserObject:n,sourceId:this.sourceModel.id,queryService:this.queryService});if(this._loadedMetadataColumns[a]=s,i(s)&&(t.push(s),o))return e.moserVisitor.BREAK}}return!0},p.getMetadataColumns=function(t,i){return this.metadataColumns&&!t||(this.metadataColumns=[],e.moserVisitor(this.module.metadataTreeView,this._moserVisitorCallback.bind(this,this.metadataColumns,t,i))),this.metadataColumns},p.getMoserObject=function(e){return t.default.ModuleUtils.getMoserObjectByIdForExpression(e,this.module)},p.clearCache=function(){this.metadataColumnCache={}},p.relink=function(e){var i=this;return this._ignoreMoserEvents=!0,this.shapingModel.moserJSON&&this._updateUseSpecInMoserJSON(e),this.clearCache(),this.tempModuleLoaded=this._shapingHelper.relinkSource({source:{id:e.get("assetId"),href:e.get("searchPath"),type:d[e.type]},module:this.shapingModel.moserJSON},{progressCallback:this._onLoadMetadataProgress.bind(this)}),this.tempModuleLoaded.then((function(o){var r;return i.module=o,i.shapingModel.moserJSON=t.default.ModuleUtils.prepareModuleForSave(o),e&&-1===u.indexOf(e.type)&&(r={sourceId:e.id,relinkIdForExpressions:function(e){return void 0===e&&(e=[]),t.default.ModuleUtils.relinkIdForExpressions(null,e,i.module)}}),i.shapingModel.setEmbeddedModuleUpToDate(!1),r})).catch(this._reloadMetadataErrorHandler.bind(this)).finally((function(){i._ignoreMoserEvents=null}))},p._updateUseSpecInMoserJSON=function(e){var i=t.default.createObjectFactory(),o=t.default.createJSONObjectFactory(i).createModule(this.shapingModel.moserJSON),r=o.getUseSpec()[0];r.setSearchPath(e.get("searchPath")),r.setStoreID(e.get("assetId")),r.setType(d[e.type]),this.shapingModel.moserJSON=t.default.ModuleUtils.prepareModuleForSave(o)},p.reloadMetadata=function(){return this.clearCache(),this._isMissingDatasetData()?this.dashboardApi.reloadFromJSONSpec(this.dashboardApi.getSpec()):this._shapingHelper.reloadMetadata().then(this._postReloadMetadataHandler.bind(this,null)).catch(this._reloadMetadataErrorHandler.bind(this))},p.getDrillGroups=function(){return this.module.getDrillGroup()},p._reloadMetadataErrorHandler=function(e){throw this.shapingModel.trigger("shapingmodel:changed",{error:e}),e},p._postReloadMetadataHandler=function(e,t){this.module=t;this.shapingModel.trigger("shapingmodel:changed",{sender:{}})},p.getDrillGroupsForColumn=function(e){var t=this.getDrillGroups();return t&&0!==t.length?t.filter(this._containsSelectedColumn.bind(this,e)):null},p._containsSelectedColumn=function(e,t){return-1!==this._findIndex(t.getSegment(),"ref",e)},p._findIndex=function(e,t,i){if(!e)return-1;for(var o=0;o<e.length;o++)if(e[o][t]===i)return o;return-1},p.addCalculation=function(e){var i=this._shapingHelper.expressionCreateObjectSimpleCalculation(e,null);return i.setRegularAggregate(t.default.RegularAggregateType.CALCULATED),this._shapingHelper.expressionAddToModuleWithValidation(i).then((function(){return i.idForExpression}))},p.getTableNames=function(){var e=this;this.tableNames||(this.tableNames=[],this.module&&this.module.getQuerySubject().forEach((function(t){e.tableNames.push(t.getIdentifier())})));return this.tableNames},p.tablesHaveJointRelationship=function(e,t){if(e&&e.length&&t&&t.length){if(e===t)return-1!==this.getTableNames().indexOf(e);var o=this._getRelationships();if(o){var r=function(e,t,i){return i?e.left===t:e.right===t};return!!i.find(o,(function(i){return r(i,e,!0)&&r(i,t,!1)||r(i,e,!1)&&r(i,t,!0)}))}}},p._getRelationships=function(){var e=this;if(!this.tableRelationships){var t={};this.tableRelationships=[];var i=this.module.getRelationship();i&&i.length&&i.forEach((function(i){var o=i.getLeft(),r=i.getRight();if(o&&r){var n=o.getRef(),a=r.getRef();if(n&&a){var s=n+a;t[s]||(t[s]=!0,e.tableRelationships.push({left:n,right:a}))}}}))}return this.tableRelationships},p.getTemporarySessionModuleJSON=function(){return this.module.toJSON()},p.copyPartialMoserModuleJSON=function(e){var i=t.default.createObjectFactory();return t.default.ModuleUtils.copyPartialMoserModule(this.module,e,i).toJSON()},p._getWidgetSubsetIds=function(e){var t=this,o=[],r=e.layout?n.getWidgetList(e.layout):[],a=Object.values(e.widgets||{}).map((function(e){return{model:e}}));return[].concat(r,a).forEach((function(e){var r=e.model,n=e.properties,a=i.chain(r.data).compact().flatten().filter((function(e){return e.modelRef===t.sourceModel.id})).pluck("dataItems").compact().flatten().filter((function(e){return e.itemId!==l.MULTI_MEASURES_SERIES})).value();a.length>0&&(o.push.apply(o,i.pluck(a,"itemId")),o.push.apply(o,i.chain(a).pluck("selection").compact().flatten().pluck("context").compact().flatten().pluck("itemId").value()),r.localFilters&&o.push.apply(o,t._getWidgetLocalFilterSubsetIds(r.localFilters)),r.savedPrompts&&o.push.apply(o,t._getWidgetSavedPromptsSubsetIds(r.savedPrompts))),n&&n.forecasting&&n.forecasting.multivariates&&n.forecasting.multivariates.forEach((function(e){var t=e.columnId;return o.push(t)}))})),o},p._getWidgetLocalFilterSubsetIds=function(e){var t=this,o=[];return i.each(e,(function(e){"columnId"in e?o.push(e.columnId):"operator"in e&&o.push.apply(o,t._getWidgetLocalFilterSubsetIds(e.values))})),o},p._getWidgetSavedPromptsSubsetIds=function(e){var t=[];for(var i in e)e[i].modelFilterItem&&t.push(e[i].modelFilterItem);return t},p._getShapingReferenceSubsetIds=function(e){var t=this,o=e&&e.dataSources&&e.dataSources.sources,r=o&&o.find((function(e){return e.id===t.sourceModel.id})),n=r&&r.shaping;return n&&i.values(n.references)},p.getMetadataSubsetIds=function(){if("authoring"!==this.dashboardApi.getMode()&&!this.tempModuleLoaded&&!this.sourceModel.hasInlineModule()){if(!this.metadataSubsetIds){var e=this.dashboardApi.getFeature("internal").getBoardModel(),t=this.dashboardApi.getFeature("DataSources.moser");if(e){var o=this.dashboardApi.getFeature("Serializer").toJSON();if(o){var r=[];r.push.apply(r,this._getWidgetSubsetIds(o)),r.push.apply(r,this._getShapingReferenceSubsetIds(o)),r.push.apply(r,t.getMetadataSubsetIds(this.sourceModel.id)),this.metadataSubsetIds=i.uniq(r)}}}return this.metadataSubsetIds}},h}()})),define("dashboard-analytics/dataSources/modelapis/ModuleAPI",["./modelmanagers/ShapingModelManager","../utils/ShapingUIUtils"],(function(e,t){"use strict";return function(i){var o=this,r=new e(i),n=i.sourceModel.get("shaping"),a=i.sourceModelManager,s=a.sourcesCollectionManager;this.on=n.on.bind(n),this.off=n.off.bind(n),this.getShapingUIUtils=function(){return t},this.load=r.load.bind(r),this.queryData=r.queryData.bind(r),this.queryPredictData=r.queryPredictData.bind(r),this.querySmartsExploreRelationshipData=r.querySmartsExploreRelationshipData.bind(r),this.getModuleId=r.getModuleId.bind(r),this.getShapingHelper=r.getShapingHelper.bind(r),this.addCalculation=r.addCalculation.bind(r),this.getMetadataColumn=r.getMetadataColumn.bind(r),this.getMetadataColumns=r.getMetadataColumns.bind(r),this.getMoserObject=r.getMoserObject.bind(r),this.addToUndoStack=r.addToUndoStack.bind(r),this.getDrillGroups=r.getDrillGroups.bind(r),this.getDrillGroupsForColumn=r.getDrillGroupsForColumn.bind(r),this.relink=r.relink.bind(r),this.reloadMetadata=r.reloadMetadata.bind(r),this.tablesHaveJointRelationship=r.tablesHaveJointRelationship.bind(r),this.getTableNames=r.getTableNames.bind(r),this.getLocalizedName=r.getLocalizedName.bind(r),this.ensureTemporaryModule=r.ensureTemporaryModule.bind(r),this.getShapingId=n.getShapingId.bind(n),this.getEmbeddedModuleId=n.get.bind(n,"embeddedModuleId"),this.addShapingReference=n.addShapingReference.bind(n),this.removeShapingReference=n.removeShapingReference.bind(n),this.updateEmbeddedModule=function(){var e=n.shapingHelper;n.setEmbeddedModuleUpToDate(!1),n.updateMoserJSON(e.toJSON())},this.getState=a.getState.bind(a),this.getSourceId=i.sourceModel.get.bind(i.sourceModel,"id"),this.getSourceName=i.sourceModel.get.bind(i.sourceModel,"name"),this.getAssetId=i.sourceModel.get.bind(i.sourceModel,"assetId"),this.isOlapPackage=i.sourceModel.getIsOlapPackage.bind(i.sourceModel),this.getSourceType=i.sourceModel.get.bind(i.sourceModel,"type"),this.getLastModified=a.getLastModified.bind(i.sourceModel),this.setLastModified=a.setLastModified.bind(i.sourceModel),this.getSourceIdsFromAssetId=s&&s.getSourceIdsFromAssetId.bind(s),this.addWADerivedAttribute=r.addWADerivedAttribute.bind(r),this.getTemporarySessionModuleJSON=r.getTemporarySessionModuleJSON.bind(r),this.copyPartialMoserModuleJSON=r.copyPartialMoserModuleJSON.bind(r),this.saveTemporaryModule=r.saveTemporaryModule.bind(r),this.clearTemporaryModule=r.clearTemporaryModule.bind(r),this.whenTemporaryModuleReady=r.whenTemporaryModuleReady.bind(r),this.getMetadataSubsetIds=r.getMetadataSubsetIds.bind(r),this.isMultiSheetUploadedFile=function(){return"uploadedFile"===o.getSourceType()&&o.getTableNames().length>1}}})),define("dashboard-analytics/visualizations/vipr/extendedVis/SchematicEditorUI",["authoring-common"],(function(e){var t=e.SchematicEditor,i=e.DialogWrapper;return function(){function e(){}return e.openSchematicEditor=function(e){if(e){var o,r,n,a=new Promise((function(e,t){o=e,r=t}));return i.show(t,{definition:e,okCallbackFn:function(e){n=e},onCloseDialog:function(){return n?o(n):r()},ref:function(e){e&&e.openDialog()}}),a}},e}()})),define("dashboard-analytics/widgets/layers",["./livewidget/LiveWidget","./livewidget/LiveWidgetUIHelper","./livewidget/models/LiveWidgetModel","./livewidget/features/SampleFeature","../dataSources/models/DataSourcesModel","../dataSources/models/sources/SourcesCollection","../dataSources/modelapis/SourceModelAPI","../dataSources/modelapis/ModuleAPI","../dataSources/modelapis/modelmanagers/SourceModelManager","../visualizations/vipr/extendedVis/SchematicEditorUI"],(function(){})),define("dashboard-analytics/liveWidgetBundle",(function(){}));